{"episode_reward_max": -1501.229011713297, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -1546.7492634458254, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2219909187658272, "mean_inference_ms": 1.112377283848535, "mean_action_processing_ms": 0.13078045522509207, "mean_env_wait_ms": 0.8425403708101683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"learn_time_ms": 5315.52, "learn_throughput": 0.376, "update_time_ms": 11.799}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9962904453277588, "grad_norm": 2.5237720012664795, "td_error_abs": 0.8952725423177084, "q_taken_mean": -0.0020871397654215495, "target_mean": -0.03799388122558594}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 9600, "num_steps_trained": 2, "num_agent_steps_trained": 19200, "last_target_update_ts": 0}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-43-25", "timestamp": 1708857805, "time_this_iter_s": 28.099275588989258, "time_total_s": 28.099275588989258, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 28.099275588989258, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.85263157894736, "ram_util_percent": 8.594736842105263, "gpu_util_percent0": 0.037368421052631585, "vram_util_percent0": 0.02445475260416666}}
{"episode_reward_max": -1203.3780197123308, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -1408.9763037568548, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2230813329882237, "mean_inference_ms": 1.1209717429539892, "mean_action_processing_ms": 0.1314170386016479, "mean_env_wait_ms": 0.8451607517469151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"learn_time_ms": 5202.577, "learn_throughput": 0.384, "update_time_ms": 11.886}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6861459016799927, "grad_norm": 1.6957858800888062, "td_error_abs": 0.6437426350911458, "q_taken_mean": -0.029944424947102866, "target_mean": -0.04082259623209635}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 19200, "num_steps_trained": 4, "num_agent_steps_trained": 38400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-43-54", "timestamp": 1708857834, "time_this_iter_s": 28.373227834701538, "time_total_s": 56.472503423690796, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 56.472503423690796, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.31621621621622, "ram_util_percent": 11.608108108108109, "gpu_util_percent0": 0.013783783783783784, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -1079.875843159467, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -1307.9650239407456, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2239301439148375, "mean_inference_ms": 1.1256363325119547, "mean_action_processing_ms": 0.13170480776449978, "mean_env_wait_ms": 0.848713961191759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"learn_time_ms": 5189.918, "learn_throughput": 0.385, "update_time_ms": 12.012}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3898478746414185, "grad_norm": 16.012962341308594, "td_error_abs": 1.0609947916666667, "q_taken_mean": 0.3077057902018229, "target_mean": -0.03893865712483724}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 28800, "num_steps_trained": 6, "num_agent_steps_trained": 57600, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-44-23", "timestamp": 1708857863, "time_this_iter_s": 28.708312034606934, "time_total_s": 85.18081545829773, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 85.18081545829773, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.786486486486485, "ram_util_percent": 11.65675675675676, "gpu_util_percent0": 0.023783783783783787, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -604.0522605104616, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -1147.3339401109638, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2249383849763947, "mean_inference_ms": 1.1296468236110346, "mean_action_processing_ms": 0.13191488709284857, "mean_env_wait_ms": 0.8505195021812533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"learn_time_ms": 5172.688, "learn_throughput": 0.387, "update_time_ms": 12.165}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8122725486755371, "grad_norm": 1.8500680923461914, "td_error_abs": 0.5013747151692708, "q_taken_mean": 0.1500743916829427, "target_mean": -0.033342173258463545}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 8, "num_agent_steps_trained": 76800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-44-51", "timestamp": 1708857891, "time_this_iter_s": 28.72930669784546, "time_total_s": 113.91012215614319, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 113.91012215614319, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.716216216216218, "ram_util_percent": 12.12162162162162, "gpu_util_percent0": 0.023783783783783787, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -604.0522605104616, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -1052.039202673269, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22598358594866258, "mean_inference_ms": 1.1325211902704353, "mean_action_processing_ms": 0.13207301252800105, "mean_env_wait_ms": 0.8521224694198939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"learn_time_ms": 5169.386, "learn_throughput": 0.387, "update_time_ms": 12.206}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6924163699150085, "grad_norm": 1.6414138078689575, "td_error_abs": 0.4206896565755208, "q_taken_mean": 0.19509364827473957, "target_mean": -0.0335235341389974}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 10, "num_agent_steps_trained": 96000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-45-20", "timestamp": 1708857920, "time_this_iter_s": 28.818320989608765, "time_total_s": 142.72844314575195, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 142.72844314575195, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.927777777777774, "ram_util_percent": 12.366666666666669, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -388.60861462561036, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -942.9292500336284, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22665915927244112, "mean_inference_ms": 1.1348613153841138, "mean_action_processing_ms": 0.13218391451540934, "mean_env_wait_ms": 0.853509219856998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"learn_time_ms": 5167.859, "learn_throughput": 0.387, "update_time_ms": 12.169}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8731845021247864, "grad_norm": 5.311403751373291, "td_error_abs": 0.5156978352864583, "q_taken_mean": 0.2854265340169271, "target_mean": -0.04108543904622396}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 57600, "num_steps_trained": 12, "num_agent_steps_trained": 115200, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-45-49", "timestamp": 1708857949, "time_this_iter_s": 28.815141677856445, "time_total_s": 171.5435848236084, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 171.5435848236084, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.589189189189195, "ram_util_percent": 12.594594594594595, "gpu_util_percent0": 0.016486486486486488, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -388.60861462561036, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -866.9531843532043, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2271995032868268, "mean_inference_ms": 1.13717436785916, "mean_action_processing_ms": 0.13227810015040767, "mean_env_wait_ms": 0.8543286581151898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"learn_time_ms": 5161.582, "learn_throughput": 0.387, "update_time_ms": 12.231}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9412910342216492, "grad_norm": 1.1035066843032837, "td_error_abs": 0.509319091796875, "q_taken_mean": 0.20716668701171875, "target_mean": 0.19901361083984376}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 67200, "num_steps_trained": 14, "num_agent_steps_trained": 134400, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-46-18", "timestamp": 1708857978, "time_this_iter_s": 28.883060932159424, "time_total_s": 200.42664575576782, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 200.42664575576782, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.033333333333335, "ram_util_percent": 12.913888888888888, "gpu_util_percent0": 0.021944444444444447, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -388.60861462561036, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -809.962241854736, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22757197754683256, "mean_inference_ms": 1.139470254604876, "mean_action_processing_ms": 0.13236759375620372, "mean_env_wait_ms": 0.8550355242565898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"learn_time_ms": 5161.969, "learn_throughput": 0.387, "update_time_ms": 12.488}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9007260799407959, "grad_norm": 2.719644069671631, "td_error_abs": 0.5123422444661458, "q_taken_mean": 0.34423567708333336, "target_mean": 0.1991964111328125}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 16, "num_agent_steps_trained": 153600, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-46-47", "timestamp": 1708858007, "time_this_iter_s": 28.96832847595215, "time_total_s": 229.39497423171997, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 229.39497423171997, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.991891891891886, "ram_util_percent": 13.032432432432431, "gpu_util_percent0": 0.024324324324324326, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -761.6334167277486, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22792562448400056, "mean_inference_ms": 1.1416830189037273, "mean_action_processing_ms": 0.13245472245074347, "mean_env_wait_ms": 0.8553001608052718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"learn_time_ms": 5163.428, "learn_throughput": 0.387, "update_time_ms": 12.589}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8555012345314026, "grad_norm": 1.195969820022583, "td_error_abs": 0.49300642903645836, "q_taken_mean": 0.059568817138671876, "target_mean": 0.05919706726074219}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 86400, "num_steps_trained": 18, "num_agent_steps_trained": 172800, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-47-16", "timestamp": 1708858036, "time_this_iter_s": 28.897591829299927, "time_total_s": 258.2925660610199, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 258.2925660610199, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.19166666666667, "ram_util_percent": 13.333333333333334, "gpu_util_percent0": 0.021666666666666667, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -1584.889778251278, "episode_reward_mean": -723.045700796092, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1525.83420197746, -1578.535558478593, -1564.7381580966646, -1501.229011713297, -1541.5770017154782, -1530.4851451688235, -1584.889778251278, -1554.4447280298932, -1551.292157874881, -1534.4668931518856, -1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22825916879644775, "mean_inference_ms": 1.1435362972679353, "mean_action_processing_ms": 0.13252988569343643, "mean_env_wait_ms": 0.8554760899485909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"learn_time_ms": 5160.061, "learn_throughput": 0.388, "update_time_ms": 12.687}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8510974049568176, "grad_norm": 4.540517330169678, "td_error_abs": 0.5197027587890625, "q_taken_mean": 0.3038951009114583, "target_mean": 0.05870444742838542}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 20, "num_agent_steps_trained": 192000, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-47-45", "timestamp": 1708858065, "time_this_iter_s": 28.836027145385742, "time_total_s": 287.12859320640564, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 287.12859320640564, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.897222222222222, "ram_util_percent": 13.347222222222221, "gpu_util_percent0": 0.01638888888888889, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -1325.5607486501995, "episode_reward_mean": -609.8687956580482, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1310.3131991394623, -1276.5567145080367, -1325.5607486501995, -1255.8885541757165, -1260.5756994238063, -1276.5022618981106, -1292.4767167352502, -1259.1955370789885, -1251.5859893569404, -1203.3780197123308, -1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22919924590326887, "mean_inference_ms": 1.1484355229375227, "mean_action_processing_ms": 0.13278137277543553, "mean_env_wait_ms": 0.8571749752829845, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"learn_time_ms": 5148.968, "learn_throughput": 0.388, "update_time_ms": 12.767}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7510606050491333, "grad_norm": 2.889716625213623, "td_error_abs": 0.4308072509765625, "q_taken_mean": -0.15656709798177082, "target_mean": -0.11516652425130208}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 105600, "num_steps_trained": 22, "num_agent_steps_trained": 211200, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 110, "training_iteration": 11, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-48-14", "timestamp": 1708858094, "time_this_iter_s": 29.13003921508789, "time_total_s": 316.25863242149353, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 316.25863242149353, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.191666666666663, "ram_util_percent": 13.422222222222222, "gpu_util_percent0": 0.02555555555555556, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -1122.516150377544, "episode_reward_mean": -523.9088317978461, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.516150377544, -1119.099587212149, -1079.875843159467, -1084.3651645338732, -1111.009532230705, -1108.2249233333282, -1093.7781631213415, -1113.6647132519497, -1113.634210142058, -1113.2563557228507, -614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22996487958831913, "mean_inference_ms": 1.1518014320878809, "mean_action_processing_ms": 0.13291367442397836, "mean_env_wait_ms": 0.8585233554972388, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"learn_time_ms": 5146.134, "learn_throughput": 0.389, "update_time_ms": 12.986}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.694945216178894, "grad_norm": 3.410010576248169, "td_error_abs": 0.42880794270833333, "q_taken_mean": 0.09745535278320312, "target_mean": -0.11517765299479167}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 115200, "num_steps_trained": 24, "num_agent_steps_trained": 230400, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-48-43", "timestamp": 1708858123, "time_this_iter_s": 29.135236024856567, "time_total_s": 345.3938684463501, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 345.3938684463501, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.922222222222224, "ram_util_percent": 13.722222222222221, "gpu_util_percent0": 0.01638888888888889, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -719.2081326486775, "episode_reward_mean": -454.96925849864135, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-614.0073834982737, -719.2081326486775, -685.4067579503883, -687.865964532293, -604.0522605104616, -659.4782778227886, -654.600249834293, -659.8042219814562, -675.1686075501368, -694.8150298874224, -674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.230591482184995, "mean_inference_ms": 1.1547483986239353, "mean_action_processing_ms": 0.1330259161576185, "mean_env_wait_ms": 0.8592242791906117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"learn_time_ms": 5148.739, "learn_throughput": 0.388, "update_time_ms": 13.379}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6226969957351685, "grad_norm": 2.725836992263794, "td_error_abs": 0.4109085693359375, "q_taken_mean": -0.24156620279947916, "target_mean": -0.213794189453125}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 124800, "num_steps_trained": 26, "num_agent_steps_trained": 249600, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 130, "training_iteration": 13, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-49-12", "timestamp": 1708858152, "time_this_iter_s": 29.206496715545654, "time_total_s": 374.60036516189575, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 374.60036516189575, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.12972972972973, "ram_util_percent": 13.991891891891893, "gpu_util_percent0": 0.024054054054054058, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -685.2114163355603, "episode_reward_mean": -429.8824925018931, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-674.1938386754647, -664.1252280405103, -672.0374070012078, -651.602906228074, -666.6020654141208, -685.2114163355603, -685.0118395455605, -679.446535922522, -661.7903219818169, -668.5809700800521, -392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23099562068556437, "mean_inference_ms": 1.1571590283978517, "mean_action_processing_ms": 0.13311750524877933, "mean_env_wait_ms": 0.8600975402129697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"learn_time_ms": 5149.732, "learn_throughput": 0.388, "update_time_ms": 13.373}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5864189267158508, "grad_norm": 5.121931076049805, "td_error_abs": 0.42453076171875, "q_taken_mean": 0.006249150594075521, "target_mean": -0.21462729899088542}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 134400, "num_steps_trained": 28, "num_agent_steps_trained": 268800, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-49-41", "timestamp": 1708858181, "time_this_iter_s": 29.179798126220703, "time_total_s": 403.78016328811646, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 403.78016328811646, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.927777777777774, "ram_util_percent": 14.177777777777775, "gpu_util_percent0": 0.014722222222222223, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -403.88300415292156, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-392.65073222221304, -398.84299672047143, -398.64303000409217, -396.5873897207328, -406.5600420006523, -394.6360727251064, -396.7918960817547, -407.12093532453645, -388.60861462561036, -393.35315892908847, -411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23117059329914835, "mean_inference_ms": 1.1595347411890047, "mean_action_processing_ms": 0.13320519897380437, "mean_env_wait_ms": 0.8608547598519357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"learn_time_ms": 5163.404, "learn_throughput": 0.387, "update_time_ms": 13.624}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8953516483306885, "grad_norm": 3.5437381267547607, "td_error_abs": 0.5220711669921875, "q_taken_mean": -0.42478662109375, "target_mean": -0.3043841552734375}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 30, "num_agent_steps_trained": 288000, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 150, "training_iteration": 15, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-50-11", "timestamp": 1708858211, "time_this_iter_s": 29.579384803771973, "time_total_s": 433.3595480918884, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 433.3595480918884, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.372222222222224, "ram_util_percent": 14.36111111111111, "gpu_util_percent0": 0.021944444444444447, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -405.1695929542877, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-411.64330698694374, -407.58868848805025, -413.4445527506167, -409.7477887209639, -410.8476676286851, -411.6965858043436, -409.49541528611815, -414.6165734848126, -410.78189820694985, -411.10542534911525, -414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23137384495731728, "mean_inference_ms": 1.1618742966893212, "mean_action_processing_ms": 0.1332982169487521, "mean_env_wait_ms": 0.8615039474676415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 153600, "timers": {"learn_time_ms": 5180.223, "learn_throughput": 0.386, "update_time_ms": 13.752}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3321529626846313, "grad_norm": 22.222064971923828, "td_error_abs": 0.85153955078125, "q_taken_mean": 0.3908545328776042, "target_mean": -0.30487428792317706}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 153600, "num_steps_trained": 32, "num_agent_steps_trained": 307200, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-50-41", "timestamp": 1708858241, "time_this_iter_s": 29.626920461654663, "time_total_s": 462.9864685535431, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 462.9864685535431, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 31.163888888888884, "ram_util_percent": 14.494444444444444, "gpu_util_percent0": 0.014166666666666668, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -405.3231945655277, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.44788411924424, -407.91926732932444, -414.7240145831007, -406.21155885836566, -411.6864190603742, -414.170396808868, -412.64226077007345, -409.9259018465883, -411.0306328944465, -407.4981073841984, -377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2315925782884467, "mean_inference_ms": 1.1639514524004948, "mean_action_processing_ms": 0.1333974641312731, "mean_env_wait_ms": 0.8625126545484144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 163200, "timers": {"learn_time_ms": 5197.418, "learn_throughput": 0.385, "update_time_ms": 13.878}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6735326051712036, "grad_norm": 8.766366958618164, "td_error_abs": 0.48683846028645833, "q_taken_mean": -0.47352372233072915, "target_mean": -0.21376816813151042}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 163200, "num_steps_trained": 34, "num_agent_steps_trained": 326400, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 170, "training_iteration": 17, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-51-10", "timestamp": 1708858270, "time_this_iter_s": 29.805472135543823, "time_total_s": 492.7919406890869, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 492.7919406890869, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 31.983783783783775, "ram_util_percent": 14.813513513513515, "gpu_util_percent0": 0.026486486486486494, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -365.86054283152424, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -405.5653790971397, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-377.5800098452168, -375.3278135848936, -378.6605111993497, -370.36507257502666, -365.86054283152424, -381.2695045102582, -374.01220129591377, -376.9285873952686, -372.247126784628, -377.7767870964129, -376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23189860959855127, "mean_inference_ms": 1.165852783954895, "mean_action_processing_ms": 0.1334963649643892, "mean_env_wait_ms": 0.863564331636103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"learn_time_ms": 5189.936, "learn_throughput": 0.385, "update_time_ms": 13.799}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6661757230758667, "grad_norm": 8.802205085754395, "td_error_abs": 0.4912235514322917, "q_taken_mean": 0.15570745849609374, "target_mean": -0.21468023681640624}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 172800, "num_steps_trained": 36, "num_agent_steps_trained": 345600, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-51-40", "timestamp": 1708858300, "time_this_iter_s": 29.779489994049072, "time_total_s": 522.571430683136, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 522.571430683136, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.244444444444444, "ram_util_percent": 15.002777777777778, "gpu_util_percent0": 0.01361111111111111, "vram_util_percent0": 0.024454752604166664}}
{"episode_reward_max": -370.6667699490617, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -409.53304350022154, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-376.1887556150292, -374.2234402740061, -372.675482331687, -380.6635262820427, -380.3846949887379, -375.3729803710019, -374.6330829220066, -375.4730295229355, -370.6667699490617, -377.28081185530675, -412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2321471040864066, "mean_inference_ms": 1.1675679065916442, "mean_action_processing_ms": 0.13358682496753085, "mean_env_wait_ms": 0.8649789982917114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 182400, "timers": {"learn_time_ms": 5221.011, "learn_throughput": 0.383, "update_time_ms": 13.783}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.541877269744873, "grad_norm": 2.8537163734436035, "td_error_abs": 0.4039388834635417, "q_taken_mean": -0.389813720703125, "target_mean": -0.3360673624674479}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 182400, "num_steps_trained": 38, "num_agent_steps_trained": 364800, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 190, "training_iteration": 19, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-52-10", "timestamp": 1708858330, "time_this_iter_s": 29.964619874954224, "time_total_s": 552.5360505580902, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 552.5360505580902, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.511111111111106, "ram_util_percent": 15.219444444444443, "gpu_util_percent0": 0.02388888888888889, "vram_util_percent0": 0.024332682291666668}}
{"episode_reward_max": -397.2638660014016, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -413.067111585364, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-412.0400793666912, -422.52804323042693, -419.3406781311228, -407.6274585844068, -411.56847780909874, -418.6072796742652, -423.84597525333635, -419.37842989407585, -409.11260683083407, -405.7530918796211, -397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23238690229120013, "mean_inference_ms": 1.1694589751850768, "mean_action_processing_ms": 0.13368892812813835, "mean_env_wait_ms": 0.8665905246959982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"learn_time_ms": 5280.866, "learn_throughput": 0.379, "update_time_ms": 14.794}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5191993117332458, "grad_norm": 2.3891923427581787, "td_error_abs": 0.40341756184895833, "q_taken_mean": -0.23486842854817708, "target_mean": -0.33704085286458335}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 40, "num_agent_steps_trained": 384000, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-52-41", "timestamp": 1708858361, "time_this_iter_s": 30.522372245788574, "time_total_s": 583.0584228038788, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 583.0584228038788, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.14324324324324, "ram_util_percent": 15.572972972972977, "gpu_util_percent0": 0.0518918918918919, "vram_util_percent0": 0.024363474802927932}}
{"episode_reward_max": -397.2638660014016, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -412.84399245609484, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-397.2638660014016, -416.6032461154034, -413.99756323420456, -407.0810121685723, -412.48176583549287, -416.5659021379398, -415.8544349156001, -411.2921078050682, -412.4191028842415, -412.4780535607038, -417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23263013055356221, "mean_inference_ms": 1.171516511758925, "mean_action_processing_ms": 0.1337930888848911, "mean_env_wait_ms": 0.8680466770952273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"learn_time_ms": 5282.652, "learn_throughput": 0.379, "update_time_ms": 15.827}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.49488216638565063, "grad_norm": 3.7830848693847656, "td_error_abs": 0.40189188639322915, "q_taken_mean": -0.42932914225260416, "target_mean": -0.3366495157877604}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 201600, "num_steps_trained": 42, "num_agent_steps_trained": 403200, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 210, "training_iteration": 21, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-53-11", "timestamp": 1708858391, "time_this_iter_s": 29.877671480178833, "time_total_s": 612.9360942840576, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 612.9360942840576, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.71081081081081, "ram_util_percent": 15.302702702702701, "gpu_util_percent0": 0.02594594594594595, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -403.50386520703586, "episode_reward_min": -427.98849909875935, "episode_reward_mean": -413.24906636455336, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.49566589663533, -418.63674377055526, -415.04896769505797, -416.32279807981746, -422.36064202687095, -410.8840409024066, -410.10126302246186, -427.98849909875935, -418.9981737063281, -407.63051896590525, -408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23284344872945714, "mean_inference_ms": 1.173470054043648, "mean_action_processing_ms": 0.13389832683570535, "mean_env_wait_ms": 0.8694762616626851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 211200, "timesteps_this_iter": 0, "agent_timesteps_total": 211200, "timers": {"learn_time_ms": 5304.155, "learn_throughput": 0.377, "update_time_ms": 15.758}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4838641285896301, "grad_norm": 5.332275867462158, "td_error_abs": 0.40551521809895835, "q_taken_mean": -0.1706231689453125, "target_mean": -0.33637461344401043}}}, "num_steps_sampled": 211200, "num_agent_steps_sampled": 211200, "num_steps_trained": 44, "num_agent_steps_trained": 422400, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-53-41", "timestamp": 1708858421, "time_this_iter_s": 29.82600736618042, "time_total_s": 642.762101650238, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 642.762101650238, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.85833333333333, "ram_util_percent": 15.783333333333335, "gpu_util_percent0": 0.006944444444444444, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -403.50386520703586, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -413.38908866845026, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-408.64205063483547, -418.4072466099292, -412.06697171501065, -405.7492645341581, -419.45972230350816, -407.59079076493157, -421.4031256577148, -416.6158589926002, -417.67106916658867, -418.1241861620923, -405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23312643092820035, "mean_inference_ms": 1.1753877948397027, "mean_action_processing_ms": 0.13401232090664691, "mean_env_wait_ms": 0.8709047780333634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 220800, "timesteps_this_iter": 0, "agent_timesteps_total": 220800, "timers": {"learn_time_ms": 5325.593, "learn_throughput": 0.376, "update_time_ms": 15.604}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.507270872592926, "grad_norm": 8.807108879089355, "td_error_abs": 0.4316416829427083, "q_taken_mean": -0.5737508951822917, "target_mean": -0.33608793131510417}}}, "num_steps_sampled": 220800, "num_agent_steps_sampled": 220800, "num_steps_trained": 46, "num_agent_steps_trained": 441600, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 230, "training_iteration": 23, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-54-11", "timestamp": 1708858451, "time_this_iter_s": 30.031056880950928, "time_total_s": 672.793158531189, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 672.793158531189, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.772222222222222, "ram_util_percent": 15.741666666666662, "gpu_util_percent0": 0.021944444444444447, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -403.50386520703586, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -413.1720689981846, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-405.65170553739597, -407.3330423032143, -411.2128614332078, -410.08005160662304, -413.21917432977614, -410.1845185859422, -411.6295596441383, -415.30955820353483, -408.2787799648417, -415.754442719062, -411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23340265129754736, "mean_inference_ms": 1.1771850461690685, "mean_action_processing_ms": 0.13412322998588075, "mean_env_wait_ms": 0.8723541372718586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 230400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"learn_time_ms": 5350.894, "learn_throughput": 0.374, "update_time_ms": 15.598}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5872111916542053, "grad_norm": 11.98302173614502, "td_error_abs": 0.49295894368489585, "q_taken_mean": 0.016785723368326823, "target_mean": -0.33680078125}}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230400, "num_steps_trained": 48, "num_agent_steps_trained": 460800, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-54-41", "timestamp": 1708858481, "time_this_iter_s": 29.943869829177856, "time_total_s": 702.7370283603668, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 702.7370283603668, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.45277777777777, "ram_util_percent": 16.286111111111108, "gpu_util_percent0": 0.01638888888888889, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -368.9443683469645, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -409.5521091451746, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-411.705977219532, -410.03873106928563, -410.44808005881333, -412.56971112108175, -412.61211349876214, -408.934374197457, -407.22441397941714, -414.743266552898, -406.56037953893224, -407.6167012546813, -414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2336958671887732, "mean_inference_ms": 1.1789032206255956, "mean_action_processing_ms": 0.13422538169010018, "mean_env_wait_ms": 0.8737005367949908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"learn_time_ms": 5355.194, "learn_throughput": 0.373, "update_time_ms": 15.457}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.843985915184021, "grad_norm": 2.8973264694213867, "td_error_abs": 0.5200845540364584, "q_taken_mean": -0.5401240234375, "target_mean": -0.46268107096354166}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 50, "num_agent_steps_trained": 480000, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 250, "training_iteration": 25, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-55-10", "timestamp": 1708858510, "time_this_iter_s": 29.79881763458252, "time_total_s": 732.5358459949493, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 732.5358459949493, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.716666666666665, "ram_util_percent": 16.13333333333334, "gpu_util_percent0": 0.020277777777777783, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -405.6713789968673, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.4586549695654, -408.10299769213316, -415.71285932772383, -406.3299793629464, -418.4134957775965, -410.50211850111464, -417.0520348476048, -413.48240503696894, -410.28524216779437, -411.98827614715293, -419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23397676439317794, "mean_inference_ms": 1.1806511789840597, "mean_action_processing_ms": 0.13433344038285935, "mean_env_wait_ms": 0.874976284806039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"learn_time_ms": 5340.725, "learn_throughput": 0.374, "update_time_ms": 15.42}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.043540596961975, "grad_norm": 16.98751449584961, "td_error_abs": 0.6973523763020834, "q_taken_mean": 0.032231056213378906, "target_mean": -0.47050569661458336}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 249600, "num_steps_trained": 52, "num_agent_steps_trained": 499200, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-55-40", "timestamp": 1708858540, "time_this_iter_s": 29.906399726867676, "time_total_s": 762.442245721817, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 762.442245721817, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 31.474285714285717, "ram_util_percent": 16.665714285714284, "gpu_util_percent0": 0.015142857142857144, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -406.0207365318012, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-419.30105768245403, -409.87576348047327, -413.97267417280244, -409.09031717505167, -407.76721818332504, -415.31036186941446, -407.0862610779685, -414.1128871094138, -421.4361897441383, -416.5221663207501, -411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23420670053288528, "mean_inference_ms": 1.1822894062644547, "mean_action_processing_ms": 0.13442432549605945, "mean_env_wait_ms": 0.8760773339148166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 259200, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"learn_time_ms": 5367.196, "learn_throughput": 0.373, "update_time_ms": 15.848}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4969692528247833, "grad_norm": 3.6298437118530273, "td_error_abs": 0.39919148763020834, "q_taken_mean": -0.5462752685546876, "target_mean": -0.46287198893229164}}}, "num_steps_sampled": 259200, "num_agent_steps_sampled": 259200, "num_steps_trained": 54, "num_agent_steps_trained": 518400, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 270, "training_iteration": 27, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-56-10", "timestamp": 1708858570, "time_this_iter_s": 30.111634016036987, "time_total_s": 792.553879737854, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 792.553879737854, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 31.96388888888889, "ram_util_percent": 16.541666666666668, "gpu_util_percent0": 0.02638888888888889, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -406.01945070104506, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-411.9625723542045, -423.04026325979817, -411.28014405664044, -422.1439525348251, -418.7239434932848, -409.01194636187637, -412.5132332660986, -413.68044256118867, -411.9001421396703, -412.53795739908315, -409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23437886349354956, "mean_inference_ms": 1.183747152865166, "mean_action_processing_ms": 0.13450198234709493, "mean_env_wait_ms": 0.877135503448985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 268800, "timesteps_this_iter": 0, "agent_timesteps_total": 268800, "timers": {"learn_time_ms": 5388.905, "learn_throughput": 0.371, "update_time_ms": 15.847}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4797470271587372, "grad_norm": 1.996749997138977, "td_error_abs": 0.39205196126302083, "q_taken_mean": -0.3861344807942708, "target_mean": -0.4638271891276042}}}, "num_steps_sampled": 268800, "num_agent_steps_sampled": 268800, "num_steps_trained": 56, "num_agent_steps_trained": 537600, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-56-40", "timestamp": 1708858600, "time_this_iter_s": 29.804540157318115, "time_total_s": 822.3584198951721, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 822.3584198951721, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.38055555555555, "ram_util_percent": 16.749999999999993, "gpu_util_percent0": 0.018611111111111113, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -426.77131766475145, "episode_reward_mean": -405.53073917362764, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-409.61339550519534, -413.8087292780668, -416.5960224641128, -407.3277472476996, -414.9560943325692, -411.6510256533271, -413.13344263972266, -408.77991745894013, -410.78581660436026, -404.3171914420666, -408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23455853036854968, "mean_inference_ms": 1.185183641519528, "mean_action_processing_ms": 0.13457634572074498, "mean_env_wait_ms": 0.8781171268569194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 278400, "timesteps_this_iter": 0, "agent_timesteps_total": 278400, "timers": {"learn_time_ms": 5359.381, "learn_throughput": 0.373, "update_time_ms": 15.843}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4793824553489685, "grad_norm": 2.5046732425689697, "td_error_abs": 0.39745060221354167, "q_taken_mean": -0.5299763997395833, "target_mean": -0.4637247314453125}}}, "num_steps_sampled": 278400, "num_agent_steps_sampled": 278400, "num_steps_trained": 58, "num_agent_steps_trained": 556800, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 290, "training_iteration": 29, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-57-10", "timestamp": 1708858630, "time_this_iter_s": 29.90793752670288, "time_total_s": 852.266357421875, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 852.266357421875, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 31.82571428571428, "ram_util_percent": 17.28571428571428, "gpu_util_percent0": 0.024000000000000004, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -405.89916657891837, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-408.1372949997713, -410.5040764661599, -408.401978084964, -411.02397394677746, -416.1157837030701, -414.0825100885427, -409.2256243395314, -417.919039589686, -415.6346158492547, -416.44531065921086, -426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346948341473276, "mean_inference_ms": 1.1865198407826094, "mean_action_processing_ms": 0.13463983417299188, "mean_env_wait_ms": 0.8790366860086785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"learn_time_ms": 5315.651, "learn_throughput": 0.376, "update_time_ms": 14.952}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.46521827578544617, "grad_norm": 2.380150556564331, "td_error_abs": 0.39023787434895835, "q_taken_mean": -0.392811767578125, "target_mean": -0.4631256917317708}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 60, "num_agent_steps_trained": 576000, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-57-40", "timestamp": 1708858660, "time_this_iter_s": 30.15514636039734, "time_total_s": 882.4215037822723, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 882.4215037822723, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 31.54166666666666, "ram_util_percent": 17.19166666666667, "gpu_util_percent0": 0.01638888888888889, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -405.83029784053497, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.77131766475145, -418.37372049220613, -414.14858315856355, -414.08315610955873, -417.90435999778254, -421.3371842799364, -418.89296202510747, -413.66527589367934, -403.50386520703586, -407.86402067586135, -415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2348222778939102, "mean_inference_ms": 1.18769420334795, "mean_action_processing_ms": 0.13469594220570932, "mean_env_wait_ms": 0.8799487948648398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 297600, "timesteps_this_iter": 0, "agent_timesteps_total": 297600, "timers": {"learn_time_ms": 5321.625, "learn_throughput": 0.376, "update_time_ms": 14.154}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4656561017036438, "grad_norm": 3.3558590412139893, "td_error_abs": 0.399010498046875, "q_taken_mean": -0.5487344970703125, "target_mean": -0.4539335123697917}}}, "num_steps_sampled": 297600, "num_agent_steps_sampled": 297600, "num_steps_trained": 62, "num_agent_steps_trained": 595200, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-58-10", "timestamp": 1708858690, "time_this_iter_s": 30.036206483840942, "time_total_s": 912.4577102661133, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 912.4577102661133, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 31.822222222222212, "ram_util_percent": 17.383333333333336, "gpu_util_percent0": 0.026666666666666665, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -405.7342031627433, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.8710003282419, -412.6796977745885, -426.72451367677655, -413.0278381848504, -417.07469181972664, -413.5462473199847, -420.9779010145494, -416.42895651955655, -421.68481689673484, -421.4538800194817, -413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23493456701337603, "mean_inference_ms": 1.1889703172469346, "mean_action_processing_ms": 0.1347488552743728, "mean_env_wait_ms": 0.880797673187355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"learn_time_ms": 5344.061, "learn_throughput": 0.374, "update_time_ms": 14.233}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4643881022930145, "grad_norm": 4.034024715423584, "td_error_abs": 0.39961857096354164, "q_taken_mean": -0.34731022135416667, "target_mean": -0.4536090087890625}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 307200, "num_steps_trained": 64, "num_agent_steps_trained": 614400, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-58-41", "timestamp": 1708858721, "time_this_iter_s": 30.490500450134277, "time_total_s": 942.9482107162476, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 942.9482107162476, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 31.724999999999998, "ram_util_percent": 17.605555555555558, "gpu_util_percent0": 0.013055555555555556, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -405.3436617318867, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-413.3572574064567, -420.7802879495636, -410.97652330532924, -409.56128332726297, -416.32209325565253, -406.5624906320179, -416.7547057519727, -407.33653514746044, -410.87194968566916, -411.50519305341146, -368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23498150573790735, "mean_inference_ms": 1.190256692837491, "mean_action_processing_ms": 0.134793272412256, "mean_env_wait_ms": 0.8815833227088045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 316800, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"learn_time_ms": 5323.899, "learn_throughput": 0.376, "update_time_ms": 14.024}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.47779199481010437, "grad_norm": 5.11245584487915, "td_error_abs": 0.4027975260416667, "q_taken_mean": -0.6007335611979167, "target_mean": -0.4533319091796875}}}, "num_steps_sampled": 316800, "num_agent_steps_sampled": 316800, "num_steps_trained": 66, "num_agent_steps_trained": 633600, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 330, "training_iteration": 33, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-59-11", "timestamp": 1708858751, "time_this_iter_s": 30.025055170059204, "time_total_s": 972.9732658863068, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 972.9732658863068, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 31.971428571428564, "ram_util_percent": 17.805714285714284, "gpu_util_percent0": 0.021142857142857144, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -405.4059976645989, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-368.9443683469645, -374.76592273713726, -375.5333996854642, -379.11119945068367, -377.57548389182523, -371.48261917536945, -374.5581458509547, -372.6929516248713, -374.22199311993614, -377.7716251435368, -373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23505025751712638, "mean_inference_ms": 1.1916007028293165, "mean_action_processing_ms": 0.13483846303808, "mean_env_wait_ms": 0.8822943530354093, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 326400, "timesteps_this_iter": 0, "agent_timesteps_total": 326400, "timers": {"learn_time_ms": 5329.684, "learn_throughput": 0.375, "update_time_ms": 14.182}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4857136309146881, "grad_norm": 6.3669657707214355, "td_error_abs": 0.411840576171875, "q_taken_mean": -0.2765232950846354, "target_mean": -0.4531898193359375}}}, "num_steps_sampled": 326400, "num_agent_steps_sampled": 326400, "num_steps_trained": 68, "num_agent_steps_trained": 652800, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_16-59-41", "timestamp": 1708858781, "time_this_iter_s": 30.396369218826294, "time_total_s": 1003.369635105133, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1003.369635105133, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 31.744444444444444, "ram_util_percent": 17.994444444444447, "gpu_util_percent0": 0.018055555555555557, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -364.0911388240284, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -408.0489476361475, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-373.5345553129849, -371.38937145678625, -365.2216456935218, -364.0911388240284, -372.88119528965717, -374.26356232099204, -370.09793030052424, -370.1534461380294, -374.35671656790066, -378.3911717557039, -423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23512516985843207, "mean_inference_ms": 1.1930045244852077, "mean_action_processing_ms": 0.13488509699690746, "mean_env_wait_ms": 0.8830459102237014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"learn_time_ms": 5324.72, "learn_throughput": 0.376, "update_time_ms": 14.137}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6719428896903992, "grad_norm": 3.2897863388061523, "td_error_abs": 0.4516019287109375, "q_taken_mean": -0.6386038411458334, "target_mean": -0.5126776123046874}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 70, "num_agent_steps_trained": 672000, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 350, "training_iteration": 35, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-00-12", "timestamp": 1708858812, "time_this_iter_s": 30.40200686454773, "time_total_s": 1033.7716419696808, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1033.7716419696808, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.105714285714285, "ram_util_percent": 18.228571428571424, "gpu_util_percent0": 0.022000000000000002, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -412.2843305079595, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-423.1653434117396, -412.1950416156312, -418.3629512955544, -411.81132453248495, -414.28977421969023, -405.4939355387642, -414.20625848858174, -423.7866239786395, -418.6144553096512, -419.3381089332532, -421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23521286115667756, "mean_inference_ms": 1.1942954390998304, "mean_action_processing_ms": 0.13492367520429835, "mean_env_wait_ms": 0.8838975471047226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 345600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"learn_time_ms": 5332.72, "learn_throughput": 0.375, "update_time_ms": 14.267}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4600454866886139, "grad_norm": 1.2339271306991577, "td_error_abs": 0.38740482584635416, "q_taken_mean": -0.4071195475260417, "target_mean": -0.4550595703125}}}, "num_steps_sampled": 345600, "num_agent_steps_sampled": 345600, "num_steps_trained": 72, "num_agent_steps_trained": 691200, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-00-42", "timestamp": 1708858842, "time_this_iter_s": 30.57287287712097, "time_total_s": 1064.3445148468018, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1064.3445148468018, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 31.855555555555547, "ram_util_percent": 18.43333333333333, "gpu_util_percent0": 0.02416666666666667, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -412.2217692720452, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-421.3400042313352, -410.11478037493316, -415.05279870048474, -409.85443804738475, -417.0132016844804, -417.3147137377391, -413.79815179023325, -418.1605355325164, -405.4716078854525, -406.22608175561743, -403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23531421346862044, "mean_inference_ms": 1.1956329802453822, "mean_action_processing_ms": 0.13496855370001207, "mean_env_wait_ms": 0.8848236130056244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 355200, "timesteps_this_iter": 0, "agent_timesteps_total": 355200, "timers": {"learn_time_ms": 5327.33, "learn_throughput": 0.375, "update_time_ms": 13.802}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.462019681930542, "grad_norm": 3.3229758739471436, "td_error_abs": 0.395077880859375, "q_taken_mean": -0.508343017578125, "target_mean": -0.409079833984375}}}, "num_steps_sampled": 355200, "num_agent_steps_sampled": 355200, "num_steps_trained": 74, "num_agent_steps_trained": 710400, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 370, "training_iteration": 37, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-01-13", "timestamp": 1708858873, "time_this_iter_s": 30.762001276016235, "time_total_s": 1095.106516122818, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1095.106516122818, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.611111111111114, "ram_util_percent": 18.675, "gpu_util_percent0": 0.024722222222222225, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -412.12830298888207, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-403.32316394874306, -414.3161799128653, -411.50044893874184, -412.42139236791934, -413.42874222742324, -409.6679134085788, -411.119612791621, -410.07620984964535, -409.9023189029101, -402.16746233647905, -420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23539993400703307, "mean_inference_ms": 1.1969621045808065, "mean_action_processing_ms": 0.13501006429418805, "mean_env_wait_ms": 0.885735380510869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 364800, "timesteps_this_iter": 0, "agent_timesteps_total": 364800, "timers": {"learn_time_ms": 5352.401, "learn_throughput": 0.374, "update_time_ms": 13.829}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4737522304058075, "grad_norm": 3.743680000305176, "td_error_abs": 0.40227864583333334, "q_taken_mean": -0.3057834879557292, "target_mean": -0.4090874430338542}}}, "num_steps_sampled": 364800, "num_agent_steps_sampled": 364800, "num_steps_trained": 76, "num_agent_steps_trained": 729600, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-01-44", "timestamp": 1708858904, "time_this_iter_s": 30.397894620895386, "time_total_s": 1125.5044107437134, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1125.5044107437134, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.637142857142855, "ram_util_percent": 19.17142857142857, "gpu_util_percent0": 0.016285714285714285, "vram_util_percent0": 0.024495442708333336}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -429.6591383821855, "episode_reward_mean": -412.5386473356814, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.36033346444617, -418.51626016390594, -403.9343694822897, -416.6526245133468, -414.21388236067935, -413.4915806130233, -429.6591383821855, -404.2903160815127, -405.88254150171025, -420.81107659203155, -410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23549216079742874, "mean_inference_ms": 1.1983283785714165, "mean_action_processing_ms": 0.1350622816324548, "mean_env_wait_ms": 0.8867969407941788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 374400, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"learn_time_ms": 5435.094, "learn_throughput": 0.368, "update_time_ms": 14.046}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.47471216320991516, "grad_norm": 4.240802764892578, "td_error_abs": 0.4014788818359375, "q_taken_mean": -0.5366209309895833, "target_mean": -0.4095419514973958}}}, "num_steps_sampled": 374400, "num_agent_steps_sampled": 374400, "num_steps_trained": 78, "num_agent_steps_trained": 748800, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 390, "training_iteration": 39, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-02-16", "timestamp": 1708858936, "time_this_iter_s": 31.9173686504364, "time_total_s": 1157.4217793941498, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1157.4217793941498, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.32777777777778, "ram_util_percent": 19.105555555555558, "gpu_util_percent0": 0.08750000000000001, "vram_util_percent0": 0.024469446252893517}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -412.3800434421357, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.1515054388501, -416.14315348054697, -404.4409032281394, -397.00950883938077, -420.9036677825254, -418.58256789800816, -409.5961157519034, -416.75323211788344, -409.0802023647581, -417.94247698664856, -411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2356407079199999, "mean_inference_ms": 1.1998583548921036, "mean_action_processing_ms": 0.13513402147792955, "mean_env_wait_ms": 0.8880137394259865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"learn_time_ms": 5467.328, "learn_throughput": 0.366, "update_time_ms": 13.905}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.48311343789100647, "grad_norm": 5.066754341125488, "td_error_abs": 0.40979569498697915, "q_taken_mean": -0.2655979817708333, "target_mean": -0.4097586669921875}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 80, "num_agent_steps_trained": 768000, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-02-48", "timestamp": 1708858968, "time_this_iter_s": 32.69275689125061, "time_total_s": 1190.1145362854004, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1190.1145362854004, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.372972972972974, "ram_util_percent": 19.640540540540538, "gpu_util_percent0": 0.0881081081081081, "vram_util_percent0": 0.024679098043355857}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -411.6894819519717, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-411.31152546777855, -417.3066903619542, -413.21350983188717, -424.47907388590176, -416.916408347033, -412.31859301433474, -420.30108354733494, -416.01329573542824, -405.36921328031985, -409.70558425332786, -415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23577500689841252, "mean_inference_ms": 1.2014483568880976, "mean_action_processing_ms": 0.1352039836307692, "mean_env_wait_ms": 0.8891724789671329, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 393600, "timesteps_this_iter": 0, "agent_timesteps_total": 393600, "timers": {"learn_time_ms": 5485.255, "learn_throughput": 0.365, "update_time_ms": 13.863}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6108953356742859, "grad_norm": 2.8302178382873535, "td_error_abs": 0.4352763671875, "q_taken_mean": -0.5581208089192708, "target_mean": -0.4420582275390625}}}, "num_steps_sampled": 393600, "num_agent_steps_sampled": 393600, "num_steps_trained": 82, "num_agent_steps_trained": 787200, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 410, "training_iteration": 41, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-03-19", "timestamp": 1708858999, "time_this_iter_s": 30.674443244934082, "time_total_s": 1220.7889795303345, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1220.7889795303345, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.205714285714286, "ram_util_percent": 19.522857142857145, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -411.42699057032144, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.87728912092734, -412.2055225481008, -425.0211958196029, -404.9109560871962, -422.1279934106131, -413.3613364842752, -411.93012720002906, -411.7935618638718, -419.11744204179, -404.06997589242053, -408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23589761337155546, "mean_inference_ms": 1.2029666990911112, "mean_action_processing_ms": 0.13526487262538744, "mean_env_wait_ms": 0.8902613836648888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 403200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"learn_time_ms": 5490.655, "learn_throughput": 0.364, "update_time_ms": 13.781}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4650557339191437, "grad_norm": 1.2903543710708618, "td_error_abs": 0.3923492024739583, "q_taken_mean": -0.3624949137369792, "target_mean": -0.41008028157552084}}}, "num_steps_sampled": 403200, "num_agent_steps_sampled": 403200, "num_steps_trained": 84, "num_agent_steps_trained": 806400, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-03-50", "timestamp": 1708859030, "time_this_iter_s": 30.570258378982544, "time_total_s": 1251.359237909317, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1251.359237909317, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.134285714285717, "ram_util_percent": 20.074285714285715, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -411.2112096901225, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-408.2636311477307, -410.1577908032398, -410.79188330275156, -419.5426690813644, -414.8911929234764, -408.83675676687085, -412.6998778230115, -409.92273230261503, -423.39109943560715, -411.7642791993582, -408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23603029282891125, "mean_inference_ms": 1.2044720873625874, "mean_action_processing_ms": 0.13532397490387557, "mean_env_wait_ms": 0.8913217583953358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 412800, "timesteps_this_iter": 0, "agent_timesteps_total": 412800, "timers": {"learn_time_ms": 5497.285, "learn_throughput": 0.364, "update_time_ms": 13.933}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5361659526824951, "grad_norm": 2.466569185256958, "td_error_abs": 0.4137045084635417, "q_taken_mean": -0.45594352213541667, "target_mean": -0.35593416341145834}}}, "num_steps_sampled": 412800, "num_agent_steps_sampled": 412800, "num_steps_trained": 86, "num_agent_steps_trained": 825600, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 430, "training_iteration": 43, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-04-20", "timestamp": 1708859060, "time_this_iter_s": 30.341331720352173, "time_total_s": 1281.7005696296692, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1281.7005696296692, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 31.21764705882353, "ram_util_percent": 19.99411764705882, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -385.8980103803456, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -411.13667265882793, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-408.02153073991275, -402.1721242281393, -407.3193439164784, -400.91021019533974, -403.56768783105304, -402.00537603477005, -401.4329706008748, -385.8980103803456, -396.8738391872433, -402.7516130674432, -407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2361640397074926, "mean_inference_ms": 1.2061311696966217, "mean_action_processing_ms": 0.13539280577586182, "mean_env_wait_ms": 0.8923960645897143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 422400, "timesteps_this_iter": 0, "agent_timesteps_total": 422400, "timers": {"learn_time_ms": 5515.169, "learn_throughput": 0.363, "update_time_ms": 13.998}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4692257344722748, "grad_norm": 2.452061176300049, "td_error_abs": 0.3957926432291667, "q_taken_mean": -0.29207234700520834, "target_mean": -0.36688545735677086}}}, "num_steps_sampled": 422400, "num_agent_steps_sampled": 422400, "num_steps_trained": 88, "num_agent_steps_trained": 844800, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-04-52", "timestamp": 1708859092, "time_this_iter_s": 31.844634771347046, "time_total_s": 1313.5452044010162, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1313.5452044010162, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 33.886111111111106, "ram_util_percent": 20.497222222222224, "gpu_util_percent0": 0.03361111111111112, "vram_util_percent0": 0.025236906828703706}}
{"episode_reward_max": -383.3855787275185, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -410.05880871941963, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-407.58886905405745, -416.49593724137424, -418.80296545713236, -408.2698852298018, -418.14093245703833, -419.52644131191846, -412.5185311776475, -409.87326573064485, -415.7803373279965, -410.921855853727, -426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852, -385.44108315339804, -389.3651647618108, -388.9741187915844, -383.3855787275185, -388.5584643464618, -383.82979482826346, -390.19547756331605, -392.2047320404579, -406.0211908948442, -395.19070713311226], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2363106811646462, "mean_inference_ms": 1.2076943881330375, "mean_action_processing_ms": 0.1354594388243987, "mean_env_wait_ms": 0.8934871847857407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"learn_time_ms": 5533.8, "learn_throughput": 0.361, "update_time_ms": 13.961}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7847592830657959, "grad_norm": 2.531463146209717, "td_error_abs": 0.4872411702473958, "q_taken_mean": -0.40207454427083333, "target_mean": -0.36225126139322916}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 90, "num_agent_steps_trained": 864000, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 450, "training_iteration": 45, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-05-23", "timestamp": 1708859123, "time_this_iter_s": 30.889179229736328, "time_total_s": 1344.4343836307526, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1344.4343836307526, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.105714285714285, "ram_util_percent": 20.402857142857144, "gpu_util_percent0": 0.02057142857142857, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -383.3855787275185, "episode_reward_min": -426.1291803247438, "episode_reward_mean": -409.8727023753815, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.1291803247438, -413.07739370372946, -407.61767215384657, -416.0250268064263, -411.3981839750765, -416.9742018099815, -417.5462504576263, -422.4242908208044, -412.53008838013255, -411.2854053001781, -413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852, -385.44108315339804, -389.3651647618108, -388.9741187915844, -383.3855787275185, -388.5584643464618, -383.82979482826346, -390.19547756331605, -392.2047320404579, -406.0211908948442, -395.19070713311226, -412.46100218304645, -405.65353509412375, -408.521901166524, -424.0984743807212, -411.7400220642782, -406.8384954686711, -408.23783772550206, -411.65668302638966, -410.4619694188514, -419.63846590941694], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23646501533852635, "mean_inference_ms": 1.2092709557721097, "mean_action_processing_ms": 0.1355278910368154, "mean_env_wait_ms": 0.8945880509535761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 441600, "timesteps_this_iter": 0, "agent_timesteps_total": 441600, "timers": {"learn_time_ms": 5536.242, "learn_throughput": 0.361, "update_time_ms": 13.791}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.48228174448013306, "grad_norm": 0.5329412221908569, "td_error_abs": 0.3951212565104167, "q_taken_mean": -0.3408543904622396, "target_mean": -0.36801155598958335}}}, "num_steps_sampled": 441600, "num_agent_steps_sampled": 441600, "num_steps_trained": 92, "num_agent_steps_trained": 883200, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-05-54", "timestamp": 1708859154, "time_this_iter_s": 31.142287731170654, "time_total_s": 1375.5766713619232, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1375.5766713619232, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 32.536111111111104, "ram_util_percent": 20.58888888888889, "gpu_util_percent0": 0.026944444444444448, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -383.3855787275185, "episode_reward_min": -425.9223395492852, "episode_reward_mean": -409.4084460261584, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-413.6399442099314, -414.18531462359, -409.36208501336563, -409.69150009751206, -412.5105799016922, -413.89781031971893, -412.6868475473643, -408.31381884474814, -415.00700034697024, -415.70478451896633, -414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852, -385.44108315339804, -389.3651647618108, -388.9741187915844, -383.3855787275185, -388.5584643464618, -383.82979482826346, -390.19547756331605, -392.2047320404579, -406.0211908948442, -395.19070713311226, -412.46100218304645, -405.65353509412375, -408.521901166524, -424.0984743807212, -411.7400220642782, -406.8384954686711, -408.23783772550206, -411.65668302638966, -410.4619694188514, -419.63846590941694, -404.21980098327987, -415.5082109451997, -415.76151361632094, -408.76329156906195, -411.3739324636232, -412.55748852319795, -408.80365886284426, -412.0750146801786, -408.712898648518, -410.8062485180097], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23660871810409062, "mean_inference_ms": 1.210762860912316, "mean_action_processing_ms": 0.1355915237931858, "mean_env_wait_ms": 0.895650245949227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 451200, "timesteps_this_iter": 0, "agent_timesteps_total": 451200, "timers": {"learn_time_ms": 5506.408, "learn_throughput": 0.363, "update_time_ms": 13.697}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4707365036010742, "grad_norm": 1.1318354606628418, "td_error_abs": 0.39516764322916664, "q_taken_mean": -0.393004150390625, "target_mean": -0.3675017496744792}}}, "num_steps_sampled": 451200, "num_agent_steps_sampled": 451200, "num_steps_trained": 94, "num_agent_steps_trained": 902400, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 470, "training_iteration": 47, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-06-25", "timestamp": 1708859185, "time_this_iter_s": 30.503376722335815, "time_total_s": 1406.080048084259, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1406.080048084259, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 31.991176470588236, "ram_util_percent": 20.81764705882353, "gpu_util_percent0": 0.015588235294117648, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -383.3855787275185, "episode_reward_min": -425.9223395492852, "episode_reward_mean": -409.8180324341749, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.64961753247684, -412.6845469052177, -420.6815255624406, -414.1097449259896, -401.63914607301905, -415.3201160854326, -417.8148175093214, -412.93499132927525, -422.78339551663396, -406.3399779250509, -410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852, -385.44108315339804, -389.3651647618108, -388.9741187915844, -383.3855787275185, -388.5584643464618, -383.82979482826346, -390.19547756331605, -392.2047320404579, -406.0211908948442, -395.19070713311226, -412.46100218304645, -405.65353509412375, -408.521901166524, -424.0984743807212, -411.7400220642782, -406.8384954686711, -408.23783772550206, -411.65668302638966, -410.4619694188514, -419.63846590941694, -404.21980098327987, -415.5082109451997, -415.76151361632094, -408.76329156906195, -411.3739324636232, -412.55748852319795, -408.80365886284426, -412.0750146801786, -408.712898648518, -410.8062485180097, -404.96505681607385, -418.17620333924935, -411.87866946059387, -416.74519037382106, -419.55432706960113, -413.3735325452049, -418.78943530282385, -420.0818923864399, -423.14692351985803, -419.24709541184205], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2367928420187257, "mean_inference_ms": 1.212284292309192, "mean_action_processing_ms": 0.1356613261394728, "mean_env_wait_ms": 0.8967297601132636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 460800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"learn_time_ms": 5506.397, "learn_throughput": 0.363, "update_time_ms": 13.915}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4444182813167572, "grad_norm": 1.0107887983322144, "td_error_abs": 0.38651957194010417, "q_taken_mean": -0.33114457194010416, "target_mean": -0.36777071126302086}}}, "num_steps_sampled": 460800, "num_agent_steps_sampled": 460800, "num_steps_trained": 96, "num_agent_steps_trained": 921600, "last_target_update_ts": 460800, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-06-56", "timestamp": 1708859216, "time_this_iter_s": 31.16382622718811, "time_total_s": 1437.2438743114471, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1437.2438743114471, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 32.63142857142857, "ram_util_percent": 21.045714285714283, "gpu_util_percent0": 0.011142857142857144, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -383.3855787275185, "episode_reward_min": -425.9223395492852, "episode_reward_mean": -409.7885749087842, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.4469952399227, -411.7402142958923, -414.8008532853148, -407.14541172974566, -412.86673429857063, -419.01134952272747, -417.65657842616235, -414.5052964992221, -406.52061414582795, -417.2576863571786, -404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852, -385.44108315339804, -389.3651647618108, -388.9741187915844, -383.3855787275185, -388.5584643464618, -383.82979482826346, -390.19547756331605, -392.2047320404579, -406.0211908948442, -395.19070713311226, -412.46100218304645, -405.65353509412375, -408.521901166524, -424.0984743807212, -411.7400220642782, -406.8384954686711, -408.23783772550206, -411.65668302638966, -410.4619694188514, -419.63846590941694, -404.21980098327987, -415.5082109451997, -415.76151361632094, -408.76329156906195, -411.3739324636232, -412.55748852319795, -408.80365886284426, -412.0750146801786, -408.712898648518, -410.8062485180097, -404.96505681607385, -418.17620333924935, -411.87866946059387, -416.74519037382106, -419.55432706960113, -413.3735325452049, -418.78943530282385, -420.0818923864399, -423.14692351985803, -419.24709541184205, -414.81274497034707, -419.022450639764, -415.621597421773, -406.52287358743484, -414.9159174938702, -411.20753305436267, -413.14967467219975, -415.8936139944279, -411.44200734994575, -413.42371364167457], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23697017755594, "mean_inference_ms": 1.2136616367427524, "mean_action_processing_ms": 0.1357159302204819, "mean_env_wait_ms": 0.8976906185355287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 470400, "timesteps_this_iter": 0, "agent_timesteps_total": 470400, "timers": {"learn_time_ms": 5437.157, "learn_throughput": 0.368, "update_time_ms": 14.04}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.46688979864120483, "grad_norm": 3.102581739425659, "td_error_abs": 0.40566475423177084, "q_taken_mean": -0.4131582845052083, "target_mean": -0.31521160888671873}}}, "num_steps_sampled": 470400, "num_agent_steps_sampled": 470400, "num_steps_trained": 98, "num_agent_steps_trained": 940800, "last_target_update_ts": 460800, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 490, "training_iteration": 49, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-07-26", "timestamp": 1708859246, "time_this_iter_s": 30.602561712265015, "time_total_s": 1467.8464360237122, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1467.8464360237122, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.251428571428576, "ram_util_percent": 21.26571428571428, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.0244140625}}
{"episode_reward_max": -383.3855787275185, "episode_reward_min": -425.9223395492852, "episode_reward_mean": -409.7896628541213, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-404.84326566386966, -397.3176377489266, -412.5138066063861, -408.48016340159097, -399.0508004009571, -403.47639854117324, -402.747828785237, -415.2721792389124, -400.2373759572373, -407.6077285279598, -409.31499507687835, -408.15189223858096, -414.57121221460346, -408.39253674512037, -412.8600097565072, -420.4132447771446, -406.7157108266632, -422.2647587966041, -403.2701520081439, -414.7313271200221, -410.7241539681316, -409.4931745624066, -409.2352175336745, -416.91314609300906, -412.12546374193005, -409.50950706267037, -413.4801134675457, -406.8006170391018, -412.0004738892524, -418.55544509121904, -416.2024736665156, -408.40936577701063, -415.830091160344, -408.42614213667804, -400.6634678897789, -412.2227577484315, -406.16449393809984, -412.85522119047954, -416.1118565999405, -425.9223395492852, -385.44108315339804, -389.3651647618108, -388.9741187915844, -383.3855787275185, -388.5584643464618, -383.82979482826346, -390.19547756331605, -392.2047320404579, -406.0211908948442, -395.19070713311226, -412.46100218304645, -405.65353509412375, -408.521901166524, -424.0984743807212, -411.7400220642782, -406.8384954686711, -408.23783772550206, -411.65668302638966, -410.4619694188514, -419.63846590941694, -404.21980098327987, -415.5082109451997, -415.76151361632094, -408.76329156906195, -411.3739324636232, -412.55748852319795, -408.80365886284426, -412.0750146801786, -408.712898648518, -410.8062485180097, -404.96505681607385, -418.17620333924935, -411.87866946059387, -416.74519037382106, -419.55432706960113, -413.3735325452049, -418.78943530282385, -420.0818923864399, -423.14692351985803, -419.24709541184205, -414.81274497034707, -419.022450639764, -415.621597421773, -406.52287358743484, -414.9159174938702, -411.20753305436267, -413.14967467219975, -415.8936139944279, -411.44200734994575, -413.42371364167457, -411.82473093497697, -416.0446796647918, -421.4469970408913, -413.8803808499127, -409.62202350394375, -414.6061759597606, -410.1936250956195, -411.6424266637028, -408.45455859118954, -414.34493002948227], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2370880933752283, "mean_inference_ms": 1.2148001495975649, "mean_action_processing_ms": 0.1357463486387038, "mean_env_wait_ms": 0.8984853073636798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"learn_time_ms": 5408.948, "learn_throughput": 0.37, "update_time_ms": 14.129}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4790719449520111, "grad_norm": 4.647639274597168, "td_error_abs": 0.4111770426432292, "q_taken_mean": -0.1825963134765625, "target_mean": -0.3146521606445313}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 100, "num_agent_steps_trained": 960000, "last_target_update_ts": 460800, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "evaluation": {"episode_reward_max": -345.38231260470485, "episode_reward_min": -358.805615376476, "episode_reward_mean": -351.83607557694233, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-357.9255053567158, -350.8362232728018, -351.4388091402837, -353.81009094656815, -346.9734354805488, -357.529127058391, -349.0239422278373, -358.805615376476, -345.38231260470485, -346.6356943050958], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23738347842114477, "mean_inference_ms": 1.0872717363587792, "mean_action_processing_ms": 0.13140660625561468, "mean_env_wait_ms": 0.8769110085728042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 500, "training_iteration": 50, "trial_id": "a349b_00000", "experiment_id": "1c01fab9a77644318eaf56cec8bdf08a", "date": "2024-02-25_17-08-20", "timestamp": 1708859300, "time_this_iter_s": 53.20021438598633, "time_total_s": 1521.0466504096985, "pid": 11844, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1521.0466504096985, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 32.516949152542374, "ram_util_percent": 21.510169491525417, "gpu_util_percent0": 0.022033898305084745, "vram_util_percent0": 0.0244140625}}
