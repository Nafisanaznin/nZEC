{"episode_reward_max": -1500.3262721727317, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1539.1078830516267, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633779916753381, "mean_inference_ms": 1.3200832331217787, "mean_action_processing_ms": 0.13552416623817148, "mean_env_wait_ms": 0.8481959274482527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 27694.288, "sample_throughput": 3466.419, "load_time_ms": 0.603, "load_throughput": 159151456.126, "learn_time_ms": 4551.84, "learn_throughput": 21090.372, "update_time_ms": 13.62}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 205.85439215766058, "policy_loss": -0.0009347389956625799, "vf_loss": 205.8755620320638, "vf_explained_var": -0.00014987587928771973, "kl": 0.00822580050698947, "entropy": 2.1884561247295804, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-28-03", "timestamp": 1708846083, "time_this_iter_s": 32.252546548843384, "time_total_s": 32.252546548843384, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a4670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 32.252546548843384, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.309090909090905, "ram_util_percent": 13.381818181818176, "gpu_util_percent0": 0.08477272727272728, "vram_util_percent0": 0.02811501242897727}}
{"episode_reward_max": -1404.6978590143792, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1489.7743818821148, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559140947163943, "mean_inference_ms": 1.314690811172057, "mean_action_processing_ms": 0.13456896097615698, "mean_env_wait_ms": 0.8415070198420445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 29641.217, "sample_throughput": 3238.733, "load_time_ms": 0.401, "load_throughput": 239176230.472, "learn_time_ms": 4524.298, "learn_throughput": 21218.76, "update_time_ms": 15.805}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 147.86371443006726, "policy_loss": 0.0035158397836817634, "vf_loss": 147.88023969862195, "vf_explained_var": -2.8798977533976238e-05, "kl": 0.008304886206687985, "entropy": 2.1703099807103476, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 192000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-28-35", "timestamp": 1708846115, "time_this_iter_s": 31.506857872009277, "time_total_s": 63.75940442085266, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070af70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 63.75940442085266, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.518604651162786, "ram_util_percent": 13.86279069767442, "gpu_util_percent0": 0.08162790697674419, "vram_util_percent0": 0.027547200520833325}}
{"episode_reward_max": -1169.0178665477813, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1396.2270449278221, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575724743489976, "mean_inference_ms": 1.3118049658296345, "mean_action_processing_ms": 0.13402862990576617, "mean_env_wait_ms": 0.8371551107834443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 30282.386, "sample_throughput": 3170.16, "load_time_ms": 0.345, "load_throughput": 278460016.598, "learn_time_ms": 4507.945, "learn_throughput": 21295.735, "update_time_ms": 15.322}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 75.99562644958496, "policy_loss": -0.008925560059853725, "vf_loss": 76.02402199639215, "vf_explained_var": -6.427367528279622e-06, "kl": 0.00820601348440809, "entropy": 2.1110794809129505, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 288000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-29-06", "timestamp": 1708846146, "time_this_iter_s": 31.511010885238647, "time_total_s": 95.27041530609131, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab9b76a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 95.27041530609131, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.776190476190475, "ram_util_percent": 13.983333333333333, "gpu_util_percent0": 0.08071428571428571, "vram_util_percent0": 0.02754720052083333}}
{"episode_reward_max": -966.9336777459882, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1299.4203868249638, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569979604825632, "mean_inference_ms": 1.3105344238495371, "mean_action_processing_ms": 0.13382281713176147, "mean_env_wait_ms": 0.8350372384617539, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 30665.703, "sample_throughput": 3130.533, "load_time_ms": 0.317, "load_throughput": 303031558.984, "learn_time_ms": 4516.018, "learn_throughput": 21257.667, "update_time_ms": 15.293}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 34.613996505737305, "policy_loss": 0.0027335059518615403, "vf_loss": 34.6289881600274, "vf_explained_var": -8.192327287462023e-06, "kl": 0.011687642696731107, "entropy": 2.006282693809933, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 384000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-29-38", "timestamp": 1708846178, "time_this_iter_s": 31.855680227279663, "time_total_s": 127.12609553337097, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab8207670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 127.12609553337097, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.788372093023252, "ram_util_percent": 14.097674418604647, "gpu_util_percent0": 0.07209302325581396, "vram_util_percent0": 0.027547200520833325}}
{"episode_reward_max": -784.169961534335, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1199.63729472905, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581283979435423, "mean_inference_ms": 1.3130472096225734, "mean_action_processing_ms": 0.13411902563245115, "mean_env_wait_ms": 0.8356171667876897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 31236.389, "sample_throughput": 3073.339, "load_time_ms": 0.337, "load_throughput": 284923000.283, "learn_time_ms": 4519.743, "learn_throughput": 21240.147, "update_time_ms": 15.12}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 10.89103094736735, "policy_loss": 0.000662105436074651, "vf_loss": 10.906936115688747, "vf_explained_var": -2.2325250837537977e-05, "kl": 0.010689902453902595, "entropy": 1.870511856344011, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-30-12", "timestamp": 1708846212, "time_this_iter_s": 33.48506236076355, "time_total_s": 160.61115789413452, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab8207ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 160.61115789413452, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.879999999999995, "ram_util_percent": 14.268888888888894, "gpu_util_percent0": 0.0771111111111111, "vram_util_percent0": 0.03515625000000001}}
{"episode_reward_max": -588.4297826053505, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1105.4557704359836, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587026714285108, "mean_inference_ms": 1.314180708348616, "mean_action_processing_ms": 0.13421600294944758, "mean_env_wait_ms": 0.8356894972903507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 31323.068, "sample_throughput": 3064.834, "load_time_ms": 0.32, "load_throughput": 300002372.284, "learn_time_ms": 4519.201, "learn_throughput": 21242.694, "update_time_ms": 15.179}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 2.895816889074114, "policy_loss": -0.0044856735815604525, "vf_loss": 2.9168214400609336, "vf_explained_var": 5.950199233161079e-05, "kl": 0.006063025066979281, "entropy": 1.7731384105152554, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 576000, "num_steps_trained": 576000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-30-44", "timestamp": 1708846244, "time_this_iter_s": 31.71725082397461, "time_total_s": 192.32840871810913, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffabbc9a820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 192.32840871810913, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.548837209302327, "ram_util_percent": 14.21395348837209, "gpu_util_percent0": 0.03604651162790698, "vram_util_percent0": 0.033378187076065886}}
{"episode_reward_max": -515.9644741238906, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -1023.9360575762762, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588964522742401, "mean_inference_ms": 1.3142436536855246, "mean_action_processing_ms": 0.13419016793759286, "mean_env_wait_ms": 0.8352897164566645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"sample_time_ms": 31334.835, "sample_throughput": 3063.683, "load_time_ms": 0.309, "load_throughput": 310997714.664, "learn_time_ms": 4510.975, "learn_throughput": 21281.43, "update_time_ms": 14.953}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 1.8259008328119914, "policy_loss": -0.00783970584678981, "vf_loss": 1.849841680791643, "vf_explained_var": -0.00020634796884324815, "kl": 0.0037546518339690404, "entropy": 1.6852054331037734, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 672000, "num_steps_trained": 672000, "num_agent_steps_trained": 672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-31-15", "timestamp": 1708846275, "time_this_iter_s": 31.278931617736816, "time_total_s": 223.60734033584595, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070a310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 223.60734033584595, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.51219512195122, "ram_util_percent": 14.353658536585366, "gpu_util_percent0": 0.009268292682926829, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -458.06344084574755, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -955.4886092759076, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589970171114496, "mean_inference_ms": 1.3139486639505507, "mean_action_processing_ms": 0.1341291183598145, "mean_env_wait_ms": 0.834749367214598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 31356.308, "sample_throughput": 3061.585, "load_time_ms": 0.299, "load_throughput": 320999050.523, "learn_time_ms": 4506.564, "learn_throughput": 21302.259, "update_time_ms": 14.817}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005, "total_loss": 2.093429022365146, "policy_loss": -0.017733702177388802, "vf_loss": 2.126852856742011, "vf_explained_var": -0.000396605994966295, "kl": 0.005061852519622486, "entropy": 1.619629959265391, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 768000, "num_steps_trained": 768000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-31-46", "timestamp": 1708846306, "time_this_iter_s": 31.49293351173401, "time_total_s": 255.10027384757996, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a4040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 255.10027384757996, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.22619047619047, "ram_util_percent": 14.416666666666666, "gpu_util_percent0": 0.021190476190476194, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -392.00955732815396, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -897.0938844873181, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590142578622026, "mean_inference_ms": 1.313507130842607, "mean_action_processing_ms": 0.1340564346460619, "mean_env_wait_ms": 0.8342702628213876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 864000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 31383.896, "sample_throughput": 3058.894, "load_time_ms": 0.292, "load_throughput": 328845613.067, "learn_time_ms": 4494.76, "learn_throughput": 21358.203, "update_time_ms": 14.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005, "total_loss": 2.4903947379853992, "policy_loss": -0.016125453823608242, "vf_loss": 2.5219949748780994, "vf_explained_var": -0.0004513098133934869, "kl": 0.004261186194172601, "entropy": 1.5900960829522874, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 864000, "num_agent_steps_sampled": 864000, "num_steps_trained": 864000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-32-18", "timestamp": 1708846338, "time_this_iter_s": 31.499958515167236, "time_total_s": 286.6002323627472, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab80d8700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 286.6002323627472, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.895238095238092, "ram_util_percent": 14.514285714285718, "gpu_util_percent0": 0.017619047619047618, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -368.0701312396668, "episode_reward_min": -1596.1040032341382, "episode_reward_mean": -846.8801375796925, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1529.1131178271364, -1581.5041999918428, -1505.6240625367031, -1502.0497062626105, -1524.7505185315317, -1566.872868695852, -1542.0862806522641, -1500.3262721727317, -1596.1040032341382, -1542.6478006114553, -1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590752018360752, "mean_inference_ms": 1.3130624150260106, "mean_action_processing_ms": 0.13397772696895263, "mean_env_wait_ms": 0.8338403324953667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 31412.076, "sample_throughput": 3056.15, "load_time_ms": 0.291, "load_throughput": 329422550.929, "learn_time_ms": 4492.128, "learn_throughput": 21370.72, "update_time_ms": 14.937}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005, "total_loss": 2.5323765608999462, "policy_loss": 0.023506850832038455, "vf_loss": 2.5238459640079074, "vf_explained_var": -0.0003956423865424262, "kl": 0.005597078037712476, "entropy": 1.525605148739285, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-32-50", "timestamp": 1708846370, "time_this_iter_s": 31.712379693984985, "time_total_s": 318.3126120567322, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74f973550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 318.3126120567322, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.134883720930233, "ram_util_percent": 14.60697674418605, "gpu_util_percent0": 0.01930232558139535, "vram_util_percent0": 0.03304036458333333}}
{"episode_reward_max": -339.5857314530355, "episode_reward_min": -1478.1347607204548, "episode_reward_mean": -727.5640353449667, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1478.1347607204548, -1434.816372508805, -1453.888526036554, -1438.4711147589956, -1404.6978590143792, -1445.112493510963, -1432.6488237204774, -1457.231815166632, -1414.48988937129, -1444.917152317476, -1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5586597238486961, "mean_inference_ms": 1.3118354567236503, "mean_action_processing_ms": 0.13373419392760544, "mean_env_wait_ms": 0.8319636295237024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1056000, "timesteps_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"sample_time_ms": 31801.371, "sample_throughput": 3018.738, "load_time_ms": 0.254, "load_throughput": 377404802.699, "learn_time_ms": 4483.664, "learn_throughput": 21411.061, "update_time_ms": 14.969}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005, "total_loss": 2.6605315473344593, "policy_loss": 0.010428696405142546, "vf_loss": 2.6650326119528875, "vf_explained_var": -0.00022740827666388618, "kl": 0.0019729425828646815, "entropy": 1.5028483072916667, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1056000, "num_agent_steps_sampled": 1056000, "num_steps_trained": 1056000, "num_agent_steps_trained": 1056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 110, "training_iteration": 11, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-33-21", "timestamp": 1708846401, "time_this_iter_s": 31.55375838279724, "time_total_s": 349.8663704395294, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a4670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 349.8663704395294, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.807317073170736, "ram_util_percent": 14.712195121951218, "gpu_util_percent0": 0.011951219512195122, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -338.7818961051562, "episode_reward_min": -1244.745998083128, "episode_reward_mean": -618.7754454348826, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179.7697174485709, -1244.745998083128, -1169.0178665477813, -1201.227740365456, -1202.01320900417, -1210.709715732475, -1236.5207502690614, -1200.7000387407031, -1211.1672808492356, -1235.4513931517854, -1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591270074564618, "mean_inference_ms": 1.3116663922226288, "mean_action_processing_ms": 0.1336785865522117, "mean_env_wait_ms": 0.8314835938703472, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1152000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 31831.289, "sample_throughput": 3015.9, "load_time_ms": 0.258, "load_throughput": 371691298.809, "learn_time_ms": 4487.771, "learn_throughput": 21391.467, "update_time_ms": 14.579}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 1.78547685013877, "policy_loss": -0.006947723010347949, "vf_loss": 1.8074974086549547, "vf_explained_var": 7.618798149956597e-05, "kl": 0.002245443571756848, "entropy": 1.5128994385401409, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 1152000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-33-53", "timestamp": 1708846433, "time_this_iter_s": 31.933172702789307, "time_total_s": 381.7995431423187, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a4040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 381.7995431423187, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.260465116279065, "ram_util_percent": 14.804651162790696, "gpu_util_percent0": 0.02488372093023256, "vram_util_percent0": 0.03304036458333333}}
{"episode_reward_max": -338.7818961051562, "episode_reward_min": -1070.3701086227081, "episode_reward_mean": -533.4184708409651, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1024.3892264233518, -1006.376466952964, -1029.1196303056147, -990.1501238075423, -966.9336777459882, -980.3714295007668, -1070.3701086227081, -1021.6254964266477, -1020.5838731438214, -980.0840922344869, -793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596672814237711, "mean_inference_ms": 1.3117437852034737, "mean_action_processing_ms": 0.13367849112997487, "mean_env_wait_ms": 0.8315626913436508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1248000, "timesteps_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"sample_time_ms": 31851.807, "sample_throughput": 3013.958, "load_time_ms": 0.259, "load_throughput": 370698935.739, "learn_time_ms": 4483.78, "learn_throughput": 21410.509, "update_time_ms": 14.62}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005, "total_loss": 1.217933177947998, "policy_loss": 0.002197935815072722, "vf_loss": 1.2311179604795244, "vf_explained_var": 0.0002401272455851237, "kl": 0.003550683145627543, "entropy": 1.542712648709615, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1248000, "num_agent_steps_sampled": 1248000, "num_steps_trained": 1248000, "num_agent_steps_trained": 1248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 130, "training_iteration": 13, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-34-25", "timestamp": 1708846465, "time_this_iter_s": 31.64388656616211, "time_total_s": 413.44342970848083, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070a040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 413.44342970848083, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.904761904761905, "ram_util_percent": 14.90952380952381, "gpu_util_percent0": 0.015476190476190477, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -338.7818961051562, "episode_reward_min": -836.6184846658822, "episode_reward_mean": -471.36764630174713, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.730370355173, -787.5516477782694, -836.6184846658822, -798.9623335323524, -787.1031676490661, -791.9030130754957, -824.0074549799456, -784.169961534335, -788.1742396282709, -812.8285902551529, -625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560181947907311, "mean_inference_ms": 1.3117823738237018, "mean_action_processing_ms": 0.13365369870127478, "mean_env_wait_ms": 0.8316204782309198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1344000, "timesteps_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"sample_time_ms": 31859.943, "sample_throughput": 3013.188, "load_time_ms": 0.26, "load_throughput": 369813725.202, "learn_time_ms": 4484.174, "learn_throughput": 21408.624, "update_time_ms": 14.479}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005, "total_loss": 0.7979239490297105, "policy_loss": -0.0021575895241565174, "vf_loss": 0.8154973453945584, "vf_explained_var": 0.00025966101222568087, "kl": 0.004423656205979926, "entropy": 1.5443454318576388, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1344000, "num_agent_steps_sampled": 1344000, "num_steps_trained": 1344000, "num_agent_steps_trained": 1344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-34-57", "timestamp": 1708846497, "time_this_iter_s": 31.977146863937378, "time_total_s": 445.4205765724182, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a41f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 445.4205765724182, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.302380952380954, "ram_util_percent": 14.988095238095237, "gpu_util_percent0": 0.022380952380952383, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -689.2481550031156, "episode_reward_mean": -427.8754788193672, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-625.045141105653, -606.0569482167225, -653.130497645166, -627.0879812465918, -615.7802891200565, -588.4297826053505, -689.2481550031156, -649.5266710757844, -611.467529695838, -679.7084939922331, -538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5599682349820967, "mean_inference_ms": 1.310068174625336, "mean_action_processing_ms": 0.13340186671549387, "mean_env_wait_ms": 0.8307137825629981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 31673.349, "sample_throughput": 3030.939, "load_time_ms": 0.247, "load_throughput": 389375480.128, "learn_time_ms": 4474.213, "learn_throughput": 21456.286, "update_time_ms": 14.406}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005, "total_loss": 0.8833852973249223, "policy_loss": 0.01291169308953815, "vf_loss": 0.8861130641566383, "vf_explained_var": 0.0002659791045718723, "kl": 0.0034411142381720536, "entropy": 1.5650244421429105, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1440000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 1440000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 15, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-35-28", "timestamp": 1708846528, "time_this_iter_s": 31.51911473274231, "time_total_s": 476.9396913051605, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a4820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 476.9396913051605, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.885714285714286, "ram_util_percent": 15.095238095238098, "gpu_util_percent0": 0.012380952380952381, "vram_util_percent0": 0.033040364583333336}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -551.5940713140366, "episode_reward_mean": -401.61914335110174, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-538.2395975003518, -544.697267012917, -530.2982329292729, -522.9750606310847, -551.5940713140366, -543.9999019348385, -545.7331355001431, -515.9644741238906, -520.5974429530974, -534.0786202807246, -503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598972383968076, "mean_inference_ms": 1.308754047934678, "mean_action_processing_ms": 0.1332126459198196, "mean_env_wait_ms": 0.8299994022964648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 31697.418, "sample_throughput": 3028.638, "load_time_ms": 0.25, "load_throughput": 383406193.106, "learn_time_ms": 4478.161, "learn_throughput": 21437.37, "update_time_ms": 14.285}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005, "total_loss": 0.8261667059527503, "policy_loss": -0.0023705724419818986, "vf_loss": 0.8435450593630472, "vf_explained_var": 0.00038311216566297744, "kl": 0.002620049629033288, "entropy": 1.5011849734518263, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1536000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 1536000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-36-01", "timestamp": 1708846561, "time_this_iter_s": 32.03708338737488, "time_total_s": 508.9767746925354, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa074a940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 508.9767746925354, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.404761904761898, "ram_util_percent": 15.226190476190476, "gpu_util_percent0": 0.025, "vram_util_percent0": 0.03149995349702381}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -503.72963735679434, "episode_reward_mean": -382.652003387624, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-503.72963735679434, -469.4695588014607, -458.06344084574755, -460.9237927655756, -477.0631657746457, -478.9661829530268, -460.3153789337474, -476.3442557498285, -479.7398246734683, -498.94947387895394, -431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5599621227134705, "mean_inference_ms": 1.3080015229442563, "mean_action_processing_ms": 0.133083733050651, "mean_env_wait_ms": 0.8296040685112359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1632000, "timesteps_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"sample_time_ms": 31754.195, "sample_throughput": 3023.223, "load_time_ms": 0.26, "load_throughput": 368966538.99, "learn_time_ms": 4479.036, "learn_throughput": 21433.182, "update_time_ms": 14.313}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005, "total_loss": 0.6821897857718997, "policy_loss": 0.003975796733155019, "vf_loss": 0.6932318905989329, "vf_explained_var": 9.372830390930176e-05, "kl": 0.003729705017163465, "entropy": 1.502083592944675, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1632000, "num_agent_steps_sampled": 1632000, "num_steps_trained": 1632000, "num_agent_steps_trained": 1632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 17, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-36-32", "timestamp": 1708846592, "time_this_iter_s": 31.857778310775757, "time_total_s": 540.8345530033112, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74f708af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 540.8345530033112, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.963414634146343, "ram_util_percent": 15.317073170731707, "gpu_util_percent0": 0.010731707317073172, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -453.08355614175036, "episode_reward_mean": -371.87777577258123, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-431.4928298973317, -439.9458341712499, -420.45867812150595, -453.08355614175036, -433.3324355783684, -426.42351473670897, -392.00955732815396, -431.4319047585302, -421.97975573435474, -449.2027953180448, -394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600706620024842, "mean_inference_ms": 1.3075733135654983, "mean_action_processing_ms": 0.1329840037046013, "mean_env_wait_ms": 0.8293884022537799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1728000, "timesteps_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"sample_time_ms": 31791.52, "sample_throughput": 3019.673, "load_time_ms": 0.262, "load_throughput": 366949042.194, "learn_time_ms": 4482.965, "learn_throughput": 21414.397, "update_time_ms": 14.32}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005, "total_loss": 0.7117344472143385, "policy_loss": 0.01306833192292187, "vf_loss": 0.7136418455176883, "vf_explained_var": 0.0011472503344217937, "kl": 0.005248216211171505, "entropy": 1.4977760977215238, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1728000, "num_agent_steps_sampled": 1728000, "num_steps_trained": 1728000, "num_agent_steps_trained": 1728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-37-04", "timestamp": 1708846624, "time_this_iter_s": 31.90273904800415, "time_total_s": 572.7372920513153, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755f1ff70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 572.7372920513153, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.40238095238095, "ram_util_percent": 15.402380952380952, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -431.66103601120966, "episode_reward_mean": -364.5404981395084, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-394.1143034925305, -431.66103601120966, -372.8821927235025, -368.0701312396668, -392.8186893452296, -408.6953684616905, -383.90330845478155, -406.8847592898083, -416.6585330706109, -373.87583202160044, -350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602989983845121, "mean_inference_ms": 1.3073693159911886, "mean_action_processing_ms": 0.13291259215565288, "mean_env_wait_ms": 0.8292692024577883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1824000, "timesteps_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"sample_time_ms": 31844.61, "sample_throughput": 3014.639, "load_time_ms": 0.263, "load_throughput": 365649458.772, "learn_time_ms": 4493.065, "learn_throughput": 21366.259, "update_time_ms": 14.29}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005, "total_loss": 0.676484990451071, "policy_loss": 0.002160611756456395, "vf_loss": 0.6890564329094357, "vf_explained_var": 0.00020458632045321993, "kl": 0.013593998899648437, "entropy": 1.4737340807914734, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1824000, "num_agent_steps_sampled": 1824000, "num_steps_trained": 1824000, "num_agent_steps_trained": 1824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 19, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-37-36", "timestamp": 1708846656, "time_this_iter_s": 32.08840608596802, "time_total_s": 604.8256981372833, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74f708f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 604.8256981372833, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.942857142857136, "ram_util_percent": 15.507142857142858, "gpu_util_percent0": 0.01738095238095238, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -413.28050138518455, "episode_reward_mean": -361.04580147182793, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-350.5954551175211, -348.22966485035784, -346.2475201208296, -339.5857314530355, -348.5151555670196, -341.438677783843, -349.6874638209286, -348.6448725036178, -345.9126786093875, -340.61138721714923, -356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604932995704316, "mean_inference_ms": 1.3073247510445334, "mean_action_processing_ms": 0.132860079190493, "mean_env_wait_ms": 0.8291930657742641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 31878.454, "sample_throughput": 3011.438, "load_time_ms": 0.258, "load_throughput": 371828593.591, "learn_time_ms": 4502.764, "learn_throughput": 21320.236, "update_time_ms": 14.027}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005, "total_loss": 0.6177982538938522, "policy_loss": -0.0025395325695474944, "vf_loss": 0.6346563431951735, "vf_explained_var": 0.0010856489340464275, "kl": 0.006829262769057764, "entropy": 1.4321229921446905, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1920000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 1920000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-38-09", "timestamp": 1708846689, "time_this_iter_s": 32.043280363082886, "time_total_s": 636.8689785003662, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab95d0c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 636.8689785003662, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.447619047619046, "ram_util_percent": 15.621428571428572, "gpu_util_percent0": 0.02642857142857143, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -413.28050138518455, "episode_reward_mean": -360.9087377997107, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-356.8812574484268, -345.6707839391894, -367.5005954990764, -338.7818961051562, -343.08101715019086, -356.9087888368774, -347.8606031056515, -358.26820703453416, -351.9556583415452, -358.6410086569807, -344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560716704460754, "mean_inference_ms": 1.3074489650676684, "mean_action_processing_ms": 0.13282326882121429, "mean_env_wait_ms": 0.8291753268722384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2016000, "timesteps_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"sample_time_ms": 31920.063, "sample_throughput": 3007.513, "load_time_ms": 0.261, "load_throughput": 368089573.087, "learn_time_ms": 4505.904, "learn_throughput": 21305.381, "update_time_ms": 14.073}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005, "total_loss": 0.5547831522093879, "policy_loss": 0.005795338572675569, "vf_loss": 0.5637144578827752, "vf_explained_var": 0.00036260485649108887, "kl": 0.004671060852055898, "entropy": 1.4728452629513211, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2016000, "num_agent_steps_sampled": 2016000, "num_steps_trained": 2016000, "num_agent_steps_trained": 2016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 210, "training_iteration": 21, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-38-40", "timestamp": 1708846720, "time_this_iter_s": 31.908780336380005, "time_total_s": 668.7777588367462, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab823dca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 668.7777588367462, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.957142857142852, "ram_util_percent": 15.704761904761906, "gpu_util_percent0": 0.019761904761904762, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -413.28050138518455, "episode_reward_mean": -360.5450028744992, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-344.0462927867017, -343.58452277841474, -340.92417542249484, -359.6508941764135, -348.1052503397855, -358.2296576248038, -358.2913293811518, -406.9649976843077, -340.69834627893107, -355.1307843276111, -413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609299751861225, "mean_inference_ms": 1.3076521287588614, "mean_action_processing_ms": 0.1327884587269358, "mean_env_wait_ms": 0.8290897066967156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2112000, "timesteps_this_iter": 0, "agent_timesteps_total": 2112000, "timers": {"sample_time_ms": 31933.95, "sample_throughput": 3006.205, "load_time_ms": 0.262, "load_throughput": 366882172.21, "learn_time_ms": 4507.447, "learn_throughput": 21298.086, "update_time_ms": 14.079}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0005, "total_loss": 0.581118118431833, "policy_loss": -0.008208885504346754, "vf_loss": 0.6045261157883538, "vf_explained_var": 0.0004448095957438151, "kl": 0.002374030377780317, "entropy": 1.5199593901634216, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2112000, "num_agent_steps_sampled": 2112000, "num_steps_trained": 2112000, "num_agent_steps_trained": 2112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-39-13", "timestamp": 1708846753, "time_this_iter_s": 32.057042598724365, "time_total_s": 700.8348014354706, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755f1f790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 700.8348014354706, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.511904761904763, "ram_util_percent": 15.804761904761904, "gpu_util_percent0": 0.02238095238095238, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -413.28050138518455, "episode_reward_mean": -360.6696519360692, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-413.28050138518455, -392.9697943961174, -402.51020721089435, -372.6049744929304, -394.24927053863746, -379.6267587951489, -391.06276423877483, -380.1966023428464, -367.8299526364326, -390.5908452051179, -382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611066012007149, "mean_inference_ms": 1.3080195323238863, "mean_action_processing_ms": 0.13276109557030208, "mean_env_wait_ms": 0.8290516213477527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2208000, "timesteps_this_iter": 0, "agent_timesteps_total": 2208000, "timers": {"sample_time_ms": 31958.8, "sample_throughput": 3003.867, "load_time_ms": 0.263, "load_throughput": 365549871.993, "learn_time_ms": 4513.771, "learn_throughput": 21268.25, "update_time_ms": 14.103}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005, "total_loss": 0.6924337132109536, "policy_loss": 0.00045166309509012435, "vf_loss": 0.7072739667362637, "vf_explained_var": 0.000538892216152615, "kl": 0.0029975578022644286, "entropy": 1.5292195015483432, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2208000, "num_agent_steps_sampled": 2208000, "num_steps_trained": 2208000, "num_agent_steps_trained": 2208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 230, "training_iteration": 23, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-39-45", "timestamp": 1708846785, "time_this_iter_s": 31.93958568572998, "time_total_s": 732.7743871212006, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff764054dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 732.7743871212006, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.180487804878044, "ram_util_percent": 15.885365853658536, "gpu_util_percent0": 0.011219512195121953, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.0030443790248, "episode_reward_min": -401.5603612235349, "episode_reward_mean": -357.48269625263566, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-382.46342921118213, -355.10200251656494, -333.0030443790248, -401.5603612235349, -369.72491301436247, -389.82868395756077, -345.50105595038997, -352.26253887904414, -374.3944182258712, -351.9920678584183, -352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612580720970322, "mean_inference_ms": 1.308373657486016, "mean_action_processing_ms": 0.13273312457286834, "mean_env_wait_ms": 0.8290725984300796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2304000, "timesteps_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"sample_time_ms": 31983.239, "sample_throughput": 3001.572, "load_time_ms": 0.263, "load_throughput": 365118955.386, "learn_time_ms": 4514.746, "learn_throughput": 21263.654, "update_time_ms": 14.181}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005, "total_loss": 0.6613607207934061, "policy_loss": 0.0005362064888079962, "vf_loss": 0.6759122875001695, "vf_explained_var": 0.00044976009262932674, "kl": 0.00783126503681985, "entropy": 1.5088163084454007, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2304000, "num_agent_steps_sampled": 2304000, "num_steps_trained": 2304000, "num_agent_steps_trained": 2304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-40-17", "timestamp": 1708846817, "time_this_iter_s": 32.16813635826111, "time_total_s": 764.9425234794617, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a41f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 764.9425234794617, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.530952380952378, "ram_util_percent": 16.002380952380953, "gpu_util_percent0": 0.02357142857142857, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -420.76729706299267, "episode_reward_mean": -360.4593648330234, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-352.6983752915844, -356.87966577812284, -353.37693803098574, -390.423427565138, -361.1884481376066, -379.9523448996628, -389.3910531898533, -374.50997375283237, -370.9699363443096, -390.4577798898841, -343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614022880111194, "mean_inference_ms": 1.308889868247891, "mean_action_processing_ms": 0.13271854942253072, "mean_env_wait_ms": 0.8291587879450476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2400000, "timesteps_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"sample_time_ms": 32029.501, "sample_throughput": 2997.237, "load_time_ms": 0.259, "load_throughput": 370698935.739, "learn_time_ms": 4522.673, "learn_throughput": 21226.385, "update_time_ms": 14.179}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005, "total_loss": 0.8907934079567591, "policy_loss": -0.007270232256915834, "vf_loss": 0.9136281079716153, "vf_explained_var": -0.000258819924460517, "kl": 0.004391011005271063, "entropy": 1.5564673609203763, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2400000, "num_agent_steps_sampled": 2400000, "num_steps_trained": 2400000, "num_agent_steps_trained": 2400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 250, "training_iteration": 25, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-40-49", "timestamp": 1708846849, "time_this_iter_s": 32.05047297477722, "time_total_s": 796.9929964542389, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa07a4820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 796.9929964542389, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.188095238095237, "ram_util_percent": 16.080952380952382, "gpu_util_percent0": 0.018571428571428572, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -420.76729706299267, "episode_reward_mean": -359.5449544506846, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-343.17423490146723, -345.5272268844868, -344.4421208212258, -352.05770797734095, -351.5385312831643, -346.3426056783172, -345.7242856234226, -336.3128125373429, -341.3046374224327, -345.0396447033666, -375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615319689792733, "mean_inference_ms": 1.3094046442520897, "mean_action_processing_ms": 0.13270184364539886, "mean_env_wait_ms": 0.8292830493314307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2496000, "timesteps_this_iter": 0, "agent_timesteps_total": 2496000, "timers": {"sample_time_ms": 32054.99, "sample_throughput": 2994.854, "load_time_ms": 0.288, "load_throughput": 333515434.44, "learn_time_ms": 4521.069, "learn_throughput": 21233.918, "update_time_ms": 14.373}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005, "total_loss": 0.6775693777534697, "policy_loss": -0.020187264929215114, "vf_loss": 0.7125919891728295, "vf_explained_var": 0.0005716383457183838, "kl": 0.002858764836702244, "entropy": 1.483542846308814, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2496000, "num_agent_steps_sampled": 2496000, "num_steps_trained": 2496000, "num_agent_steps_trained": 2496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-41-21", "timestamp": 1708846881, "time_this_iter_s": 32.257009744644165, "time_total_s": 829.250006198883, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff764054dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 829.250006198883, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.66666666666666, "ram_util_percent": 16.1547619047619, "gpu_util_percent0": 0.020952380952380955, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -420.76729706299267, "episode_reward_mean": -360.94974270308575, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-375.511556594226, -357.74158073210623, -378.42259583781436, -353.70370743448586, -364.417982321269, -374.281887061361, -369.28091557637333, -375.83149199009, -377.9484133582425, -359.00181932300165, -344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616723673947882, "mean_inference_ms": 1.3099536898617166, "mean_action_processing_ms": 0.13269424266218516, "mean_env_wait_ms": 0.829436938478618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2592000, "timesteps_this_iter": 0, "agent_timesteps_total": 2592000, "timers": {"sample_time_ms": 32079.853, "sample_throughput": 2992.532, "load_time_ms": 0.278, "load_throughput": 345328631.218, "learn_time_ms": 4525.323, "learn_throughput": 21213.957, "update_time_ms": 14.37}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0005, "total_loss": 0.6561845921807818, "policy_loss": 0.014678893403874503, "vf_loss": 0.6566045681635538, "vf_explained_var": 0.0010391738679673937, "kl": 0.006151319165696235, "entropy": 1.5098946624332004, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2592000, "num_agent_steps_sampled": 2592000, "num_steps_trained": 2592000, "num_agent_steps_trained": 2592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 270, "training_iteration": 27, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-41-53", "timestamp": 1708846913, "time_this_iter_s": 32.16544008255005, "time_total_s": 861.4154462814331, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab9b92d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 861.4154462814331, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.160975609756107, "ram_util_percent": 16.26585365853658, "gpu_util_percent0": 0.013170731707317074, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -420.76729706299267, "episode_reward_mean": -359.3517341378979, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-344.641825546197, -369.3362996471736, -358.6472282196096, -358.1723369669585, -369.6968987985299, -343.5408832279736, -367.32994734392537, -353.59995416986146, -352.05865302687636, -348.6090715316128, -348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618283905003348, "mean_inference_ms": 1.3105573916237634, "mean_action_processing_ms": 0.13269313517996253, "mean_env_wait_ms": 0.8296266367653113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2688000, "timesteps_this_iter": 0, "agent_timesteps_total": 2688000, "timers": {"sample_time_ms": 32126.598, "sample_throughput": 2988.178, "load_time_ms": 0.277, "load_throughput": 345951700.318, "learn_time_ms": 4535.81, "learn_throughput": 21164.909, "update_time_ms": 14.386}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0005, "total_loss": 0.6354456775718265, "policy_loss": 0.015159688463124136, "vf_loss": 0.6353658868206872, "vf_explained_var": 0.0015773309601677789, "kl": 0.006416001287501721, "entropy": 1.5079980889956157, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2688000, "num_agent_steps_sampled": 2688000, "num_steps_trained": 2688000, "num_agent_steps_trained": 2688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-42-26", "timestamp": 1708846946, "time_this_iter_s": 32.42919373512268, "time_total_s": 893.8446400165558, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab94a6b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 893.8446400165558, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.030952380952385, "ram_util_percent": 16.357142857142858, "gpu_util_percent0": 0.02357142857142857, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -420.76729706299267, "episode_reward_mean": -359.61699291587024, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-348.24694163715276, -357.47868388315527, -362.24817496490147, -375.7016601184617, -375.624842306693, -360.11290100239904, -359.0724775034228, -354.51245691115537, -344.062663355856, -363.0336856593867, -347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561941016720088, "mean_inference_ms": 1.3111265464649648, "mean_action_processing_ms": 0.1326806691158709, "mean_env_wait_ms": 0.8297857212781193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2784000, "timesteps_this_iter": 0, "agent_timesteps_total": 2784000, "timers": {"sample_time_ms": 32128.663, "sample_throughput": 2987.986, "load_time_ms": 0.282, "load_throughput": 340913710.947, "learn_time_ms": 4534.208, "learn_throughput": 21172.387, "update_time_ms": 14.421}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0005, "total_loss": 0.6822242389122645, "policy_loss": 0.013131832496987449, "vf_loss": 0.6839240690072378, "vf_explained_var": 0.0015177428722381592, "kl": 0.002362753186362966, "entropy": 1.4831689265039232, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2784000, "num_agent_steps_sampled": 2784000, "num_steps_trained": 2784000, "num_agent_steps_trained": 2784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 290, "training_iteration": 29, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-42-58", "timestamp": 1708846978, "time_this_iter_s": 31.994067192077637, "time_total_s": 925.8387072086334, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070a040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 925.8387072086334, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.180487804878044, "ram_util_percent": 16.4, "gpu_util_percent0": 0.014146341463414636, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -420.76729706299267, "episode_reward_mean": -358.43105464659163, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-347.88138023846443, -341.19456420752704, -344.66744062025083, -346.334749177906, -345.6838364025152, -347.5055331896506, -342.84935243529577, -341.6207909847204, -341.20233810924026, -346.82225446640103, -335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562056088051803, "mean_inference_ms": 1.3116828407376986, "mean_action_processing_ms": 0.13266871067439912, "mean_env_wait_ms": 0.8300029419766309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2880000, "timesteps_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"sample_time_ms": 32156.197, "sample_throughput": 2985.428, "load_time_ms": 0.281, "load_throughput": 341781838.554, "learn_time_ms": 4535.585, "learn_throughput": 21165.956, "update_time_ms": 14.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0005, "total_loss": 0.5734924839602576, "policy_loss": 0.010737030301243067, "vf_loss": 0.5775849355591668, "vf_explained_var": 0.0008163121011522082, "kl": 0.0029764714610986337, "entropy": 1.4829496410157945, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2880000, "num_agent_steps_sampled": 2880000, "num_steps_trained": 2880000, "num_agent_steps_trained": 2880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-43-30", "timestamp": 1708847010, "time_this_iter_s": 32.34909534454346, "time_total_s": 958.1878025531769, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffabbc9a820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 958.1878025531769, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 16.535714285714285, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -335.85619543998143, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -363.08307610525947, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.85619543998143, -350.25033407016514, -349.8948012491593, -352.79081848359414, -346.05933989670007, -350.3682774556061, -348.5490525846336, -344.7946254846429, -352.0986554207984, -358.5142235111939, -339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621702431572633, "mean_inference_ms": 1.312245714228729, "mean_action_processing_ms": 0.13265522827032383, "mean_env_wait_ms": 0.8302057214347818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 2976000, "timesteps_this_iter": 0, "agent_timesteps_total": 2976000, "timers": {"sample_time_ms": 32166.325, "sample_throughput": 2984.488, "load_time_ms": 0.279, "load_throughput": 343883494.748, "learn_time_ms": 4540.616, "learn_throughput": 21142.505, "update_time_ms": 14.652}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0005, "total_loss": 0.9192674375242658, "policy_loss": -0.009976851443449656, "vf_loss": 0.9442421065436469, "vf_explained_var": 0.0016940401660071479, "kl": 0.0033984922871115614, "entropy": 1.4997847477595012, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2976000, "num_agent_steps_sampled": 2976000, "num_steps_trained": 2976000, "num_agent_steps_trained": 2976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-44-02", "timestamp": 1708847042, "time_this_iter_s": 32.04804706573486, "time_total_s": 990.2358496189117, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74f708c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 990.2358496189117, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.404878048780485, "ram_util_percent": 16.619512195121953, "gpu_util_percent0": 0.010487804878048781, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -337.40357493138515, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -364.4920792322639, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-339.6304020280717, -354.8040107667337, -355.9819400054318, -376.68341750687114, -346.70759526372785, -364.3749411840678, -366.59956817841623, -350.0459046884664, -355.091832793367, -358.1715445424661, -367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622941691387929, "mean_inference_ms": 1.3128363644818775, "mean_action_processing_ms": 0.13264633339365464, "mean_env_wait_ms": 0.8304669212271396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3072000, "timesteps_this_iter": 0, "agent_timesteps_total": 3072000, "timers": {"sample_time_ms": 32217.539, "sample_throughput": 2979.743, "load_time_ms": 0.281, "load_throughput": 342043139.653, "learn_time_ms": 4546.202, "learn_throughput": 21116.529, "update_time_ms": 14.659}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0005, "total_loss": 0.7325027833382288, "policy_loss": 0.006492325622174475, "vf_loss": 0.7410215073161655, "vf_explained_var": 0.0012000501155853271, "kl": 0.0028912226390610052, "entropy": 1.5011023150549994, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3072000, "num_agent_steps_sampled": 3072000, "num_steps_trained": 3072000, "num_agent_steps_trained": 3072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-44-35", "timestamp": 1708847075, "time_this_iter_s": 32.56939363479614, "time_total_s": 1022.8052432537079, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74f708e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1022.8052432537079, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.750000000000007, "ram_util_percent": 16.704761904761902, "gpu_util_percent0": 0.021904761904761903, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -337.40357493138515, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -363.5203865213518, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-367.12880184827696, -356.9529914476532, -363.19806362228513, -348.099474012438, -371.7588230274532, -347.9516140319789, -344.34260643528637, -350.38040160010553, -358.30650727332886, -358.1068195999074, -410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624242297763261, "mean_inference_ms": 1.3134184006603287, "mean_action_processing_ms": 0.13263790873233572, "mean_env_wait_ms": 0.8307608468057772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3168000, "timesteps_this_iter": 0, "agent_timesteps_total": 3168000, "timers": {"sample_time_ms": 32245.753, "sample_throughput": 2977.136, "load_time_ms": 0.28, "load_throughput": 342566942.318, "learn_time_ms": 4547.163, "learn_throughput": 21112.063, "update_time_ms": 14.554}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0005, "total_loss": 0.5827431264850829, "policy_loss": 0.0041056207976200515, "vf_loss": 0.5932103627257876, "vf_explained_var": 0.0018216106626722547, "kl": 0.0015340167049723004, "entropy": 1.4572842452261183, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3168000, "num_agent_steps_sampled": 3168000, "num_steps_trained": 3168000, "num_agent_steps_trained": 3168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 330, "training_iteration": 33, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-45-07", "timestamp": 1708847107, "time_this_iter_s": 32.173662185668945, "time_total_s": 1054.9789054393768, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070adc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1054.9789054393768, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 30.39024390243903, "ram_util_percent": 16.804878048780484, "gpu_util_percent0": 0.015365853658536585, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -334.05310798089056, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -363.625038948667, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.2239034432347, -377.26758221664045, -384.60586862231656, -396.7524908326498, -412.9896541913561, -376.59695199660155, -364.86464866297484, -412.2871678575374, -397.14380836843617, -420.76729706299267, -358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625429029964524, "mean_inference_ms": 1.3140854204987877, "mean_action_processing_ms": 0.13263274963444968, "mean_env_wait_ms": 0.831040688368344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3264000, "timesteps_this_iter": 0, "agent_timesteps_total": 3264000, "timers": {"sample_time_ms": 32287.055, "sample_throughput": 2973.328, "load_time_ms": 0.281, "load_throughput": 341723825.851, "learn_time_ms": 4546.585, "learn_throughput": 21114.75, "update_time_ms": 14.514}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0005, "total_loss": 0.6260557952854369, "policy_loss": -0.0002931765177183681, "vf_loss": 0.6413499381807115, "vf_explained_var": 0.0014258258872561986, "kl": 0.0035461156807373873, "entropy": 1.5000972416665819, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3264000, "num_agent_steps_sampled": 3264000, "num_steps_trained": 3264000, "num_agent_steps_trained": 3264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-45-40", "timestamp": 1708847140, "time_this_iter_s": 32.566802740097046, "time_total_s": 1087.5457081794739, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755eed550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1087.5457081794739, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.788095238095234, "ram_util_percent": 16.900000000000002, "gpu_util_percent0": 0.02357142857142857, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -334.05310798089056, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -360.88485976243413, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.4002391998635, -357.7531072462724, -369.2604211528508, -369.17002478799844, -365.1871357831725, -350.55588092230414, -339.20762549815424, -364.53045512372967, -375.31163414440147, -379.03038078735887, -349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626804870310876, "mean_inference_ms": 1.3148130814467283, "mean_action_processing_ms": 0.13262988535650094, "mean_env_wait_ms": 0.8312783219911136, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3360000, "timesteps_this_iter": 0, "agent_timesteps_total": 3360000, "timers": {"sample_time_ms": 32316.984, "sample_throughput": 2970.574, "load_time_ms": 0.281, "load_throughput": 341723825.851, "learn_time_ms": 4550.693, "learn_throughput": 21095.687, "update_time_ms": 14.55}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0005, "total_loss": 0.7268593990140491, "policy_loss": 0.008491331297490332, "vf_loss": 0.7332849966155158, "vf_explained_var": 0.0012055635452270508, "kl": 0.007987892308128318, "entropy": 1.491692880789439, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3360000, "num_agent_steps_sampled": 3360000, "num_steps_trained": 3360000, "num_agent_steps_trained": 3360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 350, "training_iteration": 35, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-46-12", "timestamp": 1708847172, "time_this_iter_s": 32.39591836929321, "time_total_s": 1119.941626548767, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070a310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1119.941626548767, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.373170731707315, "ram_util_percent": 17.007317073170732, "gpu_util_percent0": 0.012926829268292684, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -334.05310798089056, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -360.0090981415892, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.5608314407376, -358.07624738247284, -338.6004330223399, -367.8312349707899, -367.7872506996238, -348.2917247563373, -365.9051158849561, -377.90959607876476, -373.9928289839015, -343.9873698527492, -358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5628117614740247, "mean_inference_ms": 1.3155500712831059, "mean_action_processing_ms": 0.1326278019339046, "mean_env_wait_ms": 0.8314922597748654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3456000, "timesteps_this_iter": 0, "agent_timesteps_total": 3456000, "timers": {"sample_time_ms": 32337.884, "sample_throughput": 2968.654, "load_time_ms": 0.249, "load_throughput": 385166619.476, "learn_time_ms": 4554.509, "learn_throughput": 21078.011, "update_time_ms": 14.952}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0005, "total_loss": 0.6996740947167078, "policy_loss": 0.007945788765533103, "vf_loss": 0.706605013873842, "vf_explained_var": 0.00038384728961520724, "kl": 0.005732109114507062, "entropy": 1.4876722229851618, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3456000, "num_agent_steps_sampled": 3456000, "num_steps_trained": 3456000, "num_agent_steps_trained": 3456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-46-44", "timestamp": 1708847204, "time_this_iter_s": 32.466251373291016, "time_total_s": 1152.407877922058, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755eed0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1152.407877922058, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.7095238095238, "ram_util_percent": 17.104761904761908, "gpu_util_percent0": 0.022619047619047622, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -334.05310798089056, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -358.8762464948091, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.90455934003353, -357.54275476166833, -357.87114724926306, -341.3785900648918, -350.78770088386074, -389.2925528889937, -343.81162534154276, -340.02833700847526, -338.55505718960654, -348.16876898185365, -356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5629687717075145, "mean_inference_ms": 1.3162915239106996, "mean_action_processing_ms": 0.13262287041197704, "mean_env_wait_ms": 0.8316850426029613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3552000, "timesteps_this_iter": 0, "agent_timesteps_total": 3552000, "timers": {"sample_time_ms": 32365.263, "sample_throughput": 2966.143, "load_time_ms": 0.25, "load_throughput": 383260217.019, "learn_time_ms": 4558.386, "learn_throughput": 21060.087, "update_time_ms": 15.175}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0005, "total_loss": 0.5837266859081056, "policy_loss": 0.007836648043141596, "vf_loss": 0.5901962187555101, "vf_explained_var": 0.001427362362543742, "kl": 0.0017739756290557135, "entropy": 1.430616901980506, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3552000, "num_agent_steps_sampled": 3552000, "num_steps_trained": 3552000, "num_agent_steps_trained": 3552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 370, "training_iteration": 37, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-47-17", "timestamp": 1708847237, "time_this_iter_s": 32.43195915222168, "time_total_s": 1184.8398370742798, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755d3f1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1184.8398370742798, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.399999999999995, "ram_util_percent": 17.214634146341464, "gpu_util_percent0": 0.010975609756097562, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.44726953479994, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -358.70278174013765, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-356.2801828235672, -357.60502933025776, -375.9054315032378, -378.9416010028761, -353.73227365281195, -375.5633446831259, -361.42135551123346, -353.4219032592309, -337.992307338756, -341.295547170849, -346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631112934237088, "mean_inference_ms": 1.317065700692712, "mean_action_processing_ms": 0.13261723490632465, "mean_env_wait_ms": 0.8318454854586982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3648000, "timesteps_this_iter": 0, "agent_timesteps_total": 3648000, "timers": {"sample_time_ms": 32389.625, "sample_throughput": 2963.912, "load_time_ms": 0.251, "load_throughput": 383005026.158, "learn_time_ms": 4555.698, "learn_throughput": 21072.514, "update_time_ms": 15.38}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0005, "total_loss": 0.5990017503499985, "policy_loss": 0.01219059028921442, "vf_loss": 0.6013845304648081, "vf_explained_var": 0.0017541017797258166, "kl": 0.00306778145587004, "entropy": 1.4573387967215643, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3648000, "num_agent_steps_sampled": 3648000, "num_steps_trained": 3648000, "num_agent_steps_trained": 3648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-47-50", "timestamp": 1708847270, "time_this_iter_s": 32.604963064193726, "time_total_s": 1217.4448001384735, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755eed550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1217.4448001384735, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.91707317073171, "ram_util_percent": 17.287804878048778, "gpu_util_percent0": 0.022195121951219515, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.44726953479994, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -358.2828448822362, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346.61727013849605, -364.2076561883193, -341.5911255865043, -339.6654594384936, -344.66729463889084, -350.18806271184883, -347.3467371530737, -343.359049806619, -366.45442982110603, -337.40357493138515, -407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632499310194002, "mean_inference_ms": 1.3178558047396955, "mean_action_processing_ms": 0.1326153876742341, "mean_env_wait_ms": 0.8320379551497933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3744000, "timesteps_this_iter": 0, "agent_timesteps_total": 3744000, "timers": {"sample_time_ms": 32416.24, "sample_throughput": 2961.479, "load_time_ms": 0.25, "load_throughput": 384321069.008, "learn_time_ms": 4556.765, "learn_throughput": 21067.578, "update_time_ms": 15.388}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0005, "total_loss": 0.6249733616908392, "policy_loss": -0.0017466070130467415, "vf_loss": 0.6413245167997148, "vf_explained_var": 0.001775612433751424, "kl": 0.0018249155878613127, "entropy": 1.4604532718658447, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3744000, "num_agent_steps_sampled": 3744000, "num_steps_trained": 3744000, "num_agent_steps_trained": 3744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 390, "training_iteration": 39, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-48-22", "timestamp": 1708847302, "time_this_iter_s": 32.296873807907104, "time_total_s": 1249.7416739463806, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755eedd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1249.7416739463806, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.48048780487805, "ram_util_percent": 17.31219512195122, "gpu_util_percent0": 0.01902439024390244, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -333.069823786461, "episode_reward_min": -421.6381880847021, "episode_reward_mean": -359.98283883088806, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-407.9670313684312, -409.01703081923733, -402.6267204368369, -357.0174513786598, -374.3936133589902, -363.39904986626794, -369.7105510015169, -385.48758555152284, -421.6381880847021, -419.70716383258326, -358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5633960060941555, "mean_inference_ms": 1.3186650796699149, "mean_action_processing_ms": 0.13261720109171957, "mean_env_wait_ms": 0.8322024163630602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3840000, "timesteps_this_iter": 0, "agent_timesteps_total": 3840000, "timers": {"sample_time_ms": 32441.213, "sample_throughput": 2959.199, "load_time_ms": 0.259, "load_throughput": 370869654.601, "learn_time_ms": 4552.554, "learn_throughput": 21087.066, "update_time_ms": 15.822}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0005, "total_loss": 0.7626240410738521, "policy_loss": -0.006018332309193081, "vf_loss": 0.7832133107715182, "vf_explained_var": 0.0009474522537655301, "kl": 0.0025415419944210932, "entropy": 1.4570941593911912, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3840000, "num_agent_steps_sampled": 3840000, "num_steps_trained": 3840000, "num_agent_steps_trained": 3840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-48-54", "timestamp": 1708847334, "time_this_iter_s": 32.55943942070007, "time_total_s": 1282.3011133670807, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab9b76a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1282.3011133670807, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.835714285714282, "ram_util_percent": 17.43333333333333, "gpu_util_percent0": 0.021904761904761906, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -332.77082697019785, "episode_reward_min": -401.9696574344943, "episode_reward_mean": -354.8495557247047, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.2477584108085, -353.9948423791686, -378.4347819379662, -363.11439166492875, -345.1990483879773, -354.7774942784842, -354.3468307477257, -393.8316644262139, -370.3756077697164, -357.75421629392713, -345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5635501108438961, "mean_inference_ms": 1.3194765014818395, "mean_action_processing_ms": 0.13262089678585723, "mean_env_wait_ms": 0.8323943530856603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3936000, "timesteps_this_iter": 0, "agent_timesteps_total": 3936000, "timers": {"sample_time_ms": 32468.103, "sample_throughput": 2956.748, "load_time_ms": 0.261, "load_throughput": 367116323.851, "learn_time_ms": 4544.186, "learn_throughput": 21125.894, "update_time_ms": 15.714}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0005, "total_loss": 0.5236101117399004, "policy_loss": 0.003965968266129494, "vf_loss": 0.5342963437239329, "vf_explained_var": 0.0017640855577256945, "kl": 0.0027834401200609905, "entropy": 1.4652207891146343, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3936000, "num_agent_steps_sampled": 3936000, "num_steps_trained": 3936000, "num_agent_steps_trained": 3936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 410, "training_iteration": 41, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-49-27", "timestamp": 1708847367, "time_this_iter_s": 32.25096797943115, "time_total_s": 1314.5520813465118, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab95d0c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1314.5520813465118, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.446341463414633, "ram_util_percent": 17.504878048780487, "gpu_util_percent0": 0.012439024390243903, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -401.9696574344943, "episode_reward_mean": -354.90381064340255, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.8830665338276, -342.67605225480554, -341.55304740405137, -371.11268999481416, -338.9017066539278, -348.1448699685073, -337.4791161019396, -351.3589908574092, -342.08576203761646, -351.72658405950654, -379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636930891537613, "mean_inference_ms": 1.3202791704218344, "mean_action_processing_ms": 0.1326246313357945, "mean_env_wait_ms": 0.8325898162286604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4032000, "timesteps_this_iter": 0, "agent_timesteps_total": 4032000, "timers": {"sample_time_ms": 32489.962, "sample_throughput": 2954.759, "load_time_ms": 0.26, "load_throughput": 368628750.343, "learn_time_ms": 4552.134, "learn_throughput": 21089.009, "update_time_ms": 15.853}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0005, "total_loss": 0.7448741942644119, "policy_loss": 0.009931465714342065, "vf_loss": 0.7501548164420657, "vf_explained_var": 0.0008190406693352594, "kl": 0.003342789098473754, "entropy": 1.5212089949183993, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4032000, "num_agent_steps_sampled": 4032000, "num_steps_trained": 4032000, "num_agent_steps_trained": 4032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-50-00", "timestamp": 1708847400, "time_this_iter_s": 32.86951756477356, "time_total_s": 1347.4215989112854, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74c314160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1347.4215989112854, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.04634146341463, "ram_util_percent": 17.63170731707317, "gpu_util_percent0": 0.021219512195121953, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -401.9696574344943, "episode_reward_mean": -356.22969941058886, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-379.831132155638, -334.05310798089056, -344.58482294938835, -341.409664400437, -375.1352175390476, -364.09660072752774, -355.80317194180344, -370.4803954085253, -357.2463687651441, -354.05086376182794, -386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5638597148767299, "mean_inference_ms": 1.3210650764953362, "mean_action_processing_ms": 0.1326261710552481, "mean_env_wait_ms": 0.832743628057938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4128000, "timesteps_this_iter": 0, "agent_timesteps_total": 4128000, "timers": {"sample_time_ms": 32500.662, "sample_throughput": 2953.786, "load_time_ms": 0.261, "load_throughput": 368156883.972, "learn_time_ms": 4565.473, "learn_throughput": 21027.393, "update_time_ms": 16.004}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0005, "total_loss": 0.7246162676148944, "policy_loss": 0.014693285131620036, "vf_loss": 0.7250421047210693, "vf_explained_var": 0.0012072059843275282, "kl": 0.0026467468178689437, "entropy": 1.5119116173850164, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4128000, "num_agent_steps_sampled": 4128000, "num_steps_trained": 4128000, "num_agent_steps_trained": 4128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 430, "training_iteration": 43, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-50-32", "timestamp": 1708847432, "time_this_iter_s": 32.335596323013306, "time_total_s": 1379.7571952342987, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755eeddc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1379.7571952342987, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.54390243902439, "ram_util_percent": 17.79512195121951, "gpu_util_percent0": 0.012439024390243903, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -401.9696574344943, "episode_reward_mean": -356.287625150498, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-386.91302361659046, -357.12953881911204, -383.0608798078235, -363.4914939924012, -347.59954251291737, -367.8024555915877, -392.2799487574351, -368.61629323278606, -357.4378412012135, -355.15043709959065, -352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640398747589586, "mean_inference_ms": 1.321828335336584, "mean_action_processing_ms": 0.13262533536731347, "mean_env_wait_ms": 0.8328637636067139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4224000, "timesteps_this_iter": 0, "agent_timesteps_total": 4224000, "timers": {"sample_time_ms": 32523.163, "sample_throughput": 2951.742, "load_time_ms": 0.261, "load_throughput": 367955025.13, "learn_time_ms": 4578.72, "learn_throughput": 20966.559, "update_time_ms": 16.037}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0005, "total_loss": 0.6756940252251096, "policy_loss": 0.02241466662639545, "vf_loss": 0.66774582862854, "vf_explained_var": 0.0022425121731228298, "kl": 0.0034488691620067702, "entropy": 1.4466456770896912, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4224000, "num_agent_steps_sampled": 4224000, "num_steps_trained": 4224000, "num_agent_steps_trained": 4224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-51-05", "timestamp": 1708847465, "time_this_iter_s": 32.791625022888184, "time_total_s": 1412.548820257187, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff755eedee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1412.548820257187, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.978048780487804, "ram_util_percent": 17.88780487804878, "gpu_util_percent0": 0.021463414634146343, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -401.9696574344943, "episode_reward_mean": -353.9914560374795, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-352.1150297750509, -351.65406127045264, -353.0332956947866, -364.29880877511386, -364.5257171418078, -352.1235877871509, -348.9525709182035, -344.18683501312404, -355.40445865214605, -354.53637753377757, -354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659, -346.8617918030242, -340.6157494296672, -345.3393410457029, -342.18911276909233, -337.84025520527393, -335.0835292421041, -341.28339394661936, -360.11725090298825, -350.78518340352935, -349.748935581611], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5642009701849389, "mean_inference_ms": 1.322560251849966, "mean_action_processing_ms": 0.13262854517050882, "mean_env_wait_ms": 0.8330225240248034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4320000, "timesteps_this_iter": 0, "agent_timesteps_total": 4320000, "timers": {"sample_time_ms": 32553.75, "sample_throughput": 2948.969, "load_time_ms": 0.26, "load_throughput": 369067996.334, "learn_time_ms": 4582.945, "learn_throughput": 20947.23, "update_time_ms": 16.096}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0005, "total_loss": 0.5688676171832614, "policy_loss": 0.0028676720750000742, "vf_loss": 0.5807789895269606, "vf_explained_var": 0.0016514956951141357, "kl": 0.002261876997252941, "entropy": 1.4779052072101169, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4320000, "num_agent_steps_sampled": 4320000, "num_steps_trained": 4320000, "num_agent_steps_trained": 4320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 450, "training_iteration": 45, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-51-38", "timestamp": 1708847498, "time_this_iter_s": 32.61154532432556, "time_total_s": 1445.1603655815125, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74c314670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1445.1603655815125, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.614634146341466, "ram_util_percent": 17.973170731707317, "gpu_util_percent0": 0.013902439024390246, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -413.47576886866807, "episode_reward_mean": -355.71011128819237, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.82517256153716, -339.23190562281815, -358.23678346322214, -349.33661145254206, -346.4380935588262, -343.7378560035872, -345.7489943885292, -347.90288875556286, -347.97347200095396, -345.2256905870921, -333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659, -346.8617918030242, -340.6157494296672, -345.3393410457029, -342.18911276909233, -337.84025520527393, -335.0835292421041, -341.28339394661936, -360.11725090298825, -350.78518340352935, -349.748935581611, -355.7452407848926, -349.39512497798546, -367.5029607432204, -413.47576886866807, -361.57147618971663, -388.80728668932915, -385.04629104676064, -371.64626897392003, -356.79561423687113, -362.710235121535], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5643895198069755, "mean_inference_ms": 1.323244706992022, "mean_action_processing_ms": 0.13263197699277365, "mean_env_wait_ms": 0.8332137489258045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4416000, "timesteps_this_iter": 0, "agent_timesteps_total": 4416000, "timers": {"sample_time_ms": 32584.993, "sample_throughput": 2946.142, "load_time_ms": 0.26, "load_throughput": 369406590.826, "learn_time_ms": 4593.062, "learn_throughput": 20901.087, "update_time_ms": 15.512}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0005, "total_loss": 0.7463114567928844, "policy_loss": 0.012274205477701293, "vf_loss": 0.7488218512800005, "vf_explained_var": 0.0013642178641425238, "kl": 0.005517858148196827, "entropy": 1.4784588151507907, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4416000, "num_agent_steps_sampled": 4416000, "num_steps_trained": 4416000, "num_agent_steps_trained": 4416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-52-10", "timestamp": 1708847530, "time_this_iter_s": 32.82802438735962, "time_total_s": 1477.988389968872, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffab9b92d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1477.988389968872, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.302439024390246, "ram_util_percent": 18.041463414634144, "gpu_util_percent0": 0.02219512195121951, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -413.47576886866807, "episode_reward_mean": -355.4435198213803, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.44726953479994, -337.4629698285397, -372.00520218572063, -346.18478075340965, -354.88057819793596, -347.3155672437255, -351.7647891971543, -356.40975577024074, -371.47816532092526, -338.04554021057857, -353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659, -346.8617918030242, -340.6157494296672, -345.3393410457029, -342.18911276909233, -337.84025520527393, -335.0835292421041, -341.28339394661936, -360.11725090298825, -350.78518340352935, -349.748935581611, -355.7452407848926, -349.39512497798546, -367.5029607432204, -413.47576886866807, -361.57147618971663, -388.80728668932915, -385.04629104676064, -371.64626897392003, -356.79561423687113, -362.710235121535, -364.0658617267168, -336.0084341183112, -344.5042037514843, -333.26585358011283, -344.19049890941153, -340.2825438824289, -344.82706370857784, -348.04699109427787, -350.7354386923895, -346.07143224975397], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5645613788025858, "mean_inference_ms": 1.323927048803927, "mean_action_processing_ms": 0.1326374411708312, "mean_env_wait_ms": 0.8334299837917498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4512000, "timesteps_this_iter": 0, "agent_timesteps_total": 4512000, "timers": {"sample_time_ms": 32618.748, "sample_throughput": 2943.093, "load_time_ms": 0.26, "load_throughput": 368966538.99, "learn_time_ms": 4601.205, "learn_throughput": 20864.099, "update_time_ms": 15.31}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0005, "total_loss": 0.5599565042389764, "policy_loss": -0.002305620763864782, "vf_loss": 0.5772544609175788, "vf_explained_var": 0.0013371937804751927, "kl": 0.002349895288969467, "entropy": 1.499231669637892, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4512000, "num_agent_steps_sampled": 4512000, "num_steps_trained": 4512000, "num_agent_steps_trained": 4512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 470, "training_iteration": 47, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-52-43", "timestamp": 1708847563, "time_this_iter_s": 32.75877285003662, "time_total_s": 1510.7471628189087, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070a8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1510.7471628189087, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.651219512195123, "ram_util_percent": 18.180487804878044, "gpu_util_percent0": 0.017073170731707315, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -413.47576886866807, "episode_reward_mean": -356.7399438460972, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-353.5056312334157, -351.35649652737175, -354.6068608904154, -350.46797245640926, -354.0470880670888, -335.2675015456911, -374.6415449398091, -352.6484496446706, -362.25067160832765, -361.373073572609, -342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659, -346.8617918030242, -340.6157494296672, -345.3393410457029, -342.18911276909233, -337.84025520527393, -335.0835292421041, -341.28339394661936, -360.11725090298825, -350.78518340352935, -349.748935581611, -355.7452407848926, -349.39512497798546, -367.5029607432204, -413.47576886866807, -361.57147618971663, -388.80728668932915, -385.04629104676064, -371.64626897392003, -356.79561423687113, -362.710235121535, -364.0658617267168, -336.0084341183112, -344.5042037514843, -333.26585358011283, -344.19049890941153, -340.2825438824289, -344.82706370857784, -348.04699109427787, -350.7354386923895, -346.07143224975397, -353.04203087624563, -351.11267845642254, -356.7810103249849, -383.5905556542519, -340.8058092103305, -335.0896695581201, -390.3598639251077, -361.09447766130205, -383.6817800474701, -383.0791450004922], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.564738911358856, "mean_inference_ms": 1.324557550573247, "mean_action_processing_ms": 0.13264111144980034, "mean_env_wait_ms": 0.8336617944930421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4608000, "timesteps_this_iter": 0, "agent_timesteps_total": 4608000, "timers": {"sample_time_ms": 32635.222, "sample_throughput": 2941.607, "load_time_ms": 0.259, "load_throughput": 369949636.163, "learn_time_ms": 4607.994, "learn_throughput": 20833.362, "update_time_ms": 15.167}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0005, "total_loss": 0.7292806787623299, "policy_loss": -0.011984421975082822, "vf_loss": 0.7564594911204444, "vf_explained_var": 0.0010156035423278809, "kl": 0.006287436128519671, "entropy": 1.5194374455346003, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4608000, "num_agent_steps_sampled": 4608000, "num_steps_trained": 4608000, "num_agent_steps_trained": 4608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-53-16", "timestamp": 1708847596, "time_this_iter_s": 32.758111000061035, "time_total_s": 1543.5052738189697, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74fa4fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1543.5052738189697, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.956097560975618, "ram_util_percent": 18.29268292682927, "gpu_util_percent0": 0.025853658536585368, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -413.47576886866807, "episode_reward_mean": -359.3746646482769, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.5095912139581, -333.069823786461, -401.9696574344943, -351.27715720881184, -356.17319844797265, -370.0769116147826, -337.16051752804816, -396.58445946098436, -379.6154219013017, -383.0633166831009, -341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659, -346.8617918030242, -340.6157494296672, -345.3393410457029, -342.18911276909233, -337.84025520527393, -335.0835292421041, -341.28339394661936, -360.11725090298825, -350.78518340352935, -349.748935581611, -355.7452407848926, -349.39512497798546, -367.5029607432204, -413.47576886866807, -361.57147618971663, -388.80728668932915, -385.04629104676064, -371.64626897392003, -356.79561423687113, -362.710235121535, -364.0658617267168, -336.0084341183112, -344.5042037514843, -333.26585358011283, -344.19049890941153, -340.2825438824289, -344.82706370857784, -348.04699109427787, -350.7354386923895, -346.07143224975397, -353.04203087624563, -351.11267845642254, -356.7810103249849, -383.5905556542519, -340.8058092103305, -335.0896695581201, -390.3598639251077, -361.09447766130205, -383.6817800474701, -383.0791450004922, -349.39065246006635, -375.45842511047874, -411.65268272806543, -409.6059230535595, -343.1737292277693, -379.399025084001, -400.2966859282918, -375.6435149516962, -380.6462899581374, -388.37044220170674], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5649034286607322, "mean_inference_ms": 1.3252343559886193, "mean_action_processing_ms": 0.13264688416883885, "mean_env_wait_ms": 0.8338905391404521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4704000, "timesteps_this_iter": 0, "agent_timesteps_total": 4704000, "timers": {"sample_time_ms": 32674.047, "sample_throughput": 2938.112, "load_time_ms": 0.257, "load_throughput": 374004443.619, "learn_time_ms": 4622.46, "learn_throughput": 20768.161, "update_time_ms": 15.172}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0005, "total_loss": 0.8526110781563653, "policy_loss": 0.004535623515645663, "vf_loss": 0.8628508183691237, "vf_explained_var": 0.001038952006234063, "kl": 0.00230695474568632, "entropy": 1.47753596968121, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4704000, "num_agent_steps_sampled": 4704000, "num_steps_trained": 4704000, "num_agent_steps_trained": 4704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 490, "training_iteration": 49, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-53-49", "timestamp": 1708847629, "time_this_iter_s": 32.76124382019043, "time_total_s": 1576.2665176391602, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ff74fa4f670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1576.2665176391602, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.626829268292685, "ram_util_percent": 18.31219512195122, "gpu_util_percent0": 0.012439024390243903, "vram_util_percent0": 0.0308837890625}}
{"episode_reward_max": -328.79855318684946, "episode_reward_min": -413.47576886866807, "episode_reward_mean": -357.4030606992243, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-341.58917216894, -332.77082697019785, -338.32669638553097, -343.1245742296789, -340.47227557661415, -341.71859724967794, -338.83493999749066, -339.49681934791266, -340.94394296235595, -340.3582301920261, -357.53903952762835, -371.1935692809752, -344.6145650452004, -392.1250142719179, -377.18304713646444, -376.89726228334865, -328.79855318684946, -385.65059939907997, -353.4108888708134, -348.08958916441793, -381.64638420021936, -347.73204426607407, -380.3459814632602, -372.3613225139389, -337.22898553797484, -392.41645574459926, -357.66555569684846, -345.0288198703032, -349.2540545791872, -339.8311587126365, -360.79863739313555, -361.448890407539, -354.82682160499957, -330.6580179089684, -358.50764783624805, -364.34656783361066, -352.05965892649084, -377.70261965269367, -387.0206611486838, -335.1143969087659, -346.8617918030242, -340.6157494296672, -345.3393410457029, -342.18911276909233, -337.84025520527393, -335.0835292421041, -341.28339394661936, -360.11725090298825, -350.78518340352935, -349.748935581611, -355.7452407848926, -349.39512497798546, -367.5029607432204, -413.47576886866807, -361.57147618971663, -388.80728668932915, -385.04629104676064, -371.64626897392003, -356.79561423687113, -362.710235121535, -364.0658617267168, -336.0084341183112, -344.5042037514843, -333.26585358011283, -344.19049890941153, -340.2825438824289, -344.82706370857784, -348.04699109427787, -350.7354386923895, -346.07143224975397, -353.04203087624563, -351.11267845642254, -356.7810103249849, -383.5905556542519, -340.8058092103305, -335.0896695581201, -390.3598639251077, -361.09447766130205, -383.6817800474701, -383.0791450004922, -349.39065246006635, -375.45842511047874, -411.65268272806543, -409.6059230535595, -343.1737292277693, -379.399025084001, -400.2966859282918, -375.6435149516962, -380.6462899581374, -388.37044220170674, -346.5856340510981, -339.94113985707276, -346.8892874661147, -344.97948096857505, -347.1861432388926, -342.38639395162954, -348.9697449615575, -342.98795681369165, -342.2867320507867, -352.1271470152377], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5650564786807263, "mean_inference_ms": 1.3258888715496988, "mean_action_processing_ms": 0.132652070713443, "mean_env_wait_ms": 0.8341500047696749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 4800000, "timesteps_this_iter": 0, "agent_timesteps_total": 4800000, "timers": {"sample_time_ms": 32709.417, "sample_throughput": 2934.935, "load_time_ms": 0.249, "load_throughput": 385056119.346, "learn_time_ms": 4633.916, "learn_throughput": 20716.821, "update_time_ms": 14.555}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0005, "total_loss": 0.5735221803188324, "policy_loss": 0.0014716581079281038, "vf_loss": 0.5870131552219391, "vf_explained_var": 0.00029574169052971736, "kl": 0.006188046722436437, "entropy": 1.496263908015357, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4800000, "num_agent_steps_sampled": 4800000, "num_steps_trained": 4800000, "num_agent_steps_trained": 4800000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -332.82439304447263, "episode_reward_min": -374.2522669618879, "episode_reward_mean": -356.193034271543, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-358.13600845137506, -354.00361712905453, -374.2522669618879, -356.21653645473026, -362.32941545270137, -362.16730346321776, -356.8947296401124, -332.82439304447263, -348.25513956223915, -356.85093255563925], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348795044609637, "mean_inference_ms": 1.416089745588991, "mean_action_processing_ms": 0.13172908346301107, "mean_env_wait_ms": 0.8485796252658823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 500, "training_iteration": 50, "trial_id": "55ddd_00000", "experiment_id": "70ab72688d6a48d291499cfc2050f0de", "date": "2024-02-25_13-54-50", "timestamp": 1708847690, "time_this_iter_s": 61.07340741157532, "time_total_s": 1637.3399250507355, "pid": 19963, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 10000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 10, "episode_limit": 5000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "ten team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa070ad30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 10000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1637.3399250507355, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.94342105263157, "ram_util_percent": 18.514473684210525, "gpu_util_percent0": 0.019473684210526317, "vram_util_percent0": 0.0308837890625}}
