{"episode_reward_max": -3016.9636549922056, "episode_reward_min": -3151.62660216466, "episode_reward_mean": -3095.340445945656, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3139.840999207947, -3026.9678891616304, -3059.6205230126398, -3147.0514456912338, -3108.339811728116, -3121.914501637978, -3086.9753998511933, -3043.900767194077, -3016.9636549922056, -3151.62660216466, -3132.571315110319, -3090.0777954500754, -3107.915181210576, -3083.290141027387, -3036.253193544428, -3145.7086120268523, -3083.212606787845, -3101.526617230375, -3120.5510722789063, -3102.5007896046823], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30517620301023357, "mean_inference_ms": 1.3032720934960147, "mean_action_processing_ms": 0.1599543176506114, "mean_env_wait_ms": 1.3726520984899737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"learn_time_ms": 22256.738, "learn_throughput": 0.09, "update_time_ms": 21.724}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9927420020103455, "grad_norm": 2.272831439971924, "td_error_abs": 0.8935262044270833, "q_taken_mean": 0.0021506915092468263, "target_mean": -0.03571209716796875}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 19200, "num_steps_trained": 2, "num_agent_steps_trained": 38400, "last_target_update_ts": 0}, "done": false, "episodes_total": 20, "training_iteration": 1, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_15-51-31", "timestamp": 1708854691, "time_this_iter_s": 84.7020332813263, "time_total_s": 84.7020332813263, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 84.7020332813263, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.04642857142857, "ram_util_percent": 10.853571428571428, "gpu_util_percent0": 0.06839285714285714, "vram_util_percent0": 0.027820042201450894}}
{"episode_reward_max": -2149.238148913746, "episode_reward_min": -3151.62660216466, "episode_reward_mean": -2660.5254004590656, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3139.840999207947, -3026.9678891616304, -3059.6205230126398, -3147.0514456912338, -3108.339811728116, -3121.914501637978, -3086.9753998511933, -3043.900767194077, -3016.9636549922056, -3151.62660216466, -3132.571315110319, -3090.0777954500754, -3107.915181210576, -3083.290141027387, -3036.253193544428, -3145.7086120268523, -3083.212606787845, -3101.526617230375, -3120.5510722789063, -3102.5007896046823, -2251.081080060873, -2249.3126222131264, -2202.576447576949, -2214.910350646289, -2156.675470918637, -2239.8091402675363, -2265.8838371789966, -2211.0669565484554, -2275.3022798292795, -2234.7543547556893, -2215.8298536791985, -2273.8972702888827, -2262.6444215223087, -2173.5819554332293, -2220.7375250119208, -2273.2834843423684, -2191.888944941766, -2222.557634292311, -2149.238148913746, -2229.175321027947], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31213961736235063, "mean_inference_ms": 1.3223695563032105, "mean_action_processing_ms": 0.16120241576750663, "mean_env_wait_ms": 1.4028593986132871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"learn_time_ms": 22700.307, "learn_throughput": 0.088, "update_time_ms": 21.872}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6457282900810242, "grad_norm": 2.019413471221924, "td_error_abs": 0.5488596598307292, "q_taken_mean": 0.07945523071289062, "target_mean": -0.03441606903076172}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 4, "num_agent_steps_trained": 76800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 2, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_15-53-02", "timestamp": 1708854782, "time_this_iter_s": 90.35986471176147, "time_total_s": 175.06189799308777, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 175.06189799308777, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.0647619047619, "ram_util_percent": 22.163809523809526, "gpu_util_percent0": 0.049619047619047625, "vram_util_percent0": 0.0283784412202381}}
{"episode_reward_max": -1305.4731079343378, "episode_reward_min": -3151.62660216466, "episode_reward_mean": -2224.2600891865213, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3139.840999207947, -3026.9678891616304, -3059.6205230126398, -3147.0514456912338, -3108.339811728116, -3121.914501637978, -3086.9753998511933, -3043.900767194077, -3016.9636549922056, -3151.62660216466, -3132.571315110319, -3090.0777954500754, -3107.915181210576, -3083.290141027387, -3036.253193544428, -3145.7086120268523, -3083.212606787845, -3101.526617230375, -3120.5510722789063, -3102.5007896046823, -2251.081080060873, -2249.3126222131264, -2202.576447576949, -2214.910350646289, -2156.675470918637, -2239.8091402675363, -2265.8838371789966, -2211.0669565484554, -2275.3022798292795, -2234.7543547556893, -2215.8298536791985, -2273.8972702888827, -2262.6444215223087, -2173.5819554332293, -2220.7375250119208, -2273.2834843423684, -2191.888944941766, -2222.557634292311, -2149.238148913746, -2229.175321027947, -1305.4731079343378, -1345.4182385751626, -1338.1367527798811, -1352.379429009501, -1321.0128273795056, -1361.9874416218006, -1359.8938134512869, -1335.153247820555, -1356.9641422469365, -1401.136157022465, -1306.1978130667242, -1374.8370230841174, -1371.1931480289065, -1349.2154183784212, -1379.0529175025895, -1352.3056945914007, -1363.0841918006163, -1367.2870476846183, -1336.7480747380757, -1357.1128461117655], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31599826381038654, "mean_inference_ms": 1.335110940110314, "mean_action_processing_ms": 0.1615470893322953, "mean_env_wait_ms": 1.4194919819698888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"learn_time_ms": 22339.096, "learn_throughput": 0.09, "update_time_ms": 22.124}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.8995113372802734, "grad_norm": 30.505813598632812, "td_error_abs": 1.3265614420572918, "q_taken_mean": 1.0630062662760416, "target_mean": -0.02888085174560547}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 57600, "num_steps_trained": 6, "num_agent_steps_trained": 115200, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 60, "training_iteration": 3, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_15-54-31", "timestamp": 1708854871, "time_this_iter_s": 89.10201072692871, "time_total_s": 264.1639087200165, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 264.1639087200165, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.841414141414138, "ram_util_percent": 23.69494949494949, "gpu_util_percent0": 0.00393939393939394, "vram_util_percent0": 0.0283811421506734}}
{"episode_reward_max": -735.2889071790651, "episode_reward_min": -3151.62660216466, "episode_reward_mean": -1854.8085614943484, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3139.840999207947, -3026.9678891616304, -3059.6205230126398, -3147.0514456912338, -3108.339811728116, -3121.914501637978, -3086.9753998511933, -3043.900767194077, -3016.9636549922056, -3151.62660216466, -3132.571315110319, -3090.0777954500754, -3107.915181210576, -3083.290141027387, -3036.253193544428, -3145.7086120268523, -3083.212606787845, -3101.526617230375, -3120.5510722789063, -3102.5007896046823, -2251.081080060873, -2249.3126222131264, -2202.576447576949, -2214.910350646289, -2156.675470918637, -2239.8091402675363, -2265.8838371789966, -2211.0669565484554, -2275.3022798292795, -2234.7543547556893, -2215.8298536791985, -2273.8972702888827, -2262.6444215223087, -2173.5819554332293, -2220.7375250119208, -2273.2834843423684, -2191.888944941766, -2222.557634292311, -2149.238148913746, -2229.175321027947, -1305.4731079343378, -1345.4182385751626, -1338.1367527798811, -1352.379429009501, -1321.0128273795056, -1361.9874416218006, -1359.8938134512869, -1335.153247820555, -1356.9641422469365, -1401.136157022465, -1306.1978130667242, -1374.8370230841174, -1371.1931480289065, -1349.2154183784212, -1379.0529175025895, -1352.3056945914007, -1363.0841918006163, -1367.2870476846183, -1336.7480747380757, -1357.1128461117655, -756.3491504058832, -740.7370489462572, -754.0276246458246, -747.9139064182554, -747.0401470682774, -735.3182538834443, -746.922615173192, -741.4306831985193, -744.1328164896363, -741.4950731836605, -745.4351976529447, -769.4143649457916, -746.3388624648439, -753.4270189898721, -735.2889071790651, -746.8814574843676, -749.3104027325659, -738.1015635398279, -746.0409828045, -743.4734911498323], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3189907735003089, "mean_inference_ms": 1.3490705659089037, "mean_action_processing_ms": 0.16214265669237388, "mean_env_wait_ms": 1.431841230600574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"learn_time_ms": 22382.515, "learn_throughput": 0.089, "update_time_ms": 22.558}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.836418628692627, "grad_norm": 0.9765682816505432, "td_error_abs": 0.4987587890625, "q_taken_mean": 0.3342006429036458, "target_mean": 0.3253989461263021}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 8, "num_agent_steps_trained": 153600, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 80, "training_iteration": 4, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_15-56-03", "timestamp": 1708854963, "time_this_iter_s": 92.36157822608948, "time_total_s": 356.52548694610596, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 356.52548694610596, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.473, "ram_util_percent": 24.668999999999997, "gpu_util_percent0": 0.019200000000000002, "vram_util_percent0": 0.02828165690104167}}
{"episode_reward_max": -735.0369368055921, "episode_reward_min": -3151.62660216466, "episode_reward_mean": -1633.0758487884796, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3139.840999207947, -3026.9678891616304, -3059.6205230126398, -3147.0514456912338, -3108.339811728116, -3121.914501637978, -3086.9753998511933, -3043.900767194077, -3016.9636549922056, -3151.62660216466, -3132.571315110319, -3090.0777954500754, -3107.915181210576, -3083.290141027387, -3036.253193544428, -3145.7086120268523, -3083.212606787845, -3101.526617230375, -3120.5510722789063, -3102.5007896046823, -2251.081080060873, -2249.3126222131264, -2202.576447576949, -2214.910350646289, -2156.675470918637, -2239.8091402675363, -2265.8838371789966, -2211.0669565484554, -2275.3022798292795, -2234.7543547556893, -2215.8298536791985, -2273.8972702888827, -2262.6444215223087, -2173.5819554332293, -2220.7375250119208, -2273.2834843423684, -2191.888944941766, -2222.557634292311, -2149.238148913746, -2229.175321027947, -1305.4731079343378, -1345.4182385751626, -1338.1367527798811, -1352.379429009501, -1321.0128273795056, -1361.9874416218006, -1359.8938134512869, -1335.153247820555, -1356.9641422469365, -1401.136157022465, -1306.1978130667242, -1374.8370230841174, -1371.1931480289065, -1349.2154183784212, -1379.0529175025895, -1352.3056945914007, -1363.0841918006163, -1367.2870476846183, -1336.7480747380757, -1357.1128461117655, -756.3491504058832, -740.7370489462572, -754.0276246458246, -747.9139064182554, -747.0401470682774, -735.3182538834443, -746.922615173192, -741.4306831985193, -744.1328164896363, -741.4950731836605, -745.4351976529447, -769.4143649457916, -746.3388624648439, -753.4270189898721, -735.2889071790651, -746.8814574843676, -749.3104027325659, -738.1015635398279, -746.0409828045, -743.4734911498323, -749.5533873938309, -751.2927421052174, -752.2304629941433, -745.8122066339046, -744.7077028332179, -755.4927464482837, -744.867212070269, -735.0369368055921, -744.230267350326, -748.8108438751522, -738.9845671279556, -750.4089085582563, -740.3268366424248, -742.3035194188408, -744.5875383879561, -750.2131371149321, -741.7868802268553, -749.5136509296245, -745.8629847915256, -746.8774275918013], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32195616156192763, "mean_inference_ms": 1.363028244028327, "mean_action_processing_ms": 0.16280571684149836, "mean_env_wait_ms": 1.4419151336381828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"learn_time_ms": 22507.626, "learn_throughput": 0.089, "update_time_ms": 22.602}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8895429968833923, "grad_norm": 6.6555070877075195, "td_error_abs": 0.5664588623046874, "q_taken_mean": 0.7085198567708333, "target_mean": 0.32594954427083334}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 10, "num_agent_steps_trained": 192000, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 5, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_15-57-38", "timestamp": 1708855058, "time_this_iter_s": 94.56517624855042, "time_total_s": 451.0906631946564, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 451.0906631946564, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.796, "ram_util_percent": 27.159000000000006, "gpu_util_percent0": 0.0378, "vram_util_percent0": 0.02725138346354167}}
{"episode_reward_max": -735.0369368055921, "episode_reward_min": -2275.3022798292795, "episode_reward_mean": -1180.1387007440453, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2251.081080060873, -2249.3126222131264, -2202.576447576949, -2214.910350646289, -2156.675470918637, -2239.8091402675363, -2265.8838371789966, -2211.0669565484554, -2275.3022798292795, -2234.7543547556893, -2215.8298536791985, -2273.8972702888827, -2262.6444215223087, -2173.5819554332293, -2220.7375250119208, -2273.2834843423684, -2191.888944941766, -2222.557634292311, -2149.238148913746, -2229.175321027947, -1305.4731079343378, -1345.4182385751626, -1338.1367527798811, -1352.379429009501, -1321.0128273795056, -1361.9874416218006, -1359.8938134512869, -1335.153247820555, -1356.9641422469365, -1401.136157022465, -1306.1978130667242, -1374.8370230841174, -1371.1931480289065, -1349.2154183784212, -1379.0529175025895, -1352.3056945914007, -1363.0841918006163, -1367.2870476846183, -1336.7480747380757, -1357.1128461117655, -756.3491504058832, -740.7370489462572, -754.0276246458246, -747.9139064182554, -747.0401470682774, -735.3182538834443, -746.922615173192, -741.4306831985193, -744.1328164896363, -741.4950731836605, -745.4351976529447, -769.4143649457916, -746.3388624648439, -753.4270189898721, -735.2889071790651, -746.8814574843676, -749.3104027325659, -738.1015635398279, -746.0409828045, -743.4734911498323, -749.5533873938309, -751.2927421052174, -752.2304629941433, -745.8122066339046, -744.7077028332179, -755.4927464482837, -744.867212070269, -735.0369368055921, -744.230267350326, -748.8108438751522, -738.9845671279556, -750.4089085582563, -740.3268366424248, -742.3035194188408, -744.5875383879561, -750.2131371149321, -741.7868802268553, -749.5136509296245, -745.8629847915256, -746.8774275918013, -832.6902568045527, -824.9067663953808, -843.9274488110166, -833.6171112549064, -820.7884953561381, -835.7182941751198, -837.2343474934368, -810.5024614275659, -832.5526504843958, -839.2282634623117, -834.1959931162913, -837.9539010447911, -840.0733003375375, -827.2372927890342, -836.904330652248, -817.4289936540845, -827.3826940733464, -818.9730050467705, -832.7706020348239, -829.0079060559399], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32857710848188054, "mean_inference_ms": 1.3878081033415213, "mean_action_processing_ms": 0.16399115946994414, "mean_env_wait_ms": 1.4666740538668777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"learn_time_ms": 22447.767, "learn_throughput": 0.089, "update_time_ms": 22.863}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8194570541381836, "grad_norm": 3.351027727127075, "td_error_abs": 0.46058528645833335, "q_taken_mean": 0.14996223958333332, "target_mean": 0.2723212890625}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 115200, "num_steps_trained": 12, "num_agent_steps_trained": 230400, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 120, "training_iteration": 6, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_15-59-11", "timestamp": 1708855151, "time_this_iter_s": 93.19073462486267, "time_total_s": 544.281397819519, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 544.281397819519, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.86767676767676, "ram_util_percent": 27.41010101010101, "gpu_util_percent0": 0.00909090909090909, "vram_util_percent0": 0.02700384377630471}}
{"episode_reward_max": -735.0369368055921, "episode_reward_min": -1401.136157022465, "episode_reward_mean": -900.3931099451431, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1305.4731079343378, -1345.4182385751626, -1338.1367527798811, -1352.379429009501, -1321.0128273795056, -1361.9874416218006, -1359.8938134512869, -1335.153247820555, -1356.9641422469365, -1401.136157022465, -1306.1978130667242, -1374.8370230841174, -1371.1931480289065, -1349.2154183784212, -1379.0529175025895, -1352.3056945914007, -1363.0841918006163, -1367.2870476846183, -1336.7480747380757, -1357.1128461117655, -756.3491504058832, -740.7370489462572, -754.0276246458246, -747.9139064182554, -747.0401470682774, -735.3182538834443, -746.922615173192, -741.4306831985193, -744.1328164896363, -741.4950731836605, -745.4351976529447, -769.4143649457916, -746.3388624648439, -753.4270189898721, -735.2889071790651, -746.8814574843676, -749.3104027325659, -738.1015635398279, -746.0409828045, -743.4734911498323, -749.5533873938309, -751.2927421052174, -752.2304629941433, -745.8122066339046, -744.7077028332179, -755.4927464482837, -744.867212070269, -735.0369368055921, -744.230267350326, -748.8108438751522, -738.9845671279556, -750.4089085582563, -740.3268366424248, -742.3035194188408, -744.5875383879561, -750.2131371149321, -741.7868802268553, -749.5136509296245, -745.8629847915256, -746.8774275918013, -832.6902568045527, -824.9067663953808, -843.9274488110166, -833.6171112549064, -820.7884953561381, -835.7182941751198, -837.2343474934368, -810.5024614275659, -832.5526504843958, -839.2282634623117, -834.1959931162913, -837.9539010447911, -840.0733003375375, -827.2372927890342, -836.904330652248, -817.4289936540845, -827.3826940733464, -818.9730050467705, -832.7706020348239, -829.0079060559399, -814.6003075465632, -819.0223540819743, -819.6383209810683, -810.5233538272928, -819.5887740801168, -835.2053527248153, -830.6644705105759, -822.4581269182816, -831.1904759837088, -825.6983954323426, -832.0863106406131, -843.8654121587971, -840.4148592333207, -817.3969877474435, -828.7957088078492, -833.0734495260289, -836.9169879153587, -818.9192578927126, -837.5612849846216, -822.0278285657917], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33229664096141115, "mean_inference_ms": 1.406981048111605, "mean_action_processing_ms": 0.1647484764666827, "mean_env_wait_ms": 1.481934352642695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"learn_time_ms": 22454.104, "learn_throughput": 0.089, "update_time_ms": 23.174}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6200642585754395, "grad_norm": 1.7862205505371094, "td_error_abs": 0.4121057942708333, "q_taken_mean": 0.5667939046223959, "target_mean": 0.5897496744791667}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 134400, "num_steps_trained": 14, "num_agent_steps_trained": 268800, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 140, "training_iteration": 7, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-00-45", "timestamp": 1708855245, "time_this_iter_s": 94.0294828414917, "time_total_s": 638.3108806610107, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 638.3108806610107, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.11010101010101, "ram_util_percent": 27.47171717171717, "gpu_util_percent0": 0.010707070707070708, "vram_util_percent0": 0.0269775390625}}
{"episode_reward_max": -735.0369368055921, "episode_reward_min": -843.9274488110166, "episode_reward_mean": -794.5808972449175, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-756.3491504058832, -740.7370489462572, -754.0276246458246, -747.9139064182554, -747.0401470682774, -735.3182538834443, -746.922615173192, -741.4306831985193, -744.1328164896363, -741.4950731836605, -745.4351976529447, -769.4143649457916, -746.3388624648439, -753.4270189898721, -735.2889071790651, -746.8814574843676, -749.3104027325659, -738.1015635398279, -746.0409828045, -743.4734911498323, -749.5533873938309, -751.2927421052174, -752.2304629941433, -745.8122066339046, -744.7077028332179, -755.4927464482837, -744.867212070269, -735.0369368055921, -744.230267350326, -748.8108438751522, -738.9845671279556, -750.4089085582563, -740.3268366424248, -742.3035194188408, -744.5875383879561, -750.2131371149321, -741.7868802268553, -749.5136509296245, -745.8629847915256, -746.8774275918013, -832.6902568045527, -824.9067663953808, -843.9274488110166, -833.6171112549064, -820.7884953561381, -835.7182941751198, -837.2343474934368, -810.5024614275659, -832.5526504843958, -839.2282634623117, -834.1959931162913, -837.9539010447911, -840.0733003375375, -827.2372927890342, -836.904330652248, -817.4289936540845, -827.3826940733464, -818.9730050467705, -832.7706020348239, -829.0079060559399, -814.6003075465632, -819.0223540819743, -819.6383209810683, -810.5233538272928, -819.5887740801168, -835.2053527248153, -830.6644705105759, -822.4581269182816, -831.1904759837088, -825.6983954323426, -832.0863106406131, -843.8654121587971, -840.4148592333207, -817.3969877474435, -828.7957088078492, -833.0734495260289, -836.9169879153587, -818.9192578927126, -837.5612849846216, -822.0278285657917, -818.8337801441919, -819.7838440756365, -824.6337911389124, -818.5371420030023, -822.3982506367436, -821.6305162395713, -816.7803655689833, -827.0322211678123, -817.2676644422718, -802.249515814278, -836.7019794035166, -808.2380354320871, -823.8924701302036, -821.2192965811885, -827.3958544371866, -826.0465723296956, -823.447282578641, -832.1310538315838, -833.128132160749, -832.0202946898623], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33556843338457965, "mean_inference_ms": 1.423754711594536, "mean_action_processing_ms": 0.16561959273890822, "mean_env_wait_ms": 1.494987726548883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 153600, "timers": {"learn_time_ms": 22404.553, "learn_throughput": 0.089, "update_time_ms": 23.306}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5909949541091919, "grad_norm": 4.491693496704102, "td_error_abs": 0.43142618815104167, "q_taken_mean": 0.82690673828125, "target_mean": 0.589511474609375}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 153600, "num_steps_trained": 16, "num_agent_steps_trained": 307200, "last_target_update_ts": 115200, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 160, "training_iteration": 8, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-02-19", "timestamp": 1708855339, "time_this_iter_s": 93.69713568687439, "time_total_s": 732.0080163478851, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 732.0080163478851, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.288775510204076, "ram_util_percent": 27.93775510204082, "gpu_util_percent0": 0.01193877551020408, "vram_util_percent0": 0.026944737856079932}}
{"episode_reward_max": -735.0369368055921, "episode_reward_min": -843.9274488110166, "episode_reward_mean": -809.6608420985541, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749.5533873938309, -751.2927421052174, -752.2304629941433, -745.8122066339046, -744.7077028332179, -755.4927464482837, -744.867212070269, -735.0369368055921, -744.230267350326, -748.8108438751522, -738.9845671279556, -750.4089085582563, -740.3268366424248, -742.3035194188408, -744.5875383879561, -750.2131371149321, -741.7868802268553, -749.5136509296245, -745.8629847915256, -746.8774275918013, -832.6902568045527, -824.9067663953808, -843.9274488110166, -833.6171112549064, -820.7884953561381, -835.7182941751198, -837.2343474934368, -810.5024614275659, -832.5526504843958, -839.2282634623117, -834.1959931162913, -837.9539010447911, -840.0733003375375, -827.2372927890342, -836.904330652248, -817.4289936540845, -827.3826940733464, -818.9730050467705, -832.7706020348239, -829.0079060559399, -814.6003075465632, -819.0223540819743, -819.6383209810683, -810.5233538272928, -819.5887740801168, -835.2053527248153, -830.6644705105759, -822.4581269182816, -831.1904759837088, -825.6983954323426, -832.0863106406131, -843.8654121587971, -840.4148592333207, -817.3969877474435, -828.7957088078492, -833.0734495260289, -836.9169879153587, -818.9192578927126, -837.5612849846216, -822.0278285657917, -818.8337801441919, -819.7838440756365, -824.6337911389124, -818.5371420030023, -822.3982506367436, -821.6305162395713, -816.7803655689833, -827.0322211678123, -817.2676644422718, -802.249515814278, -836.7019794035166, -808.2380354320871, -823.8924701302036, -821.2192965811885, -827.3958544371866, -826.0465723296956, -823.447282578641, -832.1310538315838, -833.128132160749, -832.0202946898623, -828.3021343295603, -833.5328029611602, -828.1581346123265, -811.8308955724236, -816.5313563137455, -824.8181109781873, -814.8393847858944, -826.7282827824074, -829.1871047457056, -818.5124738531442, -818.1185525744528, -824.3736109129346, -819.8666802925239, -813.77016265446, -825.6753515488346, -818.7144032902728, -823.8925820989216, -819.6569249187232, -818.8401929948537, -821.7249114996764], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3382798394237128, "mean_inference_ms": 1.4364575582624477, "mean_action_processing_ms": 0.1662533093053653, "mean_env_wait_ms": 1.5063813949746938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"learn_time_ms": 22379.641, "learn_throughput": 0.089, "update_time_ms": 23.892}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9313076138496399, "grad_norm": 2.9429187774658203, "td_error_abs": 0.5275597330729167, "q_taken_mean": 0.425215576171875, "target_mean": 0.3050154012044271}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 172800, "num_steps_trained": 18, "num_agent_steps_trained": 345600, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 180, "training_iteration": 9, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-03-54", "timestamp": 1708855434, "time_this_iter_s": 94.7048089504242, "time_total_s": 826.7128252983093, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 826.7128252983093, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.30918367346938, "ram_util_percent": 28.964285714285715, "gpu_util_percent0": 0.012244897959183675, "vram_util_percent0": 0.026936848958333336}}
{"episode_reward_max": -802.249515814278, "episode_reward_min": -846.7486653489705, "episode_reward_mean": -826.1189965095032, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.6902568045527, -824.9067663953808, -843.9274488110166, -833.6171112549064, -820.7884953561381, -835.7182941751198, -837.2343474934368, -810.5024614275659, -832.5526504843958, -839.2282634623117, -834.1959931162913, -837.9539010447911, -840.0733003375375, -827.2372927890342, -836.904330652248, -817.4289936540845, -827.3826940733464, -818.9730050467705, -832.7706020348239, -829.0079060559399, -814.6003075465632, -819.0223540819743, -819.6383209810683, -810.5233538272928, -819.5887740801168, -835.2053527248153, -830.6644705105759, -822.4581269182816, -831.1904759837088, -825.6983954323426, -832.0863106406131, -843.8654121587971, -840.4148592333207, -817.3969877474435, -828.7957088078492, -833.0734495260289, -836.9169879153587, -818.9192578927126, -837.5612849846216, -822.0278285657917, -818.8337801441919, -819.7838440756365, -824.6337911389124, -818.5371420030023, -822.3982506367436, -821.6305162395713, -816.7803655689833, -827.0322211678123, -817.2676644422718, -802.249515814278, -836.7019794035166, -808.2380354320871, -823.8924701302036, -821.2192965811885, -827.3958544371866, -826.0465723296956, -823.447282578641, -832.1310538315838, -833.128132160749, -832.0202946898623, -828.3021343295603, -833.5328029611602, -828.1581346123265, -811.8308955724236, -816.5313563137455, -824.8181109781873, -814.8393847858944, -826.7282827824074, -829.1871047457056, -818.5124738531442, -818.1185525744528, -824.3736109129346, -819.8666802925239, -813.77016265446, -825.6753515488346, -818.7144032902728, -823.8925820989216, -819.6569249187232, -818.8401929948537, -821.7249114996764, -829.8645966488084, -822.3815898786289, -810.1697318764925, -835.5692707508164, -846.7486653489705, -833.4038372370138, -819.6839819168314, -825.5299243717557, -814.071599187187, -827.6728515562106, -821.3851047515266, -826.3732662465707, -843.072779121729, -823.9593742003698, -823.6035603952694, -823.9769388671091, -834.6071474151081, -830.620390190136, -837.7974145301301, -838.2233759043586], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3402003130376579, "mean_inference_ms": 1.444895440728445, "mean_action_processing_ms": 0.16663294628550251, "mean_env_wait_ms": 1.5162606488265151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"learn_time_ms": 22359.247, "learn_throughput": 0.089, "update_time_ms": 23.836}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6027626991271973, "grad_norm": 1.8009041547775269, "td_error_abs": 0.41119063313802084, "q_taken_mean": 0.35296687825520834, "target_mean": 0.3824776611328125}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 20, "num_agent_steps_trained": 384000, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 10, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-05-28", "timestamp": 1708855528, "time_this_iter_s": 94.70244121551514, "time_total_s": 921.4152665138245, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 921.4152665138245, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 33.30309278350516, "ram_util_percent": 29.319587628865985, "gpu_util_percent0": 0.010721649484536083, "vram_util_percent0": 0.026936848958333336}}
{"episode_reward_max": -802.249515814278, "episode_reward_min": -846.7486653489705, "episode_reward_mean": -825.2429908277197, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-814.6003075465632, -819.0223540819743, -819.6383209810683, -810.5233538272928, -819.5887740801168, -835.2053527248153, -830.6644705105759, -822.4581269182816, -831.1904759837088, -825.6983954323426, -832.0863106406131, -843.8654121587971, -840.4148592333207, -817.3969877474435, -828.7957088078492, -833.0734495260289, -836.9169879153587, -818.9192578927126, -837.5612849846216, -822.0278285657917, -818.8337801441919, -819.7838440756365, -824.6337911389124, -818.5371420030023, -822.3982506367436, -821.6305162395713, -816.7803655689833, -827.0322211678123, -817.2676644422718, -802.249515814278, -836.7019794035166, -808.2380354320871, -823.8924701302036, -821.2192965811885, -827.3958544371866, -826.0465723296956, -823.447282578641, -832.1310538315838, -833.128132160749, -832.0202946898623, -828.3021343295603, -833.5328029611602, -828.1581346123265, -811.8308955724236, -816.5313563137455, -824.8181109781873, -814.8393847858944, -826.7282827824074, -829.1871047457056, -818.5124738531442, -818.1185525744528, -824.3736109129346, -819.8666802925239, -813.77016265446, -825.6753515488346, -818.7144032902728, -823.8925820989216, -819.6569249187232, -818.8401929948537, -821.7249114996764, -829.8645966488084, -822.3815898786289, -810.1697318764925, -835.5692707508164, -846.7486653489705, -833.4038372370138, -819.6839819168314, -825.5299243717557, -814.071599187187, -827.6728515562106, -821.3851047515266, -826.3732662465707, -843.072779121729, -823.9593742003698, -823.6035603952694, -823.9769388671091, -834.6071474151081, -830.620390190136, -837.7974145301301, -838.2233759043586, -834.8364704631183, -827.5792336816572, -814.1496662520359, -817.3001086019834, -815.626393453565, -818.8626348544243, -815.7852066423711, -833.2860305844106, -815.5050414304412, -820.0703625173456, -836.4731468542223, -831.4462439265292, -822.9181353884859, -826.7527707119887, -835.9833185620662, -834.1293697103913, -818.5052137208686, -842.7850536116422, -830.4154503671097, -833.0836949566897], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34135520608454095, "mean_inference_ms": 1.4528916431077914, "mean_action_processing_ms": 0.16696288894167288, "mean_env_wait_ms": 1.5244031003879577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 211200, "timesteps_this_iter": 0, "agent_timesteps_total": 211200, "timers": {"learn_time_ms": 22435.2, "learn_throughput": 0.089, "update_time_ms": 24.476}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.549096941947937, "grad_norm": 2.7362143993377686, "td_error_abs": 0.41108565266927083, "q_taken_mean": 0.5432391764322917, "target_mean": 0.382383544921875}}}, "num_steps_sampled": 211200, "num_agent_steps_sampled": 211200, "num_steps_trained": 22, "num_agent_steps_trained": 422400, "last_target_update_ts": 172800, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 220, "training_iteration": 11, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-07-04", "timestamp": 1708855624, "time_this_iter_s": 95.72559452056885, "time_total_s": 1017.1408610343933, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1017.1408610343933, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.4734693877551, "ram_util_percent": 29.64285714285714, "gpu_util_percent0": 0.013367346938775511, "vram_util_percent0": 0.026835123697916664}}
{"episode_reward_max": -802.249515814278, "episode_reward_min": -847.6840097894274, "episode_reward_mean": -825.0071257736897, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.8337801441919, -819.7838440756365, -824.6337911389124, -818.5371420030023, -822.3982506367436, -821.6305162395713, -816.7803655689833, -827.0322211678123, -817.2676644422718, -802.249515814278, -836.7019794035166, -808.2380354320871, -823.8924701302036, -821.2192965811885, -827.3958544371866, -826.0465723296956, -823.447282578641, -832.1310538315838, -833.128132160749, -832.0202946898623, -828.3021343295603, -833.5328029611602, -828.1581346123265, -811.8308955724236, -816.5313563137455, -824.8181109781873, -814.8393847858944, -826.7282827824074, -829.1871047457056, -818.5124738531442, -818.1185525744528, -824.3736109129346, -819.8666802925239, -813.77016265446, -825.6753515488346, -818.7144032902728, -823.8925820989216, -819.6569249187232, -818.8401929948537, -821.7249114996764, -829.8645966488084, -822.3815898786289, -810.1697318764925, -835.5692707508164, -846.7486653489705, -833.4038372370138, -819.6839819168314, -825.5299243717557, -814.071599187187, -827.6728515562106, -821.3851047515266, -826.3732662465707, -843.072779121729, -823.9593742003698, -823.6035603952694, -823.9769388671091, -834.6071474151081, -830.620390190136, -837.7974145301301, -838.2233759043586, -834.8364704631183, -827.5792336816572, -814.1496662520359, -817.3001086019834, -815.626393453565, -818.8626348544243, -815.7852066423711, -833.2860305844106, -815.5050414304412, -820.0703625173456, -836.4731468542223, -831.4462439265292, -822.9181353884859, -826.7527707119887, -835.9833185620662, -834.1293697103913, -818.5052137208686, -842.7850536116422, -830.4154503671097, -833.0836949566897, -822.8617802795621, -822.8223190237636, -834.2002939778039, -824.3278520707605, -815.9330794824448, -819.4966649701287, -823.2165695846548, -816.0780871281668, -847.6840097894274, -818.3703410825447, -828.7641235502532, -832.9855855490056, -816.5589077184902, -827.5820996021322, -831.0783146251184, -830.3852841221632, -808.174075169022, -833.4988654305408, -822.5480938026619, -839.4951671976405], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34262401969829, "mean_inference_ms": 1.4603160026757618, "mean_action_processing_ms": 0.16728120864996324, "mean_env_wait_ms": 1.5313348442893564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 230400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"learn_time_ms": 22354.863, "learn_throughput": 0.089, "update_time_ms": 24.555}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5145519375801086, "grad_norm": 2.013047695159912, "td_error_abs": 0.39909724934895835, "q_taken_mean": 0.3355034383138021, "target_mean": 0.38258797200520833}}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230400, "num_steps_trained": 24, "num_agent_steps_trained": 460800, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 240, "training_iteration": 12, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-08-40", "timestamp": 1708855720, "time_this_iter_s": 95.81508898735046, "time_total_s": 1112.9559500217438, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1112.9559500217438, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 33.57319587628866, "ram_util_percent": 31.355670103092788, "gpu_util_percent0": 0.012268041237113402, "vram_util_percent0": 0.026774088541666664}}
{"episode_reward_max": -808.174075169022, "episode_reward_min": -847.6840097894274, "episode_reward_mean": -825.3543620946967, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.3021343295603, -833.5328029611602, -828.1581346123265, -811.8308955724236, -816.5313563137455, -824.8181109781873, -814.8393847858944, -826.7282827824074, -829.1871047457056, -818.5124738531442, -818.1185525744528, -824.3736109129346, -819.8666802925239, -813.77016265446, -825.6753515488346, -818.7144032902728, -823.8925820989216, -819.6569249187232, -818.8401929948537, -821.7249114996764, -829.8645966488084, -822.3815898786289, -810.1697318764925, -835.5692707508164, -846.7486653489705, -833.4038372370138, -819.6839819168314, -825.5299243717557, -814.071599187187, -827.6728515562106, -821.3851047515266, -826.3732662465707, -843.072779121729, -823.9593742003698, -823.6035603952694, -823.9769388671091, -834.6071474151081, -830.620390190136, -837.7974145301301, -838.2233759043586, -834.8364704631183, -827.5792336816572, -814.1496662520359, -817.3001086019834, -815.626393453565, -818.8626348544243, -815.7852066423711, -833.2860305844106, -815.5050414304412, -820.0703625173456, -836.4731468542223, -831.4462439265292, -822.9181353884859, -826.7527707119887, -835.9833185620662, -834.1293697103913, -818.5052137208686, -842.7850536116422, -830.4154503671097, -833.0836949566897, -822.8617802795621, -822.8223190237636, -834.2002939778039, -824.3278520707605, -815.9330794824448, -819.4966649701287, -823.2165695846548, -816.0780871281668, -847.6840097894274, -818.3703410825447, -828.7641235502532, -832.9855855490056, -816.5589077184902, -827.5820996021322, -831.0783146251184, -830.3852841221632, -808.174075169022, -833.4988654305408, -822.5480938026619, -839.4951671976405, -809.8159560333434, -818.9625081310411, -817.3274295899505, -834.0445988856575, -818.9051508788649, -825.9117419841639, -820.8092007057501, -843.0444847397392, -816.4701985992239, -820.2551056698796, -821.6807356404329, -825.093017076624, -824.5087763578251, -824.4164962899291, -830.5460045044605, -822.3874241075296, -839.9616640229822, -813.8312709500568, -825.6683467030861, -834.4515840362892], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34372179411965015, "mean_inference_ms": 1.4672226010185483, "mean_action_processing_ms": 0.16756320000467112, "mean_env_wait_ms": 1.537544268056148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"learn_time_ms": 22478.951, "learn_throughput": 0.089, "update_time_ms": 24.795}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.48075035214424133, "grad_norm": 2.2745087146759033, "td_error_abs": 0.3984319661458333, "q_taken_mean": 0.5418095703125, "target_mean": 0.61803515625}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 249600, "num_steps_trained": 26, "num_agent_steps_trained": 499200, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 260, "training_iteration": 13, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-10-16", "timestamp": 1708855816, "time_this_iter_s": 96.10181832313538, "time_total_s": 1209.0577683448792, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1209.0577683448792, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.704166666666666, "ram_util_percent": 31.5625, "gpu_util_percent0": 0.011145833333333332, "vram_util_percent0": 0.026774088541666668}}
{"episode_reward_max": -808.174075169022, "episode_reward_min": -847.6840097894274, "episode_reward_mean": -826.4707505128007, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-829.8645966488084, -822.3815898786289, -810.1697318764925, -835.5692707508164, -846.7486653489705, -833.4038372370138, -819.6839819168314, -825.5299243717557, -814.071599187187, -827.6728515562106, -821.3851047515266, -826.3732662465707, -843.072779121729, -823.9593742003698, -823.6035603952694, -823.9769388671091, -834.6071474151081, -830.620390190136, -837.7974145301301, -838.2233759043586, -834.8364704631183, -827.5792336816572, -814.1496662520359, -817.3001086019834, -815.626393453565, -818.8626348544243, -815.7852066423711, -833.2860305844106, -815.5050414304412, -820.0703625173456, -836.4731468542223, -831.4462439265292, -822.9181353884859, -826.7527707119887, -835.9833185620662, -834.1293697103913, -818.5052137208686, -842.7850536116422, -830.4154503671097, -833.0836949566897, -822.8617802795621, -822.8223190237636, -834.2002939778039, -824.3278520707605, -815.9330794824448, -819.4966649701287, -823.2165695846548, -816.0780871281668, -847.6840097894274, -818.3703410825447, -828.7641235502532, -832.9855855490056, -816.5589077184902, -827.5820996021322, -831.0783146251184, -830.3852841221632, -808.174075169022, -833.4988654305408, -822.5480938026619, -839.4951671976405, -809.8159560333434, -818.9625081310411, -817.3274295899505, -834.0445988856575, -818.9051508788649, -825.9117419841639, -820.8092007057501, -843.0444847397392, -816.4701985992239, -820.2551056698796, -821.6807356404329, -825.093017076624, -824.5087763578251, -824.4164962899291, -830.5460045044605, -822.3874241075296, -839.9616640229822, -813.8312709500568, -825.6683467030861, -834.4515840362892, -821.1551205126242, -823.4377322209716, -820.3042529444414, -824.1093148872177, -822.2971274364969, -833.3422525802748, -821.5074056900088, -826.5219836132155, -846.4697437351456, -827.8522318452057, -822.3427763454291, -836.0891984621478, -825.8537306931231, -832.5352557508265, -832.7663806261887, -814.8643121175913, -838.4710060411229, -816.200730903515, -832.8211240547067, -829.771215070349], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3446073511332021, "mean_inference_ms": 1.4738164897166899, "mean_action_processing_ms": 0.16778102152679467, "mean_env_wait_ms": 1.5426778371463485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 268800, "timesteps_this_iter": 0, "agent_timesteps_total": 268800, "timers": {"learn_time_ms": 22470.518, "learn_throughput": 0.089, "update_time_ms": 24.871}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4922640323638916, "grad_norm": 4.972668170928955, "td_error_abs": 0.4153090413411458, "q_taken_mean": 0.7906451822916667, "target_mean": 0.6181317545572916}}}, "num_steps_sampled": 268800, "num_agent_steps_sampled": 268800, "num_steps_trained": 28, "num_agent_steps_trained": 537600, "last_target_update_ts": 230400, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 280, "training_iteration": 14, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-11-52", "timestamp": 1708855912, "time_this_iter_s": 96.05976104736328, "time_total_s": 1305.1175293922424, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1305.1175293922424, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.78736842105263, "ram_util_percent": 32.974736842105266, "gpu_util_percent0": 0.010526315789473684, "vram_util_percent0": 0.026774088541666654}}
{"episode_reward_max": -808.174075169022, "episode_reward_min": -847.6840097894274, "episode_reward_mean": -825.4882547254756, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-834.8364704631183, -827.5792336816572, -814.1496662520359, -817.3001086019834, -815.626393453565, -818.8626348544243, -815.7852066423711, -833.2860305844106, -815.5050414304412, -820.0703625173456, -836.4731468542223, -831.4462439265292, -822.9181353884859, -826.7527707119887, -835.9833185620662, -834.1293697103913, -818.5052137208686, -842.7850536116422, -830.4154503671097, -833.0836949566897, -822.8617802795621, -822.8223190237636, -834.2002939778039, -824.3278520707605, -815.9330794824448, -819.4966649701287, -823.2165695846548, -816.0780871281668, -847.6840097894274, -818.3703410825447, -828.7641235502532, -832.9855855490056, -816.5589077184902, -827.5820996021322, -831.0783146251184, -830.3852841221632, -808.174075169022, -833.4988654305408, -822.5480938026619, -839.4951671976405, -809.8159560333434, -818.9625081310411, -817.3274295899505, -834.0445988856575, -818.9051508788649, -825.9117419841639, -820.8092007057501, -843.0444847397392, -816.4701985992239, -820.2551056698796, -821.6807356404329, -825.093017076624, -824.5087763578251, -824.4164962899291, -830.5460045044605, -822.3874241075296, -839.9616640229822, -813.8312709500568, -825.6683467030861, -834.4515840362892, -821.1551205126242, -823.4377322209716, -820.3042529444414, -824.1093148872177, -822.2971274364969, -833.3422525802748, -821.5074056900088, -826.5219836132155, -846.4697437351456, -827.8522318452057, -822.3427763454291, -836.0891984621478, -825.8537306931231, -832.5352557508265, -832.7663806261887, -814.8643121175913, -838.4710060411229, -816.200730903515, -832.8211240547067, -829.771215070349, -809.0617659073438, -833.9856655552039, -829.5917295016112, -820.5072677472111, -823.016522557929, -827.3904441561344, -826.0451872668887, -828.4286518172515, -821.3366402109809, -817.395637944372, -810.7594162362876, -825.6064429142102, -820.5391522970278, -837.0211633725934, -816.58153669966, -830.1653670831278, -822.865724680009, -814.2723859149199, -818.1225869893113, -837.7725328104061], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3453460157278001, "mean_inference_ms": 1.480139610244687, "mean_action_processing_ms": 0.16799114516728064, "mean_env_wait_ms": 1.547562979654335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"learn_time_ms": 22415.563, "learn_throughput": 0.089, "update_time_ms": 36.339}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5528393387794495, "grad_norm": 7.5843186378479, "td_error_abs": 0.4639999186197917, "q_taken_mean": 0.3354898478190104, "target_mean": 0.6179071858723958}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 30, "num_agent_steps_trained": 576000, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 15, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-13-29", "timestamp": 1708856009, "time_this_iter_s": 96.82172751426697, "time_total_s": 1401.9392569065094, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1401.9392569065094, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.75729166666667, "ram_util_percent": 33.096875000000004, "gpu_util_percent0": 0.012083333333333335, "vram_util_percent0": 0.026774088541666668}}
{"episode_reward_max": -808.174075169022, "episode_reward_min": -847.6840097894274, "episode_reward_mean": -825.6354783258055, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-822.8617802795621, -822.8223190237636, -834.2002939778039, -824.3278520707605, -815.9330794824448, -819.4966649701287, -823.2165695846548, -816.0780871281668, -847.6840097894274, -818.3703410825447, -828.7641235502532, -832.9855855490056, -816.5589077184902, -827.5820996021322, -831.0783146251184, -830.3852841221632, -808.174075169022, -833.4988654305408, -822.5480938026619, -839.4951671976405, -809.8159560333434, -818.9625081310411, -817.3274295899505, -834.0445988856575, -818.9051508788649, -825.9117419841639, -820.8092007057501, -843.0444847397392, -816.4701985992239, -820.2551056698796, -821.6807356404329, -825.093017076624, -824.5087763578251, -824.4164962899291, -830.5460045044605, -822.3874241075296, -839.9616640229822, -813.8312709500568, -825.6683467030861, -834.4515840362892, -821.1551205126242, -823.4377322209716, -820.3042529444414, -824.1093148872177, -822.2971274364969, -833.3422525802748, -821.5074056900088, -826.5219836132155, -846.4697437351456, -827.8522318452057, -822.3427763454291, -836.0891984621478, -825.8537306931231, -832.5352557508265, -832.7663806261887, -814.8643121175913, -838.4710060411229, -816.200730903515, -832.8211240547067, -829.771215070349, -809.0617659073438, -833.9856655552039, -829.5917295016112, -820.5072677472111, -823.016522557929, -827.3904441561344, -826.0451872668887, -828.4286518172515, -821.3366402109809, -817.395637944372, -810.7594162362876, -825.6064429142102, -820.5391522970278, -837.0211633725934, -816.58153669966, -830.1653670831278, -822.865724680009, -814.2723859149199, -818.1225869893113, -837.7725328104061, -826.2874167969669, -823.3504995058182, -825.0922317015742, -838.275989793243, -826.86689192396, -825.6341090490406, -815.0076102001948, -825.7773639808288, -816.4736366514657, -830.7410950474882, -837.3169613593125, -830.90435932903, -831.4178395881812, -833.7072725224808, -831.8648379966357, -820.414404487817, -814.6668165975033, -820.4187377050794, -839.3281682283805, -826.6696638593403], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3459483105664038, "mean_inference_ms": 1.4860904215617075, "mean_action_processing_ms": 0.16820201952533773, "mean_env_wait_ms": 1.5524204260491516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"learn_time_ms": 22456.813, "learn_throughput": 0.089, "update_time_ms": 36.406}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4687100052833557, "grad_norm": 2.418544292449951, "td_error_abs": 0.39451041666666664, "q_taken_mean": 0.9323485514322917, "target_mean": 1.0390565592447916}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 307200, "num_steps_trained": 32, "num_agent_steps_trained": 614400, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 320, "training_iteration": 16, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-15-06", "timestamp": 1708856106, "time_this_iter_s": 96.80841708183289, "time_total_s": 1498.7476739883423, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1498.7476739883423, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 33.768085106382976, "ram_util_percent": 33.9468085106383, "gpu_util_percent0": 0.012127659574468087, "vram_util_percent0": 0.026774088541666654}}
{"episode_reward_max": -804.8782310970131, "episode_reward_min": -846.4697437351456, "episode_reward_mean": -825.7337873794323, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.8159560333434, -818.9625081310411, -817.3274295899505, -834.0445988856575, -818.9051508788649, -825.9117419841639, -820.8092007057501, -843.0444847397392, -816.4701985992239, -820.2551056698796, -821.6807356404329, -825.093017076624, -824.5087763578251, -824.4164962899291, -830.5460045044605, -822.3874241075296, -839.9616640229822, -813.8312709500568, -825.6683467030861, -834.4515840362892, -821.1551205126242, -823.4377322209716, -820.3042529444414, -824.1093148872177, -822.2971274364969, -833.3422525802748, -821.5074056900088, -826.5219836132155, -846.4697437351456, -827.8522318452057, -822.3427763454291, -836.0891984621478, -825.8537306931231, -832.5352557508265, -832.7663806261887, -814.8643121175913, -838.4710060411229, -816.200730903515, -832.8211240547067, -829.771215070349, -809.0617659073438, -833.9856655552039, -829.5917295016112, -820.5072677472111, -823.016522557929, -827.3904441561344, -826.0451872668887, -828.4286518172515, -821.3366402109809, -817.395637944372, -810.7594162362876, -825.6064429142102, -820.5391522970278, -837.0211633725934, -816.58153669966, -830.1653670831278, -822.865724680009, -814.2723859149199, -818.1225869893113, -837.7725328104061, -826.2874167969669, -823.3504995058182, -825.0922317015742, -838.275989793243, -826.86689192396, -825.6341090490406, -815.0076102001948, -825.7773639808288, -816.4736366514657, -830.7410950474882, -837.3169613593125, -830.90435932903, -831.4178395881812, -833.7072725224808, -831.8648379966357, -820.414404487817, -814.6668165975033, -820.4187377050794, -839.3281682283805, -826.6696638593403, -828.7004679131453, -832.6768246161251, -840.995684436306, -829.8205330966479, -817.4189512932279, -817.6660010218227, -822.6195631771851, -830.8748211471728, -830.225330656675, -818.3118539466371, -804.8782310970131, -819.5676089323318, -819.7494554530089, -826.3122398946851, -829.928800228353, -829.6212769233014, -838.6078185024237, -823.6353529740245, -834.3332685412354, -829.9483356676667], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34682797901221063, "mean_inference_ms": 1.4916010466898968, "mean_action_processing_ms": 0.1683971762010947, "mean_env_wait_ms": 1.5567442916234353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 326400, "timesteps_this_iter": 0, "agent_timesteps_total": 326400, "timers": {"learn_time_ms": 22564.479, "learn_throughput": 0.089, "update_time_ms": 36.977}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.47855111956596375, "grad_norm": 3.8513591289520264, "td_error_abs": 0.40258402506510416, "q_taken_mean": 1.1417058919270833, "target_mean": 1.0387540690104167}}}, "num_steps_sampled": 326400, "num_agent_steps_sampled": 326400, "num_steps_trained": 34, "num_agent_steps_trained": 652800, "last_target_update_ts": 288000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 340, "training_iteration": 17, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-16-44", "timestamp": 1708856204, "time_this_iter_s": 98.37194061279297, "time_total_s": 1597.1196146011353, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1597.1196146011353, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.07578947368421, "ram_util_percent": 35.15894736842107, "gpu_util_percent0": 0.01136842105263158, "vram_util_percent0": 0.026774088541666654}}
{"episode_reward_max": -804.8782310970131, "episode_reward_min": -846.4697437351456, "episode_reward_mean": -826.0401309425761, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-821.1551205126242, -823.4377322209716, -820.3042529444414, -824.1093148872177, -822.2971274364969, -833.3422525802748, -821.5074056900088, -826.5219836132155, -846.4697437351456, -827.8522318452057, -822.3427763454291, -836.0891984621478, -825.8537306931231, -832.5352557508265, -832.7663806261887, -814.8643121175913, -838.4710060411229, -816.200730903515, -832.8211240547067, -829.771215070349, -809.0617659073438, -833.9856655552039, -829.5917295016112, -820.5072677472111, -823.016522557929, -827.3904441561344, -826.0451872668887, -828.4286518172515, -821.3366402109809, -817.395637944372, -810.7594162362876, -825.6064429142102, -820.5391522970278, -837.0211633725934, -816.58153669966, -830.1653670831278, -822.865724680009, -814.2723859149199, -818.1225869893113, -837.7725328104061, -826.2874167969669, -823.3504995058182, -825.0922317015742, -838.275989793243, -826.86689192396, -825.6341090490406, -815.0076102001948, -825.7773639808288, -816.4736366514657, -830.7410950474882, -837.3169613593125, -830.90435932903, -831.4178395881812, -833.7072725224808, -831.8648379966357, -820.414404487817, -814.6668165975033, -820.4187377050794, -839.3281682283805, -826.6696638593403, -828.7004679131453, -832.6768246161251, -840.995684436306, -829.8205330966479, -817.4189512932279, -817.6660010218227, -822.6195631771851, -830.8748211471728, -830.225330656675, -818.3118539466371, -804.8782310970131, -819.5676089323318, -819.7494554530089, -826.3122398946851, -829.928800228353, -829.6212769233014, -838.6078185024237, -823.6353529740245, -834.3332685412354, -829.9483356676667, -825.0431844299765, -817.3350288972381, -817.5189258503359, -839.0165809406234, -828.9756741377448, -823.9547053029576, -844.9646489392862, -830.6234731073556, -835.1787966650853, -820.7263246099252, -825.4495583243703, -822.9666600017697, -818.7725984754001, -821.0334803640744, -823.2233032883715, -823.5991424060271, -816.9388554674209, -832.4481649964656, -823.2694983469812, -827.6874466697815], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3475289002989173, "mean_inference_ms": 1.497268667638439, "mean_action_processing_ms": 0.1685792137061541, "mean_env_wait_ms": 1.5604454042450682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 345600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"learn_time_ms": 22650.368, "learn_throughput": 0.088, "update_time_ms": 49.141}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5212328433990479, "grad_norm": 6.633423805236816, "td_error_abs": 0.44420487467447917, "q_taken_mean": 0.7797984212239584, "target_mean": 1.03863916015625}}}, "num_steps_sampled": 345600, "num_agent_steps_sampled": 345600, "num_steps_trained": 36, "num_agent_steps_trained": 691200, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 360, "training_iteration": 18, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-18-22", "timestamp": 1708856302, "time_this_iter_s": 97.3497064113617, "time_total_s": 1694.469321012497, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1694.469321012497, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.91595744680851, "ram_util_percent": 36.376595744680856, "gpu_util_percent0": 0.010957446808510638, "vram_util_percent0": 0.026774088541666654}}
{"episode_reward_max": -804.8782310970131, "episode_reward_min": -850.7670194093614, "episode_reward_mean": -826.693727566984, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.0617659073438, -833.9856655552039, -829.5917295016112, -820.5072677472111, -823.016522557929, -827.3904441561344, -826.0451872668887, -828.4286518172515, -821.3366402109809, -817.395637944372, -810.7594162362876, -825.6064429142102, -820.5391522970278, -837.0211633725934, -816.58153669966, -830.1653670831278, -822.865724680009, -814.2723859149199, -818.1225869893113, -837.7725328104061, -826.2874167969669, -823.3504995058182, -825.0922317015742, -838.275989793243, -826.86689192396, -825.6341090490406, -815.0076102001948, -825.7773639808288, -816.4736366514657, -830.7410950474882, -837.3169613593125, -830.90435932903, -831.4178395881812, -833.7072725224808, -831.8648379966357, -820.414404487817, -814.6668165975033, -820.4187377050794, -839.3281682283805, -826.6696638593403, -828.7004679131453, -832.6768246161251, -840.995684436306, -829.8205330966479, -817.4189512932279, -817.6660010218227, -822.6195631771851, -830.8748211471728, -830.225330656675, -818.3118539466371, -804.8782310970131, -819.5676089323318, -819.7494554530089, -826.3122398946851, -829.928800228353, -829.6212769233014, -838.6078185024237, -823.6353529740245, -834.3332685412354, -829.9483356676667, -825.0431844299765, -817.3350288972381, -817.5189258503359, -839.0165809406234, -828.9756741377448, -823.9547053029576, -844.9646489392862, -830.6234731073556, -835.1787966650853, -820.7263246099252, -825.4495583243703, -822.9666600017697, -818.7725984754001, -821.0334803640744, -823.2233032883715, -823.5991424060271, -816.9388554674209, -832.4481649964656, -823.2694983469812, -827.6874466697815, -844.3500952723628, -819.2519391587756, -825.6879216464484, -835.6327355460934, -828.6529905076774, -835.1430460673162, -843.9053552025365, -823.7004794782973, -831.6819540114356, -829.7765250051684, -827.0457427454255, -825.1349765682343, -818.893048942903, -838.3974837012547, -814.0035649706367, -829.866066827045, -826.0518397181183, -830.7650450091653, -850.7670194093614, -835.3647281831326], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34835997426746473, "mean_inference_ms": 1.5022235467241445, "mean_action_processing_ms": 0.16876325571719797, "mean_env_wait_ms": 1.5643993130263405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 364800, "timesteps_this_iter": 0, "agent_timesteps_total": 364800, "timers": {"learn_time_ms": 22706.172, "learn_throughput": 0.088, "update_time_ms": 49.566}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.4848484694957733, "grad_norm": 2.4779558181762695, "td_error_abs": 0.39488387044270834, "q_taken_mean": 1.3251797688802083, "target_mean": 1.4447571614583334}}}, "num_steps_sampled": 364800, "num_agent_steps_sampled": 364800, "num_steps_trained": 38, "num_agent_steps_trained": 729600, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 380, "training_iteration": 19, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-20-00", "timestamp": 1708856400, "time_this_iter_s": 97.82989931106567, "time_total_s": 1792.2992203235626, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1792.2992203235626, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.9483870967742, "ram_util_percent": 35.76666666666665, "gpu_util_percent0": 0.010215053763440859, "vram_util_percent0": 0.026774088541666657}}
{"episode_reward_max": -804.8782310970131, "episode_reward_min": -850.7670194093614, "episode_reward_mean": -827.8096414983539, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.2874167969669, -823.3504995058182, -825.0922317015742, -838.275989793243, -826.86689192396, -825.6341090490406, -815.0076102001948, -825.7773639808288, -816.4736366514657, -830.7410950474882, -837.3169613593125, -830.90435932903, -831.4178395881812, -833.7072725224808, -831.8648379966357, -820.414404487817, -814.6668165975033, -820.4187377050794, -839.3281682283805, -826.6696638593403, -828.7004679131453, -832.6768246161251, -840.995684436306, -829.8205330966479, -817.4189512932279, -817.6660010218227, -822.6195631771851, -830.8748211471728, -830.225330656675, -818.3118539466371, -804.8782310970131, -819.5676089323318, -819.7494554530089, -826.3122398946851, -829.928800228353, -829.6212769233014, -838.6078185024237, -823.6353529740245, -834.3332685412354, -829.9483356676667, -825.0431844299765, -817.3350288972381, -817.5189258503359, -839.0165809406234, -828.9756741377448, -823.9547053029576, -844.9646489392862, -830.6234731073556, -835.1787966650853, -820.7263246099252, -825.4495583243703, -822.9666600017697, -818.7725984754001, -821.0334803640744, -823.2233032883715, -823.5991424060271, -816.9388554674209, -832.4481649964656, -823.2694983469812, -827.6874466697815, -844.3500952723628, -819.2519391587756, -825.6879216464484, -835.6327355460934, -828.6529905076774, -835.1430460673162, -843.9053552025365, -823.7004794782973, -831.6819540114356, -829.7765250051684, -827.0457427454255, -825.1349765682343, -818.893048942903, -838.3974837012547, -814.0035649706367, -829.866066827045, -826.0518397181183, -830.7650450091653, -850.7670194093614, -835.3647281831326, -847.2423026111265, -817.4363121754421, -837.4403304435511, -828.3706092429937, -839.5088493270171, -817.7869893927613, -829.4256825523111, -825.1570221956628, -829.5253684834873, -830.0229140473342, -827.3065907124483, -831.8172872264681, -839.1828964060193, -827.8256652505353, -828.2226383980095, -818.6981907927506, -819.6548496426009, -830.2179387720561, -821.0110539226607, -836.203723204259], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34919503274283803, "mean_inference_ms": 1.5071483790854234, "mean_action_processing_ms": 0.16895865237221344, "mean_env_wait_ms": 1.5684090935630284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"learn_time_ms": 22780.332, "learn_throughput": 0.088, "update_time_ms": 49.74}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.479877769947052, "grad_norm": 3.862600803375244, "td_error_abs": 0.400398681640625, "q_taken_mean": 1.5340642903645834, "target_mean": 1.4446520182291667}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 40, "num_agent_steps_trained": 768000, "last_target_update_ts": 345600, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 400, "training_iteration": 20, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-21-39", "timestamp": 1708856499, "time_this_iter_s": 99.11346316337585, "time_total_s": 1891.4126834869385, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1891.4126834869385, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.27157894736841, "ram_util_percent": 37.74947368421054, "gpu_util_percent0": 0.012210526315789475, "vram_util_percent0": 0.026774088541666654}}
{"episode_reward_max": -804.8782310970131, "episode_reward_min": -850.7670194093614, "episode_reward_mean": -827.8650436001845, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.7004679131453, -832.6768246161251, -840.995684436306, -829.8205330966479, -817.4189512932279, -817.6660010218227, -822.6195631771851, -830.8748211471728, -830.225330656675, -818.3118539466371, -804.8782310970131, -819.5676089323318, -819.7494554530089, -826.3122398946851, -829.928800228353, -829.6212769233014, -838.6078185024237, -823.6353529740245, -834.3332685412354, -829.9483356676667, -825.0431844299765, -817.3350288972381, -817.5189258503359, -839.0165809406234, -828.9756741377448, -823.9547053029576, -844.9646489392862, -830.6234731073556, -835.1787966650853, -820.7263246099252, -825.4495583243703, -822.9666600017697, -818.7725984754001, -821.0334803640744, -823.2233032883715, -823.5991424060271, -816.9388554674209, -832.4481649964656, -823.2694983469812, -827.6874466697815, -844.3500952723628, -819.2519391587756, -825.6879216464484, -835.6327355460934, -828.6529905076774, -835.1430460673162, -843.9053552025365, -823.7004794782973, -831.6819540114356, -829.7765250051684, -827.0457427454255, -825.1349765682343, -818.893048942903, -838.3974837012547, -814.0035649706367, -829.866066827045, -826.0518397181183, -830.7650450091653, -850.7670194093614, -835.3647281831326, -847.2423026111265, -817.4363121754421, -837.4403304435511, -828.3706092429937, -839.5088493270171, -817.7869893927613, -829.4256825523111, -825.1570221956628, -829.5253684834873, -830.0229140473342, -827.3065907124483, -831.8172872264681, -839.1828964060193, -827.8256652505353, -828.2226383980095, -818.6981907927506, -819.6548496426009, -830.2179387720561, -821.0110539226607, -836.203723204259, -818.5528246000058, -841.3836688201018, -831.0008172462368, -824.6209935061166, -837.6807643492224, -844.4195894955565, -816.0567832905601, -821.680597593162, -832.602621959327, -827.5229184573247, -818.6719147345818, -835.2568322208369, -817.2271788325029, -836.9506817852867, -822.5547681206773, -836.5272151833534, -825.2460792553265, -821.3308348126883, -814.3950663885145, -822.0739658560097], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3500741648477528, "mean_inference_ms": 1.5119347900310427, "mean_action_processing_ms": 0.16913921781517818, "mean_env_wait_ms": 1.572065998928658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 403200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"learn_time_ms": 22763.696, "learn_throughput": 0.088, "update_time_ms": 50.126}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5612680912017822, "grad_norm": 8.364423751831055, "td_error_abs": 0.47498282877604164, "q_taken_mean": 1.1189014485677082, "target_mean": 1.44468359375}}}, "num_steps_sampled": 403200, "num_agent_steps_sampled": 403200, "num_steps_trained": 42, "num_agent_steps_trained": 806400, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 420, "training_iteration": 21, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-23-17", "timestamp": 1708856597, "time_this_iter_s": 97.7140245437622, "time_total_s": 1989.1267080307007, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1989.1267080307007, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 33.990425531914894, "ram_util_percent": 37.34893617021276, "gpu_util_percent0": 0.01053191489361702, "vram_util_percent0": 0.026774088541666654}}
{"episode_reward_max": -814.0035649706367, "episode_reward_min": -850.7670194093614, "episode_reward_mean": -827.8215046436197, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-825.0431844299765, -817.3350288972381, -817.5189258503359, -839.0165809406234, -828.9756741377448, -823.9547053029576, -844.9646489392862, -830.6234731073556, -835.1787966650853, -820.7263246099252, -825.4495583243703, -822.9666600017697, -818.7725984754001, -821.0334803640744, -823.2233032883715, -823.5991424060271, -816.9388554674209, -832.4481649964656, -823.2694983469812, -827.6874466697815, -844.3500952723628, -819.2519391587756, -825.6879216464484, -835.6327355460934, -828.6529905076774, -835.1430460673162, -843.9053552025365, -823.7004794782973, -831.6819540114356, -829.7765250051684, -827.0457427454255, -825.1349765682343, -818.893048942903, -838.3974837012547, -814.0035649706367, -829.866066827045, -826.0518397181183, -830.7650450091653, -850.7670194093614, -835.3647281831326, -847.2423026111265, -817.4363121754421, -837.4403304435511, -828.3706092429937, -839.5088493270171, -817.7869893927613, -829.4256825523111, -825.1570221956628, -829.5253684834873, -830.0229140473342, -827.3065907124483, -831.8172872264681, -839.1828964060193, -827.8256652505353, -828.2226383980095, -818.6981907927506, -819.6548496426009, -830.2179387720561, -821.0110539226607, -836.203723204259, -818.5528246000058, -841.3836688201018, -831.0008172462368, -824.6209935061166, -837.6807643492224, -844.4195894955565, -816.0567832905601, -821.680597593162, -832.602621959327, -827.5229184573247, -818.6719147345818, -835.2568322208369, -817.2271788325029, -836.9506817852867, -822.5547681206773, -836.5272151833534, -825.2460792553265, -821.3308348126883, -814.3950663885145, -822.0739658560097, -814.2524604256538, -827.4407073857581, -837.039193735855, -826.4930931244378, -818.1698704704058, -816.6125324556966, -831.1258975378087, -839.4651472586237, -828.9612855257349, -828.7183515923847, -828.3383746181586, -816.257579224122, -829.5658932947291, -834.2446079330753, -831.9640248507823, -821.4491479540842, -816.9528591688512, -822.5561793493839, -830.8642298334677, -821.0670881234782], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35067993243931744, "mean_inference_ms": 1.5162328557499418, "mean_action_processing_ms": 0.1693146340321343, "mean_env_wait_ms": 1.5759520146797588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 422400, "timesteps_this_iter": 0, "agent_timesteps_total": 422400, "timers": {"learn_time_ms": 22792.054, "learn_throughput": 0.088, "update_time_ms": 50.177}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5266463160514832, "grad_norm": 2.5061874389648438, "td_error_abs": 0.40359513346354164, "q_taken_mean": 1.8782080078125, "target_mean": 2.0073963216145834}}}, "num_steps_sampled": 422400, "num_agent_steps_sampled": 422400, "num_steps_trained": 44, "num_agent_steps_trained": 844800, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 440, "training_iteration": 22, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-24-55", "timestamp": 1708856695, "time_this_iter_s": 98.08921360969543, "time_total_s": 2087.215921640396, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 2087.215921640396, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 34.01290322580646, "ram_util_percent": 38.05913978494624, "gpu_util_percent0": 0.011935483870967743, "vram_util_percent0": 0.026774088541666657}}
{"episode_reward_max": -806.1960615263295, "episode_reward_min": -850.7670194093614, "episode_reward_mean": -827.5935252997473, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-844.3500952723628, -819.2519391587756, -825.6879216464484, -835.6327355460934, -828.6529905076774, -835.1430460673162, -843.9053552025365, -823.7004794782973, -831.6819540114356, -829.7765250051684, -827.0457427454255, -825.1349765682343, -818.893048942903, -838.3974837012547, -814.0035649706367, -829.866066827045, -826.0518397181183, -830.7650450091653, -850.7670194093614, -835.3647281831326, -847.2423026111265, -817.4363121754421, -837.4403304435511, -828.3706092429937, -839.5088493270171, -817.7869893927613, -829.4256825523111, -825.1570221956628, -829.5253684834873, -830.0229140473342, -827.3065907124483, -831.8172872264681, -839.1828964060193, -827.8256652505353, -828.2226383980095, -818.6981907927506, -819.6548496426009, -830.2179387720561, -821.0110539226607, -836.203723204259, -818.5528246000058, -841.3836688201018, -831.0008172462368, -824.6209935061166, -837.6807643492224, -844.4195894955565, -816.0567832905601, -821.680597593162, -832.602621959327, -827.5229184573247, -818.6719147345818, -835.2568322208369, -817.2271788325029, -836.9506817852867, -822.5547681206773, -836.5272151833534, -825.2460792553265, -821.3308348126883, -814.3950663885145, -822.0739658560097, -814.2524604256538, -827.4407073857581, -837.039193735855, -826.4930931244378, -818.1698704704058, -816.6125324556966, -831.1258975378087, -839.4651472586237, -828.9612855257349, -828.7183515923847, -828.3383746181586, -816.257579224122, -829.5658932947291, -834.2446079330753, -831.9640248507823, -821.4491479540842, -816.9528591688512, -822.5561793493839, -830.8642298334677, -821.0670881234782, -827.656405255089, -828.7789431381083, -822.804501963053, -808.8033055154698, -830.8033571459204, -826.3813280068334, -812.4448369809732, -825.9515811919193, -811.7541489735687, -806.1960615263295, -826.2910828560632, -838.675111312031, -833.0631742558878, -833.8272072935074, -826.8404223517728, -828.4478776042786, -821.706729656286, -836.4708325146474, -829.2180000686346, -819.8132092235787], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.351389251350949, "mean_inference_ms": 1.5201540287857822, "mean_action_processing_ms": 0.1695109059491109, "mean_env_wait_ms": 1.580149136006841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 441600, "timesteps_this_iter": 0, "agent_timesteps_total": 441600, "timers": {"learn_time_ms": 22774.5, "learn_throughput": 0.088, "update_time_ms": 50.007}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5267410278320312, "grad_norm": 4.668181419372559, "td_error_abs": 0.41324088541666665, "q_taken_mean": 2.0989246419270833, "target_mean": 2.00730419921875}}}, "num_steps_sampled": 441600, "num_agent_steps_sampled": 441600, "num_steps_trained": 46, "num_agent_steps_trained": 883200, "last_target_update_ts": 403200, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 460, "training_iteration": 23, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-26-33", "timestamp": 1708856793, "time_this_iter_s": 98.62000727653503, "time_total_s": 2185.835928916931, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 2185.835928916931, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 34.25212765957447, "ram_util_percent": 38.628723404255325, "gpu_util_percent0": 0.011914893617021277, "vram_util_percent0": 0.026730801196808505}}
{"episode_reward_max": -806.1960615263295, "episode_reward_min": -847.2423026111265, "episode_reward_mean": -826.8152997423826, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-847.2423026111265, -817.4363121754421, -837.4403304435511, -828.3706092429937, -839.5088493270171, -817.7869893927613, -829.4256825523111, -825.1570221956628, -829.5253684834873, -830.0229140473342, -827.3065907124483, -831.8172872264681, -839.1828964060193, -827.8256652505353, -828.2226383980095, -818.6981907927506, -819.6548496426009, -830.2179387720561, -821.0110539226607, -836.203723204259, -818.5528246000058, -841.3836688201018, -831.0008172462368, -824.6209935061166, -837.6807643492224, -844.4195894955565, -816.0567832905601, -821.680597593162, -832.602621959327, -827.5229184573247, -818.6719147345818, -835.2568322208369, -817.2271788325029, -836.9506817852867, -822.5547681206773, -836.5272151833534, -825.2460792553265, -821.3308348126883, -814.3950663885145, -822.0739658560097, -814.2524604256538, -827.4407073857581, -837.039193735855, -826.4930931244378, -818.1698704704058, -816.6125324556966, -831.1258975378087, -839.4651472586237, -828.9612855257349, -828.7183515923847, -828.3383746181586, -816.257579224122, -829.5658932947291, -834.2446079330753, -831.9640248507823, -821.4491479540842, -816.9528591688512, -822.5561793493839, -830.8642298334677, -821.0670881234782, -827.656405255089, -828.7789431381083, -822.804501963053, -808.8033055154698, -830.8033571459204, -826.3813280068334, -812.4448369809732, -825.9515811919193, -811.7541489735687, -806.1960615263295, -826.2910828560632, -838.675111312031, -833.0631742558878, -833.8272072935074, -826.8404223517728, -828.4478776042786, -821.706729656286, -836.4708325146474, -829.2180000686346, -819.8132092235787, -827.902912910362, -822.2543669567591, -833.0752236590558, -833.294657008055, -843.6648281329096, -823.6937660180997, -820.3975400923158, -815.0876184198582, -816.9523215884883, -816.9999581501903, -840.1537195981196, -824.9891167511354, -817.9393449764617, -820.2339894681152, -828.4292842204817, -826.1170562489046, -825.9776478714043, -836.8034963883904, -828.597987218956, -833.6851665568868], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3522258332537194, "mean_inference_ms": 1.5238289565342347, "mean_action_processing_ms": 0.1697088121627417, "mean_env_wait_ms": 1.5841434844118467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 460800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"learn_time_ms": 22837.473, "learn_throughput": 0.088, "update_time_ms": 49.948}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6893793940544128, "grad_norm": 12.93565845489502, "td_error_abs": 0.5782469075520833, "q_taken_mean": 1.526486328125, "target_mean": 2.0076424153645833}}}, "num_steps_sampled": 460800, "num_agent_steps_sampled": 460800, "num_steps_trained": 48, "num_agent_steps_trained": 921600, "last_target_update_ts": 460800, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 480, "training_iteration": 24, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-28-13", "timestamp": 1708856893, "time_this_iter_s": 99.19621443748474, "time_total_s": 2285.032143354416, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 2285.032143354416, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 34.260215053763446, "ram_util_percent": 39.174193548387095, "gpu_util_percent0": 0.010537634408602151, "vram_util_percent0": 0.024699330757168448}}
{"episode_reward_max": -806.1960615263295, "episode_reward_min": -853.7395302062134, "episode_reward_mean": -827.3380525672167, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.5528246000058, -841.3836688201018, -831.0008172462368, -824.6209935061166, -837.6807643492224, -844.4195894955565, -816.0567832905601, -821.680597593162, -832.602621959327, -827.5229184573247, -818.6719147345818, -835.2568322208369, -817.2271788325029, -836.9506817852867, -822.5547681206773, -836.5272151833534, -825.2460792553265, -821.3308348126883, -814.3950663885145, -822.0739658560097, -814.2524604256538, -827.4407073857581, -837.039193735855, -826.4930931244378, -818.1698704704058, -816.6125324556966, -831.1258975378087, -839.4651472586237, -828.9612855257349, -828.7183515923847, -828.3383746181586, -816.257579224122, -829.5658932947291, -834.2446079330753, -831.9640248507823, -821.4491479540842, -816.9528591688512, -822.5561793493839, -830.8642298334677, -821.0670881234782, -827.656405255089, -828.7789431381083, -822.804501963053, -808.8033055154698, -830.8033571459204, -826.3813280068334, -812.4448369809732, -825.9515811919193, -811.7541489735687, -806.1960615263295, -826.2910828560632, -838.675111312031, -833.0631742558878, -833.8272072935074, -826.8404223517728, -828.4478776042786, -821.706729656286, -836.4708325146474, -829.2180000686346, -819.8132092235787, -827.902912910362, -822.2543669567591, -833.0752236590558, -833.294657008055, -843.6648281329096, -823.6937660180997, -820.3975400923158, -815.0876184198582, -816.9523215884883, -816.9999581501903, -840.1537195981196, -824.9891167511354, -817.9393449764617, -820.2339894681152, -828.4292842204817, -826.1170562489046, -825.9776478714043, -836.8034963883904, -828.597987218956, -833.6851665568868, -813.0337469931798, -831.902733236421, -841.9973431390121, -845.4509529635069, -826.5645409351787, -820.039451550248, -827.7913967129765, -835.2619068401813, -814.1614030938268, -839.1507423548401, -832.1323550702614, -820.2039920399691, -839.3087658695615, -826.2289891640277, -848.8335127705785, -853.7395302062134, -839.8919219685238, -827.8917122697134, -821.3091513213936, -829.4383487832819], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3527947910712477, "mean_inference_ms": 1.5269546054396972, "mean_action_processing_ms": 0.169889155114482, "mean_env_wait_ms": 1.5883840718347093, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"learn_time_ms": 22912.71, "learn_throughput": 0.087, "update_time_ms": 39.06}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5562472939491272, "grad_norm": 2.651782989501953, "td_error_abs": 0.404959716796875, "q_taken_mean": 2.521701171875, "target_mean": 2.6587179361979167}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 50, "num_agent_steps_trained": 960000, "last_target_update_ts": 460800, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": true, "episodes_total": 500, "training_iteration": 25, "trial_id": "410d0_00000", "experiment_id": "dd66075696614dbcb987ebb9e6759c8b", "date": "2024-02-25_16-29-52", "timestamp": 1708856992, "time_this_iter_s": 99.77046537399292, "time_total_s": 2384.802608728409, "pid": 5832, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 2384.802608728409, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.409677419354836, "ram_util_percent": 40.01720430107527, "gpu_util_percent0": 0.012258064516129034, "vram_util_percent0": 0.024698893229166657}}
