{"episode_reward_max": -3011.3992770296322, "episode_reward_min": -3139.642448527641, "episode_reward_mean": -3084.750052756298, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.258621250209, -3078.492494346633, -3100.814414668701, -3103.2363136411395, -3051.1196965585805, -3062.702697397684, -3090.977696799652, -3011.3992770296322, -3029.6160247716975, -3139.642448527641, -3110.221713855313, -3077.968429801204, -3098.7269339502773, -3055.527021411941, -3037.7827975276314, -3136.500260190031, -3069.0190474233696, -3113.6361057796357, -3132.9822226975107, -3097.3768374974793], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0383756922385445, "mean_inference_ms": 1.4168083357637304, "mean_action_processing_ms": 0.21253563735040984, "mean_env_wait_ms": 1.3423340873837346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 77465.528, "sample_throughput": 4957.044, "load_time_ms": 0.72, "load_throughput": 533668898.608, "learn_time_ms": 23350.676, "learn_throughput": 16444.92, "update_time_ms": 29.966}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 185.90309102911698, "policy_loss": -0.003531784594279567, "vf_loss": 185.92650644402755, "vf_explained_var": -7.949377361096835e-06, "kl": 0.009926248367073162, "entropy": 2.187127709388733, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 20, "training_iteration": 1, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-13-11", "timestamp": 1708848791, "time_this_iter_s": 100.84531617164612, "time_total_s": 100.84531617164612, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84159e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 100.84531617164612, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.613970588235293, "ram_util_percent": 14.428676470588234, "gpu_util_percent0": 0.013897058823529413, "vram_util_percent0": 0.03141395718443627}}
{"episode_reward_max": -2741.2013179741866, "episode_reward_min": -3139.642448527641, "episode_reward_mean": -2956.2104921024975, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.258621250209, -3078.492494346633, -3100.814414668701, -3103.2363136411395, -3051.1196965585805, -3062.702697397684, -3090.977696799652, -3011.3992770296322, -3029.6160247716975, -3139.642448527641, -3110.221713855313, -3077.968429801204, -3098.7269339502773, -3055.527021411941, -3037.7827975276314, -3136.500260190031, -3069.0190474233696, -3113.6361057796357, -3132.9822226975107, -3097.3768374974793, -2810.7472192129126, -2741.2221124883026, -2881.8498762726126, -2849.057428396738, -2820.0946628940524, -2741.2013179741866, -2912.980125317027, -2841.3285465260046, -2836.5266108686324, -2813.0696300627833, -2853.1414486448043, -2872.3403455109355, -2834.501088956771, -2777.0625406661306, -2832.780329054539, -2924.669791928649, -2814.26967983634, -2780.7369362187114, -2765.313604987583, -2850.5253331562276], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0433059559509161, "mean_inference_ms": 1.4253094955343353, "mean_action_processing_ms": 0.2135778026321491, "mean_env_wait_ms": 1.3478025983465858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 89907.286, "sample_throughput": 4271.067, "load_time_ms": 0.515, "load_throughput": 745654044.444, "learn_time_ms": 23546.433, "learn_throughput": 16308.203, "update_time_ms": 30.12}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 93.7256626329924, "policy_loss": -0.004564461289096232, "vf_loss": 93.74984138890316, "vf_explained_var": 9.426945134213096e-07, "kl": 0.009976125423308028, "entropy": 2.1609914240084196, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 768000, "num_steps_trained": 768000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 2, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-14-53", "timestamp": 1708848893, "time_this_iter_s": 102.72562003135681, "time_total_s": 203.57093620300293, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84159d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 203.57093620300293, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.793333333333337, "ram_util_percent": 16.26592592592593, "gpu_util_percent0": 0.010518518518518519, "vram_util_percent0": 0.03141276041666665}}
{"episode_reward_max": -2403.428543364449, "episode_reward_min": -3139.642448527641, "episode_reward_mean": -2802.0637617516995, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.258621250209, -3078.492494346633, -3100.814414668701, -3103.2363136411395, -3051.1196965585805, -3062.702697397684, -3090.977696799652, -3011.3992770296322, -3029.6160247716975, -3139.642448527641, -3110.221713855313, -3077.968429801204, -3098.7269339502773, -3055.527021411941, -3037.7827975276314, -3136.500260190031, -3069.0190474233696, -3113.6361057796357, -3132.9822226975107, -3097.3768374974793, -2810.7472192129126, -2741.2221124883026, -2881.8498762726126, -2849.057428396738, -2820.0946628940524, -2741.2013179741866, -2912.980125317027, -2841.3285465260046, -2836.5266108686324, -2813.0696300627833, -2853.1414486448043, -2872.3403455109355, -2834.501088956771, -2777.0625406661306, -2832.780329054539, -2924.669791928649, -2814.26967983634, -2780.7369362187114, -2765.313604987583, -2850.5253331562276, -2403.428543364449, -2465.584663076917, -2491.108356426258, -2471.0479052033243, -2444.3920102021902, -2525.1781438565235, -2566.970749643351, -2448.1356698270174, -2459.423922783182, -2573.773097586027, -2423.0974433065076, -2494.637160380505, -2527.942107089485, -2469.949022219637, -2461.2296987081895, -2449.8341070714887, -2542.90766971594, -2583.430533115757, -2591.184679110907, -2482.150538314427], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0470488892011076, "mean_inference_ms": 1.4327303440630899, "mean_action_processing_ms": 0.2144219423809934, "mean_env_wait_ms": 1.352421173583256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 1152000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 94504.509, "sample_throughput": 4063.298, "load_time_ms": 0.428, "load_throughput": 896611283.726, "learn_time_ms": 23639.512, "learn_throughput": 16243.99, "update_time_ms": 29.541}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 36.82646189237896, "policy_loss": -0.003496328629185691, "vf_loss": 36.84800348783794, "vf_explained_var": -6.724658765290912e-05, "kl": 0.014753135257993372, "entropy": 2.0995843473233675, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 1152000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 3, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-16-37", "timestamp": 1708848997, "time_this_iter_s": 103.75650382041931, "time_total_s": 307.32744002342224, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca246fb940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 307.32744002342224, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.965671641791047, "ram_util_percent": 17.017910447761196, "gpu_util_percent0": 0.011417910447761196, "vram_util_percent0": 0.031383609297263686}}
{"episode_reward_max": -1989.6791170218487, "episode_reward_min": -3139.642448527641, "episode_reward_mean": -2619.8413400154736, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.258621250209, -3078.492494346633, -3100.814414668701, -3103.2363136411395, -3051.1196965585805, -3062.702697397684, -3090.977696799652, -3011.3992770296322, -3029.6160247716975, -3139.642448527641, -3110.221713855313, -3077.968429801204, -3098.7269339502773, -3055.527021411941, -3037.7827975276314, -3136.500260190031, -3069.0190474233696, -3113.6361057796357, -3132.9822226975107, -3097.3768374974793, -2810.7472192129126, -2741.2221124883026, -2881.8498762726126, -2849.057428396738, -2820.0946628940524, -2741.2013179741866, -2912.980125317027, -2841.3285465260046, -2836.5266108686324, -2813.0696300627833, -2853.1414486448043, -2872.3403455109355, -2834.501088956771, -2777.0625406661306, -2832.780329054539, -2924.669791928649, -2814.26967983634, -2780.7369362187114, -2765.313604987583, -2850.5253331562276, -2403.428543364449, -2465.584663076917, -2491.108356426258, -2471.0479052033243, -2444.3920102021902, -2525.1781438565235, -2566.970749643351, -2448.1356698270174, -2459.423922783182, -2573.773097586027, -2423.0974433065076, -2494.637160380505, -2527.942107089485, -2469.949022219637, -2461.2296987081895, -2449.8341070714887, -2542.90766971594, -2583.430533115757, -2591.184679110907, -2482.150538314427, -2065.593223330709, -2144.0668875306455, -2067.822647180774, -2061.6557155643486, -2057.4829648131263, -2128.693710506765, -2100.7401850570436, -2033.0021484327822, -1989.6791170218487, -2043.0657088298717, -2046.3398547412587, -2005.6115946727498, -2048.9878872269683, -2086.815135723323, -2065.7186413166974, -2069.3085697825973, -2137.0637445208067, -2046.5048040706108, -2156.856510393512, -2108.472445419458], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.050569368986797, "mean_inference_ms": 1.439040682829927, "mean_action_processing_ms": 0.21502591598925314, "mean_env_wait_ms": 1.3565887458386492, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 1536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 97034.999, "sample_throughput": 3957.335, "load_time_ms": 0.412, "load_throughput": 932742282.322, "learn_time_ms": 23702.863, "learn_throughput": 16200.575, "update_time_ms": 29.762}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 9.639110740862394, "policy_loss": -0.0056474229970358706, "vf_loss": 9.661997606879787, "vf_explained_var": -0.0001264057661357679, "kl": 0.014023351813911608, "entropy": 2.0044058686808537, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1536000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 1536000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 4, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-18-22", "timestamp": 1708849102, "time_this_iter_s": 104.66368675231934, "time_total_s": 411.9911267757416, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd842899d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 411.9911267757416, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.23507462686567, "ram_util_percent": 17.62686567164179, "gpu_util_percent0": 0.009850746268656717, "vram_util_percent0": 0.03133138020833334}}
{"episode_reward_max": -1641.536254534541, "episode_reward_min": -3139.642448527641, "episode_reward_mean": -2434.6406199997527, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3097.258621250209, -3078.492494346633, -3100.814414668701, -3103.2363136411395, -3051.1196965585805, -3062.702697397684, -3090.977696799652, -3011.3992770296322, -3029.6160247716975, -3139.642448527641, -3110.221713855313, -3077.968429801204, -3098.7269339502773, -3055.527021411941, -3037.7827975276314, -3136.500260190031, -3069.0190474233696, -3113.6361057796357, -3132.9822226975107, -3097.3768374974793, -2810.7472192129126, -2741.2221124883026, -2881.8498762726126, -2849.057428396738, -2820.0946628940524, -2741.2013179741866, -2912.980125317027, -2841.3285465260046, -2836.5266108686324, -2813.0696300627833, -2853.1414486448043, -2872.3403455109355, -2834.501088956771, -2777.0625406661306, -2832.780329054539, -2924.669791928649, -2814.26967983634, -2780.7369362187114, -2765.313604987583, -2850.5253331562276, -2403.428543364449, -2465.584663076917, -2491.108356426258, -2471.0479052033243, -2444.3920102021902, -2525.1781438565235, -2566.970749643351, -2448.1356698270174, -2459.423922783182, -2573.773097586027, -2423.0974433065076, -2494.637160380505, -2527.942107089485, -2469.949022219637, -2461.2296987081895, -2449.8341070714887, -2542.90766971594, -2583.430533115757, -2591.184679110907, -2482.150538314427, -2065.593223330709, -2144.0668875306455, -2067.822647180774, -2061.6557155643486, -2057.4829648131263, -2128.693710506765, -2100.7401850570436, -2033.0021484327822, -1989.6791170218487, -2043.0657088298717, -2046.3398547412587, -2005.6115946727498, -2048.9878872269683, -2086.815135723323, -2065.7186413166974, -2069.3085697825973, -2137.0637445208067, -2046.5048040706108, -2156.856510393512, -2108.472445419458, -1661.2987737822534, -1724.2997396692556, -1692.5019860492464, -1665.4160522451584, -1704.8939747588277, -1718.4005051764461, -1680.8180973035096, -1641.536254534541, -1645.7998778502733, -1753.4225898807229, -1689.4806821238205, -1693.1582446803886, -1674.7337420225144, -1692.1862553222886, -1762.9904225785679, -1677.5426015147896, -1691.1331961247186, -1744.9713173465514, -1645.5314041940605, -1716.639081579455], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.053724350184431, "mean_inference_ms": 1.4453668860118805, "mean_action_processing_ms": 0.21555143135986937, "mean_env_wait_ms": 1.36003113280147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 1920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 98724.734, "sample_throughput": 3889.603, "load_time_ms": 0.433, "load_throughput": 886023069.645, "learn_time_ms": 23768.312, "learn_throughput": 16155.965, "update_time_ms": 29.414}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 4.105175419857628, "policy_loss": -0.005891554496453242, "vf_loss": 4.127143295187699, "vf_explained_var": -0.00020499605881540398, "kl": 0.013444723178843944, "entropy": 1.8765290944199813, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1920000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 1920000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 5, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-20-07", "timestamp": 1708849207, "time_this_iter_s": 105.58862090110779, "time_total_s": 517.5797476768494, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84159d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 517.5797476768494, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.301492537313436, "ram_util_percent": 18.241044776119402, "gpu_util_percent0": 0.009477611940298508, "vram_util_percent0": 0.03133138020833334}}
{"episode_reward_max": -1255.801806648742, "episode_reward_min": -2924.669791928649, "episode_reward_mean": -2087.961310440627, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2810.7472192129126, -2741.2221124883026, -2881.8498762726126, -2849.057428396738, -2820.0946628940524, -2741.2013179741866, -2912.980125317027, -2841.3285465260046, -2836.5266108686324, -2813.0696300627833, -2853.1414486448043, -2872.3403455109355, -2834.501088956771, -2777.0625406661306, -2832.780329054539, -2924.669791928649, -2814.26967983634, -2780.7369362187114, -2765.313604987583, -2850.5253331562276, -2403.428543364449, -2465.584663076917, -2491.108356426258, -2471.0479052033243, -2444.3920102021902, -2525.1781438565235, -2566.970749643351, -2448.1356698270174, -2459.423922783182, -2573.773097586027, -2423.0974433065076, -2494.637160380505, -2527.942107089485, -2469.949022219637, -2461.2296987081895, -2449.8341070714887, -2542.90766971594, -2583.430533115757, -2591.184679110907, -2482.150538314427, -2065.593223330709, -2144.0668875306455, -2067.822647180774, -2061.6557155643486, -2057.4829648131263, -2128.693710506765, -2100.7401850570436, -2033.0021484327822, -1989.6791170218487, -2043.0657088298717, -2046.3398547412587, -2005.6115946727498, -2048.9878872269683, -2086.815135723323, -2065.7186413166974, -2069.3085697825973, -2137.0637445208067, -2046.5048040706108, -2156.856510393512, -2108.472445419458, -1661.2987737822534, -1724.2997396692556, -1692.5019860492464, -1665.4160522451584, -1704.8939747588277, -1718.4005051764461, -1680.8180973035096, -1641.536254534541, -1645.7998778502733, -1753.4225898807229, -1689.4806821238205, -1693.1582446803886, -1674.7337420225144, -1692.1862553222886, -1762.9904225785679, -1677.5426015147896, -1691.1331961247186, -1744.9713173465514, -1645.5314041940605, -1716.639081579455, -1341.204395769235, -1340.9946543622532, -1301.665958833755, -1408.0135717632713, -1357.6313920552823, -1346.3606718132673, -1308.198313695549, -1494.0004876878365, -1255.801806648742, -1294.5729617747807, -1368.5000624791357, -1396.737050635028, -1372.1940580902422, -1384.0081487865655, -1327.888168902636, -1349.6762970888992, -1284.8617199027892, -1350.5035285626616, -1383.0634202376523, -1361.193430123833], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0601999499851977, "mean_inference_ms": 1.4585193967360797, "mean_action_processing_ms": 0.21667523742790545, "mean_env_wait_ms": 1.367242211247286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 2304000, "timesteps_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"sample_time_ms": 99977.575, "sample_throughput": 3840.861, "load_time_ms": 0.409, "load_throughput": 939497998.833, "learn_time_ms": 23855.719, "learn_throughput": 16096.769, "update_time_ms": 29.132}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 5.675778087816741, "policy_loss": -0.005136648389069657, "vf_loss": 5.696181498075786, "vf_explained_var": -0.0004504856310392681, "kl": 0.01159089167087682, "entropy": 1.758498816113723, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2304000, "num_agent_steps_sampled": 2304000, "num_steps_trained": 2304000, "num_agent_steps_trained": 2304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 6, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-21-54", "timestamp": 1708849314, "time_this_iter_s": 106.47779178619385, "time_total_s": 624.0575394630432, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca246fba60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 624.0575394630432, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.458646616541355, "ram_util_percent": 18.88721804511278, "gpu_util_percent0": 0.011278195488721804, "vram_util_percent0": 0.031331380208333336}}
{"episode_reward_max": -1007.1847521634868, "episode_reward_min": -2591.184679110907, "episode_reward_mean": -1737.2399705296423, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2403.428543364449, -2465.584663076917, -2491.108356426258, -2471.0479052033243, -2444.3920102021902, -2525.1781438565235, -2566.970749643351, -2448.1356698270174, -2459.423922783182, -2573.773097586027, -2423.0974433065076, -2494.637160380505, -2527.942107089485, -2469.949022219637, -2461.2296987081895, -2449.8341070714887, -2542.90766971594, -2583.430533115757, -2591.184679110907, -2482.150538314427, -2065.593223330709, -2144.0668875306455, -2067.822647180774, -2061.6557155643486, -2057.4829648131263, -2128.693710506765, -2100.7401850570436, -2033.0021484327822, -1989.6791170218487, -2043.0657088298717, -2046.3398547412587, -2005.6115946727498, -2048.9878872269683, -2086.815135723323, -2065.7186413166974, -2069.3085697825973, -2137.0637445208067, -2046.5048040706108, -2156.856510393512, -2108.472445419458, -1661.2987737822534, -1724.2997396692556, -1692.5019860492464, -1665.4160522451584, -1704.8939747588277, -1718.4005051764461, -1680.8180973035096, -1641.536254534541, -1645.7998778502733, -1753.4225898807229, -1689.4806821238205, -1693.1582446803886, -1674.7337420225144, -1692.1862553222886, -1762.9904225785679, -1677.5426015147896, -1691.1331961247186, -1744.9713173465514, -1645.5314041940605, -1716.639081579455, -1341.204395769235, -1340.9946543622532, -1301.665958833755, -1408.0135717632713, -1357.6313920552823, -1346.3606718132673, -1308.198313695549, -1494.0004876878365, -1255.801806648742, -1294.5729617747807, -1368.5000624791357, -1396.737050635028, -1372.1940580902422, -1384.0081487865655, -1327.888168902636, -1349.6762970888992, -1284.8617199027892, -1350.5035285626616, -1383.0634202376523, -1361.193430123833, -1099.1797623028951, -1064.9292390395517, -1047.5887137621537, -1061.4888358068038, -1057.0781055038997, -1007.1847521634868, -1103.299393656562, -1032.5675951908113, -1137.5902131757161, -1062.9631927349446, -1114.2782916152962, -1084.6290467511149, -1058.7852370371593, -1034.2276282465532, -1104.0542587455257, -1101.9936681167167, -1107.4944302865497, -1069.6772920237709, -1033.8141502201743, -1098.4608314957848], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.065702645671462, "mean_inference_ms": 1.4698369175290988, "mean_action_processing_ms": 0.2174830140363403, "mean_env_wait_ms": 1.3735390243615213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 2688000, "timesteps_this_iter": 0, "agent_timesteps_total": 2688000, "timers": {"sample_time_ms": 100997.507, "sample_throughput": 3802.074, "load_time_ms": 0.391, "load_throughput": 982166491.158, "learn_time_ms": 23922.913, "learn_throughput": 16051.557, "update_time_ms": 28.836}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005000000000000001, "total_loss": 6.292871048575954, "policy_loss": -0.004056284807646941, "vf_loss": 6.312626524975426, "vf_explained_var": -0.00013275052371777987, "kl": 0.004770949957578284, "entropy": 1.665339680094468, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2688000, "num_agent_steps_sampled": 2688000, "num_steps_trained": 2688000, "num_agent_steps_trained": 2688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 7, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-23-41", "timestamp": 1708849421, "time_this_iter_s": 107.12174320220947, "time_total_s": 731.1792826652527, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd6c22d790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 731.1792826652527, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.768421052631577, "ram_util_percent": 19.55714285714286, "gpu_util_percent0": 0.011203007518796994, "vram_util_percent0": 0.03120930989583334}}
{"episode_reward_max": -887.43703785521, "episode_reward_min": -2156.856510393512, "episode_reward_mean": -1431.7148448494158, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2065.593223330709, -2144.0668875306455, -2067.822647180774, -2061.6557155643486, -2057.4829648131263, -2128.693710506765, -2100.7401850570436, -2033.0021484327822, -1989.6791170218487, -2043.0657088298717, -2046.3398547412587, -2005.6115946727498, -2048.9878872269683, -2086.815135723323, -2065.7186413166974, -2069.3085697825973, -2137.0637445208067, -2046.5048040706108, -2156.856510393512, -2108.472445419458, -1661.2987737822534, -1724.2997396692556, -1692.5019860492464, -1665.4160522451584, -1704.8939747588277, -1718.4005051764461, -1680.8180973035096, -1641.536254534541, -1645.7998778502733, -1753.4225898807229, -1689.4806821238205, -1693.1582446803886, -1674.7337420225144, -1692.1862553222886, -1762.9904225785679, -1677.5426015147896, -1691.1331961247186, -1744.9713173465514, -1645.5314041940605, -1716.639081579455, -1341.204395769235, -1340.9946543622532, -1301.665958833755, -1408.0135717632713, -1357.6313920552823, -1346.3606718132673, -1308.198313695549, -1494.0004876878365, -1255.801806648742, -1294.5729617747807, -1368.5000624791357, -1396.737050635028, -1372.1940580902422, -1384.0081487865655, -1327.888168902636, -1349.6762970888992, -1284.8617199027892, -1350.5035285626616, -1383.0634202376523, -1361.193430123833, -1099.1797623028951, -1064.9292390395517, -1047.5887137621537, -1061.4888358068038, -1057.0781055038997, -1007.1847521634868, -1103.299393656562, -1032.5675951908113, -1137.5902131757161, -1062.9631927349446, -1114.2782916152962, -1084.6290467511149, -1058.7852370371593, -1034.2276282465532, -1104.0542587455257, -1101.9936681167167, -1107.4944302865497, -1069.6772920237709, -1033.8141502201743, -1098.4608314957848, -968.2968265624204, -976.5496514998583, -1021.0321932791749, -953.0205197025141, -1010.6550939308016, -959.0998341108733, -909.1039496159689, -1000.8572857573878, -984.9028802516367, -978.2890532497133, -996.4738533839409, -980.1762875884322, -989.2235409762371, -959.5244981118192, -953.0404910307687, -945.734020014163, -887.43703785521, -929.1315355300222, -938.6819493960612, -981.6629511323658], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0706746473859277, "mean_inference_ms": 1.4802800314018745, "mean_action_processing_ms": 0.21810758444262657, "mean_env_wait_ms": 1.3793909120988888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 3072000, "timesteps_this_iter": 0, "agent_timesteps_total": 3072000, "timers": {"sample_time_ms": 101862.694, "sample_throughput": 3769.781, "load_time_ms": 0.378, "load_throughput": 1016720736.053, "learn_time_ms": 23989.024, "learn_throughput": 16007.321, "update_time_ms": 28.964}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 4.012471820178785, "policy_loss": -0.005595520477264041, "vf_loss": 4.033410699743974, "vf_explained_var": -0.00047549134806582804, "kl": 0.00576340463880785, "entropy": 1.5919694084870188, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3072000, "num_agent_steps_sampled": 3072000, "num_steps_trained": 3072000, "num_agent_steps_trained": 3072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 8, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-25-29", "timestamp": 1708849529, "time_this_iter_s": 108.01756620407104, "time_total_s": 839.1968488693237, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca246fb790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 839.1968488693237, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.716666666666665, "ram_util_percent": 20.137878787878794, "gpu_util_percent0": 0.010303030303030302, "vram_util_percent0": 0.03120930989583334}}
{"episode_reward_max": -801.3624123757332, "episode_reward_min": -1762.9904225785679, "episode_reward_mean": -1182.7191428973376, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661.2987737822534, -1724.2997396692556, -1692.5019860492464, -1665.4160522451584, -1704.8939747588277, -1718.4005051764461, -1680.8180973035096, -1641.536254534541, -1645.7998778502733, -1753.4225898807229, -1689.4806821238205, -1693.1582446803886, -1674.7337420225144, -1692.1862553222886, -1762.9904225785679, -1677.5426015147896, -1691.1331961247186, -1744.9713173465514, -1645.5314041940605, -1716.639081579455, -1341.204395769235, -1340.9946543622532, -1301.665958833755, -1408.0135717632713, -1357.6313920552823, -1346.3606718132673, -1308.198313695549, -1494.0004876878365, -1255.801806648742, -1294.5729617747807, -1368.5000624791357, -1396.737050635028, -1372.1940580902422, -1384.0081487865655, -1327.888168902636, -1349.6762970888992, -1284.8617199027892, -1350.5035285626616, -1383.0634202376523, -1361.193430123833, -1099.1797623028951, -1064.9292390395517, -1047.5887137621537, -1061.4888358068038, -1057.0781055038997, -1007.1847521634868, -1103.299393656562, -1032.5675951908113, -1137.5902131757161, -1062.9631927349446, -1114.2782916152962, -1084.6290467511149, -1058.7852370371593, -1034.2276282465532, -1104.0542587455257, -1101.9936681167167, -1107.4944302865497, -1069.6772920237709, -1033.8141502201743, -1098.4608314957848, -968.2968265624204, -976.5496514998583, -1021.0321932791749, -953.0205197025141, -1010.6550939308016, -959.0998341108733, -909.1039496159689, -1000.8572857573878, -984.9028802516367, -978.2890532497133, -996.4738533839409, -980.1762875884322, -989.2235409762371, -959.5244981118192, -953.0404910307687, -945.734020014163, -887.43703785521, -929.1315355300222, -938.6819493960612, -981.6629511323658, -834.5395373881177, -833.0821162499118, -820.5324782126339, -811.3481957707651, -823.5869682171707, -829.4433363148589, -821.5974970078524, -813.2451325401929, -807.1537083397473, -827.9488128321094, -882.3037445452926, -821.4189757306083, -801.3624123757332, -827.0782146643934, -841.8215843301418, -819.0654023455984, -827.001156560683, -830.78819262228, -855.3044678180142, -835.2893670620067], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0751284478170846, "mean_inference_ms": 1.4900035299450765, "mean_action_processing_ms": 0.21870921861927994, "mean_env_wait_ms": 1.3849032885421835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 3456000, "timesteps_this_iter": 0, "agent_timesteps_total": 3456000, "timers": {"sample_time_ms": 102582.779, "sample_throughput": 3743.318, "load_time_ms": 0.364, "load_throughput": 1054909731.752, "learn_time_ms": 24087.231, "learn_throughput": 15942.056, "update_time_ms": 28.735}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 2.7719272657444605, "policy_loss": -0.0006571932034076829, "vf_loss": 2.787787923687383, "vf_explained_var": -0.002408857408322786, "kl": 0.005396461478946884, "entropy": 1.5743075232756765, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3456000, "num_agent_steps_sampled": 3456000, "num_steps_trained": 3456000, "num_agent_steps_trained": 3456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 9, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-27-18", "timestamp": 1708849638, "time_this_iter_s": 108.73338866233826, "time_total_s": 947.930237531662, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca2c918a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 947.930237531662, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.890151515151516, "ram_util_percent": 20.770454545454545, "gpu_util_percent0": 0.011590909090909091, "vram_util_percent0": 0.03120930989583334}}
{"episode_reward_max": -730.5286345536072, "episode_reward_min": -1494.0004876878365, "episode_reward_mean": -999.0708552729586, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1341.204395769235, -1340.9946543622532, -1301.665958833755, -1408.0135717632713, -1357.6313920552823, -1346.3606718132673, -1308.198313695549, -1494.0004876878365, -1255.801806648742, -1294.5729617747807, -1368.5000624791357, -1396.737050635028, -1372.1940580902422, -1384.0081487865655, -1327.888168902636, -1349.6762970888992, -1284.8617199027892, -1350.5035285626616, -1383.0634202376523, -1361.193430123833, -1099.1797623028951, -1064.9292390395517, -1047.5887137621537, -1061.4888358068038, -1057.0781055038997, -1007.1847521634868, -1103.299393656562, -1032.5675951908113, -1137.5902131757161, -1062.9631927349446, -1114.2782916152962, -1084.6290467511149, -1058.7852370371593, -1034.2276282465532, -1104.0542587455257, -1101.9936681167167, -1107.4944302865497, -1069.6772920237709, -1033.8141502201743, -1098.4608314957848, -968.2968265624204, -976.5496514998583, -1021.0321932791749, -953.0205197025141, -1010.6550939308016, -959.0998341108733, -909.1039496159689, -1000.8572857573878, -984.9028802516367, -978.2890532497133, -996.4738533839409, -980.1762875884322, -989.2235409762371, -959.5244981118192, -953.0404910307687, -945.734020014163, -887.43703785521, -929.1315355300222, -938.6819493960612, -981.6629511323658, -834.5395373881177, -833.0821162499118, -820.5324782126339, -811.3481957707651, -823.5869682171707, -829.4433363148589, -821.5974970078524, -813.2451325401929, -807.1537083397473, -827.9488128321094, -882.3037445452926, -821.4189757306083, -801.3624123757332, -827.0782146643934, -841.8215843301418, -819.0654023455984, -827.001156560683, -830.78819262228, -855.3044678180142, -835.2893670620067, -774.2617859106142, -797.627255123651, -769.5463449054783, -832.7235248971544, -770.2089562462781, -730.5286345536072, -770.8780531090382, -781.9171549516495, -763.5142406147975, -793.9003105081251, -810.4354988784188, -768.108564259817, -849.1167448876291, -750.0434825833665, -779.8559682500292, -748.4878500589053, -749.608492004887, -747.6877874888098, -764.0067088237408, -759.4686782434819], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.078980069900313, "mean_inference_ms": 1.4982900627693134, "mean_action_processing_ms": 0.21923442539639168, "mean_env_wait_ms": 1.3907169575393439, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 3840000, "timesteps_this_iter": 0, "agent_timesteps_total": 3840000, "timers": {"sample_time_ms": 103214.259, "sample_throughput": 3720.416, "load_time_ms": 0.353, "load_throughput": 1086343407.527, "learn_time_ms": 24159.952, "learn_throughput": 15894.072, "update_time_ms": 28.568}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 1.6579419813658063, "policy_loss": 0.0012732815168994037, "vf_loss": 1.671483127694381, "vf_explained_var": -0.00313716028866015, "kl": 0.0033074919290237105, "entropy": 1.5145159583342702, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3840000, "num_agent_steps_sampled": 3840000, "num_steps_trained": 3840000, "num_agent_steps_trained": 3840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 10, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-29-07", "timestamp": 1708849747, "time_this_iter_s": 108.80857706069946, "time_total_s": 1056.7388145923615, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fc9eca5a310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1056.7388145923615, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.96259541984733, "ram_util_percent": 21.377862595419845, "gpu_util_percent0": 0.009389312977099237, "vram_util_percent0": 0.031209309895833343}}
{"episode_reward_max": -727.0772718584446, "episode_reward_min": -1137.5902131757161, "episode_reward_mean": -877.8615070354042, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1099.1797623028951, -1064.9292390395517, -1047.5887137621537, -1061.4888358068038, -1057.0781055038997, -1007.1847521634868, -1103.299393656562, -1032.5675951908113, -1137.5902131757161, -1062.9631927349446, -1114.2782916152962, -1084.6290467511149, -1058.7852370371593, -1034.2276282465532, -1104.0542587455257, -1101.9936681167167, -1107.4944302865497, -1069.6772920237709, -1033.8141502201743, -1098.4608314957848, -968.2968265624204, -976.5496514998583, -1021.0321932791749, -953.0205197025141, -1010.6550939308016, -959.0998341108733, -909.1039496159689, -1000.8572857573878, -984.9028802516367, -978.2890532497133, -996.4738533839409, -980.1762875884322, -989.2235409762371, -959.5244981118192, -953.0404910307687, -945.734020014163, -887.43703785521, -929.1315355300222, -938.6819493960612, -981.6629511323658, -834.5395373881177, -833.0821162499118, -820.5324782126339, -811.3481957707651, -823.5869682171707, -829.4433363148589, -821.5974970078524, -813.2451325401929, -807.1537083397473, -827.9488128321094, -882.3037445452926, -821.4189757306083, -801.3624123757332, -827.0782146643934, -841.8215843301418, -819.0654023455984, -827.001156560683, -830.78819262228, -855.3044678180142, -835.2893670620067, -774.2617859106142, -797.627255123651, -769.5463449054783, -832.7235248971544, -770.2089562462781, -730.5286345536072, -770.8780531090382, -781.9171549516495, -763.5142406147975, -793.9003105081251, -810.4354988784188, -768.108564259817, -849.1167448876291, -750.0434825833665, -779.8559682500292, -748.4878500589053, -749.608492004887, -747.6877874888098, -764.0067088237408, -759.4686782434819, -751.8181137927469, -727.0772718584446, -763.2268850434042, -785.9562433849808, -746.5056789882327, -737.8612659584583, -750.9916011857138, -748.048310807908, -741.863548256389, -761.716981481622, -730.4098880668151, -742.333896456533, -757.226856481255, -736.4740953772796, -730.5922785559414, -746.617073756576, -728.1826961144252, -739.8825760399178, -746.1540395571163, -733.1959742942202], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0826904332320044, "mean_inference_ms": 1.5059476442154025, "mean_action_processing_ms": 0.21980029859697328, "mean_env_wait_ms": 1.3972431662650653, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 4224000, "timesteps_this_iter": 0, "agent_timesteps_total": 4224000, "timers": {"sample_time_ms": 106552.409, "sample_throughput": 3603.86, "load_time_ms": 0.307, "load_throughput": 1251252902.424, "learn_time_ms": 24437.731, "learn_throughput": 15713.406, "update_time_ms": 28.481}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 0.938796584543429, "policy_loss": 0.001250938411287375, "vf_loss": 0.9525009660344375, "vf_explained_var": -0.0026792444680866444, "kl": 0.004699363801352631, "entropy": 1.5190298525910628, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4224000, "num_agent_steps_sampled": 4224000, "num_steps_trained": 4224000, "num_agent_steps_trained": 4224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 11, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-30-59", "timestamp": 1708849859, "time_this_iter_s": 112.14046669006348, "time_total_s": 1168.879281282425, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd6c22d3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1168.879281282425, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.991729323308267, "ram_util_percent": 21.968421052631577, "gpu_util_percent0": 0.023233082706766918, "vram_util_percent0": 0.03195978226817042}}
{"episode_reward_max": -679.0802201837671, "episode_reward_min": -1021.0321932791749, "episode_reward_mean": -807.6144751206319, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-968.2968265624204, -976.5496514998583, -1021.0321932791749, -953.0205197025141, -1010.6550939308016, -959.0998341108733, -909.1039496159689, -1000.8572857573878, -984.9028802516367, -978.2890532497133, -996.4738533839409, -980.1762875884322, -989.2235409762371, -959.5244981118192, -953.0404910307687, -945.734020014163, -887.43703785521, -929.1315355300222, -938.6819493960612, -981.6629511323658, -834.5395373881177, -833.0821162499118, -820.5324782126339, -811.3481957707651, -823.5869682171707, -829.4433363148589, -821.5974970078524, -813.2451325401929, -807.1537083397473, -827.9488128321094, -882.3037445452926, -821.4189757306083, -801.3624123757332, -827.0782146643934, -841.8215843301418, -819.0654023455984, -827.001156560683, -830.78819262228, -855.3044678180142, -835.2893670620067, -774.2617859106142, -797.627255123651, -769.5463449054783, -832.7235248971544, -770.2089562462781, -730.5286345536072, -770.8780531090382, -781.9171549516495, -763.5142406147975, -793.9003105081251, -810.4354988784188, -768.108564259817, -849.1167448876291, -750.0434825833665, -779.8559682500292, -748.4878500589053, -749.608492004887, -747.6877874888098, -764.0067088237408, -759.4686782434819, -751.8181137927469, -727.0772718584446, -763.2268850434042, -785.9562433849808, -746.5056789882327, -737.8612659584583, -750.9916011857138, -748.048310807908, -741.863548256389, -761.716981481622, -730.4098880668151, -742.333896456533, -757.226856481255, -736.4740953772796, -730.5922785559414, -746.617073756576, -728.1826961144252, -739.8825760399178, -746.1540395571163, -733.1959742942202, -719.71028826407, -752.289956743081, -687.8421322296665, -730.1851139039991, -712.0267273378236, -720.7673296291508, -690.6031840470441, -741.5756785520127, -713.748034640319, -746.6745347221814, -723.8983594852391, -738.1040792753752, -734.8212608359864, -759.9091461101777, -679.0802201837671, -722.4357064908847, -706.3554857909464, -721.4541043464776, -715.4341703870424, -739.6659334230083], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0864589100471598, "mean_inference_ms": 1.5140978643452012, "mean_action_processing_ms": 0.22044479019609897, "mean_env_wait_ms": 1.4041086737061852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 4608000, "timesteps_this_iter": 0, "agent_timesteps_total": 4608000, "timers": {"sample_time_ms": 107692.402, "sample_throughput": 3565.711, "load_time_ms": 0.303, "load_throughput": 1265806928.639, "learn_time_ms": 24638.718, "learn_throughput": 15585.226, "update_time_ms": 33.959}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 0.804461491735358, "policy_loss": -0.0037235453369488056, "vf_loss": 0.8229752575096331, "vf_explained_var": -0.003938045940901104, "kl": 0.005140045913944242, "entropy": 1.4918722635821293, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4608000, "num_agent_steps_sampled": 4608000, "num_steps_trained": 4608000, "num_agent_steps_trained": 4608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 12, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-32-52", "timestamp": 1708849972, "time_this_iter_s": 113.43601274490356, "time_total_s": 1282.3152940273285, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fc9ecc10ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1282.3152940273285, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 32.34925373134328, "ram_util_percent": 22.582835820895525, "gpu_util_percent0": 0.029850746268656716, "vram_util_percent0": 0.03142733597636817}}
{"episode_reward_max": -677.0721675329562, "episode_reward_min": -882.3037445452926, "episode_reward_mean": -758.1421859576462, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-834.5395373881177, -833.0821162499118, -820.5324782126339, -811.3481957707651, -823.5869682171707, -829.4433363148589, -821.5974970078524, -813.2451325401929, -807.1537083397473, -827.9488128321094, -882.3037445452926, -821.4189757306083, -801.3624123757332, -827.0782146643934, -841.8215843301418, -819.0654023455984, -827.001156560683, -830.78819262228, -855.3044678180142, -835.2893670620067, -774.2617859106142, -797.627255123651, -769.5463449054783, -832.7235248971544, -770.2089562462781, -730.5286345536072, -770.8780531090382, -781.9171549516495, -763.5142406147975, -793.9003105081251, -810.4354988784188, -768.108564259817, -849.1167448876291, -750.0434825833665, -779.8559682500292, -748.4878500589053, -749.608492004887, -747.6877874888098, -764.0067088237408, -759.4686782434819, -751.8181137927469, -727.0772718584446, -763.2268850434042, -785.9562433849808, -746.5056789882327, -737.8612659584583, -750.9916011857138, -748.048310807908, -741.863548256389, -761.716981481622, -730.4098880668151, -742.333896456533, -757.226856481255, -736.4740953772796, -730.5922785559414, -746.617073756576, -728.1826961144252, -739.8825760399178, -746.1540395571163, -733.1959742942202, -719.71028826407, -752.289956743081, -687.8421322296665, -730.1851139039991, -712.0267273378236, -720.7673296291508, -690.6031840470441, -741.5756785520127, -713.748034640319, -746.6745347221814, -723.8983594852391, -738.1040792753752, -734.8212608359864, -759.9091461101777, -679.0802201837671, -722.4357064908847, -706.3554857909464, -721.4541043464776, -715.4341703870424, -739.6659334230083, -734.8739946623293, -696.6656336478814, -720.1806450003501, -713.1720057852896, -734.7262091378849, -695.5449002736015, -710.3427271495221, -759.3667945325352, -704.4967086957336, -696.8548291040189, -710.8166380164332, -688.4429752895883, -743.8951901502941, -731.0096780856022, -737.088861937737, -744.9356351605677, -732.9010708163429, -717.7262345190829, -677.0721675329562, -725.5516371830572], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0902626830335138, "mean_inference_ms": 1.5221667476075347, "mean_action_processing_ms": 0.22109117861928024, "mean_env_wait_ms": 1.410727456780949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 4992000, "timesteps_this_iter": 0, "agent_timesteps_total": 4992000, "timers": {"sample_time_ms": 108613.218, "sample_throughput": 3535.481, "load_time_ms": 0.306, "load_throughput": 1254957718.56, "learn_time_ms": 24920.614, "learn_throughput": 15408.93, "update_time_ms": 33.733}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005000000000000001, "total_loss": 0.6558150939251247, "policy_loss": 0.0009268872090615332, "vf_loss": 0.6701531316104689, "vf_explained_var": -0.003871393831152665, "kl": 0.0038091768083655837, "entropy": 1.5360155042849089, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4992000, "num_agent_steps_sampled": 4992000, "num_steps_trained": 4992000, "num_agent_steps_trained": 4992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 13, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-34-46", "timestamp": 1708850086, "time_this_iter_s": 113.63771677017212, "time_total_s": 1395.9530107975006, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fc9eca5a5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1395.9530107975006, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.743939393939392, "ram_util_percent": 23.14318181818182, "gpu_util_percent0": 0.012196969696969697, "vram_util_percent0": 0.03133168846669824}}
{"episode_reward_max": -677.0721675329562, "episode_reward_min": -849.1167448876291, "episode_reward_mean": -740.7795579704646, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-774.2617859106142, -797.627255123651, -769.5463449054783, -832.7235248971544, -770.2089562462781, -730.5286345536072, -770.8780531090382, -781.9171549516495, -763.5142406147975, -793.9003105081251, -810.4354988784188, -768.108564259817, -849.1167448876291, -750.0434825833665, -779.8559682500292, -748.4878500589053, -749.608492004887, -747.6877874888098, -764.0067088237408, -759.4686782434819, -751.8181137927469, -727.0772718584446, -763.2268850434042, -785.9562433849808, -746.5056789882327, -737.8612659584583, -750.9916011857138, -748.048310807908, -741.863548256389, -761.716981481622, -730.4098880668151, -742.333896456533, -757.226856481255, -736.4740953772796, -730.5922785559414, -746.617073756576, -728.1826961144252, -739.8825760399178, -746.1540395571163, -733.1959742942202, -719.71028826407, -752.289956743081, -687.8421322296665, -730.1851139039991, -712.0267273378236, -720.7673296291508, -690.6031840470441, -741.5756785520127, -713.748034640319, -746.6745347221814, -723.8983594852391, -738.1040792753752, -734.8212608359864, -759.9091461101777, -679.0802201837671, -722.4357064908847, -706.3554857909464, -721.4541043464776, -715.4341703870424, -739.6659334230083, -734.8739946623293, -696.6656336478814, -720.1806450003501, -713.1720057852896, -734.7262091378849, -695.5449002736015, -710.3427271495221, -759.3667945325352, -704.4967086957336, -696.8548291040189, -710.8166380164332, -688.4429752895883, -743.8951901502941, -731.0096780856022, -737.088861937737, -744.9356351605677, -732.9010708163429, -717.7262345190829, -677.0721675329562, -725.5516371830572, -712.3662582252362, -763.5339301925146, -707.0076743250529, -816.0545970543063, -742.2744087375544, -763.620865522432, -727.9640902516925, -736.3936503308875, -714.3782763959368, -707.3281595326064, -750.9612350507138, -723.5159151638785, -737.7218548929377, -731.0711597083505, -783.3878627946203, -794.086361236882, -731.8554244105086, -687.6246401793342, -723.7497492501311, -772.7523889543658], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0935194513356523, "mean_inference_ms": 1.5301703612023112, "mean_action_processing_ms": 0.22165375174614738, "mean_env_wait_ms": 1.4169200085149642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 5376000, "timesteps_this_iter": 0, "agent_timesteps_total": 5376000, "timers": {"sample_time_ms": 109403.763, "sample_throughput": 3509.934, "load_time_ms": 0.299, "load_throughput": 1286431897.764, "learn_time_ms": 25130.293, "learn_throughput": 15280.363, "update_time_ms": 33.995}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.8010163503257852, "policy_loss": -0.0018003562367276142, "vf_loss": 0.8174742679846915, "vf_explained_var": -0.0006803556492454127, "kl": 0.008933635799430226, "entropy": 1.4769229575207359, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 5376000, "num_agent_steps_sampled": 5376000, "num_steps_trained": 5376000, "num_agent_steps_trained": 5376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 14, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-36-38", "timestamp": 1708850198, "time_this_iter_s": 111.85964298248291, "time_total_s": 1507.8126537799835, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcda325bd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1507.8126537799835, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 31.508527131782948, "ram_util_percent": 23.77751937984496, "gpu_util_percent0": 0.009612403100775194, "vram_util_percent0": 0.031331380208333336}}
{"episode_reward_max": -677.0721675329562, "episode_reward_min": -816.0545970543063, "episode_reward_mean": -728.4535963288645, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751.8181137927469, -727.0772718584446, -763.2268850434042, -785.9562433849808, -746.5056789882327, -737.8612659584583, -750.9916011857138, -748.048310807908, -741.863548256389, -761.716981481622, -730.4098880668151, -742.333896456533, -757.226856481255, -736.4740953772796, -730.5922785559414, -746.617073756576, -728.1826961144252, -739.8825760399178, -746.1540395571163, -733.1959742942202, -719.71028826407, -752.289956743081, -687.8421322296665, -730.1851139039991, -712.0267273378236, -720.7673296291508, -690.6031840470441, -741.5756785520127, -713.748034640319, -746.6745347221814, -723.8983594852391, -738.1040792753752, -734.8212608359864, -759.9091461101777, -679.0802201837671, -722.4357064908847, -706.3554857909464, -721.4541043464776, -715.4341703870424, -739.6659334230083, -734.8739946623293, -696.6656336478814, -720.1806450003501, -713.1720057852896, -734.7262091378849, -695.5449002736015, -710.3427271495221, -759.3667945325352, -704.4967086957336, -696.8548291040189, -710.8166380164332, -688.4429752895883, -743.8951901502941, -731.0096780856022, -737.088861937737, -744.9356351605677, -732.9010708163429, -717.7262345190829, -677.0721675329562, -725.5516371830572, -712.3662582252362, -763.5339301925146, -707.0076743250529, -816.0545970543063, -742.2744087375544, -763.620865522432, -727.9640902516925, -736.3936503308875, -714.3782763959368, -707.3281595326064, -750.9612350507138, -723.5159151638785, -737.7218548929377, -731.0711597083505, -783.3878627946203, -794.086361236882, -731.8554244105086, -687.6246401793342, -723.7497492501311, -772.7523889543658, -744.4157460414943, -703.6802177076049, -727.4623820874896, -693.3544981348127, -700.3516983043505, -751.388415624369, -717.7377230338423, -749.0465557699927, -695.8569022222595, -715.042847347888, -704.9992877161958, -712.056166864245, -688.0975432751508, -679.6490226359981, -714.0424251502806, -686.5062783802042, -711.5620205198337, -704.5900687971983, -738.8554809682897, -740.6345915579609], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.096700610283846, "mean_inference_ms": 1.538342586007775, "mean_action_processing_ms": 0.2221884825498897, "mean_env_wait_ms": 1.4229184292587151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 5760000, "timesteps_this_iter": 0, "agent_timesteps_total": 5760000, "timers": {"sample_time_ms": 110156.453, "sample_throughput": 3485.951, "load_time_ms": 0.277, "load_throughput": 1385354151.041, "learn_time_ms": 25243.807, "learn_throughput": 15211.652, "update_time_ms": 34.883}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.5974667370319366, "policy_loss": -0.0006745877479644198, "vf_loss": 0.6131614336841985, "vf_explained_var": -0.0019105265015049984, "kl": 0.006969440170235573, "entropy": 1.5107235971250033, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 5760000, "num_agent_steps_sampled": 5760000, "num_steps_trained": 5760000, "num_agent_steps_trained": 5760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 15, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-38-30", "timestamp": 1708850310, "time_this_iter_s": 112.17396831512451, "time_total_s": 1619.986622095108, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca2d874f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1619.986622095108, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.67441860465116, "ram_util_percent": 24.446511627906972, "gpu_util_percent0": 0.00937984496124031, "vram_util_percent0": 0.031331380208333336}}
{"episode_reward_max": -677.0721675329562, "episode_reward_min": -816.0545970543063, "episode_reward_mean": -732.256341116269, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-719.71028826407, -752.289956743081, -687.8421322296665, -730.1851139039991, -712.0267273378236, -720.7673296291508, -690.6031840470441, -741.5756785520127, -713.748034640319, -746.6745347221814, -723.8983594852391, -738.1040792753752, -734.8212608359864, -759.9091461101777, -679.0802201837671, -722.4357064908847, -706.3554857909464, -721.4541043464776, -715.4341703870424, -739.6659334230083, -734.8739946623293, -696.6656336478814, -720.1806450003501, -713.1720057852896, -734.7262091378849, -695.5449002736015, -710.3427271495221, -759.3667945325352, -704.4967086957336, -696.8548291040189, -710.8166380164332, -688.4429752895883, -743.8951901502941, -731.0096780856022, -737.088861937737, -744.9356351605677, -732.9010708163429, -717.7262345190829, -677.0721675329562, -725.5516371830572, -712.3662582252362, -763.5339301925146, -707.0076743250529, -816.0545970543063, -742.2744087375544, -763.620865522432, -727.9640902516925, -736.3936503308875, -714.3782763959368, -707.3281595326064, -750.9612350507138, -723.5159151638785, -737.7218548929377, -731.0711597083505, -783.3878627946203, -794.086361236882, -731.8554244105086, -687.6246401793342, -723.7497492501311, -772.7523889543658, -744.4157460414943, -703.6802177076049, -727.4623820874896, -693.3544981348127, -700.3516983043505, -751.388415624369, -717.7377230338423, -749.0465557699927, -695.8569022222595, -715.042847347888, -704.9992877161958, -712.056166864245, -688.0975432751508, -679.6490226359981, -714.0424251502806, -686.5062783802042, -711.5620205198337, -704.5900687971983, -738.8554809682897, -740.6345915579609, -740.7547150206702, -802.9146019330607, -746.4594973988312, -790.2270797437121, -720.7341394772856, -791.8784600337469, -755.0797626300456, -758.9549135425785, -737.7812790961456, -703.6789604980285, -772.0131662336314, -800.5671707997936, -748.6052922558993, -774.501833425901, -778.040107332919, -760.8307787350913, -792.2347240338922, -797.5166373595383, -770.0632380883261, -743.5733965593292], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0994148983074692, "mean_inference_ms": 1.5460419354042174, "mean_action_processing_ms": 0.22262334093712066, "mean_env_wait_ms": 1.42804037331623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 6144000, "timesteps_this_iter": 0, "agent_timesteps_total": 6144000, "timers": {"sample_time_ms": 110740.619, "sample_throughput": 3467.562, "load_time_ms": 0.275, "load_throughput": 1394832195.375, "learn_time_ms": 25366.458, "learn_throughput": 15138.101, "update_time_ms": 34.824}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.8427879143702356, "policy_loss": 0.00021726391921555134, "vf_loss": 0.8570027555290022, "vf_explained_var": -0.0005620027843274569, "kl": 0.008166193473076228, "entropy": 1.453419500275662, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6144000, "num_agent_steps_sampled": 6144000, "num_steps_trained": 6144000, "num_agent_steps_trained": 6144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 16, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-40-23", "timestamp": 1708850423, "time_this_iter_s": 112.36597299575806, "time_total_s": 1732.352595090866, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84214790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1732.352595090866, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 31.75590551181102, "ram_util_percent": 25.04960629921259, "gpu_util_percent0": 0.008740157480314962, "vram_util_percent0": 0.031331380208333336}}
{"episode_reward_max": -677.0721675329562, "episode_reward_min": -816.0545970543063, "episode_reward_mean": -727.3455186670501, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-734.8739946623293, -696.6656336478814, -720.1806450003501, -713.1720057852896, -734.7262091378849, -695.5449002736015, -710.3427271495221, -759.3667945325352, -704.4967086957336, -696.8548291040189, -710.8166380164332, -688.4429752895883, -743.8951901502941, -731.0096780856022, -737.088861937737, -744.9356351605677, -732.9010708163429, -717.7262345190829, -677.0721675329562, -725.5516371830572, -712.3662582252362, -763.5339301925146, -707.0076743250529, -816.0545970543063, -742.2744087375544, -763.620865522432, -727.9640902516925, -736.3936503308875, -714.3782763959368, -707.3281595326064, -750.9612350507138, -723.5159151638785, -737.7218548929377, -731.0711597083505, -783.3878627946203, -794.086361236882, -731.8554244105086, -687.6246401793342, -723.7497492501311, -772.7523889543658, -744.4157460414943, -703.6802177076049, -727.4623820874896, -693.3544981348127, -700.3516983043505, -751.388415624369, -717.7377230338423, -749.0465557699927, -695.8569022222595, -715.042847347888, -704.9992877161958, -712.056166864245, -688.0975432751508, -679.6490226359981, -714.0424251502806, -686.5062783802042, -711.5620205198337, -704.5900687971983, -738.8554809682897, -740.6345915579609, -740.7547150206702, -802.9146019330607, -746.4594973988312, -790.2270797437121, -720.7341394772856, -791.8784600337469, -755.0797626300456, -758.9549135425785, -737.7812790961456, -703.6789604980285, -772.0131662336314, -800.5671707997936, -748.6052922558993, -774.501833425901, -778.040107332919, -760.8307787350913, -792.2347240338922, -797.5166373595383, -770.0632380883261, -743.5733965593292, -693.1897828597159, -680.3248507014554, -695.5172901798824, -710.9669884935299, -681.6171670578591, -695.8063820358782, -718.1848713023705, -691.181766551469, -696.5064674020921, -700.896900472549, -703.8180111961148, -696.0628643147945, -709.5200781119577, -688.3144904847577, -714.7976762268494, -690.6405549345301, -701.0145439076204, -687.4855011796521, -697.8915409452835, -711.7614731180144], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.101494395341036, "mean_inference_ms": 1.5530392855178201, "mean_action_processing_ms": 0.22291718836359625, "mean_env_wait_ms": 1.43210560023156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 6528000, "timesteps_this_iter": 0, "agent_timesteps_total": 6528000, "timers": {"sample_time_ms": 111317.998, "sample_throughput": 3449.577, "load_time_ms": 0.274, "load_throughput": 1401873736.618, "learn_time_ms": 25506.909, "learn_throughput": 15054.744, "update_time_ms": 34.899}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.5777752297489267, "policy_loss": 0.0005813727620989084, "vf_loss": 0.5919613806824935, "vf_explained_var": 0.0010538916838796514, "kl": 0.007243324012961239, "entropy": 1.4858062141820003, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6528000, "num_agent_steps_sampled": 6528000, "num_steps_trained": 6528000, "num_agent_steps_trained": 6528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 17, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-42-16", "timestamp": 1708850536, "time_this_iter_s": 113.07635641098022, "time_total_s": 1845.4289515018463, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca24013280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1845.4289515018463, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.135433070866135, "ram_util_percent": 25.614173228346463, "gpu_util_percent0": 0.006141732283464567, "vram_util_percent0": 0.031331380208333336}}
{"episode_reward_max": -679.6490226359981, "episode_reward_min": -816.0545970543063, "episode_reward_mean": -727.9528670135929, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-712.3662582252362, -763.5339301925146, -707.0076743250529, -816.0545970543063, -742.2744087375544, -763.620865522432, -727.9640902516925, -736.3936503308875, -714.3782763959368, -707.3281595326064, -750.9612350507138, -723.5159151638785, -737.7218548929377, -731.0711597083505, -783.3878627946203, -794.086361236882, -731.8554244105086, -687.6246401793342, -723.7497492501311, -772.7523889543658, -744.4157460414943, -703.6802177076049, -727.4623820874896, -693.3544981348127, -700.3516983043505, -751.388415624369, -717.7377230338423, -749.0465557699927, -695.8569022222595, -715.042847347888, -704.9992877161958, -712.056166864245, -688.0975432751508, -679.6490226359981, -714.0424251502806, -686.5062783802042, -711.5620205198337, -704.5900687971983, -738.8554809682897, -740.6345915579609, -740.7547150206702, -802.9146019330607, -746.4594973988312, -790.2270797437121, -720.7341394772856, -791.8784600337469, -755.0797626300456, -758.9549135425785, -737.7812790961456, -703.6789604980285, -772.0131662336314, -800.5671707997936, -748.6052922558993, -774.501833425901, -778.040107332919, -760.8307787350913, -792.2347240338922, -797.5166373595383, -770.0632380883261, -743.5733965593292, -693.1897828597159, -680.3248507014554, -695.5172901798824, -710.9669884935299, -681.6171670578591, -695.8063820358782, -718.1848713023705, -691.181766551469, -696.5064674020921, -700.896900472549, -703.8180111961148, -696.0628643147945, -709.5200781119577, -688.3144904847577, -714.7976762268494, -690.6405549345301, -701.0145439076204, -687.4855011796521, -697.8915409452835, -711.7614731180144, -714.2121922408484, -726.1343455106605, -724.8405054555202, -717.2605918247762, -702.4885156875076, -720.4184080685098, -700.9832833314872, -730.6558088535241, -714.241484979886, -747.8779441113031, -721.0291769809907, -724.4389542324902, -720.9436213378036, -722.9387415063231, -712.8985612946581, -734.2183481954554, -760.0162525858847, -720.1496275495152, -707.4517462221165, -713.2012613658279], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1031446416411026, "mean_inference_ms": 1.5593900352671861, "mean_action_processing_ms": 0.22313107373416724, "mean_env_wait_ms": 1.4357424309394398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 6912000, "timesteps_this_iter": 0, "agent_timesteps_total": 6912000, "timers": {"sample_time_ms": 111839.53, "sample_throughput": 3433.491, "load_time_ms": 0.272, "load_throughput": 1410590940.62, "learn_time_ms": 25660.203, "learn_throughput": 14964.808, "update_time_ms": 34.639}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.6915700341525831, "policy_loss": -0.0019759739079745486, "vf_loss": 0.7082015542607558, "vf_explained_var": -0.0021522986261468184, "kl": 0.006979400303335799, "entropy": 1.474279755040219, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6912000, "num_agent_steps_sampled": 6912000, "num_steps_trained": 6912000, "num_agent_steps_trained": 6912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 18, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-44-09", "timestamp": 1708850649, "time_this_iter_s": 113.36126208305359, "time_total_s": 1958.7902135849, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84214af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1958.7902135849, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.916666666666668, "ram_util_percent": 26.16269841269842, "gpu_util_percent0": 0.00626984126984127, "vram_util_percent0": 0.031209309895833332}}
{"episode_reward_max": -679.6490226359981, "episode_reward_min": -802.9146019330607, "episode_reward_mean": -727.2103165249024, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-744.4157460414943, -703.6802177076049, -727.4623820874896, -693.3544981348127, -700.3516983043505, -751.388415624369, -717.7377230338423, -749.0465557699927, -695.8569022222595, -715.042847347888, -704.9992877161958, -712.056166864245, -688.0975432751508, -679.6490226359981, -714.0424251502806, -686.5062783802042, -711.5620205198337, -704.5900687971983, -738.8554809682897, -740.6345915579609, -740.7547150206702, -802.9146019330607, -746.4594973988312, -790.2270797437121, -720.7341394772856, -791.8784600337469, -755.0797626300456, -758.9549135425785, -737.7812790961456, -703.6789604980285, -772.0131662336314, -800.5671707997936, -748.6052922558993, -774.501833425901, -778.040107332919, -760.8307787350913, -792.2347240338922, -797.5166373595383, -770.0632380883261, -743.5733965593292, -693.1897828597159, -680.3248507014554, -695.5172901798824, -710.9669884935299, -681.6171670578591, -695.8063820358782, -718.1848713023705, -691.181766551469, -696.5064674020921, -700.896900472549, -703.8180111961148, -696.0628643147945, -709.5200781119577, -688.3144904847577, -714.7976762268494, -690.6405549345301, -701.0145439076204, -687.4855011796521, -697.8915409452835, -711.7614731180144, -714.2121922408484, -726.1343455106605, -724.8405054555202, -717.2605918247762, -702.4885156875076, -720.4184080685098, -700.9832833314872, -730.6558088535241, -714.241484979886, -747.8779441113031, -721.0291769809907, -724.4389542324902, -720.9436213378036, -722.9387415063231, -712.8985612946581, -734.2183481954554, -760.0162525858847, -720.1496275495152, -707.4517462221165, -713.2012613658279, -749.4352220598377, -723.879832795382, -749.7305155163575, -727.4442634941064, -725.6805409341332, -744.8980246775227, -743.4748902408771, -739.7236440929744, -722.8703154808406, -756.3028613085539, -777.7635167401136, -746.9426432694075, -743.6752033885916, -765.3475557804696, -701.5119524560398, -736.2430762049996, -735.3732214113205, -706.2690246129633, -732.367178520528, -724.4599703558632], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.104871408704595, "mean_inference_ms": 1.5655803016685352, "mean_action_processing_ms": 0.22332263369841468, "mean_env_wait_ms": 1.4392843866044087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 7296000, "timesteps_this_iter": 0, "agent_timesteps_total": 7296000, "timers": {"sample_time_ms": 112380.701, "sample_throughput": 3416.957, "load_time_ms": 0.274, "load_throughput": 1402117816.662, "learn_time_ms": 25785.255, "learn_throughput": 14892.232, "update_time_ms": 34.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.6707704396624314, "policy_loss": 0.00206110458920624, "vf_loss": 0.6832499786427146, "vf_explained_var": 0.00029402030141730055, "kl": 0.010117516155380719, "entropy": 1.466712967345589, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7296000, "num_agent_steps_sampled": 7296000, "num_steps_trained": 7296000, "num_agent_steps_trained": 7296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 19, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-46-03", "timestamp": 1708850763, "time_this_iter_s": 113.86681199073792, "time_total_s": 2072.657025575638, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca2c918a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2072.657025575638, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 32.00000000000001, "ram_util_percent": 26.819047619047613, "gpu_util_percent0": 0.012460317460317461, "vram_util_percent0": 0.031209309895833332}}
{"episode_reward_max": -680.3248507014554, "episode_reward_min": -802.9146019330607, "episode_reward_mean": -727.626471079441, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.7547150206702, -802.9146019330607, -746.4594973988312, -790.2270797437121, -720.7341394772856, -791.8784600337469, -755.0797626300456, -758.9549135425785, -737.7812790961456, -703.6789604980285, -772.0131662336314, -800.5671707997936, -748.6052922558993, -774.501833425901, -778.040107332919, -760.8307787350913, -792.2347240338922, -797.5166373595383, -770.0632380883261, -743.5733965593292, -693.1897828597159, -680.3248507014554, -695.5172901798824, -710.9669884935299, -681.6171670578591, -695.8063820358782, -718.1848713023705, -691.181766551469, -696.5064674020921, -700.896900472549, -703.8180111961148, -696.0628643147945, -709.5200781119577, -688.3144904847577, -714.7976762268494, -690.6405549345301, -701.0145439076204, -687.4855011796521, -697.8915409452835, -711.7614731180144, -714.2121922408484, -726.1343455106605, -724.8405054555202, -717.2605918247762, -702.4885156875076, -720.4184080685098, -700.9832833314872, -730.6558088535241, -714.241484979886, -747.8779441113031, -721.0291769809907, -724.4389542324902, -720.9436213378036, -722.9387415063231, -712.8985612946581, -734.2183481954554, -760.0162525858847, -720.1496275495152, -707.4517462221165, -713.2012613658279, -749.4352220598377, -723.879832795382, -749.7305155163575, -727.4442634941064, -725.6805409341332, -744.8980246775227, -743.4748902408771, -739.7236440929744, -722.8703154808406, -756.3028613085539, -777.7635167401136, -746.9426432694075, -743.6752033885916, -765.3475557804696, -701.5119524560398, -736.2430762049996, -735.3732214113205, -706.2690246129633, -732.367178520528, -724.4599703558632, -720.860913813935, -736.1809802070462, -691.2561337133085, -705.5734936019198, -688.0324923345624, -709.8107949046602, -719.48788509489, -732.3714077213014, -723.4921362299878, -722.4302300530156, -723.3865235511358, -713.0987691326143, -701.8964351797496, -769.8935705235094, -696.5402954265155, -705.4614371072724, -712.8839283992287, -730.802779024454, -703.7961447856106, -713.68897678861], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.106669590915851, "mean_inference_ms": 1.5719064459422551, "mean_action_processing_ms": 0.22350780536501025, "mean_env_wait_ms": 1.4425799705983908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 7680000, "timesteps_this_iter": 0, "agent_timesteps_total": 7680000, "timers": {"sample_time_ms": 113035.825, "sample_throughput": 3397.153, "load_time_ms": 0.277, "load_throughput": 1388578960.255, "learn_time_ms": 26007.103, "learn_throughput": 14765.197, "update_time_ms": 35.816}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.7032438783269179, "policy_loss": -0.00040469276963880186, "vf_loss": 0.7182644809547224, "vf_explained_var": -0.0012653124959845293, "kl": 0.0099433349195782, "entropy": 1.4740190694206639, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7680000, "num_agent_steps_sampled": 7680000, "num_steps_trained": 7680000, "num_agent_steps_trained": 7680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 20, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-47-59", "timestamp": 1708850879, "time_this_iter_s": 116.35363173484802, "time_total_s": 2189.010657310486, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca06fe7e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2189.010657310486, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.27007874015748, "ram_util_percent": 27.38110236220472, "gpu_util_percent0": 0.00968503937007874, "vram_util_percent0": 0.031209309895833336}}
{"episode_reward_max": -680.3248507014554, "episode_reward_min": -810.3284489714235, "episode_reward_mean": -725.6007909535251, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-693.1897828597159, -680.3248507014554, -695.5172901798824, -710.9669884935299, -681.6171670578591, -695.8063820358782, -718.1848713023705, -691.181766551469, -696.5064674020921, -700.896900472549, -703.8180111961148, -696.0628643147945, -709.5200781119577, -688.3144904847577, -714.7976762268494, -690.6405549345301, -701.0145439076204, -687.4855011796521, -697.8915409452835, -711.7614731180144, -714.2121922408484, -726.1343455106605, -724.8405054555202, -717.2605918247762, -702.4885156875076, -720.4184080685098, -700.9832833314872, -730.6558088535241, -714.241484979886, -747.8779441113031, -721.0291769809907, -724.4389542324902, -720.9436213378036, -722.9387415063231, -712.8985612946581, -734.2183481954554, -760.0162525858847, -720.1496275495152, -707.4517462221165, -713.2012613658279, -749.4352220598377, -723.879832795382, -749.7305155163575, -727.4442634941064, -725.6805409341332, -744.8980246775227, -743.4748902408771, -739.7236440929744, -722.8703154808406, -756.3028613085539, -777.7635167401136, -746.9426432694075, -743.6752033885916, -765.3475557804696, -701.5119524560398, -736.2430762049996, -735.3732214113205, -706.2690246129633, -732.367178520528, -724.4599703558632, -720.860913813935, -736.1809802070462, -691.2561337133085, -705.5734936019198, -688.0324923345624, -709.8107949046602, -719.48788509489, -732.3714077213014, -723.4921362299878, -722.4302300530156, -723.3865235511358, -713.0987691326143, -701.8964351797496, -769.8935705235094, -696.5402954265155, -705.4614371072724, -712.8839283992287, -730.802779024454, -703.7961447856106, -713.68897678861, -735.6526479161125, -752.5418910025837, -779.5977540833948, -753.472367140454, -758.3459272293032, -769.5487190764723, -732.050332059823, -747.0968990999336, -699.6793219578118, -810.3284489714235, -754.2509032791535, -722.1697173985755, -761.1284587186096, -769.9996809954416, -740.1973733932726, -799.4144554735992, -727.5890562784042, -753.9931874710635, -759.8768171497777, -756.9077829116262], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.108500930996098, "mean_inference_ms": 1.5782259992845837, "mean_action_processing_ms": 0.22369886019109925, "mean_env_wait_ms": 1.4459473702264236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 8064000, "timesteps_this_iter": 0, "agent_timesteps_total": 8064000, "timers": {"sample_time_ms": 113592.06, "sample_throughput": 3380.518, "load_time_ms": 0.28, "load_throughput": 1371901819.421, "learn_time_ms": 26097.959, "learn_throughput": 14713.794, "update_time_ms": 35.997}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.7094953005251131, "policy_loss": 0.0010469785989507248, "vf_loss": 0.723012426966115, "vf_explained_var": 0.000700669853310836, "kl": 0.008306123203486717, "entropy": 1.4667930289318687, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8064000, "num_agent_steps_sampled": 8064000, "num_steps_trained": 8064000, "num_agent_steps_trained": 8064000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 21, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-49-56", "timestamp": 1708850996, "time_this_iter_s": 116.35002517700195, "time_total_s": 2305.360682487488, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca2c9184c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2305.360682487488, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.31360000000001, "ram_util_percent": 28.0272, "gpu_util_percent0": 0.010879999999999999, "vram_util_percent0": 0.031209309895833332}}
{"episode_reward_max": -675.8062937784764, "episode_reward_min": -810.3284489714235, "episode_reward_mean": -725.461243157417, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-714.2121922408484, -726.1343455106605, -724.8405054555202, -717.2605918247762, -702.4885156875076, -720.4184080685098, -700.9832833314872, -730.6558088535241, -714.241484979886, -747.8779441113031, -721.0291769809907, -724.4389542324902, -720.9436213378036, -722.9387415063231, -712.8985612946581, -734.2183481954554, -760.0162525858847, -720.1496275495152, -707.4517462221165, -713.2012613658279, -749.4352220598377, -723.879832795382, -749.7305155163575, -727.4442634941064, -725.6805409341332, -744.8980246775227, -743.4748902408771, -739.7236440929744, -722.8703154808406, -756.3028613085539, -777.7635167401136, -746.9426432694075, -743.6752033885916, -765.3475557804696, -701.5119524560398, -736.2430762049996, -735.3732214113205, -706.2690246129633, -732.367178520528, -724.4599703558632, -720.860913813935, -736.1809802070462, -691.2561337133085, -705.5734936019198, -688.0324923345624, -709.8107949046602, -719.48788509489, -732.3714077213014, -723.4921362299878, -722.4302300530156, -723.3865235511358, -713.0987691326143, -701.8964351797496, -769.8935705235094, -696.5402954265155, -705.4614371072724, -712.8839283992287, -730.802779024454, -703.7961447856106, -713.68897678861, -735.6526479161125, -752.5418910025837, -779.5977540833948, -753.472367140454, -758.3459272293032, -769.5487190764723, -732.050332059823, -747.0968990999336, -699.6793219578118, -810.3284489714235, -754.2509032791535, -722.1697173985755, -761.1284587186096, -769.9996809954416, -740.1973733932726, -799.4144554735992, -727.5890562784042, -753.9931874710635, -759.8768171497777, -756.9077829116262, -693.1495677824342, -709.7072325342043, -702.530241649725, -699.7302658006951, -681.1185898713937, -710.0219806800641, -699.5040558877317, -689.8180398586541, -675.8062937784764, -680.8084627322415, -715.6201930965959, -702.923290360786, -691.8477931436258, -707.8624442867117, -690.3068985950105, -693.6047177298208, -687.1203692980076, -713.9413467556988, -716.7940675542472, -689.3285704694401], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1103743012195295, "mean_inference_ms": 1.5846380443696955, "mean_action_processing_ms": 0.2238973408611048, "mean_env_wait_ms": 1.4493195211152408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 8448000, "timesteps_this_iter": 0, "agent_timesteps_total": 8448000, "timers": {"sample_time_ms": 113915.965, "sample_throughput": 3370.906, "load_time_ms": 0.282, "load_throughput": 1359396299.797, "learn_time_ms": 26237.872, "learn_throughput": 14635.333, "update_time_ms": 31.416}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005000000000000001, "total_loss": 0.6124224176532344, "policy_loss": 2.6488333548370162e-05, "vf_loss": 0.6270193614457783, "vf_explained_var": 0.0016043358727505332, "kl": 0.004775786691808255, "entropy": 1.4683142743612592, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8448000, "num_agent_steps_sampled": 8448000, "num_steps_trained": 8448000, "num_agent_steps_trained": 8448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 22, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-51-53", "timestamp": 1708851113, "time_this_iter_s": 117.10538101196289, "time_total_s": 2422.4660634994507, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca06fe79d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2422.4660634994507, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 32.474603174603175, "ram_util_percent": 28.5920634920635, "gpu_util_percent0": 0.009444444444444445, "vram_util_percent0": 0.031209309895833332}}
{"episode_reward_max": -675.8062937784764, "episode_reward_min": -810.3284489714235, "episode_reward_mean": -719.5775858991136, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749.4352220598377, -723.879832795382, -749.7305155163575, -727.4442634941064, -725.6805409341332, -744.8980246775227, -743.4748902408771, -739.7236440929744, -722.8703154808406, -756.3028613085539, -777.7635167401136, -746.9426432694075, -743.6752033885916, -765.3475557804696, -701.5119524560398, -736.2430762049996, -735.3732214113205, -706.2690246129633, -732.367178520528, -724.4599703558632, -720.860913813935, -736.1809802070462, -691.2561337133085, -705.5734936019198, -688.0324923345624, -709.8107949046602, -719.48788509489, -732.3714077213014, -723.4921362299878, -722.4302300530156, -723.3865235511358, -713.0987691326143, -701.8964351797496, -769.8935705235094, -696.5402954265155, -705.4614371072724, -712.8839283992287, -730.802779024454, -703.7961447856106, -713.68897678861, -735.6526479161125, -752.5418910025837, -779.5977540833948, -753.472367140454, -758.3459272293032, -769.5487190764723, -732.050332059823, -747.0968990999336, -699.6793219578118, -810.3284489714235, -754.2509032791535, -722.1697173985755, -761.1284587186096, -769.9996809954416, -740.1973733932726, -799.4144554735992, -727.5890562784042, -753.9931874710635, -759.8768171497777, -756.9077829116262, -693.1495677824342, -709.7072325342043, -702.530241649725, -699.7302658006951, -681.1185898713937, -710.0219806800641, -699.5040558877317, -689.8180398586541, -675.8062937784764, -680.8084627322415, -715.6201930965959, -702.923290360786, -691.8477931436258, -707.8624442867117, -690.3068985950105, -693.6047177298208, -687.1203692980076, -713.9413467556988, -716.7940675542472, -689.3285704694401, -677.5701114659723, -696.8432068194898, -678.3452689876304, -694.8698325975447, -700.117675869182, -683.5186342268792, -707.9924643844266, -696.4519310756126, -696.6159586672279, -699.6619469747757, -697.5965268313042, -682.0811594703142, -681.5139434114169, -735.6223086617443, -686.2387108834447, -695.7959081938334, -687.5775839664789, -685.3454058957466, -684.4362485130429, -679.8388186086843], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1123367026377913, "mean_inference_ms": 1.591344711015215, "mean_action_processing_ms": 0.22413164915628703, "mean_env_wait_ms": 1.4529803889376556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 8832000, "timesteps_this_iter": 0, "agent_timesteps_total": 8832000, "timers": {"sample_time_ms": 114455.827, "sample_throughput": 3355.006, "load_time_ms": 0.282, "load_throughput": 1362386005.752, "learn_time_ms": 26294.171, "learn_throughput": 14603.997, "update_time_ms": 31.968}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005000000000000001, "total_loss": 0.5620270677303013, "policy_loss": -0.0001073448587895224, "vf_loss": 0.576953218171471, "vf_explained_var": -0.0019177072926571494, "kl": 0.004382571750092642, "entropy": 1.4846199060741223, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8832000, "num_agent_steps_sampled": 8832000, "num_steps_trained": 8832000, "num_agent_steps_trained": 8832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 23, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-53-51", "timestamp": 1708851231, "time_this_iter_s": 118.29979276657104, "time_total_s": 2540.7658562660217, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84159940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2540.7658562660217, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 32.6432, "ram_util_percent": 29.225600000000004, "gpu_util_percent0": 0.00992, "vram_util_percent0": 0.031209309895833332}}
{"episode_reward_max": -675.8062937784764, "episode_reward_min": -812.1938544646814, "episode_reward_mean": -721.0991378121838, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-720.860913813935, -736.1809802070462, -691.2561337133085, -705.5734936019198, -688.0324923345624, -709.8107949046602, -719.48788509489, -732.3714077213014, -723.4921362299878, -722.4302300530156, -723.3865235511358, -713.0987691326143, -701.8964351797496, -769.8935705235094, -696.5402954265155, -705.4614371072724, -712.8839283992287, -730.802779024454, -703.7961447856106, -713.68897678861, -735.6526479161125, -752.5418910025837, -779.5977540833948, -753.472367140454, -758.3459272293032, -769.5487190764723, -732.050332059823, -747.0968990999336, -699.6793219578118, -810.3284489714235, -754.2509032791535, -722.1697173985755, -761.1284587186096, -769.9996809954416, -740.1973733932726, -799.4144554735992, -727.5890562784042, -753.9931874710635, -759.8768171497777, -756.9077829116262, -693.1495677824342, -709.7072325342043, -702.530241649725, -699.7302658006951, -681.1185898713937, -710.0219806800641, -699.5040558877317, -689.8180398586541, -675.8062937784764, -680.8084627322415, -715.6201930965959, -702.923290360786, -691.8477931436258, -707.8624442867117, -690.3068985950105, -693.6047177298208, -687.1203692980076, -713.9413467556988, -716.7940675542472, -689.3285704694401, -677.5701114659723, -696.8432068194898, -678.3452689876304, -694.8698325975447, -700.117675869182, -683.5186342268792, -707.9924643844266, -696.4519310756126, -696.6159586672279, -699.6619469747757, -697.5965268313042, -682.0811594703142, -681.5139434114169, -735.6223086617443, -686.2387108834447, -695.7959081938334, -687.5775839664789, -685.3454058957466, -684.4362485130429, -679.8388186086843, -750.7822173279428, -696.918250176576, -754.5505455527294, -812.1938544646814, -738.8365750413649, -735.5458076451607, -751.3058620511239, -717.8431682754008, -802.8999558119406, -769.2222879585103, -725.5181284976213, -713.7953157059441, -760.966629882568, -788.179455367543, -755.4390713490977, -766.7532010965245, -704.6645589151126, -690.4732121758135, -736.2310435181522, -733.4295038340757], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1144509145795316, "mean_inference_ms": 1.597875685258169, "mean_action_processing_ms": 0.22443007113029745, "mean_env_wait_ms": 1.4573728488680797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 9216000, "timesteps_this_iter": 0, "agent_timesteps_total": 9216000, "timers": {"sample_time_ms": 115101.249, "sample_throughput": 3336.193, "load_time_ms": 0.283, "load_throughput": 1359052177.875, "learn_time_ms": 26465.566, "learn_throughput": 14509.419, "update_time_ms": 31.854}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 0.7776585135020708, "policy_loss": 0.00031765513612251535, "vf_loss": 0.7920065130058088, "vf_explained_var": 0.00019110974512602153, "kl": 0.011639918798688373, "entropy": 1.4702033243681256, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9216000, "num_agent_steps_sampled": 9216000, "num_steps_trained": 9216000, "num_agent_steps_trained": 9216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 24, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-55-51", "timestamp": 1708851351, "time_this_iter_s": 119.45525121688843, "time_total_s": 2660.22110748291, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fcd84159d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2660.22110748291, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 32.647999999999996, "ram_util_percent": 29.8072, "gpu_util_percent0": 0.010719999999999999, "vram_util_percent0": 0.031209309895833332}}
{"episode_reward_max": -675.8062937784764, "episode_reward_min": -812.1938544646814, "episode_reward_mean": -717.2110027463355, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735.6526479161125, -752.5418910025837, -779.5977540833948, -753.472367140454, -758.3459272293032, -769.5487190764723, -732.050332059823, -747.0968990999336, -699.6793219578118, -810.3284489714235, -754.2509032791535, -722.1697173985755, -761.1284587186096, -769.9996809954416, -740.1973733932726, -799.4144554735992, -727.5890562784042, -753.9931874710635, -759.8768171497777, -756.9077829116262, -693.1495677824342, -709.7072325342043, -702.530241649725, -699.7302658006951, -681.1185898713937, -710.0219806800641, -699.5040558877317, -689.8180398586541, -675.8062937784764, -680.8084627322415, -715.6201930965959, -702.923290360786, -691.8477931436258, -707.8624442867117, -690.3068985950105, -693.6047177298208, -687.1203692980076, -713.9413467556988, -716.7940675542472, -689.3285704694401, -677.5701114659723, -696.8432068194898, -678.3452689876304, -694.8698325975447, -700.117675869182, -683.5186342268792, -707.9924643844266, -696.4519310756126, -696.6159586672279, -699.6619469747757, -697.5965268313042, -682.0811594703142, -681.5139434114169, -735.6223086617443, -686.2387108834447, -695.7959081938334, -687.5775839664789, -685.3454058957466, -684.4362485130429, -679.8388186086843, -750.7822173279428, -696.918250176576, -754.5505455527294, -812.1938544646814, -738.8365750413649, -735.5458076451607, -751.3058620511239, -717.8431682754008, -802.8999558119406, -769.2222879585103, -725.5181284976213, -713.7953157059441, -760.966629882568, -788.179455367543, -755.4390713490977, -766.7532010965245, -704.6645589151126, -690.4732121758135, -736.2310435181522, -733.4295038340757, -682.2083950931215, -698.3068421591955, -688.2137623843166, -689.4781217926492, -700.9619159546332, -691.6292519795054, -692.2854641757802, -690.9979399412265, -705.1394996688789, -691.432662527471, -693.6692379490871, -723.8304764944177, -689.6490557317424, -701.3865084359169, -703.6734907085348, -690.0140778557942, -691.8686100015759, -700.2857057217932, -711.3366897255152, -695.764112707347], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1163882581097027, "mean_inference_ms": 1.6042639548173754, "mean_action_processing_ms": 0.22470740665096206, "mean_env_wait_ms": 1.461460660729545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 20, "timesteps_total": 9600000, "timesteps_this_iter": 0, "agent_timesteps_total": 9600000, "timers": {"sample_time_ms": 115609.113, "sample_throughput": 3321.537, "load_time_ms": 0.286, "load_throughput": 1341618272.387, "learn_time_ms": 26573.853, "learn_throughput": 14450.295, "update_time_ms": 30.871}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005000000000000001, "total_loss": 0.5854817189668354, "policy_loss": 0.0009737718654306311, "vf_loss": 0.5991469590287459, "vf_explained_var": 0.000255509426719264, "kl": 0.0030476050823812044, "entropy": 1.4648536600564654, "entropy_coeff": 0.010000000000000002}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600000, "num_agent_steps_sampled": 9600000, "num_steps_trained": 9600000, "num_agent_steps_trained": 9600000, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 500, "training_iteration": 25, "trial_id": "7a67f_00000", "experiment_id": "45831085d10e4b24824ad69868346cff", "date": "2024-02-25_14-57-47", "timestamp": 1708851467, "time_this_iter_s": 116.59633827209473, "time_total_s": 2776.817445755005, "pid": 25679, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 20, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 20, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 20, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "twenty team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fca2c918c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2776.817445755005, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 32.77540983606558, "ram_util_percent": 30.461475409836066, "gpu_util_percent0": 0.00959016393442623, "vram_util_percent0": 0.03120930989583333}}
