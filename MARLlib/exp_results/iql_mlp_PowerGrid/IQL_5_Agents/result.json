{"episode_reward_max": -747.3203497405062, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -767.2367887167559, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22894653891921662, "mean_inference_ms": 1.1777158334277544, "mean_action_processing_ms": 0.13094310581870183, "mean_env_wait_ms": 0.6866178701124875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 4800, "timers": {"learn_time_ms": 1833.141, "learn_throughput": 1.091, "update_time_ms": 6.73}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9973804354667664, "grad_norm": 1.9822945594787598, "td_error_abs": 0.8955110677083333, "q_taken_mean": -0.0009192355473836263, "target_mean": -0.03712920888264974}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 4800, "num_steps_trained": 2, "num_agent_steps_trained": 9600, "last_target_update_ts": 0}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-11-31", "timestamp": 1708744291, "time_this_iter_s": 12.71153211593628, "time_total_s": 12.71153211593628, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 12.71153211593628, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 53.93888888888889, "ram_util_percent": 10.85, "gpu_util_percent0": 0.3333333333333333, "vram_util_percent0": 0.03994864004629631}}
{"episode_reward_max": -680.1573370374904, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -734.1081920799564, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23047998065789774, "mean_inference_ms": 1.1776400072737814, "mean_action_processing_ms": 0.13125812708292028, "mean_env_wait_ms": 0.6875512201497429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"learn_time_ms": 1778.688, "learn_throughput": 1.124, "update_time_ms": 6.864}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7385162115097046, "grad_norm": 1.86591637134552, "td_error_abs": 0.7297320149739583, "q_taken_mean": -0.060993937174479165, "target_mean": -0.042383201599121095}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 9600, "num_steps_trained": 4, "num_agent_steps_trained": 19200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 2, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-11-44", "timestamp": 1708744304, "time_this_iter_s": 12.758862733840942, "time_total_s": 25.47039484977722, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 25.47039484977722, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 54.62352941176471, "ram_util_percent": 11.617647058823529, "gpu_util_percent0": 0.3194117647058823, "vram_util_percent0": 0.039876302083333336}}
{"episode_reward_max": -604.8980466408726, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -706.5835404920915, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23157804000490048, "mean_inference_ms": 1.1791845355105157, "mean_action_processing_ms": 0.13141360202690722, "mean_env_wait_ms": 0.6886398952274179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"learn_time_ms": 1762.746, "learn_throughput": 1.135, "update_time_ms": 7.085}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.2836650609970093, "grad_norm": 9.167159080505371, "td_error_abs": 0.9626048177083333, "q_taken_mean": -0.08310291544596354, "target_mean": -0.03889124043782552}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 14400, "num_steps_trained": 6, "num_agent_steps_trained": 28800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-11-56", "timestamp": 1708744316, "time_this_iter_s": 12.754763841629028, "time_total_s": 38.22515869140625, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 38.22515869140625, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 54.40588235294118, "ram_util_percent": 11.641176470588235, "gpu_util_percent0": 0.32529411764705884, "vram_util_percent0": 0.039876302083333336}}
{"episode_reward_max": -530.4288046851387, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -666.2638914531944, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2334575444575186, "mean_inference_ms": 1.1869855503225684, "mean_action_processing_ms": 0.13220188858910473, "mean_env_wait_ms": 0.693494056176948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"learn_time_ms": 1780.845, "learn_throughput": 1.123, "update_time_ms": 7.9}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7631818652153015, "grad_norm": 1.974473476409912, "td_error_abs": 0.6859259440104166, "q_taken_mean": 0.027612325032552083, "target_mean": -0.03723699442545573}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 19200, "num_steps_trained": 8, "num_agent_steps_trained": 38400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-12-10", "timestamp": 1708744330, "time_this_iter_s": 13.842802286148071, "time_total_s": 52.06796097755432, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 52.06796097755432, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 54.88333333333333, "ram_util_percent": 11.87777777777778, "gpu_util_percent0": 0.3227777777777778, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -442.61645595100896, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -624.4823336160555, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2354218138784199, "mean_inference_ms": 1.1959769457420142, "mean_action_processing_ms": 0.1331170319257811, "mean_env_wait_ms": 0.6992572285092571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"learn_time_ms": 1868.061, "learn_throughput": 1.071, "update_time_ms": 11.297}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7030062079429626, "grad_norm": 1.1907249689102173, "td_error_abs": 0.548749755859375, "q_taken_mean": 0.09269058227539062, "target_mean": -0.033349558512369794}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 10, "num_agent_steps_trained": 48000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 5, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-12-25", "timestamp": 1708744345, "time_this_iter_s": 14.588414907455444, "time_total_s": 66.65637588500977, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 66.65637588500977, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.015, "ram_util_percent": 11.91, "gpu_util_percent0": 0.31949999999999995, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -410.9633636926808, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -590.509931131277, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23708379673279484, "mean_inference_ms": 1.203822310269809, "mean_action_processing_ms": 0.1339542411992321, "mean_env_wait_ms": 0.7042899706972533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"learn_time_ms": 1890.698, "learn_throughput": 1.058, "update_time_ms": 11.612}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6530001759529114, "grad_norm": 1.12428879737854, "td_error_abs": 0.521912109375, "q_taken_mean": 0.0769370829264323, "target_mean": -0.03699185434977213}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 28800, "num_steps_trained": 12, "num_agent_steps_trained": 57600, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 6, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-12-39", "timestamp": 1708744359, "time_this_iter_s": 14.089256286621094, "time_total_s": 80.74563217163086, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 80.74563217163086, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.5611111111111, "ram_util_percent": 11.966666666666667, "gpu_util_percent0": 0.31333333333333335, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -410.9633636926808, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -570.0415680597994, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23850743343138855, "mean_inference_ms": 1.2105720689591042, "mean_action_processing_ms": 0.13467471579415358, "mean_env_wait_ms": 0.708902520874486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 33600, "timers": {"learn_time_ms": 1894.899, "learn_throughput": 1.055, "update_time_ms": 10.991}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5659857392311096, "grad_norm": 0.8977499008178711, "td_error_abs": 0.4598514404296875, "q_taken_mean": 0.0667148691813151, "target_mean": -0.03189839680989583}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 33600, "num_steps_trained": 14, "num_agent_steps_trained": 67200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 7, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-12-53", "timestamp": 1708744373, "time_this_iter_s": 14.050100088119507, "time_total_s": 94.79573225975037, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 94.79573225975037, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.70526315789474, "ram_util_percent": 11.942105263157895, "gpu_util_percent0": 0.3252631578947368, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -227.15595959190978, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -529.2787144631271, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23979726377847674, "mean_inference_ms": 1.2171008186408556, "mean_action_processing_ms": 0.13537477154696773, "mean_env_wait_ms": 0.7132286629037929, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"learn_time_ms": 1946.998, "learn_throughput": 1.027, "update_time_ms": 10.879}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.48531803488731384, "grad_norm": 0.9065185189247131, "td_error_abs": 0.4141263427734375, "q_taken_mean": 0.022625033060709634, "target_mean": -0.03328560892740885}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 16, "num_agent_steps_trained": 76800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 8, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-13-08", "timestamp": 1708744388, "time_this_iter_s": 14.892475605010986, "time_total_s": 109.68820786476135, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 109.68820786476135, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.26315789473684, "ram_util_percent": 12.068421052631578, "gpu_util_percent0": 0.3163157894736842, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -227.15595959190978, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -507.41678163743336, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24096096667912784, "mean_inference_ms": 1.222950867011758, "mean_action_processing_ms": 0.13599576089450197, "mean_env_wait_ms": 0.7170875992909665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"learn_time_ms": 1933.564, "learn_throughput": 1.034, "update_time_ms": 10.52}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5520051121711731, "grad_norm": 4.450366973876953, "td_error_abs": 0.46992508951822914, "q_taken_mean": 0.2750591837565104, "target_mean": -0.03001337178548177}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 43200, "num_steps_trained": 18, "num_agent_steps_trained": 86400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 9, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-13-22", "timestamp": 1708744402, "time_this_iter_s": 14.15842318534851, "time_total_s": 123.84663105010986, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 123.84663105010986, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.31052631578948, "ram_util_percent": 12.063157894736841, "gpu_util_percent0": 0.3278947368421053, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -474.05583468240866, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24200096260414714, "mean_inference_ms": 1.2282340169225607, "mean_action_processing_ms": 0.13654095591730367, "mean_env_wait_ms": 0.7205223416496298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"learn_time_ms": 1950.748, "learn_throughput": 1.025, "update_time_ms": 10.991}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.815345048904419, "grad_norm": 3.7777388095855713, "td_error_abs": 0.552182373046875, "q_taken_mean": -0.0656203104654948, "target_mean": -0.030861320495605468}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 20, "num_agent_steps_trained": 96000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 10, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-13-37", "timestamp": 1708744417, "time_this_iter_s": 14.441108465194702, "time_total_s": 138.28773951530457, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 138.28773951530457, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 55.326315789473675, "ram_util_percent": 12.136842105263156, "gpu_util_percent0": 0.3289473684210526, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -448.79869770805817, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.243017035639546, "mean_inference_ms": 1.2334082964401616, "mean_action_processing_ms": 0.13707231001915518, "mean_env_wait_ms": 0.7238286850077116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 52800, "timers": {"learn_time_ms": 1965.957, "learn_throughput": 1.017, "update_time_ms": 14.019}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.066655158996582, "grad_norm": 3.2108023166656494, "td_error_abs": 0.6052999674479167, "q_taken_mean": 0.09223930867513021, "target_mean": -0.05022288513183594}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 52800, "num_steps_trained": 22, "num_agent_steps_trained": 105600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 55, "training_iteration": 11, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-13-51", "timestamp": 1708744431, "time_this_iter_s": 14.910905599594116, "time_total_s": 153.19864511489868, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 153.19864511489868, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 55.230000000000004, "ram_util_percent": 12.219999999999999, "gpu_util_percent0": 0.3195, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -428.3570181046126, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24396951612593698, "mean_inference_ms": 1.2380677075353337, "mean_action_processing_ms": 0.1375600627600971, "mean_env_wait_ms": 0.7269601541464061, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"learn_time_ms": 1973.315, "learn_throughput": 1.014, "update_time_ms": 14.293}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8998504281044006, "grad_norm": 4.378076076507568, "td_error_abs": 0.5421055501302083, "q_taken_mean": -0.08085743204752605, "target_mean": 0.1277518310546875}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 57600, "num_steps_trained": 24, "num_agent_steps_trained": 115200, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-14-06", "timestamp": 1708744446, "time_this_iter_s": 14.337997913360596, "time_total_s": 167.53664302825928, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 167.53664302825928, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.272222222222226, "ram_util_percent": 12.261111111111111, "gpu_util_percent0": 0.31888888888888883, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -409.58917215342905, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2448751358392504, "mean_inference_ms": 1.2425375954339408, "mean_action_processing_ms": 0.13802906933493497, "mean_env_wait_ms": 0.7299138699038682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 62400, "timers": {"learn_time_ms": 1977.816, "learn_throughput": 1.011, "update_time_ms": 16.443}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9010213017463684, "grad_norm": 3.339454412460327, "td_error_abs": 0.5336160074869791, "q_taken_mean": 0.27655084228515625, "target_mean": -0.020694483439127605}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 62400, "num_steps_trained": 26, "num_agent_steps_trained": 124800, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 65, "training_iteration": 13, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-14-21", "timestamp": 1708744461, "time_this_iter_s": 14.615604400634766, "time_total_s": 182.15224742889404, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 182.15224742889404, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 55.30999999999999, "ram_util_percent": 12.360000000000003, "gpu_util_percent0": 0.32599999999999996, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -393.5899567623846, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24566383829578844, "mean_inference_ms": 1.2464856171963934, "mean_action_processing_ms": 0.13845131182480988, "mean_env_wait_ms": 0.7324987244239387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"learn_time_ms": 1981.256, "learn_throughput": 1.009, "update_time_ms": 16.66}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9410064220428467, "grad_norm": 4.47109842300415, "td_error_abs": 0.5593955485026042, "q_taken_mean": -0.014808287302652995, "target_mean": -0.2656161295572917}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 67200, "num_steps_trained": 28, "num_agent_steps_trained": 134400, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 70, "training_iteration": 14, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-14-35", "timestamp": 1708744475, "time_this_iter_s": 14.24540901184082, "time_total_s": 196.39765644073486, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 196.39765644073486, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 55.18333333333333, "ram_util_percent": 12.283333333333335, "gpu_util_percent0": 0.3383333333333333, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -380.18036159978413, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24637618178534273, "mean_inference_ms": 1.2500876870904216, "mean_action_processing_ms": 0.13883949572806703, "mean_env_wait_ms": 0.7347902143515793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"learn_time_ms": 1957.029, "learn_throughput": 1.022, "update_time_ms": 15.404}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.884524405002594, "grad_norm": 4.961076736450195, "td_error_abs": 0.5433758951822917, "q_taken_mean": -0.08633895874023438, "target_mean": -0.2944748738606771}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 30, "num_agent_steps_trained": 144000, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 75, "training_iteration": 15, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-14-49", "timestamp": 1708744489, "time_this_iter_s": 14.338561534881592, "time_total_s": 210.73621797561646, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 210.73621797561646, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 54.805263157894736, "ram_util_percent": 12.378947368421054, "gpu_util_percent0": 0.32052631578947366, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -369.21563757506686, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24703677862980208, "mean_inference_ms": 1.2534944822670553, "mean_action_processing_ms": 0.13920534204331003, "mean_env_wait_ms": 0.7369971126683911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"learn_time_ms": 1938.314, "learn_throughput": 1.032, "update_time_ms": 14.956}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.0009982585906982, "grad_norm": 3.851752519607544, "td_error_abs": 0.5389596354166667, "q_taken_mean": -0.29657373046875, "target_mean": -0.16017838541666668}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 32, "num_agent_steps_trained": 153600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 80, "training_iteration": 16, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-15-04", "timestamp": 1708744504, "time_this_iter_s": 14.57057523727417, "time_total_s": 225.30679321289062, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 225.30679321289062, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.663157894736834, "ram_util_percent": 12.405263157894737, "gpu_util_percent0": 0.32315789473684203, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -359.6073505202435, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24766787831613588, "mean_inference_ms": 1.2566694258734126, "mean_action_processing_ms": 0.13954936343829513, "mean_env_wait_ms": 0.7391031072403519, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 81600, "timers": {"learn_time_ms": 1975.233, "learn_throughput": 1.013, "update_time_ms": 18.334}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9957764744758606, "grad_norm": 5.9719719886779785, "td_error_abs": 0.5651121826171875, "q_taken_mean": 0.1361445515950521, "target_mean": -0.1602600809733073}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 81600, "num_steps_trained": 34, "num_agent_steps_trained": 163200, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 85, "training_iteration": 17, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-15-19", "timestamp": 1708744519, "time_this_iter_s": 15.014817476272583, "time_total_s": 240.3216106891632, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 240.3216106891632, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 55.065, "ram_util_percent": 12.455, "gpu_util_percent0": 0.32, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -350.9975728508771, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24825385084770002, "mean_inference_ms": 1.2596102365086257, "mean_action_processing_ms": 0.1398626124031521, "mean_env_wait_ms": 0.7410226594622071, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"learn_time_ms": 1944.337, "learn_throughput": 1.029, "update_time_ms": 18.153}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9171304702758789, "grad_norm": 4.210099220275879, "td_error_abs": 0.536396484375, "q_taken_mean": -0.3299173787434896, "target_mean": -0.15356483968098958}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 86400, "num_steps_trained": 36, "num_agent_steps_trained": 172800, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 90, "training_iteration": 18, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-15-33", "timestamp": 1708744533, "time_this_iter_s": 14.460439205169678, "time_total_s": 254.78204989433289, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 254.78204989433289, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 55.47777777777778, "ram_util_percent": 12.511111111111111, "gpu_util_percent0": 0.3155555555555556, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -343.3832900989886, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24882205593054005, "mean_inference_ms": 1.2623754164460128, "mean_action_processing_ms": 0.14016006826127772, "mean_env_wait_ms": 0.7428811755588437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 91200, "timers": {"learn_time_ms": 1969.645, "learn_throughput": 1.015, "update_time_ms": 18.25}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8637345433235168, "grad_norm": 2.2829344272613525, "td_error_abs": 0.5043953450520834, "q_taken_mean": -0.038373990376790366, "target_mean": -0.15771509806315104}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 91200, "num_steps_trained": 38, "num_agent_steps_trained": 182400, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 95, "training_iteration": 19, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-15-48", "timestamp": 1708744548, "time_this_iter_s": 14.841217517852783, "time_total_s": 269.62326741218567, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 269.62326741218567, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.35, "ram_util_percent": 12.624999999999998, "gpu_util_percent0": 0.32299999999999995, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -802.0073114047096, "episode_reward_mean": -336.49584496947557, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.0073114047096, -758.2258526323436, -747.3203497405062, -759.3283165826996, -769.3021132235203, -680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2493280624245695, "mean_inference_ms": 1.26487341960286, "mean_action_processing_ms": 0.140430261026996, "mean_env_wait_ms": 0.7445786143927917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"learn_time_ms": 1943.223, "learn_throughput": 1.029, "update_time_ms": 17.518}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.838032066822052, "grad_norm": 1.3502483367919922, "td_error_abs": 0.5004557698567709, "q_taken_mean": -0.18966156005859375, "target_mean": -0.15871084594726562}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 40, "num_agent_steps_trained": 192000, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 20, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-16-02", "timestamp": 1708744562, "time_this_iter_s": 14.16476035118103, "time_total_s": 283.7880277633667, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 283.7880277633667, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 55.06111111111111, "ram_util_percent": 12.633333333333335, "gpu_util_percent0": 0.3111111111111111, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -726.6589823954441, "episode_reward_mean": -308.40914374933794, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.1573370374904, -688.0713567162223, -695.4233611541529, -726.6589823954441, -714.5869399124753, -649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2508524722365228, "mean_inference_ms": 1.271697952559042, "mean_action_processing_ms": 0.14117098661385755, "mean_env_wait_ms": 0.7491675844681212, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"learn_time_ms": 1964.645, "learn_throughput": 1.018, "update_time_ms": 14.686}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.797188401222229, "grad_norm": 0.920830249786377, "td_error_abs": 0.49473388671875, "q_taken_mean": -0.13400717163085937, "target_mean": -0.15920477294921875}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 100800, "num_steps_trained": 42, "num_agent_steps_trained": 201600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 105, "training_iteration": 21, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-16-17", "timestamp": 1708744577, "time_this_iter_s": 14.829206943511963, "time_total_s": 298.61723470687866, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 298.61723470687866, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.20000000000001, "ram_util_percent": 12.8, "gpu_util_percent0": 0.3155, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -680.6057970412326, "episode_reward_mean": -283.68330723279445, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-649.2530167449927, -677.6856389578884, -604.8980466408726, -680.6057970412326, -645.2286871968232, -557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25224677726785893, "mean_inference_ms": 1.2786516275795352, "mean_action_processing_ms": 0.141893737832264, "mean_env_wait_ms": 0.7537424974151048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"learn_time_ms": 1984.828, "learn_throughput": 1.008, "update_time_ms": 14.66}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7537188529968262, "grad_norm": 1.0824276208877563, "td_error_abs": 0.48972216796875, "q_taken_mean": -0.17485015869140624, "target_mean": -0.1596552530924479}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 105600, "num_steps_trained": 44, "num_agent_steps_trained": 211200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 110, "training_iteration": 22, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-16-32", "timestamp": 1708744592, "time_this_iter_s": 14.733851432800293, "time_total_s": 313.35108613967896, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 313.35108613967896, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 55.61052631578947, "ram_util_percent": 12.815789473684212, "gpu_util_percent0": 0.3221052631578947, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -561.3804675496475, "episode_reward_mean": -261.37760531013686, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-557.4153291949027, -537.462083884172, -530.4288046851387, -539.8380363686534, -561.3804675496475, -459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2535769747448653, "mean_inference_ms": 1.285469753883431, "mean_action_processing_ms": 0.14261879838765268, "mean_env_wait_ms": 0.7582760920304428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 110400, "timesteps_this_iter": 0, "agent_timesteps_total": 110400, "timers": {"learn_time_ms": 2012.496, "learn_throughput": 0.994, "update_time_ms": 12.737}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7167760133743286, "grad_norm": 1.055275797843933, "td_error_abs": 0.49014851888020833, "q_taken_mean": -0.1501004842122396, "target_mean": -0.13357861328125}}}, "num_steps_sampled": 110400, "num_agent_steps_sampled": 110400, "num_steps_trained": 46, "num_agent_steps_trained": 220800, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 115, "training_iteration": 23, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-16-47", "timestamp": 1708744607, "time_this_iter_s": 14.86988639831543, "time_total_s": 328.2209725379944, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 328.2209725379944, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 55.421052631578945, "ram_util_percent": 12.9, "gpu_util_percent0": 0.3157894736842105, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -476.67610476884676, "episode_reward_mean": -244.4147538497685, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-459.644180964964, -455.98026175574824, -476.67610476884676, -451.8635078969316, -442.61645595100896, -420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2546588552647783, "mean_inference_ms": 1.2909381551992973, "mean_action_processing_ms": 0.14320481941189298, "mean_env_wait_ms": 0.7619606630110392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"learn_time_ms": 2026.15, "learn_throughput": 0.987, "update_time_ms": 12.827}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6828191876411438, "grad_norm": 0.9801183342933655, "td_error_abs": 0.49151338704427083, "q_taken_mean": -0.12438975016276042, "target_mean": -0.13362601725260417}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 115200, "num_steps_trained": 48, "num_agent_steps_trained": 230400, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 120, "training_iteration": 24, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-17-01", "timestamp": 1708744621, "time_this_iter_s": 14.472710371017456, "time_total_s": 342.69368290901184, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 342.69368290901184, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 55.08947368421054, "ram_util_percent": 13.015789473684208, "gpu_util_percent0": 0.3157894736842105, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -456.4898604291252, "episode_reward_mean": -231.84519634558472, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.98395999482324, -413.80359068568697, -433.23190558817265, -410.9633636926808, -424.2567735755597, -442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25554598383881855, "mean_inference_ms": 1.2954461349544664, "mean_action_processing_ms": 0.1436927223805978, "mean_env_wait_ms": 0.7650031877283098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"learn_time_ms": 2033.911, "learn_throughput": 0.983, "update_time_ms": 12.548}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6437609791755676, "grad_norm": 1.3613865375518799, "td_error_abs": 0.4807176513671875, "q_taken_mean": -0.17685508219401042, "target_mean": -0.1330797627766927}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 50, "num_agent_steps_trained": 240000, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 125, "training_iteration": 25, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-17-16", "timestamp": 1708744636, "time_this_iter_s": 14.867863178253174, "time_total_s": 357.561546087265, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 357.561546087265, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 55.23684210526316, "ram_util_percent": 13.094736842105263, "gpu_util_percent0": 0.3131578947368421, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -456.4898604291252, "episode_reward_mean": -221.0515464059437, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-442.5381062117274, -447.6952714658146, -456.4898604291252, -436.32161715544424, -453.1120928925554, -227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25634314309963246, "mean_inference_ms": 1.2995295998830596, "mean_action_processing_ms": 0.14412089137065842, "mean_env_wait_ms": 0.7677343741821951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"learn_time_ms": 2050.596, "learn_throughput": 0.975, "update_time_ms": 12.538}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6303738951683044, "grad_norm": 2.136857032775879, "td_error_abs": 0.48827742513020833, "q_taken_mean": -0.08201132202148438, "target_mean": -0.133953857421875}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 124800, "num_steps_trained": 52, "num_agent_steps_trained": 249600, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 130, "training_iteration": 26, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-17-31", "timestamp": 1708744651, "time_this_iter_s": 14.78592586517334, "time_total_s": 372.34747195243835, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 372.34747195243835, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 55.16842105263158, "ram_util_percent": 13.094736842105263, "gpu_util_percent0": 0.3294736842105263, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -340.7506161179163, "episode_reward_mean": -209.05027739128, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.15595959190978, -256.8885887899178, -274.3189367337821, -233.18192992380247, -228.14828139269335, -330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2570636851808518, "mean_inference_ms": 1.3033105565192207, "mean_action_processing_ms": 0.14450963309322115, "mean_env_wait_ms": 0.7701438938887246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 129600, "timesteps_this_iter": 0, "agent_timesteps_total": 129600, "timers": {"learn_time_ms": 2007.455, "learn_throughput": 0.996, "update_time_ms": 9.27}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6434453725814819, "grad_norm": 5.155529022216797, "td_error_abs": 0.5080091959635417, "q_taken_mean": -0.3137184855143229, "target_mean": -0.13491016642252604}}}, "num_steps_sampled": 129600, "num_agent_steps_sampled": 129600, "num_steps_trained": 54, "num_agent_steps_trained": 259200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 135, "training_iteration": 27, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-17-46", "timestamp": 1708744666, "time_this_iter_s": 14.52567172050476, "time_total_s": 386.8731436729431, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 386.8731436729431, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 54.873684210526314, "ram_util_percent": 13.321052631578949, "gpu_util_percent0": 0.32894736842105265, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -340.7506161179163, "episode_reward_mean": -207.14169832691093, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-330.4302183518752, -332.72451135732086, -331.7642886613309, -326.93696067097255, -340.7506161179163, -171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2577107814760034, "mean_inference_ms": 1.306598509190108, "mean_action_processing_ms": 0.14484493368487505, "mean_env_wait_ms": 0.7722873797045525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"learn_time_ms": 2004.246, "learn_throughput": 0.998, "update_time_ms": 11.757}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6403899192810059, "grad_norm": 10.089668273925781, "td_error_abs": 0.5246020914713542, "q_taken_mean": 0.17052708943684897, "target_mean": -0.13189669799804687}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 134400, "num_steps_trained": 56, "num_agent_steps_trained": 268800, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 140, "training_iteration": 28, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-18-01", "timestamp": 1708744681, "time_this_iter_s": 14.86402177810669, "time_total_s": 401.7371654510498, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 401.7371654510498, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 55.415000000000006, "ram_util_percent": 13.315000000000001, "gpu_util_percent0": 0.3235, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -171.00049434060108, "episode_reward_min": -1043.2586822488697, "episode_reward_mean": -242.01986711548983, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.00049434060108, -173.0801844671836, -172.84410189209586, -179.4741888388011, -172.6375908972527, -198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2582925625544197, "mean_inference_ms": 1.309636835432553, "mean_action_processing_ms": 0.1451551845132456, "mean_env_wait_ms": 0.7742017574724582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 139200, "timesteps_this_iter": 0, "agent_timesteps_total": 139200, "timers": {"learn_time_ms": 1993.311, "learn_throughput": 1.003, "update_time_ms": 12.699}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9070733189582825, "grad_norm": 15.734152793884277, "td_error_abs": 0.6737618815104167, "q_taken_mean": -0.5533927815755209, "target_mean": -1.04732177734375}}}, "num_steps_sampled": 139200, "num_agent_steps_sampled": 139200, "num_steps_trained": 58, "num_agent_steps_trained": 278400, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 145, "training_iteration": 29, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-18-15", "timestamp": 1708744695, "time_this_iter_s": 14.71379280090332, "time_total_s": 416.4509582519531, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 416.4509582519531, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.126315789473686, "ram_util_percent": 13.357894736842105, "gpu_util_percent0": 0.3173684210526315, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -179.02631141742322, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -296.09192017762126, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.03454633745912, -196.85295675671566, -197.56248041543256, -192.49754254270795, -196.1891137704524, -207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2588324244559279, "mean_inference_ms": 1.3124691826880237, "mean_action_processing_ms": 0.1454499251043479, "mean_env_wait_ms": 0.7759455469094507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"learn_time_ms": 1997.203, "learn_throughput": 1.001, "update_time_ms": 12.699}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 2.5334062576293945, "grad_norm": 41.81094741821289, "td_error_abs": 1.3689627278645833, "q_taken_mean": -0.2619281209309896, "target_mean": -1.1992850748697916}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 60, "num_agent_steps_trained": 288000, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 150, "training_iteration": 30, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-18-30", "timestamp": 1708744710, "time_this_iter_s": 14.570665836334229, "time_total_s": 431.02162408828735, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 431.02162408828735, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.08888888888889, "ram_util_percent": 13.427777777777779, "gpu_util_percent0": 0.31777777777777777, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -179.02631141742322, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -335.8300426784426, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.21321890512462, -202.68979065261573, -198.75268673537533, -198.1991345279606, -210.63788151247974, -188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.259297878663485, "mean_inference_ms": 1.3149326359905218, "mean_action_processing_ms": 0.1457068630192712, "mean_env_wait_ms": 0.7774535373729599, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 148800, "timesteps_this_iter": 0, "agent_timesteps_total": 148800, "timers": {"learn_time_ms": 1984.893, "learn_throughput": 1.008, "update_time_ms": 13.011}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.6770638227462769, "grad_norm": 15.054450988769531, "td_error_abs": 1.0252071940104166, "q_taken_mean": -1.0622998046875, "target_mean": -1.0835648600260417}}}, "num_steps_sampled": 148800, "num_agent_steps_sampled": 148800, "num_steps_trained": 62, "num_agent_steps_trained": 297600, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 155, "training_iteration": 31, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-18-45", "timestamp": 1708744725, "time_this_iter_s": 14.934357166290283, "time_total_s": 445.95598125457764, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 445.95598125457764, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.30499999999999, "ram_util_percent": 13.430000000000001, "gpu_util_percent0": 0.31849999999999995, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -179.02631141742322, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -336.1272031089525, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.3942206063378, -179.02631141742322, -179.05546093962394, -187.03942996142362, -188.35968077132173, -186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.259705192776753, "mean_inference_ms": 1.3172452205177987, "mean_action_processing_ms": 0.14594035107350511, "mean_env_wait_ms": 0.7787647864805366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 153600, "timers": {"learn_time_ms": 1974.884, "learn_throughput": 1.013, "update_time_ms": 12.958}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5020193457603455, "grad_norm": 3.110910654067993, "td_error_abs": 0.4600650634765625, "q_taken_mean": -0.728165771484375, "target_mean": -0.549823486328125}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 153600, "num_steps_trained": 64, "num_agent_steps_trained": 307200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 160, "training_iteration": 32, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-19-00", "timestamp": 1708744740, "time_this_iter_s": 14.65135908126831, "time_total_s": 460.60734033584595, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 460.60734033584595, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.3842105263158, "ram_util_percent": 13.636842105263156, "gpu_util_percent0": 0.31631578947368416, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -180.99440766645523, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -337.31334694112024, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.54023116526994, -191.32567462081255, -187.63428846550394, -181.50618147599394, -180.99440766645523, -188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2600570266802831, "mean_inference_ms": 1.3192675528770306, "mean_action_processing_ms": 0.14614086657412906, "mean_env_wait_ms": 0.7799150546107328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 158400, "timesteps_this_iter": 0, "agent_timesteps_total": 158400, "timers": {"learn_time_ms": 2002.955, "learn_throughput": 0.999, "update_time_ms": 13.138}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.2570135593414307, "grad_norm": 19.843332290649414, "td_error_abs": 0.8403968912760417, "q_taken_mean": 0.24400433349609374, "target_mean": -0.5489049886067708}}}, "num_steps_sampled": 158400, "num_agent_steps_sampled": 158400, "num_steps_trained": 66, "num_agent_steps_trained": 316800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 165, "training_iteration": 33, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-19-15", "timestamp": 1708744755, "time_this_iter_s": 15.056259393692017, "time_total_s": 475.66359972953796, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 475.66359972953796, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 55.363157894736844, "ram_util_percent": 13.647368421052633, "gpu_util_percent0": 0.31789473684210523, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -188.39732465586246, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -338.33199951531503, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.39732465586246, -191.6222438008705, -193.93303841396752, -194.7649233260191, -193.51261642016343, -204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26039564768460327, "mean_inference_ms": 1.321204468634445, "mean_action_processing_ms": 0.1463261836278312, "mean_env_wait_ms": 0.7810412786198188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 163200, "timers": {"learn_time_ms": 1991.542, "learn_throughput": 1.004, "update_time_ms": 12.651}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7079167366027832, "grad_norm": 2.5952718257904053, "td_error_abs": 0.432325439453125, "q_taken_mean": -0.4958416748046875, "target_mean": -0.4734781494140625}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 163200, "num_steps_trained": 68, "num_agent_steps_trained": 326400, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 170, "training_iteration": 34, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-19-29", "timestamp": 1708744769, "time_this_iter_s": 14.308632373809814, "time_total_s": 489.9722321033478, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 489.9722321033478, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 55.27894736842105, "ram_util_percent": 13.700000000000001, "gpu_util_percent0": 0.32, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -200.57700918405297, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -339.1488472336676, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.02625747177805, -203.47966734392128, -203.98529312882403, -207.13315454991752, -205.0995135271014, -203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26073214163144137, "mean_inference_ms": 1.3230971850993796, "mean_action_processing_ms": 0.14650410268148956, "mean_env_wait_ms": 0.7822203183165041, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"learn_time_ms": 1988.742, "learn_throughput": 1.006, "update_time_ms": 12.935}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6584277153015137, "grad_norm": 2.349168539047241, "td_error_abs": 0.42233772786458335, "q_taken_mean": -0.342981201171875, "target_mean": -0.47264404296875}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 70, "num_agent_steps_trained": 336000, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 175, "training_iteration": 35, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-19-44", "timestamp": 1708744784, "time_this_iter_s": 15.289349555969238, "time_total_s": 505.261581659317, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 505.261581659317, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 55.57368421052631, "ram_util_percent": 13.74736842105263, "gpu_util_percent0": 0.3173684210526315, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -200.57700918405297, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -339.3138656206333, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.3616011794474, -205.93353102210503, -206.33624846482374, -205.46160753861227, -208.2808000103596, -205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2610482006146697, "mean_inference_ms": 1.3247909089822274, "mean_action_processing_ms": 0.14666060125775443, "mean_env_wait_ms": 0.783266825455534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"learn_time_ms": 1994.791, "learn_throughput": 1.003, "update_time_ms": 13.59}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.620373010635376, "grad_norm": 3.891420364379883, "td_error_abs": 0.42432181803385416, "q_taken_mean": -0.54104052734375, "target_mean": -0.47097928873697914}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 172800, "num_steps_trained": 72, "num_agent_steps_trained": 345600, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 180, "training_iteration": 36, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-19-59", "timestamp": 1708744799, "time_this_iter_s": 14.62512493133545, "time_total_s": 519.8867065906525, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 519.8867065906525, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 55.26842105263159, "ram_util_percent": 13.752631578947366, "gpu_util_percent0": 0.3178947368421053, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -200.57700918405297, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -339.54520787148414, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205.38750205898378, -202.7490989546889, -206.6500970943036, -206.58443451837383, -201.78562973188767, -203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2613305678206461, "mean_inference_ms": 1.3263626949930738, "mean_action_processing_ms": 0.14680080304280257, "mean_env_wait_ms": 0.784206906258034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 177600, "timesteps_this_iter": 0, "agent_timesteps_total": 177600, "timers": {"learn_time_ms": 2000.911, "learn_throughput": 1.0, "update_time_ms": 13.576}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6212921738624573, "grad_norm": 5.85585880279541, "td_error_abs": 0.4365830078125, "q_taken_mean": -0.25106646728515625, "target_mean": -0.471691650390625}}}, "num_steps_sampled": 177600, "num_agent_steps_sampled": 177600, "num_steps_trained": 74, "num_agent_steps_trained": 355200, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 185, "training_iteration": 37, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-20-14", "timestamp": 1708744814, "time_this_iter_s": 14.531394243240356, "time_total_s": 534.4181008338928, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 534.4181008338928, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 55.357894736842105, "ram_util_percent": 13.957894736842105, "gpu_util_percent0": 0.3168421052631579, "vram_util_percent0": 0.03987630208333334}}
{"episode_reward_max": -187.78886644494432, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -338.8976776911698, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.29576000502368, -205.6683084547566, -207.3012702101293, -209.0058291132606, -206.35983504181294, -205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26160927584715127, "mean_inference_ms": 1.3278914182865007, "mean_action_processing_ms": 0.14694137190856135, "mean_env_wait_ms": 0.7851347740989236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 182400, "timers": {"learn_time_ms": 1996.994, "learn_throughput": 1.002, "update_time_ms": 11.188}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6503510475158691, "grad_norm": 8.94034194946289, "td_error_abs": 0.468906982421875, "q_taken_mean": -0.7338802897135417, "target_mean": -0.512609375}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 182400, "num_steps_trained": 76, "num_agent_steps_trained": 364800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 190, "training_iteration": 38, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-20-28", "timestamp": 1708744828, "time_this_iter_s": 14.887121677398682, "time_total_s": 549.3052225112915, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 549.3052225112915, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 56.22105263157895, "ram_util_percent": 13.915789473684208, "gpu_util_percent0": 0.31421052631578944, "vram_util_percent0": 0.03983132881030702}}
{"episode_reward_max": -187.78886644494432, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -338.960810221793, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205.70483549236977, -204.7524806948225, -205.81051811203062, -203.91408442792823, -207.99001881648147, -206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2618689544013037, "mean_inference_ms": 1.3293885125513851, "mean_action_processing_ms": 0.14707511112170504, "mean_env_wait_ms": 0.7860109643638072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 187200, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"learn_time_ms": 1999.01, "learn_throughput": 1.0, "update_time_ms": 10.268}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.844892680644989, "grad_norm": 6.969422340393066, "td_error_abs": 0.532696044921875, "q_taken_mean": -0.29117293294270835, "target_mean": -0.47571830240885415}}}, "num_steps_sampled": 187200, "num_agent_steps_sampled": 187200, "num_steps_trained": 78, "num_agent_steps_trained": 374400, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 195, "training_iteration": 39, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-20-44", "timestamp": 1708744844, "time_this_iter_s": 15.22098970413208, "time_total_s": 564.5262122154236, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 564.5262122154236, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 55.88421052631579, "ram_util_percent": 14.084210526315788, "gpu_util_percent0": 0.32526315789473687, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -184.17662607156996, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -338.0032252029736, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.23965339662215, -203.08888620494767, -203.3176096380359, -210.2458761042727, -204.62179622614434, -204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2621327266093702, "mean_inference_ms": 1.3308900489753297, "mean_action_processing_ms": 0.14720700678651635, "mean_env_wait_ms": 0.78685700085333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"learn_time_ms": 2002.781, "learn_throughput": 0.999, "update_time_ms": 10.32}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.556232213973999, "grad_norm": 0.8660409450531006, "td_error_abs": 0.41020279947916666, "q_taken_mean": -0.4724884440104167, "target_mean": -0.5218882242838542}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 80, "num_agent_steps_trained": 384000, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 40, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-20-58", "timestamp": 1708744858, "time_this_iter_s": 14.414345979690552, "time_total_s": 578.9405581951141, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 578.9405581951141, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 55.126315789473686, "ram_util_percent": 14.131578947368421, "gpu_util_percent0": 0.321578947368421, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -184.17662607156996, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -337.06376065589023, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.3947183251454, -212.62505335259374, -203.93596961509053, -208.65041099953658, -202.70817326907346, -204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26237663854057, "mean_inference_ms": 1.332347076110382, "mean_action_processing_ms": 0.14733435554975802, "mean_env_wait_ms": 0.7876474384387913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 196800, "timesteps_this_iter": 0, "agent_timesteps_total": 196800, "timers": {"learn_time_ms": 2012.522, "learn_throughput": 0.994, "update_time_ms": 10.103}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.0222556591033936, "grad_norm": 5.925516128540039, "td_error_abs": 0.5647787272135417, "q_taken_mean": -0.3961025390625, "target_mean": -0.5291134440104167}}}, "num_steps_sampled": 196800, "num_agent_steps_sampled": 196800, "num_steps_trained": 82, "num_agent_steps_trained": 393600, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 205, "training_iteration": 41, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-21-13", "timestamp": 1708744873, "time_this_iter_s": 15.043278694152832, "time_total_s": 593.983836889267, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 593.983836889267, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.54736842105264, "ram_util_percent": 14.18421052631579, "gpu_util_percent0": 0.3126315789473684, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -184.17662607156996, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -337.09383714042156, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.62605877327817, -202.78786878067208, -205.8683563034714, -209.42609496541326, -204.39261549321176, -206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.262601985490954, "mean_inference_ms": 1.333762931849752, "mean_action_processing_ms": 0.14745162645342066, "mean_env_wait_ms": 0.7883943266874366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"learn_time_ms": 2023.6, "learn_throughput": 0.988, "update_time_ms": 10.267}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8957884311676025, "grad_norm": 9.462625503540039, "td_error_abs": 0.5852972005208333, "q_taken_mean": -0.7450305989583333, "target_mean": -0.47620235188802085}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 201600, "num_steps_trained": 84, "num_agent_steps_trained": 403200, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 210, "training_iteration": 42, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-21-28", "timestamp": 1708744888, "time_this_iter_s": 15.059046983718872, "time_total_s": 609.0428838729858, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 609.0428838729858, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 55.800000000000004, "ram_util_percent": 14.205263157894736, "gpu_util_percent0": 0.3210526315789474, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.40077146482767, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -336.169994442032, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.05028738827116, -203.95748896309397, -207.4844063865362, -206.09618106955966, -206.65121183821864, -206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26280877357967286, "mean_inference_ms": 1.3351237411075516, "mean_action_processing_ms": 0.14756057624955082, "mean_env_wait_ms": 0.7890692089634203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 206400, "timesteps_this_iter": 0, "agent_timesteps_total": 206400, "timers": {"learn_time_ms": 1998.312, "learn_throughput": 1.001, "update_time_ms": 10.168}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8170667290687561, "grad_norm": 6.235344886779785, "td_error_abs": 0.5238756510416667, "q_taken_mean": -0.2008531494140625, "target_mean": -0.5234430338541667}}}, "num_steps_sampled": 206400, "num_agent_steps_sampled": 206400, "num_steps_trained": 86, "num_agent_steps_trained": 412800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 215, "training_iteration": 43, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-21-43", "timestamp": 1708744903, "time_this_iter_s": 14.787126541137695, "time_total_s": 623.8300104141235, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 623.8300104141235, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 55.33157894736842, "ram_util_percent": 14.289473684210526, "gpu_util_percent0": 0.3252631578947368, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.40077146482767, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -336.2646685701766, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.04307985238404, -207.00289333092104, -204.4021467991302, -203.49276788455035, -208.88387305213845, -208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2630081268852927, "mean_inference_ms": 1.336508814565974, "mean_action_processing_ms": 0.14767401541101705, "mean_env_wait_ms": 0.7897940255092096, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 211200, "timesteps_this_iter": 0, "agent_timesteps_total": 211200, "timers": {"learn_time_ms": 2011.892, "learn_throughput": 0.994, "update_time_ms": 10.215}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8787678480148315, "grad_norm": 3.8651938438415527, "td_error_abs": 0.5267994384765625, "q_taken_mean": -0.6018819580078125, "target_mean": -0.47901790364583335}}}, "num_steps_sampled": 211200, "num_agent_steps_sampled": 211200, "num_steps_trained": 88, "num_agent_steps_trained": 422400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 220, "training_iteration": 44, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-21-58", "timestamp": 1708744918, "time_this_iter_s": 15.193557262420654, "time_total_s": 639.0235676765442, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 639.0235676765442, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 56.08947368421052, "ram_util_percent": 14.336842105263159, "gpu_util_percent0": 0.3089473684210526, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.40077146482767, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -335.3767634572562, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.1538337693962, -205.6667917232655, -202.32345381541094, -201.36146191479057, -206.3690583499567, -207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.263203661236011, "mean_inference_ms": 1.337872705804138, "mean_action_processing_ms": 0.14778078853783788, "mean_env_wait_ms": 0.7904844061246902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"learn_time_ms": 2016.541, "learn_throughput": 0.992, "update_time_ms": 9.797}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7112962007522583, "grad_norm": 4.267397880554199, "td_error_abs": 0.4859928792317708, "q_taken_mean": -0.3646366373697917, "target_mean": -0.2102784423828125}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 90, "num_agent_steps_trained": 432000, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 225, "training_iteration": 45, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-22-14", "timestamp": 1708744934, "time_this_iter_s": 15.210071802139282, "time_total_s": 654.2336394786835, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 654.2336394786835, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 55.894999999999996, "ram_util_percent": 14.375, "gpu_util_percent0": 0.31500000000000006, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -334.4918217107985, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.46416365392568, -205.56162465677465, -208.97657581674935, -206.02741767746053, -208.00026488338625, -207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26338163903112494, "mean_inference_ms": 1.3391010050376488, "mean_action_processing_ms": 0.1478779324732176, "mean_env_wait_ms": 0.7911188206859127, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220800, "timesteps_this_iter": 0, "agent_timesteps_total": 220800, "timers": {"learn_time_ms": 2020.254, "learn_throughput": 0.99, "update_time_ms": 9.326}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7969508171081543, "grad_norm": 3.8405303955078125, "td_error_abs": 0.5168953043619792, "q_taken_mean": -0.10694917805989583, "target_mean": -0.2140575968424479}}}, "num_steps_sampled": 220800, "num_agent_steps_sampled": 220800, "num_steps_trained": 92, "num_agent_steps_trained": 441600, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 230, "training_iteration": 46, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-22-28", "timestamp": 1708744948, "time_this_iter_s": 14.54000186920166, "time_total_s": 668.7736413478851, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 668.7736413478851, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 55.483333333333334, "ram_util_percent": 14.416666666666666, "gpu_util_percent0": 0.32555555555555554, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -334.4184649350494, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.39531735543872, -202.72291123982532, -203.51747512039572, -207.1592726959334, -208.04081358360364, -1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2635500428940815, "mean_inference_ms": 1.3402431667516876, "mean_action_processing_ms": 0.14796982582877835, "mean_env_wait_ms": 0.791710002387422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 225600, "timesteps_this_iter": 0, "agent_timesteps_total": 225600, "timers": {"learn_time_ms": 2028.081, "learn_throughput": 0.986, "update_time_ms": 9.483}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7858341336250305, "grad_norm": 3.1889922618865967, "td_error_abs": 0.5098723958333333, "q_taken_mean": -0.3416971028645833, "target_mean": -0.43786006673177086}}}, "num_steps_sampled": 225600, "num_agent_steps_sampled": 225600, "num_steps_trained": 94, "num_agent_steps_trained": 451200, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 235, "training_iteration": 47, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-22-43", "timestamp": 1708744963, "time_this_iter_s": 14.487544059753418, "time_total_s": 683.2611854076385, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 683.2611854076385, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 54.98421052631579, "ram_util_percent": 14.531578947368422, "gpu_util_percent0": 0.3252631578947368, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -334.6495264058552, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1038.8639776566943, -1043.2586822488697, -1030.730938605912, -1017.4713775852337, -1020.0984979205961, -1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2637093423435389, "mean_inference_ms": 1.3413615864364823, "mean_action_processing_ms": 0.14805453095773202, "mean_env_wait_ms": 0.7922514037455227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 230400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"learn_time_ms": 2050.879, "learn_throughput": 0.975, "update_time_ms": 9.856}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6474430561065674, "grad_norm": 5.87704610824585, "td_error_abs": 0.4538468424479167, "q_taken_mean": -0.19458382161458335, "target_mean": -0.432717041015625}}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230400, "num_steps_trained": 96, "num_agent_steps_trained": 460800, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 240, "training_iteration": 48, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-22-58", "timestamp": 1708744978, "time_this_iter_s": 15.212785243988037, "time_total_s": 698.4739706516266, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 698.4739706516266, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 55.752631578947366, "ram_util_percent": 14.521052631578947, "gpu_util_percent0": 0.31105263157894736, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -1261.4375953721396, "episode_reward_mean": -292.5527528059564, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1246.6209800704398, -1258.3967134607676, -1256.8697404313516, -1252.91683731438, -1261.4375953721396, -974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2638773404466823, "mean_inference_ms": 1.3424166852757293, "mean_action_processing_ms": 0.14813305975011798, "mean_env_wait_ms": 0.7928441594725919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 235200, "timesteps_this_iter": 0, "agent_timesteps_total": 235200, "timers": {"learn_time_ms": 2039.243, "learn_throughput": 0.981, "update_time_ms": 9.812}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7280276417732239, "grad_norm": 7.857828140258789, "td_error_abs": 0.5136824544270834, "q_taken_mean": -0.660961669921875, "target_mean": -0.41594083658854164}}}, "num_steps_sampled": 235200, "num_agent_steps_sampled": 235200, "num_steps_trained": 98, "num_agent_steps_trained": 470400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 245, "training_iteration": 49, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-23-13", "timestamp": 1708744993, "time_this_iter_s": 14.846787214279175, "time_total_s": 713.3207578659058, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 713.3207578659058, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 55.65263157894737, "ram_util_percent": 14.689473684210524, "gpu_util_percent0": 0.32315789473684203, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -1005.8733329842984, "episode_reward_mean": -240.15086894662298, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-974.7536952015347, -998.289406274914, -1005.8733329842984, -992.52455864731, -983.5078967968434, -213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26404244627233087, "mean_inference_ms": 1.3434355940951515, "mean_action_processing_ms": 0.14820749694997645, "mean_env_wait_ms": 0.7934815785839061, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"learn_time_ms": 2056.066, "learn_throughput": 0.973, "update_time_ms": 9.989}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7451942563056946, "grad_norm": 9.350539207458496, "td_error_abs": 0.5186201985677084, "q_taken_mean": -0.1433197021484375, "target_mean": -0.4366815185546875}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 100, "num_agent_steps_trained": 480000, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "evaluation": {"episode_reward_max": -164.34486202571665, "episode_reward_min": -174.99362631107135, "episode_reward_mean": -170.934074467383, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.94124807143382, -168.45917802284052, -164.34486202571665, -170.60988442731096, -170.20988869184626, -168.9108376699087, -174.99362631107135, -173.02755330193526, -172.36535895370665, -171.47830719805975], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27552322476695645, "mean_inference_ms": 1.1928387947746049, "mean_action_processing_ms": 0.14856581563267185, "mean_env_wait_ms": 0.8004985368695063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 250, "training_iteration": 50, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-23-51", "timestamp": 1708745031, "time_this_iter_s": 38.52990102767944, "time_total_s": 751.8506588935852, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 751.8506588935852, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 56.76326530612244, "ram_util_percent": 14.730612244897959, "gpu_util_percent0": 0.3187755102040817, "vram_util_percent0": 0.039754231770833336}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -199.9274026638336, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.90532249264325, -207.92568256797017, -216.1018744316252, -207.44391540882117, -201.83196048348023, -207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26419801949757493, "mean_inference_ms": 1.3443807177409688, "mean_action_processing_ms": 0.14827409147627862, "mean_env_wait_ms": 0.7940928338529075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 244800, "timesteps_this_iter": 0, "agent_timesteps_total": 244800, "timers": {"learn_time_ms": 2048.714, "learn_throughput": 0.976, "update_time_ms": 9.938}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7954484224319458, "grad_norm": 17.274816513061523, "td_error_abs": 0.6285242513020833, "q_taken_mean": -0.686094482421875, "target_mean": -0.20843865966796876}}}, "num_steps_sampled": 244800, "num_agent_steps_sampled": 244800, "num_steps_trained": 102, "num_agent_steps_trained": 489600, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 255, "training_iteration": 51, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-24-06", "timestamp": 1708745046, "time_this_iter_s": 14.876599311828613, "time_total_s": 766.7272582054138, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 766.7272582054138, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 56.078947368421055, "ram_util_percent": 14.810526315789472, "gpu_util_percent0": 0.3173684210526315, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -199.84639217171036, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.30087876020633, -205.9636083685086, -206.7984488172935, -210.93561984106455, -209.49093112583282, -209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.264346924331224, "mean_inference_ms": 1.3452854896346857, "mean_action_processing_ms": 0.14833833432183, "mean_env_wait_ms": 0.794695436848167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"learn_time_ms": 2076.999, "learn_throughput": 0.963, "update_time_ms": 9.749}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7357527017593384, "grad_norm": 1.8394614458084106, "td_error_abs": 0.5062263997395834, "q_taken_mean": -0.4835755208333333, "target_mean": -0.43821370442708335}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 249600, "num_steps_trained": 104, "num_agent_steps_trained": 499200, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 260, "training_iteration": 52, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-24-21", "timestamp": 1708745061, "time_this_iter_s": 15.03285026550293, "time_total_s": 781.7601084709167, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 781.7601084709167, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 55.526315789473685, "ram_util_percent": 14.836842105263157, "gpu_util_percent0": 0.3152631578947368, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -199.7858839327169, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.71770271366847, -204.6244291102582, -203.81507460598166, -204.95213920829687, -206.75669517531347, -207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26448690478033543, "mean_inference_ms": 1.3461647836218598, "mean_action_processing_ms": 0.14839831288301034, "mean_env_wait_ms": 0.7952606459996774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 254400, "timesteps_this_iter": 0, "agent_timesteps_total": 254400, "timers": {"learn_time_ms": 2064.841, "learn_throughput": 0.969, "update_time_ms": 9.486}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6469444036483765, "grad_norm": 9.218093872070312, "td_error_abs": 0.4795919596354167, "q_taken_mean": -0.10152048746744792, "target_mean": -0.432562744140625}}}, "num_steps_sampled": 254400, "num_agent_steps_sampled": 254400, "num_steps_trained": 106, "num_agent_steps_trained": 508800, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 265, "training_iteration": 53, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-24-36", "timestamp": 1708745076, "time_this_iter_s": 14.71620798110962, "time_total_s": 796.4763164520264, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 796.4763164520264, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 55.373684210526314, "ram_util_percent": 14.910526315789474, "gpu_util_percent0": 0.3157894736842105, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -198.9840796867819, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.863917355564, -200.57700918405297, -211.40204943320356, -208.62250077529785, -215.4494417040202, -207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26464249927111244, "mean_inference_ms": 1.347128707879441, "mean_action_processing_ms": 0.1484647749076671, "mean_env_wait_ms": 0.7958225292480594, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 259200, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"learn_time_ms": 2066.605, "learn_throughput": 0.968, "update_time_ms": 9.55}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7052122950553894, "grad_norm": 15.024283409118652, "td_error_abs": 0.5679694010416667, "q_taken_mean": -0.6200448404947917, "target_mean": -0.20704597981770834}}}, "num_steps_sampled": 259200, "num_agent_steps_sampled": 259200, "num_steps_trained": 108, "num_agent_steps_trained": 518400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 270, "training_iteration": 54, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-24-51", "timestamp": 1708745091, "time_this_iter_s": 15.169256925582886, "time_total_s": 811.6455733776093, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 811.6455733776093, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 56.22105263157895, "ram_util_percent": 14.936842105263159, "gpu_util_percent0": 0.3121052631578947, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -198.84132478085047, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.19835127894243, -207.34815467310275, -212.24879552546759, -207.67135020194954, -205.75907303864358, -204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26477797623505694, "mean_inference_ms": 1.348014480178495, "mean_action_processing_ms": 0.14852243614939037, "mean_env_wait_ms": 0.7963149775082796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"learn_time_ms": 2055.048, "learn_throughput": 0.973, "update_time_ms": 9.589}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6557351350784302, "grad_norm": 4.828263759613037, "td_error_abs": 0.47468668619791665, "q_taken_mean": -0.26059590657552084, "target_mean": -0.43368912760416667}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 110, "num_agent_steps_trained": 528000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 275, "training_iteration": 55, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-25-06", "timestamp": 1708745106, "time_this_iter_s": 14.696607828140259, "time_total_s": 826.3421812057495, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 826.3421812057495, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 55.55263157894737, "ram_util_percent": 14.984210526315788, "gpu_util_percent0": 0.31578947368421045, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -197.79432877426188, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.1185246166518, -211.18475470255825, -210.53728174528038, -211.45770310735278, -215.2097491286058, -190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26491011146761584, "mean_inference_ms": 1.348927148655809, "mean_action_processing_ms": 0.14858376158198572, "mean_env_wait_ms": 0.7968275963829101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 268800, "timesteps_this_iter": 0, "agent_timesteps_total": 268800, "timers": {"learn_time_ms": 2035.091, "learn_throughput": 0.983, "update_time_ms": 9.574}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5289730429649353, "grad_norm": 3.258530378341675, "td_error_abs": 0.41252705891927083, "q_taken_mean": -0.3753706461588542, "target_mean": -0.3040223185221354}}}, "num_steps_sampled": 268800, "num_agent_steps_sampled": 268800, "num_steps_trained": 112, "num_agent_steps_trained": 537600, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 280, "training_iteration": 56, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-25-21", "timestamp": 1708745121, "time_this_iter_s": 15.00907015800476, "time_total_s": 841.3512513637543, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 841.3512513637543, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.5, "ram_util_percent": 15.036842105263156, "gpu_util_percent0": 0.31263157894736837, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -197.55757038009116, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.03030860662062, -189.20046575144858, -196.2009102228404, -187.78886644494432, -195.18319330094835, -210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2650472044101592, "mean_inference_ms": 1.3498764503092489, "mean_action_processing_ms": 0.14864841382106656, "mean_env_wait_ms": 0.7973582603130831, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 273600, "timesteps_this_iter": 0, "agent_timesteps_total": 273600, "timers": {"learn_time_ms": 2040.639, "learn_throughput": 0.98, "update_time_ms": 9.583}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7978293299674988, "grad_norm": 4.933755397796631, "td_error_abs": 0.5405979817708333, "q_taken_mean": -0.25654060872395834, "target_mean": -0.32059171549479165}}}, "num_steps_sampled": 273600, "num_agent_steps_sampled": 273600, "num_steps_trained": 114, "num_agent_steps_trained": 547200, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 285, "training_iteration": 57, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-25-36", "timestamp": 1708745136, "time_this_iter_s": 15.317894220352173, "time_total_s": 856.6691455841064, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 856.6691455841064, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 56.147368421052626, "ram_util_percent": 15.126315789473686, "gpu_util_percent0": 0.3078947368421052, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -197.3848484748838, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.23428982318714, -205.4414416107535, -209.98662405123176, -206.10943610041662, -206.17246430170147, -184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2651636278764168, "mean_inference_ms": 1.3507673130183133, "mean_action_processing_ms": 0.1487067025620853, "mean_env_wait_ms": 0.7978694717391228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 278400, "timesteps_this_iter": 0, "agent_timesteps_total": 278400, "timers": {"learn_time_ms": 2031.402, "learn_throughput": 0.985, "update_time_ms": 9.447}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6160263419151306, "grad_norm": 1.9560102224349976, "td_error_abs": 0.45301163736979166, "q_taken_mean": -0.38233272298177085, "target_mean": -0.32470377604166667}}}, "num_steps_sampled": 278400, "num_agent_steps_sampled": 278400, "num_steps_trained": 116, "num_agent_steps_trained": 556800, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 290, "training_iteration": 58, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-25-51", "timestamp": 1708745151, "time_this_iter_s": 14.748673439025879, "time_total_s": 871.4178190231323, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 871.4178190231323, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 55.442105263157885, "ram_util_percent": 15.189473684210524, "gpu_util_percent0": 0.31421052631578944, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.25870381052584, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -196.55591618099896, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.17662607156996, -189.71838150996342, -185.1589904726253, -184.64547283816924, -188.71396476936022, -186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.265259430357598, "mean_inference_ms": 1.3515716957670825, "mean_action_processing_ms": 0.14875757405878767, "mean_env_wait_ms": 0.798336153543789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 283200, "timesteps_this_iter": 0, "agent_timesteps_total": 283200, "timers": {"learn_time_ms": 2079.01, "learn_throughput": 0.962, "update_time_ms": 9.406}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6885915398597717, "grad_norm": 2.4489662647247314, "td_error_abs": 0.49859208170572916, "q_taken_mean": -0.27395780436197914, "target_mean": -0.31939823404947915}}}, "num_steps_sampled": 283200, "num_agent_steps_sampled": 283200, "num_steps_trained": 118, "num_agent_steps_trained": 566400, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 295, "training_iteration": 59, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-26-07", "timestamp": 1708745167, "time_this_iter_s": 15.321213960647583, "time_total_s": 886.7390329837799, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 886.7390329837799, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.48947368421052, "ram_util_percent": 15.131578947368421, "gpu_util_percent0": 0.31263157894736837, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.0358985138425, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -196.6061018780561, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.84500087480075, -187.2139625192389, -188.2293707917905, -185.49432834107395, -185.78470433478333, -210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26535811593142283, "mean_inference_ms": 1.3523595127831394, "mean_action_processing_ms": 0.14880754351133207, "mean_env_wait_ms": 0.7988204834792195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"learn_time_ms": 2080.136, "learn_throughput": 0.961, "update_time_ms": 9.857}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6457535028457642, "grad_norm": 1.1837271451950073, "td_error_abs": 0.4924227701822917, "q_taken_mean": -0.3194637654622396, "target_mean": -0.3384133504231771}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 120, "num_agent_steps_trained": 576000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 60, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-26-21", "timestamp": 1708745181, "time_this_iter_s": 14.764915466308594, "time_total_s": 901.5039484500885, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 901.5039484500885, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.363157894736844, "ram_util_percent": 15.357894736842105, "gpu_util_percent0": 0.31789473684210523, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.0358985138425, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -196.62505255732893, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.4093854631015, -196.0265251706102, -211.02741251855994, -209.95301634747207, -207.9056345148347, -187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2654592859037438, "mean_inference_ms": 1.3531445093661063, "mean_action_processing_ms": 0.14885599875615974, "mean_env_wait_ms": 0.7993061508070651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 292800, "timesteps_this_iter": 0, "agent_timesteps_total": 292800, "timers": {"learn_time_ms": 2078.234, "learn_throughput": 0.962, "update_time_ms": 9.746}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6165444850921631, "grad_norm": 1.0249764919281006, "td_error_abs": 0.48717626953125, "q_taken_mean": -0.33807405598958334, "target_mean": -0.3361389567057292}}}, "num_steps_sampled": 292800, "num_agent_steps_sampled": 292800, "num_steps_trained": 122, "num_agent_steps_trained": 585600, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 305, "training_iteration": 61, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-26-37", "timestamp": 1708745197, "time_this_iter_s": 15.148042440414429, "time_total_s": 916.6519908905029, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 916.6519908905029, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 56.29473684210526, "ram_util_percent": 15.373684210526317, "gpu_util_percent0": 0.31263157894736837, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.0358985138425, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -195.74035624938858, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.00554043553652, -192.21124100101065, -182.40077146482767, -183.1660893906611, -189.93308218506388, -211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26554527109676274, "mean_inference_ms": 1.3538146152605162, "mean_action_processing_ms": 0.1488966420018015, "mean_env_wait_ms": 0.7997244593408461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 297600, "timesteps_this_iter": 0, "agent_timesteps_total": 297600, "timers": {"learn_time_ms": 2065.003, "learn_throughput": 0.969, "update_time_ms": 10.004}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6322307586669922, "grad_norm": 3.5174801349639893, "td_error_abs": 0.49878759765625, "q_taken_mean": -0.3157472330729167, "target_mean": -0.43424466959635416}}}, "num_steps_sampled": 297600, "num_agent_steps_sampled": 297600, "num_steps_trained": 124, "num_agent_steps_trained": 595200, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 310, "training_iteration": 62, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-26-51", "timestamp": 1708745211, "time_this_iter_s": 14.414638757705688, "time_total_s": 931.0666296482086, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 931.0666296482086, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 55.49444444444445, "ram_util_percent": 15.383333333333333, "gpu_util_percent0": 0.3133333333333333, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.0358985138425, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -196.27024640429826, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-211.36825575473657, -206.02438782278236, -210.34919517693285, -205.81976192119038, -206.1453877844814, -185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2656413890152225, "mean_inference_ms": 1.354484687202786, "mean_action_processing_ms": 0.1489402886454872, "mean_env_wait_ms": 0.8001709826969617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 302400, "timesteps_this_iter": 0, "agent_timesteps_total": 302400, "timers": {"learn_time_ms": 2073.667, "learn_throughput": 0.964, "update_time_ms": 10.175}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6408165097236633, "grad_norm": 6.819792747497559, "td_error_abs": 0.5015553792317708, "q_taken_mean": -0.5666555989583333, "target_mean": -0.31706624348958334}}}, "num_steps_sampled": 302400, "num_agent_steps_sampled": 302400, "num_steps_trained": 126, "num_agent_steps_trained": 604800, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 315, "training_iteration": 63, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-27-06", "timestamp": 1708745226, "time_this_iter_s": 15.254524946212769, "time_total_s": 946.3211545944214, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 946.3211545944214, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 55.364999999999995, "ram_util_percent": 15.480000000000004, "gpu_util_percent0": 0.3195, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.0358985138425, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -195.0816144027006, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.10596960564885, -191.07301903789306, -190.79352768730774, -182.59072799893488, -191.4710052973053, -182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26573622992650336, "mean_inference_ms": 1.3551188944242605, "mean_action_processing_ms": 0.1489824470668731, "mean_env_wait_ms": 0.8005961923461682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"learn_time_ms": 2084.767, "learn_throughput": 0.959, "update_time_ms": 10.247}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7325824499130249, "grad_norm": 9.249068260192871, "td_error_abs": 0.5612699381510416, "q_taken_mean": -0.07854393513997396, "target_mean": -0.4306742350260417}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 307200, "num_steps_trained": 128, "num_agent_steps_trained": 614400, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 320, "training_iteration": 64, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-27-22", "timestamp": 1708745242, "time_this_iter_s": 15.437766551971436, "time_total_s": 961.7589211463928, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 961.7589211463928, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 55.77368421052632, "ram_util_percent": 15.521052631578948, "gpu_util_percent0": 0.31368421052631573, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -182.0358985138425, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -195.85930175663188, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.25870381052584, -186.82256111463872, -190.68597425578852, -187.19958921458053, -188.41359653152156, -201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2658173401645926, "mean_inference_ms": 1.3556774647388594, "mean_action_processing_ms": 0.14901756316405657, "mean_env_wait_ms": 0.800988290036862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"learn_time_ms": 2117.252, "learn_throughput": 0.945, "update_time_ms": 10.32}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6839261054992676, "grad_norm": 8.81274127960205, "td_error_abs": 0.54688427734375, "q_taken_mean": -0.7402461751302083, "target_mean": -0.476473388671875}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 130, "num_agent_steps_trained": 624000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 325, "training_iteration": 65, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-27-37", "timestamp": 1708745257, "time_this_iter_s": 15.001112222671509, "time_total_s": 976.7600333690643, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 976.7600333690643, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.48421052631579, "ram_util_percent": 15.56842105263158, "gpu_util_percent0": 0.318421052631579, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -177.5020033865035, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -195.70827219994456, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.46552613992657, -206.95096187481286, -209.5574383533375, -211.07670848686573, -199.64373425844107, -212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.265902527258078, "mean_inference_ms": 1.356244657037815, "mean_action_processing_ms": 0.1490532984418625, "mean_env_wait_ms": 0.8013866228031943, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 316800, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"learn_time_ms": 2184.27, "learn_throughput": 0.916, "update_time_ms": 10.528}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7461475133895874, "grad_norm": 1.7493431568145752, "td_error_abs": 0.44147115071614584, "q_taken_mean": -0.4005807698567708, "target_mean": -0.4284876708984375}}}, "num_steps_sampled": 316800, "num_agent_steps_sampled": 316800, "num_steps_trained": 132, "num_agent_steps_trained": 633600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 330, "training_iteration": 66, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-27-52", "timestamp": 1708745272, "time_this_iter_s": 15.239546298980713, "time_total_s": 991.999579668045, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 991.999579668045, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.53684210526316, "ram_util_percent": 15.63684210526316, "gpu_util_percent0": 0.31421052631578944, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -177.5020033865035, "episode_reward_min": -217.39167779317356, "episode_reward_mean": -194.97779216534607, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-212.38110532342606, -206.01635618213524, -217.39167779317356, -204.82750374915193, -211.325294027889, -191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26599992789291327, "mean_inference_ms": 1.356831437384391, "mean_action_processing_ms": 0.14909167662551087, "mean_env_wait_ms": 0.8017881570468584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 321600, "timesteps_this_iter": 0, "agent_timesteps_total": 321600, "timers": {"learn_time_ms": 2177.774, "learn_throughput": 0.918, "update_time_ms": 11.193}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6521403789520264, "grad_norm": 1.4557512998580933, "td_error_abs": 0.5157915445963541, "q_taken_mean": -0.06849312337239584, "target_mean": -0.006599365234375}}}, "num_steps_sampled": 321600, "num_agent_steps_sampled": 321600, "num_steps_trained": 134, "num_agent_steps_trained": 643200, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 335, "training_iteration": 67, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-28-07", "timestamp": 1708745287, "time_this_iter_s": 14.833568096160889, "time_total_s": 1006.8331477642059, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1006.8331477642059, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 55.82631578947369, "ram_util_percent": 15.726315789473684, "gpu_util_percent0": 0.3242105263157895, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -177.5020033865035, "episode_reward_min": -215.35716855231436, "episode_reward_mean": -193.8035565645879, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.15473804123366, -184.28948167689546, -190.86980314368392, -182.57842928652101, -191.85366187909366, -214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26609518476803035, "mean_inference_ms": 1.3573893829508092, "mean_action_processing_ms": 0.14912836968508364, "mean_env_wait_ms": 0.8021716867009855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 326400, "timesteps_this_iter": 0, "agent_timesteps_total": 326400, "timers": {"learn_time_ms": 2206.963, "learn_throughput": 0.906, "update_time_ms": 11.308}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5974106192588806, "grad_norm": 2.704716205596924, "td_error_abs": 0.4909064127604167, "q_taken_mean": 0.03987041473388672, "target_mean": -0.006077046712239583}}}, "num_steps_sampled": 326400, "num_agent_steps_sampled": 326400, "num_steps_trained": 136, "num_agent_steps_trained": 652800, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 340, "training_iteration": 68, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-28-22", "timestamp": 1708745302, "time_this_iter_s": 15.404351472854614, "time_total_s": 1022.2374992370605, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1022.2374992370605, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 15.67894736842105, "gpu_util_percent0": 0.31105263157894736, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -177.5020033865035, "episode_reward_min": -215.35716855231436, "episode_reward_mean": -193.81884857280548, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-214.92114744925576, -208.51688872688558, -206.27451647280395, -207.78824847154684, -198.55267959524372, -184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2661798673511203, "mean_inference_ms": 1.3579305295928596, "mean_action_processing_ms": 0.14916311611715982, "mean_env_wait_ms": 0.8025149715929839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 331200, "timesteps_this_iter": 0, "agent_timesteps_total": 331200, "timers": {"learn_time_ms": 2182.088, "learn_throughput": 0.917, "update_time_ms": 11.596}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5666998624801636, "grad_norm": 3.5554373264312744, "td_error_abs": 0.48381962076822915, "q_taken_mean": -0.12357315063476562, "target_mean": -0.005676447550455729}}}, "num_steps_sampled": 331200, "num_agent_steps_sampled": 331200, "num_steps_trained": 138, "num_agent_steps_trained": 662400, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 345, "training_iteration": 69, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-28-37", "timestamp": 1708745317, "time_this_iter_s": 14.920123815536499, "time_total_s": 1037.157623052597, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1037.157623052597, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 55.50526315789473, "ram_util_percent": 15.915789473684208, "gpu_util_percent0": 0.3263157894736842, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -177.5020033865035, "episode_reward_min": -215.35716855231436, "episode_reward_mean": -192.7875359694785, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.30026450985122, -185.94887838698213, -184.6819570704922, -189.33649688638255, -188.33466477225784, -211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2662572206411954, "mean_inference_ms": 1.3584508349475342, "mean_action_processing_ms": 0.14919465170217772, "mean_env_wait_ms": 0.8028116503048933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"learn_time_ms": 2180.046, "learn_throughput": 0.917, "update_time_ms": 10.934}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5765935182571411, "grad_norm": 7.764776706695557, "td_error_abs": 0.5008098551432292, "q_taken_mean": 0.20351495361328126, "target_mean": -0.007320322036743164}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 140, "num_agent_steps_trained": 672000, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 350, "training_iteration": 70, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-28-52", "timestamp": 1708745332, "time_this_iter_s": 15.016597509384155, "time_total_s": 1052.1742205619812, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1052.1742205619812, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 55.88947368421052, "ram_util_percent": 15.915789473684212, "gpu_util_percent0": 0.31263157894736837, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -215.35716855231436, "episode_reward_mean": -192.75116103812786, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-211.17350378797877, -206.27152703098136, -206.86797816194164, -205.0951113272722, -209.69958586403894, -210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26632999799698603, "mean_inference_ms": 1.3589695002693947, "mean_action_processing_ms": 0.14922726687029772, "mean_env_wait_ms": 0.8031218829157806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340800, "timesteps_this_iter": 0, "agent_timesteps_total": 340800, "timers": {"learn_time_ms": 2179.339, "learn_throughput": 0.918, "update_time_ms": 10.982}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5689624547958374, "grad_norm": 4.063327789306641, "td_error_abs": 0.4927879638671875, "q_taken_mean": -0.3947959798177083, "target_mean": -0.28289892578125}}}, "num_steps_sampled": 340800, "num_agent_steps_sampled": 340800, "num_steps_trained": 142, "num_agent_steps_trained": 681600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 355, "training_iteration": 71, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-29-08", "timestamp": 1708745348, "time_this_iter_s": 15.148840188980103, "time_total_s": 1067.3230607509613, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1067.3230607509613, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 55.73157894736841, "ram_util_percent": 16.005263157894742, "gpu_util_percent0": 0.30894736842105264, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -215.35716855231436, "episode_reward_mean": -191.43113993725902, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.53283328551643, -206.3280107943832, -208.61814652744783, -205.97543698342773, -202.98423542278437, -191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.266413360910452, "mean_inference_ms": 1.3595137055192048, "mean_action_processing_ms": 0.1492608321370125, "mean_env_wait_ms": 0.80340736665663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 345600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"learn_time_ms": 2186.636, "learn_throughput": 0.915, "update_time_ms": 11.067}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.551026463508606, "grad_norm": 0.8379201889038086, "td_error_abs": 0.471570068359375, "q_taken_mean": -0.06116548665364583, "target_mean": -0.04798215738932292}}}, "num_steps_sampled": 345600, "num_agent_steps_sampled": 345600, "num_steps_trained": 144, "num_agent_steps_trained": 691200, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 360, "training_iteration": 72, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-29-23", "timestamp": 1708745363, "time_this_iter_s": 15.219078063964844, "time_total_s": 1082.5421388149261, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1082.5421388149261, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 56.247368421052634, "ram_util_percent": 15.994736842105262, "gpu_util_percent0": 0.3115789473684211, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -201.1761119417025, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.81309302483874, -187.0962185941498, -185.91860620362007, -191.61931652749993, -193.23838186991094, -202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26650459392893916, "mean_inference_ms": 1.3600525632177947, "mean_action_processing_ms": 0.14929653472784404, "mean_env_wait_ms": 0.8036921411611538, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 350400, "timesteps_this_iter": 0, "agent_timesteps_total": 350400, "timers": {"learn_time_ms": 2164.004, "learn_throughput": 0.924, "update_time_ms": 10.979}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 2.138171434402466, "grad_norm": 20.6585693359375, "td_error_abs": 0.9317736002604167, "q_taken_mean": 0.029597882588704428, "target_mean": -0.2965268961588542}}}, "num_steps_sampled": 350400, "num_agent_steps_sampled": 350400, "num_steps_trained": 146, "num_agent_steps_trained": 700800, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 365, "training_iteration": 73, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-29-38", "timestamp": 1708745378, "time_this_iter_s": 14.761699199676514, "time_total_s": 1097.3038380146027, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1097.3038380146027, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 56.03333333333333, "ram_util_percent": 15.938888888888888, "gpu_util_percent0": 0.3188888888888889, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -200.97304130051452, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.43092842870325, -200.19920752945467, -215.35716855231436, -204.12854186328704, -207.52358148523925, -183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26659403626046596, "mean_inference_ms": 1.3605235792766432, "mean_action_processing_ms": 0.14932723041378154, "mean_env_wait_ms": 0.803966568136309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 355200, "timesteps_this_iter": 0, "agent_timesteps_total": 355200, "timers": {"learn_time_ms": 2155.979, "learn_throughput": 0.928, "update_time_ms": 10.754}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9983629584312439, "grad_norm": 6.7376861572265625, "td_error_abs": 0.6101872965494791, "q_taken_mean": -0.29986761474609375, "target_mean": 0.008581732432047526}}}, "num_steps_sampled": 355200, "num_agent_steps_sampled": 355200, "num_steps_trained": 148, "num_agent_steps_trained": 710400, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 370, "training_iteration": 74, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-29-52", "timestamp": 1708745392, "time_this_iter_s": 14.907554626464844, "time_total_s": 1112.2113926410675, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1112.2113926410675, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 55.55263157894738, "ram_util_percent": 16.2, "gpu_util_percent0": 0.3194736842105263, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -199.98315977016492, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.16657485589184, -184.06491941194022, -187.87660650693024, -196.71606111454915, -183.70196216993887, -205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26668775508047554, "mean_inference_ms": 1.3609721860405384, "mean_action_processing_ms": 0.14935676847850574, "mean_env_wait_ms": 0.8042143849672986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"learn_time_ms": 2130.315, "learn_throughput": 0.939, "update_time_ms": 10.905}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.778145968914032, "grad_norm": 14.315262794494629, "td_error_abs": 0.6192792561848959, "q_taken_mean": 0.40791129557291667, "target_mean": -0.008577694574991862}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 150, "num_agent_steps_trained": 720000, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 375, "training_iteration": 75, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-30-07", "timestamp": 1708745407, "time_this_iter_s": 14.608994483947754, "time_total_s": 1126.8203871250153, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1126.8203871250153, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 55.80555555555556, "ram_util_percent": 16.2, "gpu_util_percent0": 0.32055555555555554, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -200.01354740691758, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205.9862090201308, -208.44565454629347, -200.12406204859337, -204.87664456043026, -209.39960370792255, -191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26678522199870186, "mean_inference_ms": 1.3614204872145965, "mean_action_processing_ms": 0.14938543009103183, "mean_env_wait_ms": 0.8044325786474977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 364800, "timesteps_this_iter": 0, "agent_timesteps_total": 364800, "timers": {"learn_time_ms": 2067.744, "learn_throughput": 0.967, "update_time_ms": 10.459}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6016990542411804, "grad_norm": 4.940364360809326, "td_error_abs": 0.5021337890625, "q_taken_mean": -0.17380387369791667, "target_mean": -0.008195908864339192}}}, "num_steps_sampled": 364800, "num_agent_steps_sampled": 364800, "num_steps_trained": 152, "num_agent_steps_trained": 729600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 380, "training_iteration": 76, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-30-22", "timestamp": 1708745422, "time_this_iter_s": 15.047744512557983, "time_total_s": 1141.8681316375732, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1141.8681316375732, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 56.078947368421055, "ram_util_percent": 16.257894736842104, "gpu_util_percent0": 0.32894736842105265, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -199.03281356144643, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.7478460535502, -182.83114860232888, -186.96410161039404, -191.44062258518255, -188.1478349546129, -192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26686974073071384, "mean_inference_ms": 1.361849173550578, "mean_action_processing_ms": 0.1494097547150083, "mean_env_wait_ms": 0.8045961622483678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 369600, "timesteps_this_iter": 0, "agent_timesteps_total": 369600, "timers": {"learn_time_ms": 2071.607, "learn_throughput": 0.965, "update_time_ms": 10.275}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5920700430870056, "grad_norm": 5.10500955581665, "td_error_abs": 0.4953123779296875, "q_taken_mean": 0.13068837483723958, "target_mean": -0.006424458185831706}}}, "num_steps_sampled": 369600, "num_agent_steps_sampled": 369600, "num_steps_trained": 154, "num_agent_steps_trained": 739200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 385, "training_iteration": 77, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-30-37", "timestamp": 1708745437, "time_this_iter_s": 14.903002262115479, "time_total_s": 1156.7711338996887, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1156.7711338996887, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 16.3, "gpu_util_percent0": 0.31421052631578944, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -199.01510162196374, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.65550747115032, -189.41096194075254, -192.61698856894765, -184.68252918699886, -195.6850393309545, -189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2669642415965165, "mean_inference_ms": 1.3623264206601922, "mean_action_processing_ms": 0.14943816753987252, "mean_env_wait_ms": 0.8047817178790366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 374400, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"learn_time_ms": 2046.278, "learn_throughput": 0.977, "update_time_ms": 9.803}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5632455348968506, "grad_norm": 1.3862123489379883, "td_error_abs": 0.48201753743489584, "q_taken_mean": -0.15019010416666667, "target_mean": -0.10762290445963542}}}, "num_steps_sampled": 374400, "num_agent_steps_sampled": 374400, "num_steps_trained": 156, "num_agent_steps_trained": 748800, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 390, "training_iteration": 78, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-30-53", "timestamp": 1708745453, "time_this_iter_s": 15.533602714538574, "time_total_s": 1172.3047366142273, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1172.3047366142273, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 56.62105263157895, "ram_util_percent": 16.321052631578947, "gpu_util_percent0": 0.31526315789473686, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -198.80874804593765, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.13977731529977, -189.00180624560818, -189.7354455156638, -187.51907777699128, -182.0358985138425, -182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26705568127128976, "mean_inference_ms": 1.3628018727864721, "mean_action_processing_ms": 0.14946445163357663, "mean_env_wait_ms": 0.8049289478168435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 379200, "timesteps_this_iter": 0, "agent_timesteps_total": 379200, "timers": {"learn_time_ms": 2063.793, "learn_throughput": 0.969, "update_time_ms": 10.082}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5643628239631653, "grad_norm": 2.004647731781006, "td_error_abs": 0.4853418375651042, "q_taken_mean": -0.06349892171223959, "target_mean": -0.109415771484375}}}, "num_steps_sampled": 379200, "num_agent_steps_sampled": 379200, "num_steps_trained": 158, "num_agent_steps_trained": 758400, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 395, "training_iteration": 79, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-31-08", "timestamp": 1708745468, "time_this_iter_s": 15.068830013275146, "time_total_s": 1187.3735666275024, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1187.3735666275024, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 55.699999999999996, "ram_util_percent": 16.515789473684215, "gpu_util_percent0": 0.32052631578947366, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -198.81090815047995, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.6081605981641, -185.1251162253465, -183.18000679516993, -185.42654566866938, -199.12260550161585, -187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2671481287284131, "mean_inference_ms": 1.3633133971186178, "mean_action_processing_ms": 0.1494929616331256, "mean_env_wait_ms": 0.805085609438398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"learn_time_ms": 2068.558, "learn_throughput": 0.967, "update_time_ms": 10.74}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5488200783729553, "grad_norm": 1.9301526546478271, "td_error_abs": 0.4772619222005208, "q_taken_mean": -0.16887337239583333, "target_mean": -0.10879119873046875}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 160, "num_agent_steps_trained": 768000, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 400, "training_iteration": 80, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-31-23", "timestamp": 1708745483, "time_this_iter_s": 15.26784348487854, "time_total_s": 1202.641410112381, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1202.641410112381, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 56.01052631578946, "ram_util_percent": 16.526315789473685, "gpu_util_percent0": 0.3142105263157895, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -198.77562753169124, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.38794762421028, -193.30975405674369, -184.81725034165666, -188.0116060397068, -193.3257851582254, -199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26723357374866014, "mean_inference_ms": 1.3638041602314115, "mean_action_processing_ms": 0.14951894286329934, "mean_env_wait_ms": 0.8052220065068936, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 388800, "timesteps_this_iter": 0, "agent_timesteps_total": 388800, "timers": {"learn_time_ms": 2058.11, "learn_throughput": 0.972, "update_time_ms": 10.999}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5547593832015991, "grad_norm": 3.2451086044311523, "td_error_abs": 0.4805883382161458, "q_taken_mean": -0.020479059855143228, "target_mean": -0.10777269490559896}}}, "num_steps_sampled": 388800, "num_agent_steps_sampled": 388800, "num_steps_trained": 162, "num_agent_steps_trained": 777600, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 405, "training_iteration": 81, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-31-38", "timestamp": 1708745498, "time_this_iter_s": 14.879839181900024, "time_total_s": 1217.521249294281, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1217.521249294281, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 55.955555555555556, "ram_util_percent": 16.533333333333335, "gpu_util_percent0": 0.31166666666666665, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -198.633005061754, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.98053182426145, -202.3293696104142, -201.436445310169, -194.83367865850005, -189.1257145647235, -184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2673380687814866, "mean_inference_ms": 1.3643588007393808, "mean_action_processing_ms": 0.14955195107837072, "mean_env_wait_ms": 0.8054201328124853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 393600, "timesteps_this_iter": 0, "agent_timesteps_total": 393600, "timers": {"learn_time_ms": 2034.103, "learn_throughput": 0.983, "update_time_ms": 10.999}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5558918714523315, "grad_norm": 2.0365030765533447, "td_error_abs": 0.4808502604166667, "q_taken_mean": -0.229944580078125, "target_mean": -0.17893631998697918}}}, "num_steps_sampled": 393600, "num_agent_steps_sampled": 393600, "num_steps_trained": 164, "num_agent_steps_trained": 787200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 410, "training_iteration": 82, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-31-53", "timestamp": 1708745513, "time_this_iter_s": 15.204869270324707, "time_total_s": 1232.7261185646057, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1232.7261185646057, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.67894736842104, "ram_util_percent": 16.610526315789475, "gpu_util_percent0": 0.3168421052631578, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -198.12436092127288, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.7514051893666, -188.86328707080995, -183.11968846718585, -182.05731859931674, -182.05208897368414, -192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26743256110431063, "mean_inference_ms": 1.3649058469162154, "mean_action_processing_ms": 0.14958199587338752, "mean_env_wait_ms": 0.8055967494958807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 398400, "timesteps_this_iter": 0, "agent_timesteps_total": 398400, "timers": {"learn_time_ms": 2067.592, "learn_throughput": 0.967, "update_time_ms": 11.511}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5362569689750671, "grad_norm": 1.0281637907028198, "td_error_abs": 0.4690516764322917, "q_taken_mean": -0.08417945353190104, "target_mean": -0.10674745686848959}}}, "num_steps_sampled": 398400, "num_agent_steps_sampled": 398400, "num_steps_trained": 166, "num_agent_steps_trained": 796800, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 415, "training_iteration": 83, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-32-09", "timestamp": 1708745529, "time_this_iter_s": 15.41748046875, "time_total_s": 1248.1435990333557, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1248.1435990333557, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 55.69500000000001, "ram_util_percent": 16.62, "gpu_util_percent0": 0.318, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -198.27078166337597, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.12374926642164, -206.7568378551745, -212.2329847362204, -201.27956112832825, -206.40985203406638, -181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26752302961983565, "mean_inference_ms": 1.3654371674403272, "mean_action_processing_ms": 0.14960735099277483, "mean_env_wait_ms": 0.8057379017204765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 403200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"learn_time_ms": 2075.062, "learn_throughput": 0.964, "update_time_ms": 11.543}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5338573455810547, "grad_norm": 1.159923791885376, "td_error_abs": 0.4680738525390625, "q_taken_mean": -0.14291385904947917, "target_mean": -0.10674745686848959}}}, "num_steps_sampled": 403200, "num_agent_steps_sampled": 403200, "num_steps_trained": 168, "num_agent_steps_trained": 806400, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 420, "training_iteration": 84, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-32-24", "timestamp": 1708745544, "time_this_iter_s": 15.152327299118042, "time_total_s": 1263.2959263324738, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1263.2959263324738, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 56.35555555555556, "ram_util_percent": 16.827777777777776, "gpu_util_percent0": 0.3094444444444444, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -443.8193360830111, "episode_reward_mean": -197.32119916327548, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.79506054231143, -187.32314047586183, -185.38296587017737, -188.27429898347123, -177.5020033865035, -192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2676135211977646, "mean_inference_ms": 1.365950354205979, "mean_action_processing_ms": 0.1496325403988894, "mean_env_wait_ms": 0.805878174908289, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"learn_time_ms": 2087.899, "learn_throughput": 0.958, "update_time_ms": 11.448}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5425298810005188, "grad_norm": 2.4727277755737305, "td_error_abs": 0.4726245930989583, "q_taken_mean": -0.04213672383626302, "target_mean": -0.10449127197265624}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 170, "num_agent_steps_trained": 816000, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 425, "training_iteration": 85, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-32-39", "timestamp": 1708745559, "time_this_iter_s": 14.880054712295532, "time_total_s": 1278.1759810447693, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1278.1759810447693, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 55.78421052631578, "ram_util_percent": 16.81578947368421, "gpu_util_percent0": 0.3178947368421053, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -919.6361379745078, "episode_reward_mean": -233.35692756729645, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.36489452251294, -186.97148701719615, -195.22971218434083, -192.52338495223884, -188.55688697725085, -180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26770512266740626, "mean_inference_ms": 1.3664895441140357, "mean_action_processing_ms": 0.14966151207720782, "mean_env_wait_ms": 0.8060490492211879, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 412800, "timesteps_this_iter": 0, "agent_timesteps_total": 412800, "timers": {"learn_time_ms": 2103.509, "learn_throughput": 0.951, "update_time_ms": 12.082}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7361247539520264, "grad_norm": 11.230140686035156, "td_error_abs": 0.5876168212890625, "q_taken_mean": -0.21418798828125, "target_mean": -0.507509521484375}}}, "num_steps_sampled": 412800, "num_agent_steps_sampled": 412800, "num_steps_trained": 172, "num_agent_steps_trained": 825600, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 430, "training_iteration": 86, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-32-54", "timestamp": 1708745574, "time_this_iter_s": 15.402099609375, "time_total_s": 1293.5780806541443, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1293.5780806541443, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 56.35263157894736, "ram_util_percent": 16.86842105263158, "gpu_util_percent0": 0.3036842105263157, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -286.7761952711069, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.62293645915798, -185.30663009062596, -188.08699466592617, -185.23377196695145, -195.26804381729374, -183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2677857808483117, "mean_inference_ms": 1.3669939128627435, "mean_action_processing_ms": 0.14968840805697875, "mean_env_wait_ms": 0.8062134294234603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 417600, "timesteps_this_iter": 0, "agent_timesteps_total": 417600, "timers": {"learn_time_ms": 2103.862, "learn_throughput": 0.951, "update_time_ms": 11.491}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.5373088121414185, "grad_norm": 21.114686965942383, "td_error_abs": 1.004491455078125, "q_taken_mean": -0.4328752848307292, "target_mean": -0.59962548828125}}}, "num_steps_sampled": 417600, "num_agent_steps_sampled": 417600, "num_steps_trained": 174, "num_agent_steps_trained": 835200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 435, "training_iteration": 87, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-33-09", "timestamp": 1708745589, "time_this_iter_s": 14.646893739700317, "time_total_s": 1308.2249743938446, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1308.2249743938446, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 55.72222222222222, "ram_util_percent": 16.944444444444443, "gpu_util_percent0": 0.32111111111111107, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -286.77976542871914, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.6123830091954, -186.42505207009023, -189.45121894303023, -187.02957354557535, -195.7570872812899, -188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26786543536612567, "mean_inference_ms": 1.3674895313814412, "mean_action_processing_ms": 0.14971573147069697, "mean_env_wait_ms": 0.8063827826381729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 422400, "timesteps_this_iter": 0, "agent_timesteps_total": 422400, "timers": {"learn_time_ms": 2108.341, "learn_throughput": 0.949, "update_time_ms": 11.951}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.4233671426773071, "grad_norm": 19.494754791259766, "td_error_abs": 1.0092587076822916, "q_taken_mean": -1.0922132161458333, "target_mean": -0.22961812337239584}}}, "num_steps_sampled": 422400, "num_agent_steps_sampled": 422400, "num_steps_trained": 176, "num_agent_steps_trained": 844800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 440, "training_iteration": 88, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-33-24", "timestamp": 1708745604, "time_this_iter_s": 15.552111387252808, "time_total_s": 1323.7770857810974, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1323.7770857810974, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 56.51052631578948, "ram_util_percent": 16.910526315789475, "gpu_util_percent0": 0.32789473684210524, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -286.9102003867232, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.17089043008806, -187.3731627743754, -184.03983575006737, -182.64921588590758, -190.68911554260436, -187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26794191851468835, "mean_inference_ms": 1.3679815418594528, "mean_action_processing_ms": 0.14974216810629434, "mean_env_wait_ms": 0.8065570818795699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 427200, "timesteps_this_iter": 0, "agent_timesteps_total": 427200, "timers": {"learn_time_ms": 2080.171, "learn_throughput": 0.961, "update_time_ms": 11.603}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5822885632514954, "grad_norm": 1.3398817777633667, "td_error_abs": 0.48915376790364584, "q_taken_mean": 0.048082987467447914, "target_mean": 0.0878651123046875}}}, "num_steps_sampled": 427200, "num_agent_steps_sampled": 427200, "num_steps_trained": 178, "num_agent_steps_trained": 854400, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 445, "training_iteration": 89, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-33-39", "timestamp": 1708745619, "time_this_iter_s": 14.911827325820923, "time_total_s": 1338.6889131069183, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1338.6889131069183, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 55.49473684210527, "ram_util_percent": 17.131578947368418, "gpu_util_percent0": 0.3236842105263158, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -170.80803490182734, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -286.78102060035746, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.92306734754672, -188.94855171056096, -170.80803490182734, -187.1900168048583, -194.09509772610483, -182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2680184087631815, "mean_inference_ms": 1.3684488782746587, "mean_action_processing_ms": 0.14976752797243115, "mean_env_wait_ms": 0.8067547488438171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"learn_time_ms": 2071.241, "learn_throughput": 0.966, "update_time_ms": 11.383}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.611432671546936, "grad_norm": 1.5871676206588745, "td_error_abs": 0.5057574055989583, "q_taken_mean": 0.10868771362304687, "target_mean": 0.08315620930989584}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 180, "num_agent_steps_trained": 864000, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 450, "training_iteration": 90, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-33-55", "timestamp": 1708745635, "time_this_iter_s": 15.10569453239441, "time_total_s": 1353.7946076393127, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1353.7946076393127, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 56.01666666666666, "ram_util_percent": 17.122222222222224, "gpu_util_percent0": 0.3055555555555556, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -178.5804259934435, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -286.9676562534526, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.82964686096722, -181.7936283810676, -181.91030825183412, -181.6971044117497, -178.87490817971394, -398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26809278542752335, "mean_inference_ms": 1.368917900844429, "mean_action_processing_ms": 0.14979113030498414, "mean_env_wait_ms": 0.8069370807136454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 436800, "timesteps_this_iter": 0, "agent_timesteps_total": 436800, "timers": {"learn_time_ms": 2088.898, "learn_throughput": 0.957, "update_time_ms": 11.104}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5286379456520081, "grad_norm": 0.8722142577171326, "td_error_abs": 0.47115262858072915, "q_taken_mean": 0.07053542073567709, "target_mean": 0.08071186828613282}}}, "num_steps_sampled": 436800, "num_agent_steps_sampled": 436800, "num_steps_trained": 182, "num_agent_steps_trained": 873600, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 455, "training_iteration": 91, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-34-10", "timestamp": 1708745650, "time_this_iter_s": 15.253796100616455, "time_total_s": 1369.0484037399292, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1369.0484037399292, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 55.78947368421053, "ram_util_percent": 17.178947368421053, "gpu_util_percent0": 0.31789473684210523, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -286.7210887271141, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-398.6201742696293, -416.96993060855226, -443.8193360830111, -415.84817712996204, -333.67824536674783, -179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26816038574447487, "mean_inference_ms": 1.3693749278900251, "mean_action_processing_ms": 0.14981325564622544, "mean_env_wait_ms": 0.8071439953141814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 441600, "timesteps_this_iter": 0, "agent_timesteps_total": 441600, "timers": {"learn_time_ms": 2087.36, "learn_throughput": 0.958, "update_time_ms": 10.681}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.0761845111846924, "grad_norm": 2.8887312412261963, "td_error_abs": 0.6110184326171875, "q_taken_mean": 0.09827571614583333, "target_mean": 0.07183385721842447}}}, "num_steps_sampled": 441600, "num_agent_steps_sampled": 441600, "num_steps_trained": 184, "num_agent_steps_trained": 883200, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 460, "training_iteration": 92, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-34-25", "timestamp": 1708745665, "time_this_iter_s": 15.175384044647217, "time_total_s": 1384.2237877845764, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1384.2237877845764, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 55.72105263157895, "ram_util_percent": 17.23157894736842, "gpu_util_percent0": 0.32, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -276.5914032244587, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.95728830586052, -188.11111986275293, -192.4684601499791, -190.26125778918745, -178.5804259934435, -188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26822763199114147, "mean_inference_ms": 1.369836677116436, "mean_action_processing_ms": 0.1498357397339248, "mean_env_wait_ms": 0.8073722856654162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 446400, "timesteps_this_iter": 0, "agent_timesteps_total": 446400, "timers": {"learn_time_ms": 2081.759, "learn_throughput": 0.961, "update_time_ms": 10.409}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.284916639328003, "grad_norm": 3.209052085876465, "td_error_abs": 0.5520667317708333, "q_taken_mean": 0.016619805653889975, "target_mean": 0.06175094095865885}}}, "num_steps_sampled": 446400, "num_agent_steps_sampled": 446400, "num_steps_trained": 186, "num_agent_steps_trained": 892800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 465, "training_iteration": 93, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-34-40", "timestamp": 1708745680, "time_this_iter_s": 15.328384160995483, "time_total_s": 1399.552171945572, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1399.552171945572, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 55.97368421052633, "ram_util_percent": 17.236842105263154, "gpu_util_percent0": 0.3273684210526316, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -276.7231956860894, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.52249990370518, -182.38985541048055, -185.3714994205005, -182.57792872925927, -191.78949136009527, -184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2682869719702321, "mean_inference_ms": 1.370296793264894, "mean_action_processing_ms": 0.14985876329257386, "mean_env_wait_ms": 0.8076250398336603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 451200, "timesteps_this_iter": 0, "agent_timesteps_total": 451200, "timers": {"learn_time_ms": 2078.912, "learn_throughput": 0.962, "update_time_ms": 10.763}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9613184928894043, "grad_norm": 1.4380366802215576, "td_error_abs": 0.5285802001953125, "q_taken_mean": 0.0059655946095784505, "target_mean": 0.08832400512695313}}}, "num_steps_sampled": 451200, "num_agent_steps_sampled": 451200, "num_steps_trained": 188, "num_agent_steps_trained": 902400, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 470, "training_iteration": 94, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-34-56", "timestamp": 1708745696, "time_this_iter_s": 15.203278064727783, "time_total_s": 1414.7554500102997, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1414.7554500102997, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 55.93157894736842, "ram_util_percent": 17.46315789473684, "gpu_util_percent0": 0.3152631578947368, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -276.85580678693907, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.90873997065475, -190.08178188917952, -194.23893332970923, -183.05890189293518, -186.2765306520326, -184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123, -188.87246271764684, -182.98422540281825, -191.9643121157213, -190.9953043572895, -189.09608031553205], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2683437082847864, "mean_inference_ms": 1.370786661919781, "mean_action_processing_ms": 0.14988303851224882, "mean_env_wait_ms": 0.8079032260368791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"learn_time_ms": 2066.884, "learn_throughput": 0.968, "update_time_ms": 11.005}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5989313125610352, "grad_norm": 0.9358409643173218, "td_error_abs": 0.48160400390625, "q_taken_mean": 0.12817718505859374, "target_mean": 0.07924934895833333}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 190, "num_agent_steps_trained": 912000, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 475, "training_iteration": 95, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-35-11", "timestamp": 1708745711, "time_this_iter_s": 15.247413635253906, "time_total_s": 1430.0028636455536, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1430.0028636455536, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 56.46111111111111, "ram_util_percent": 17.422222222222224, "gpu_util_percent0": 0.3288888888888889, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -276.79594419731467, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.30187918461652, -184.90474403915778, -186.35477239121713, -185.58184507010887, -189.61554865116105, -193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123, -188.87246271764684, -182.98422540281825, -191.9643121157213, -190.9953043572895, -189.09608031553205, -181.78277512290683, -180.64469253360772, -190.2184486010925, -187.98018352280195, -191.9525289916584], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2683903966686387, "mean_inference_ms": 1.371256097916013, "mean_action_processing_ms": 0.1499053745578264, "mean_env_wait_ms": 0.8081759263521602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"learn_time_ms": 2056.292, "learn_throughput": 0.973, "update_time_ms": 11.026}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.596030056476593, "grad_norm": 0.691921055316925, "td_error_abs": 0.48097745768229166, "q_taken_mean": 0.08632830810546875, "target_mean": 0.08194292195638021}}}, "num_steps_sampled": 460800, "num_agent_steps_sampled": 460800, "num_steps_trained": 192, "num_agent_steps_trained": 921600, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 480, "training_iteration": 96, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-35-26", "timestamp": 1708745726, "time_this_iter_s": 14.947938680648804, "time_total_s": 1444.9508023262024, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1444.9508023262024, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 55.663157894736834, "ram_util_percent": 17.521052631578947, "gpu_util_percent0": 0.32421052631578945, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -276.98109981938893, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.3621039624837, -184.21154072247555, -187.35690140612536, -183.55253857509285, -190.87727519162095, -191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123, -188.87246271764684, -182.98422540281825, -191.9643121157213, -190.9953043572895, -189.09608031553205, -181.78277512290683, -180.64469253360772, -190.2184486010925, -187.98018352280195, -191.9525289916584, -191.93393714188707, -185.54470417590105, -187.3675183844099, -191.7701753044711, -192.6580165370161], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2684409597451949, "mean_inference_ms": 1.3717162298008538, "mean_action_processing_ms": 0.14992915620438108, "mean_env_wait_ms": 0.8084807751230828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 465600, "timesteps_this_iter": 0, "agent_timesteps_total": 465600, "timers": {"learn_time_ms": 2064.459, "learn_throughput": 0.969, "update_time_ms": 11.301}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5576267242431641, "grad_norm": 0.6374930739402771, "td_error_abs": 0.47177848307291664, "q_taken_mean": 0.09263756306966146, "target_mean": 0.08105879211425782}}}, "num_steps_sampled": 465600, "num_agent_steps_sampled": 465600, "num_steps_trained": 194, "num_agent_steps_trained": 931200, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 485, "training_iteration": 97, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-35-41", "timestamp": 1708745741, "time_this_iter_s": 15.484734535217285, "time_total_s": 1460.4355368614197, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1460.4355368614197, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 56.07368421052631, "ram_util_percent": 17.531578947368423, "gpu_util_percent0": 0.3131578947368421, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -276.92347261811074, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.47319573233293, -188.12059108679884, -185.57963809246667, -182.0494775727363, -187.19276641186127, -184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123, -188.87246271764684, -182.98422540281825, -191.9643121157213, -190.9953043572895, -189.09608031553205, -181.78277512290683, -180.64469253360772, -190.2184486010925, -187.98018352280195, -191.9525289916584, -191.93393714188707, -185.54470417590105, -187.3675183844099, -191.7701753044711, -192.6580165370161, -188.16890575575184, -184.75847834896857, -184.8077098153652, -187.81288867731814, -188.0496571325732], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2684870932234775, "mean_inference_ms": 1.372160454951981, "mean_action_processing_ms": 0.14994965599929735, "mean_env_wait_ms": 0.8087626885288486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 470400, "timesteps_this_iter": 0, "agent_timesteps_total": 470400, "timers": {"learn_time_ms": 2063.653, "learn_throughput": 0.969, "update_time_ms": 11.061}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5773653984069824, "grad_norm": 0.6587890386581421, "td_error_abs": 0.4827564290364583, "q_taken_mean": 0.09185311889648437, "target_mean": 0.08147087097167968}}}, "num_steps_sampled": 470400, "num_agent_steps_sampled": 470400, "num_steps_trained": 196, "num_agent_steps_trained": 940800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 490, "training_iteration": 98, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-35-57", "timestamp": 1708745757, "time_this_iter_s": 15.39152717590332, "time_total_s": 1475.827064037323, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1475.827064037323, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 55.73684210526316, "ram_util_percent": 17.52631578947368, "gpu_util_percent0": 0.31263157894736837, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -277.1323345670182, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.1720877512934, -186.24737959905562, -185.67712685392087, -191.84589689776675, -189.70552471960218, -181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123, -188.87246271764684, -182.98422540281825, -191.9643121157213, -190.9953043572895, -189.09608031553205, -181.78277512290683, -180.64469253360772, -190.2184486010925, -187.98018352280195, -191.9525289916584, -191.93393714188707, -185.54470417590105, -187.3675183844099, -191.7701753044711, -192.6580165370161, -188.16890575575184, -184.75847834896857, -184.8077098153652, -187.81288867731814, -188.0496571325732, -192.63028188251965, -188.3777877430684, -194.46617646028102, -188.09175319665226, -191.7358645044198], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2685363889682826, "mean_inference_ms": 1.372609748402667, "mean_action_processing_ms": 0.1499712342614683, "mean_env_wait_ms": 0.8090677146062738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 475200, "timesteps_this_iter": 0, "agent_timesteps_total": 475200, "timers": {"learn_time_ms": 2068.844, "learn_throughput": 0.967, "update_time_ms": 10.957}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5483803749084473, "grad_norm": 0.5231165289878845, "td_error_abs": 0.47475870768229167, "q_taken_mean": 0.08231853230794271, "target_mean": 0.08087980143229166}}}, "num_steps_sampled": 475200, "num_agent_steps_sampled": 475200, "num_steps_trained": 198, "num_agent_steps_trained": 950400, "last_target_update_ts": 475200, "num_steps_trained_this_iter": 0, "num_target_updates": 9}, "done": false, "episodes_total": 495, "training_iteration": 99, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-36-12", "timestamp": 1708745772, "time_this_iter_s": 15.212457656860352, "time_total_s": 1491.0395216941833, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1491.0395216941833, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 56.099999999999994, "ram_util_percent": 17.738888888888894, "gpu_util_percent0": 0.32055555555555554, "vram_util_percent0": 0.03975423177083334}}
{"episode_reward_max": -172.41946767601928, "episode_reward_min": -1268.0435277750578, "episode_reward_mean": -277.184657930499, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.79394887220982, -181.00378587174643, -189.49239729290218, -191.86006303219656, -187.7841778410361, -187.9930117389746, -183.47772430333205, -189.22544291109296, -181.77648540084942, -190.1174318725731, -190.4412179573039, -189.99734404028743, -185.6995232083919, -183.86036262424307, -186.84287808972493, -183.06407031197975, -189.42457620071704, -186.46408697041207, -191.44363583503855, -185.0894931925264, -181.89282515096136, -180.92862353889925, -190.86724395092824, -184.6141066308711, -185.54193573850424, -919.6361379745078, -896.508586166162, -893.0357621425119, -908.7574660925142, -905.9123572847293, -1260.3209993745274, -1261.7936290564846, -1268.0435277750578, -1249.49077210352, -1257.9242077249885, -191.87549031860186, -186.30412317242426, -185.43308293558144, -185.09994620342738, -186.1627501311501, -195.42821176201195, -191.31830699410918, -186.2521762646895, -193.128788806767, -189.1913268220034, -183.81370431075925, -185.17311191259677, -180.9928283255549, -185.3521427687351, -184.6724544288224, -186.50475069803758, -192.06377761951214, -194.30405621487134, -192.58822817590794, -182.16752109209563, -172.41946767601928, -178.1843302085358, -179.83703517491594, -173.680630653166, -178.3273797388362, -214.82943818900648, -204.55065844599986, -185.7798082975958, -193.94045091450454, -196.86695734525293, -193.25287405968888, -191.977540109151, -189.847262368602, -183.9162814797322, -183.563840247123, -188.87246271764684, -182.98422540281825, -191.9643121157213, -190.9953043572895, -189.09608031553205, -181.78277512290683, -180.64469253360772, -190.2184486010925, -187.98018352280195, -191.9525289916584, -191.93393714188707, -185.54470417590105, -187.3675183844099, -191.7701753044711, -192.6580165370161, -188.16890575575184, -184.75847834896857, -184.8077098153652, -187.81288867731814, -188.0496571325732, -192.63028188251965, -188.3777877430684, -194.46617646028102, -188.09175319665226, -191.7358645044198, -191.1007407810987, -190.4226713784094, -186.13509542181384, -185.66220679706194, -189.55963779134348], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2685823481299121, "mean_inference_ms": 1.373044124811822, "mean_action_processing_ms": 0.14999126455340062, "mean_env_wait_ms": 0.8093574723104928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"learn_time_ms": 2065.769, "learn_throughput": 0.968, "update_time_ms": 10.575}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.560353696346283, "grad_norm": 1.4082667827606201, "td_error_abs": 0.48652486165364583, "q_taken_mean": 0.08908267211914063, "target_mean": 0.12925937906901042}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 200, "num_agent_steps_trained": 960000, "last_target_update_ts": 475200, "num_steps_trained_this_iter": 0, "num_target_updates": 9}, "evaluation": {"episode_reward_max": -168.24773740437794, "episode_reward_min": -174.7773164077911, "episode_reward_mean": -171.93163641087327, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.8325430556862, -170.360258622842, -168.24773740437794, -172.302368924884, -172.08723987722422, -174.7773164077911, -172.6774572637314, -172.25871052924637, -170.3180424296938, -174.45468959325524], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27615160664185456, "mean_inference_ms": 1.209927042302573, "mean_action_processing_ms": 0.14900987356021117, "mean_env_wait_ms": 0.8134858806048463, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 500, "training_iteration": 100, "trial_id": "60850_00000", "experiment_id": "6ce5e9d96d264c2c9a2d784dd61c42e8", "date": "2024-02-24_09-36-51", "timestamp": 1708745811, "time_this_iter_s": 38.853225231170654, "time_total_s": 1529.892746925354, "pid": 34005, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1529.892746925354, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 57.239583333333336, "ram_util_percent": 17.808333333333334, "gpu_util_percent0": 0.31625, "vram_util_percent0": 0.039754231770833336}}
