{"episode_reward_max": -738.6214036705803, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -767.3726784563107, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1769051963655311, "mean_inference_ms": 0.9787190841214342, "mean_action_processing_ms": 0.11500275221873273, "mean_env_wait_ms": 0.5721174095225259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 4800, "timers": {"learn_time_ms": 1551.601, "learn_throughput": 1.289, "update_time_ms": 7.192}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9976699352264404, "grad_norm": 1.9778742790222168, "td_error_abs": 0.8965895182291667, "q_taken_mean": -0.0009192409515380859, "target_mean": -0.03701930745442708}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 4800, "num_steps_trained": 2, "num_agent_steps_trained": 9600, "last_target_update_ts": 0}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-14-33", "timestamp": 1708859673, "time_this_iter_s": 10.58197546005249, "time_total_s": 10.58197546005249, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 10.58197546005249, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 7.940000000000002, "gpu_util_percent0": 0.08866666666666667, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -679.400252645191, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -733.6991307000802, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17669887271089166, "mean_inference_ms": 0.977217025066191, "mean_action_processing_ms": 0.11464036817269904, "mean_env_wait_ms": 0.5691354294397115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"learn_time_ms": 1522.647, "learn_throughput": 1.314, "update_time_ms": 6.908}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7452504634857178, "grad_norm": 1.869676947593689, "td_error_abs": 0.7349562174479166, "q_taken_mean": -0.058108408610026044, "target_mean": -0.042235616048177084}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 9600, "num_steps_trained": 4, "num_agent_steps_trained": 19200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 2, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-14-43", "timestamp": 1708859683, "time_this_iter_s": 10.483120679855347, "time_total_s": 21.065096139907837, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 21.065096139907837, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.55, "ram_util_percent": 8.742857142857144, "gpu_util_percent0": 0.013571428571428571, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -607.9691141658883, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -705.7899558199201, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17669001677025217, "mean_inference_ms": 0.9768118502121559, "mean_action_processing_ms": 0.11449376090179361, "mean_env_wait_ms": 0.5682578374699508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"learn_time_ms": 1520.628, "learn_throughput": 1.315, "update_time_ms": 6.927}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.244202971458435, "grad_norm": 8.824243545532227, "td_error_abs": 0.9472989095052083, "q_taken_mean": -0.08225598653157552, "target_mean": -0.03899420928955078}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 14400, "num_steps_trained": 6, "num_agent_steps_trained": 28800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-14-54", "timestamp": 1708859694, "time_this_iter_s": 10.522726058959961, "time_total_s": 31.587822198867798, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 31.587822198867798, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.49285714285714, "ram_util_percent": 8.814285714285713, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -531.7560793632277, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -665.2886207001119, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17727612541229876, "mean_inference_ms": 0.9770026919614965, "mean_action_processing_ms": 0.11446523390079169, "mean_env_wait_ms": 0.5677005247346907, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"learn_time_ms": 1513.948, "learn_throughput": 1.321, "update_time_ms": 7.004}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7660542130470276, "grad_norm": 1.9635851383209229, "td_error_abs": 0.687538330078125, "q_taken_mean": 0.027313145955403646, "target_mean": -0.03729111989339193}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 19200, "num_steps_trained": 8, "num_agent_steps_trained": 38400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-15-05", "timestamp": 1708859705, "time_this_iter_s": 10.541950225830078, "time_total_s": 42.129772424697876, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 42.129772424697876, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.54285714285714, "ram_util_percent": 8.97857142857143, "gpu_util_percent0": 0.05000000000000001, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -443.64722253584154, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -624.0980323970059, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17750208755490748, "mean_inference_ms": 0.9768283242923985, "mean_action_processing_ms": 0.11439774325375503, "mean_env_wait_ms": 0.567196103319336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"learn_time_ms": 1502.781, "learn_throughput": 1.331, "update_time_ms": 7.016}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7013453841209412, "grad_norm": 1.204694151878357, "td_error_abs": 0.5502099202473958, "q_taken_mean": 0.09288960774739584, "target_mean": -0.033497665405273436}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 10, "num_agent_steps_trained": 48000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 5, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-15-15", "timestamp": 1708859715, "time_this_iter_s": 10.451983451843262, "time_total_s": 52.58175587654114, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 52.58175587654114, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.892857142857146, "ram_util_percent": 9.02142857142857, "gpu_util_percent0": 0.02428571428571429, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -403.71078410503594, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -589.7326544247287, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17762032884437842, "mean_inference_ms": 0.9767715206154455, "mean_action_processing_ms": 0.11434529921762203, "mean_env_wait_ms": 0.5668466240735058, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"learn_time_ms": 1500.786, "learn_throughput": 1.333, "update_time_ms": 6.995}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6511169672012329, "grad_norm": 1.1136622428894043, "td_error_abs": 0.5227430013020833, "q_taken_mean": 0.07542159016927083, "target_mean": -0.03699858093261719}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 28800, "num_steps_trained": 12, "num_agent_steps_trained": 57600, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 6, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-15-26", "timestamp": 1708859726, "time_this_iter_s": 10.473264455795288, "time_total_s": 63.055020332336426, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 63.055020332336426, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.349999999999998, "ram_util_percent": 9.0, "gpu_util_percent0": 0.014285714285714287, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -403.71078410503594, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -568.4511317001169, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1777820190760507, "mean_inference_ms": 0.9768031100568564, "mean_action_processing_ms": 0.11431505276316149, "mean_env_wait_ms": 0.566726936960314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 33600, "timers": {"learn_time_ms": 1499.366, "learn_throughput": 1.334, "update_time_ms": 7.016}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5668407678604126, "grad_norm": 0.8784389495849609, "td_error_abs": 0.4594788411458333, "q_taken_mean": 0.06279497782389323, "target_mean": -0.031924957275390624}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 33600, "num_steps_trained": 14, "num_agent_steps_trained": 67200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 7, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-15-36", "timestamp": 1708859736, "time_this_iter_s": 10.542261600494385, "time_total_s": 73.59728193283081, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 73.59728193283081, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.47142857142857, "ram_util_percent": 9.107142857142856, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -223.43563497101405, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -527.7877264874369, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17786869857413867, "mean_inference_ms": 0.9769287291091941, "mean_action_processing_ms": 0.11428137016357627, "mean_env_wait_ms": 0.5665186828046898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"learn_time_ms": 1494.957, "learn_throughput": 1.338, "update_time_ms": 7.076}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.48835134506225586, "grad_norm": 0.8888080716133118, "td_error_abs": 0.4145699869791667, "q_taken_mean": 0.016092867533365886, "target_mean": -0.033281224568684896}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 16, "num_agent_steps_trained": 76800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 8, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-15-47", "timestamp": 1708859747, "time_this_iter_s": 10.511489629745483, "time_total_s": 84.1087715625763, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 84.1087715625763, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.214285714285715, "ram_util_percent": 9.200000000000001, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -223.43563497101405, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -506.15576836116503, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17793704762865115, "mean_inference_ms": 0.977124789035463, "mean_action_processing_ms": 0.1142626946333848, "mean_env_wait_ms": 0.5664848856705013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"learn_time_ms": 1497.33, "learn_throughput": 1.336, "update_time_ms": 7.063}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5563532114028931, "grad_norm": 4.523889064788818, "td_error_abs": 0.4736710611979167, "q_taken_mean": 0.2803441365559896, "target_mean": -0.029963831583658854}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 43200, "num_steps_trained": 18, "num_agent_steps_trained": 86400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 9, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-15-57", "timestamp": 1708859757, "time_this_iter_s": 10.598758220672607, "time_total_s": 94.7075297832489, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 94.7075297832489, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.41428571428571, "ram_util_percent": 9.207142857142857, "gpu_util_percent0": 0.03071428571428572, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -473.18308188157675, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17799374163479317, "mean_inference_ms": 0.9773237065022125, "mean_action_processing_ms": 0.11424441372398697, "mean_env_wait_ms": 0.5664847071231898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"learn_time_ms": 1494.114, "learn_throughput": 1.339, "update_time_ms": 7.067}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8103615641593933, "grad_norm": 3.687917709350586, "td_error_abs": 0.5464940592447917, "q_taken_mean": -0.06191253662109375, "target_mean": -0.03073565673828125}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 20, "num_agent_steps_trained": 96000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 10, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-16-08", "timestamp": 1708859768, "time_this_iter_s": 10.49720287322998, "time_total_s": 105.20473265647888, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 105.20473265647888, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.428571428571427, "ram_util_percent": 9.314285714285715, "gpu_util_percent0": 0.03357142857142857, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -448.1206770334042, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17806095036913563, "mean_inference_ms": 0.9776600065130675, "mean_action_processing_ms": 0.11424007547654574, "mean_env_wait_ms": 0.5664735967114561, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 52800, "timers": {"learn_time_ms": 1488.209, "learn_throughput": 1.344, "update_time_ms": 7.067}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.0498030185699463, "grad_norm": 2.9289631843566895, "td_error_abs": 0.587231201171875, "q_taken_mean": 0.08503049723307292, "target_mean": -0.04870780436197917}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 52800, "num_steps_trained": 22, "num_agent_steps_trained": 105600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 55, "training_iteration": 11, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-16-18", "timestamp": 1708859778, "time_this_iter_s": 10.688953399658203, "time_total_s": 115.89368605613708, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 115.89368605613708, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.400000000000006, "ram_util_percent": 9.314285714285715, "gpu_util_percent0": 0.015, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -427.8837053787291, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17814349309271246, "mean_inference_ms": 0.9779971057744579, "mean_action_processing_ms": 0.1142406253000695, "mean_env_wait_ms": 0.5664550304300647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"learn_time_ms": 1487.087, "learn_throughput": 1.345, "update_time_ms": 7.099}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8959534764289856, "grad_norm": 4.428015232086182, "td_error_abs": 0.5398043212890625, "q_taken_mean": -0.07850023396809896, "target_mean": 0.1292808837890625}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 57600, "num_steps_trained": 24, "num_agent_steps_trained": 115200, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-16-29", "timestamp": 1708859789, "time_this_iter_s": 10.563066005706787, "time_total_s": 126.45675206184387, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 126.45675206184387, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.657142857142862, "ram_util_percent": 9.371428571428575, "gpu_util_percent0": 0.025, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -409.1347434699538, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17824293906078836, "mean_inference_ms": 0.9782188197372874, "mean_action_processing_ms": 0.11423790531043782, "mean_env_wait_ms": 0.5663857472102877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 62400, "timers": {"learn_time_ms": 1485.694, "learn_throughput": 1.346, "update_time_ms": 7.096}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.1930447816848755, "grad_norm": 9.810784339904785, "td_error_abs": 0.7043689778645833, "q_taken_mean": 0.2891171061197917, "target_mean": -0.2874830525716146}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 62400, "num_steps_trained": 26, "num_agent_steps_trained": 124800, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 65, "training_iteration": 13, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-16-40", "timestamp": 1708859800, "time_this_iter_s": 10.443278789520264, "time_total_s": 136.90003085136414, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 136.90003085136414, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.50714285714286, "ram_util_percent": 9.335714285714285, "gpu_util_percent0": 0.022857142857142857, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -394.439990257512, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17832605021544043, "mean_inference_ms": 0.9784411504593367, "mean_action_processing_ms": 0.11423698009896384, "mean_env_wait_ms": 0.5663619815984466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"learn_time_ms": 1483.757, "learn_throughput": 1.348, "update_time_ms": 7.086}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.056908369064331, "grad_norm": 8.95247745513916, "td_error_abs": 0.6584413248697917, "q_taken_mean": -0.34198763020833334, "target_mean": 0.12392451985677083}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 67200, "num_steps_trained": 28, "num_agent_steps_trained": 134400, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 70, "training_iteration": 14, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-16-50", "timestamp": 1708859810, "time_this_iter_s": 10.653847455978394, "time_total_s": 147.55387830734253, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 147.55387830734253, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.414285714285718, "ram_util_percent": 9.52142857142857, "gpu_util_percent0": 0.023571428571428573, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -382.09519930424443, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17840676018289198, "mean_inference_ms": 0.9786621538059556, "mean_action_processing_ms": 0.11423890639864648, "mean_env_wait_ms": 0.5663947239393982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"learn_time_ms": 1484.627, "learn_throughput": 1.347, "update_time_ms": 7.099}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7560781240463257, "grad_norm": 0.8186215758323669, "td_error_abs": 0.4230908203125, "q_taken_mean": 0.20620914713541666, "target_mean": 0.12921214803059897}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 30, "num_agent_steps_trained": 144000, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 75, "training_iteration": 15, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-17-01", "timestamp": 1708859821, "time_this_iter_s": 10.58152985572815, "time_total_s": 158.13540816307068, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 158.13540816307068, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 30.357142857142858, "ram_util_percent": 9.507142857142856, "gpu_util_percent0": 0.02428571428571429, "vram_util_percent0": 0.026652018229166675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -371.11510143562424, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17847819195356496, "mean_inference_ms": 0.97885519318069, "mean_action_processing_ms": 0.11424181517942741, "mean_env_wait_ms": 0.566463906350536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"learn_time_ms": 1484.572, "learn_throughput": 1.347, "update_time_ms": 7.131}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7062569856643677, "grad_norm": 0.7614555954933167, "td_error_abs": 0.41018424479166665, "q_taken_mean": 0.2225517374674479, "target_mean": 0.1292725626627604}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 32, "num_agent_steps_trained": 153600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 80, "training_iteration": 16, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-17-11", "timestamp": 1708859831, "time_this_iter_s": 10.573016166687012, "time_total_s": 168.7084243297577, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 168.7084243297577, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.328571428571433, "ram_util_percent": 9.578571428571426, "gpu_util_percent0": 0.013571428571428571, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -361.2566750508355, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17853725049067792, "mean_inference_ms": 0.9790564683353443, "mean_action_processing_ms": 0.1142450272642099, "mean_env_wait_ms": 0.5665262150302607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 81600, "timers": {"learn_time_ms": 1484.501, "learn_throughput": 1.347, "update_time_ms": 7.111}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6628677845001221, "grad_norm": 0.7252560257911682, "td_error_abs": 0.4083532307942708, "q_taken_mean": 0.2036881103515625, "target_mean": 0.12945733642578125}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 81600, "num_steps_trained": 34, "num_agent_steps_trained": 163200, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 85, "training_iteration": 17, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-17-22", "timestamp": 1708859842, "time_this_iter_s": 10.551882982254028, "time_total_s": 179.26030731201172, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 179.26030731201172, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 30.585714285714285, "ram_util_percent": 9.592857142857142, "gpu_util_percent0": 0.02428571428571429, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -352.69255544921987, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1785946260947433, "mean_inference_ms": 0.979253073308698, "mean_action_processing_ms": 0.114244286315028, "mean_env_wait_ms": 0.5666115684819211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"learn_time_ms": 1486.343, "learn_throughput": 1.346, "update_time_ms": 7.104}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6138196587562561, "grad_norm": 0.7436866760253906, "td_error_abs": 0.4019645182291667, "q_taken_mean": 0.20605126953125, "target_mean": 0.129822265625}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 86400, "num_steps_trained": 36, "num_agent_steps_trained": 172800, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 90, "training_iteration": 18, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-17-33", "timestamp": 1708859853, "time_this_iter_s": 10.586538791656494, "time_total_s": 189.8468461036682, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 189.8468461036682, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.37142857142857, "ram_util_percent": 9.785714285714286, "gpu_util_percent0": 0.02214285714285714, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -345.1459531433509, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17864454094092694, "mean_inference_ms": 0.9794167004228354, "mean_action_processing_ms": 0.11424373704775556, "mean_env_wait_ms": 0.5667089514858447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 91200, "timers": {"learn_time_ms": 1484.342, "learn_throughput": 1.347, "update_time_ms": 7.1}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5604751110076904, "grad_norm": 0.7689803242683411, "td_error_abs": 0.39089493815104165, "q_taken_mean": 0.17415555826822918, "target_mean": 0.13007620239257814}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 91200, "num_steps_trained": 38, "num_agent_steps_trained": 182400, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 95, "training_iteration": 19, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-17-43", "timestamp": 1708859863, "time_this_iter_s": 10.54927682876587, "time_total_s": 200.39612293243408, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 200.39612293243408, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.550000000000004, "ram_util_percent": 9.77142857142857, "gpu_util_percent0": 0.02214285714285714, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -798.6622343735922, "episode_reward_mean": -338.1177887496116, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6622343735922, -756.5098936096489, -738.6214036705803, -762.3920001728528, -780.6778604548795, -679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17868784646892938, "mean_inference_ms": 0.9795689894682382, "mean_action_processing_ms": 0.11424390115821906, "mean_env_wait_ms": 0.566815424116762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"learn_time_ms": 1485.262, "learn_throughput": 1.347, "update_time_ms": 7.142}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5527359843254089, "grad_norm": 1.8469361066818237, "td_error_abs": 0.4034810791015625, "q_taken_mean": 0.23819047037760416, "target_mean": 0.129446533203125}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 40, "num_agent_steps_trained": 192000, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 20, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-17-54", "timestamp": 1708859874, "time_this_iter_s": 10.541888952255249, "time_total_s": 210.93801188468933, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 210.93801188468933, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.435714285714287, "ram_util_percent": 9.828571428571427, "gpu_util_percent0": 0.014285714285714287, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -723.2859375401281, "episode_reward_mean": -309.0554910624601, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-679.9402589247261, -694.6506594521401, -679.400252645191, -722.8508061570632, -723.2859375401281, -648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17881091844660818, "mean_inference_ms": 0.9797390024016737, "mean_action_processing_ms": 0.11420345534020848, "mean_env_wait_ms": 0.5666193502233959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"learn_time_ms": 1483.605, "learn_throughput": 1.348, "update_time_ms": 7.103}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7422101497650146, "grad_norm": 5.015285015106201, "td_error_abs": 0.51779052734375, "q_taken_mean": -0.012131488800048829, "target_mean": -0.26738429768880206}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 100800, "num_steps_trained": 42, "num_agent_steps_trained": 201600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 105, "training_iteration": 21, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-18-04", "timestamp": 1708859884, "time_this_iter_s": 10.459871768951416, "time_total_s": 221.39788365364075, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 221.39788365364075, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.628571428571426, "ram_util_percent": 9.921428571428574, "gpu_util_percent0": 0.023571428571428573, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -678.8639665500045, "episode_reward_mean": -284.26740236335655, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.7399673427767, -664.2247156319777, -607.9691141658883, -678.8639665500045, -650.0602666073524, -554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17894948254424442, "mean_inference_ms": 0.9800599283324878, "mean_action_processing_ms": 0.11419859145109496, "mean_env_wait_ms": 0.5667121811892821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"learn_time_ms": 1480.245, "learn_throughput": 1.351, "update_time_ms": 7.11}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8718221783638, "grad_norm": 3.060635805130005, "td_error_abs": 0.5408196614583334, "q_taken_mean": -0.3105510660807292, "target_mean": -0.1455155029296875}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 105600, "num_steps_trained": 44, "num_agent_steps_trained": 211200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 110, "training_iteration": 22, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-18-15", "timestamp": 1708859895, "time_this_iter_s": 10.463100910186768, "time_total_s": 231.86098456382751, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 231.86098456382751, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.47692307692307, "ram_util_percent": 9.907692307692308, "gpu_util_percent0": 0.026153846153846156, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -559.1484890663284, "episode_reward_mean": -262.04604947741626, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-554.6132658557325, -539.2707851018696, -534.1344573162787, -531.7560793632277, -559.1484890663284, -459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17908400596108687, "mean_inference_ms": 0.980387190654756, "mean_action_processing_ms": 0.11419749900721168, "mean_env_wait_ms": 0.5667764768755192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 110400, "timesteps_this_iter": 0, "agent_timesteps_total": 110400, "timers": {"learn_time_ms": 1478.109, "learn_throughput": 1.353, "update_time_ms": 7.131}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9437862038612366, "grad_norm": 1.5030587911605835, "td_error_abs": 0.5286138509114583, "q_taken_mean": -0.050901931762695314, "target_mean": -0.00965988032023112}}}, "num_steps_sampled": 110400, "num_agent_steps_sampled": 110400, "num_steps_trained": 46, "num_agent_steps_trained": 220800, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 115, "training_iteration": 23, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-18-25", "timestamp": 1708859905, "time_this_iter_s": 10.530848503112793, "time_total_s": 242.3918330669403, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 242.3918330669403, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.407142857142855, "ram_util_percent": 10.114285714285712, "gpu_util_percent0": 0.029285714285714286, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -472.8662675994124, "episode_reward_mean": -245.1125500532384, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-459.7463917247956, -462.95967983346446, -472.8662675994124, -457.4588342293969, -443.64722253584154, -424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17910117312556056, "mean_inference_ms": 0.980676950114472, "mean_action_processing_ms": 0.11418795818460666, "mean_env_wait_ms": 0.5668890833124184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"learn_time_ms": 1479.669, "learn_throughput": 1.352, "update_time_ms": 7.114}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8703950047492981, "grad_norm": 2.0491230487823486, "td_error_abs": 0.5171741129557291, "q_taken_mean": 0.03354027811686198, "target_mean": -0.008821864446004232}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 115200, "num_steps_trained": 48, "num_agent_steps_trained": 230400, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 120, "training_iteration": 24, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-18-36", "timestamp": 1708859916, "time_this_iter_s": 10.667250156402588, "time_total_s": 253.0590832233429, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 253.0590832233429, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.63571428571428, "ram_util_percent": 10.121428571428568, "gpu_util_percent0": 0.037142857142857144, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -444.59407116549323, "episode_reward_mean": -231.48487185964768, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-424.5486094283611, -403.71078410503594, -428.2716092042302, -404.67043997992704, -428.32738009916056, -441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17914806579897527, "mean_inference_ms": 0.9810363544047699, "mean_action_processing_ms": 0.11419054290506214, "mean_env_wait_ms": 0.5670252530528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"learn_time_ms": 1480.375, "learn_throughput": 1.351, "update_time_ms": 7.105}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8177904486656189, "grad_norm": 1.4509943723678589, "td_error_abs": 0.5173449300130208, "q_taken_mean": -0.07721742757161458, "target_mean": -0.03486583709716797}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 50, "num_agent_steps_trained": 240000, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 125, "training_iteration": 25, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-18-46", "timestamp": 1708859926, "time_this_iter_s": 10.4431734085083, "time_total_s": 263.5022566318512, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 263.5022566318512, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.264285714285716, "ram_util_percent": 10.207142857142857, "gpu_util_percent0": 0.018571428571428572, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -444.59407116549323, "episode_reward_mean": -219.86023465859125, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-441.7573102762398, -444.59407116549323, -444.2327716944834, -433.7774880927961, -439.44833553321604, -229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1792095572648748, "mean_inference_ms": 0.9813830102134097, "mean_action_processing_ms": 0.11419625450005304, "mean_env_wait_ms": 0.5671519512735166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"learn_time_ms": 1479.501, "learn_throughput": 1.352, "update_time_ms": 7.093}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7773905396461487, "grad_norm": 1.3151214122772217, "td_error_abs": 0.5072139078776041, "q_taken_mean": -0.012808144887288412, "target_mean": -0.03417405192057291}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 124800, "num_steps_trained": 52, "num_agent_steps_trained": 249600, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 130, "training_iteration": 26, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-18-57", "timestamp": 1708859937, "time_this_iter_s": 10.523998737335205, "time_total_s": 274.0262553691864, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 274.0262553691864, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.364285714285707, "ram_util_percent": 10.292857142857143, "gpu_util_percent0": 0.013571428571428571, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -336.4994153996868, "episode_reward_mean": -207.1992049998496, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-229.3186287318352, -255.73173475810248, -274.95324134061036, -232.28021019182128, -223.43563497101405, -333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17925057043350873, "mean_inference_ms": 0.9817391581465854, "mean_action_processing_ms": 0.11419988895660213, "mean_env_wait_ms": 0.5672278617363851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 129600, "timesteps_this_iter": 0, "agent_timesteps_total": 129600, "timers": {"learn_time_ms": 1480.129, "learn_throughput": 1.351, "update_time_ms": 7.146}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7457128167152405, "grad_norm": 1.0378530025482178, "td_error_abs": 0.498781494140625, "q_taken_mean": -0.04910585021972656, "target_mean": -0.03349429321289062}}}, "num_steps_sampled": 129600, "num_agent_steps_sampled": 129600, "num_steps_trained": 54, "num_agent_steps_trained": 259200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 135, "training_iteration": 27, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-19-08", "timestamp": 1708859948, "time_this_iter_s": 10.614365577697754, "time_total_s": 284.64062094688416, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 284.64062094688416, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.678571428571434, "ram_util_percent": 10.328571428571427, "gpu_util_percent0": 0.028571428571428574, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -336.4994153996868, "episode_reward_mean": -204.3795780980198, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333.56437521350875, -336.4994153996868, -329.8658062310703, -330.81306371208404, -334.7578561985984, -175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1793052169682227, "mean_inference_ms": 0.9820771341816642, "mean_action_processing_ms": 0.11420876131661047, "mean_env_wait_ms": 0.5673394510476222, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"learn_time_ms": 1481.741, "learn_throughput": 1.35, "update_time_ms": 7.115}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7140547037124634, "grad_norm": 1.091163992881775, "td_error_abs": 0.49639017740885416, "q_taken_mean": -0.018277018229166667, "target_mean": -0.03468291219075521}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 134400, "num_steps_trained": 56, "num_agent_steps_trained": 268800, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 140, "training_iteration": 28, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-19-18", "timestamp": 1708859958, "time_this_iter_s": 10.549564361572266, "time_total_s": 295.1901853084564, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 295.1901853084564, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.599999999999994, "ram_util_percent": 10.478571428571428, "gpu_util_percent0": 0.018571428571428572, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -172.59014542117512, "episode_reward_min": -212.90407601974272, "episode_reward_mean": -197.0896315008474, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.47567532869292, -173.78947987121225, -172.59014542117512, -185.85500215401294, -174.43421505131724, -197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17935747342114325, "mean_inference_ms": 0.9823875543239463, "mean_action_processing_ms": 0.11421493807883182, "mean_env_wait_ms": 0.5673741877710825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 139200, "timesteps_this_iter": 0, "agent_timesteps_total": 139200, "timers": {"learn_time_ms": 1481.616, "learn_throughput": 1.35, "update_time_ms": 7.116}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6809954047203064, "grad_norm": 0.9443554282188416, "td_error_abs": 0.49180550130208334, "q_taken_mean": -0.04582170613606771, "target_mean": -0.035605305989583336}}}, "num_steps_sampled": 139200, "num_agent_steps_sampled": 139200, "num_steps_trained": 58, "num_agent_steps_trained": 278400, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 145, "training_iteration": 29, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-19-29", "timestamp": 1708859969, "time_this_iter_s": 10.517307758331299, "time_total_s": 305.7074930667877, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 305.7074930667877, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.561538461538458, "ram_util_percent": 10.430769230769233, "gpu_util_percent0": 0.026153846153846156, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -180.01578327723234, "episode_reward_min": -212.90407601974272, "episode_reward_mean": -197.77109280761786, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.9040489215016, -194.81036247737845, -198.12113474348408, -197.02651507105895, -199.6210815449749, -206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17940840630511912, "mean_inference_ms": 0.9826710589413004, "mean_action_processing_ms": 0.11422220444874633, "mean_env_wait_ms": 0.5674042794576262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"learn_time_ms": 1482.506, "learn_throughput": 1.349, "update_time_ms": 7.156}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.636480987071991, "grad_norm": 0.9715279340744019, "td_error_abs": 0.47234965006510415, "q_taken_mean": -0.021556612650553385, "target_mean": -0.032518587748209635}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 60, "num_agent_steps_trained": 288000, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 150, "training_iteration": 30, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-19-39", "timestamp": 1708859979, "time_this_iter_s": 10.587185621261597, "time_total_s": 316.2946786880493, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 316.2946786880493, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.235714285714284, "ram_util_percent": 10.657142857142858, "gpu_util_percent0": 0.025714285714285717, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -180.01578327723234, "episode_reward_min": -212.90407601974272, "episode_reward_mean": -197.13460283287102, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.93885556047297, -205.89678185754948, -200.58265366197335, -204.55698396384145, -208.40981084267224, -186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17945117795243817, "mean_inference_ms": 0.9828640264047158, "mean_action_processing_ms": 0.11422308598787737, "mean_env_wait_ms": 0.5674326094632782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 148800, "timesteps_this_iter": 0, "agent_timesteps_total": 148800, "timers": {"learn_time_ms": 1482.542, "learn_throughput": 1.349, "update_time_ms": 7.168}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6177221536636353, "grad_norm": 0.8430091738700867, "td_error_abs": 0.474571044921875, "q_taken_mean": -0.040321947733561195, "target_mean": -0.03313371785481771}}}, "num_steps_sampled": 148800, "num_agent_steps_sampled": 148800, "num_steps_trained": 62, "num_agent_steps_trained": 297600, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 155, "training_iteration": 31, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-19-50", "timestamp": 1708859990, "time_this_iter_s": 10.504567623138428, "time_total_s": 326.79924631118774, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 326.79924631118774, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.821428571428566, "ram_util_percent": 10.685714285714287, "gpu_util_percent0": 0.023571428571428573, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -180.01578327723234, "episode_reward_min": -212.90407601974272, "episode_reward_mean": -196.3500229640731, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.42527470492385, -182.1326814627523, -180.01578327723234, -182.66574746841678, -189.4965159099283, -203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17947768984871065, "mean_inference_ms": 0.983055027649944, "mean_action_processing_ms": 0.11422271915268373, "mean_env_wait_ms": 0.5674549855370202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 153600, "timers": {"learn_time_ms": 1486.542, "learn_throughput": 1.345, "update_time_ms": 7.196}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5913872122764587, "grad_norm": 0.9045661687850952, "td_error_abs": 0.46872452799479164, "q_taken_mean": -0.022186442057291665, "target_mean": -0.03306047566731771}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 153600, "num_steps_trained": 64, "num_agent_steps_trained": 307200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 160, "training_iteration": 32, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-20-00", "timestamp": 1708860000, "time_this_iter_s": 10.601118326187134, "time_total_s": 337.4003646373749, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 337.4003646373749, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.642857142857146, "ram_util_percent": 10.714285714285717, "gpu_util_percent0": 0.020714285714285716, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -181.06770678661357, "episode_reward_min": -212.90407601974272, "episode_reward_mean": -196.50785361891758, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.9455647167257, -211.1937666043351, -202.1219429146019, -199.9284187597067, -199.8512994834792, -204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1794962787038767, "mean_inference_ms": 0.983270989201247, "mean_action_processing_ms": 0.1142236558073324, "mean_env_wait_ms": 0.5675182034354213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 158400, "timesteps_this_iter": 0, "agent_timesteps_total": 158400, "timers": {"learn_time_ms": 1486.772, "learn_throughput": 1.345, "update_time_ms": 7.174}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5537886619567871, "grad_norm": 1.0317151546478271, "td_error_abs": 0.45383138020833336, "q_taken_mean": -0.06066655476888021, "target_mean": -0.03213777160644531}}}, "num_steps_sampled": 158400, "num_agent_steps_sampled": 158400, "num_steps_trained": 66, "num_agent_steps_trained": 316800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 165, "training_iteration": 33, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-20-11", "timestamp": 1708860011, "time_this_iter_s": 10.588939189910889, "time_total_s": 347.98930382728577, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 347.98930382728577, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 31.03571428571428, "ram_util_percent": 10.792857142857143, "gpu_util_percent0": 0.022857142857142857, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -181.06770678661357, "episode_reward_min": -212.90407601974272, "episode_reward_mean": -195.63946338439422, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.74277090963125, -209.2555138367332, -211.92753291684807, -207.51073610953256, -212.90407601974272, -206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1795148018477977, "mean_inference_ms": 0.9834636016380606, "mean_action_processing_ms": 0.11422358124859637, "mean_env_wait_ms": 0.5675583332027359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 163200, "timers": {"learn_time_ms": 1483.472, "learn_throughput": 1.348, "update_time_ms": 7.204}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5888140201568604, "grad_norm": 1.3321653604507446, "td_error_abs": 0.4860791015625, "q_taken_mean": 0.022952046712239584, "target_mean": 0.08110693359375}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 163200, "num_steps_trained": 68, "num_agent_steps_trained": 326400, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 170, "training_iteration": 34, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-20-22", "timestamp": 1708860022, "time_this_iter_s": 10.504969835281372, "time_total_s": 358.49427366256714, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 358.49427366256714, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.946153846153848, "ram_util_percent": 10.815384615384614, "gpu_util_percent0": 0.014615384615384615, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -181.06770678661357, "episode_reward_min": -212.42805789033076, "episode_reward_mean": -194.53480325372982, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.2487668339158, -202.81601513176926, -207.15179960874843, -207.3321633373307, -208.5194221198417, -203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17952526904924934, "mean_inference_ms": 0.9836613360704248, "mean_action_processing_ms": 0.11422169771074986, "mean_env_wait_ms": 0.5675455817854929, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"learn_time_ms": 1485.121, "learn_throughput": 1.347, "update_time_ms": 7.186}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5803759098052979, "grad_norm": 3.625864028930664, "td_error_abs": 0.487089111328125, "q_taken_mean": 0.17063236490885417, "target_mean": 0.08115495808919271}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 70, "num_agent_steps_trained": 336000, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 175, "training_iteration": 35, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-20-32", "timestamp": 1708860032, "time_this_iter_s": 10.636333227157593, "time_total_s": 369.13060688972473, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 369.13060688972473, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.36428571428571, "ram_util_percent": 10.885714285714288, "gpu_util_percent0": 0.017857142857142856, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -176.89932732159363, "episode_reward_min": -212.42805789033076, "episode_reward_mean": -193.26408908259089, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.52919229890207, -205.47737646896195, -201.04604446150978, -203.87084379169082, -203.68580745001427, -210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17954823826845112, "mean_inference_ms": 0.9838635596730398, "mean_action_processing_ms": 0.11421856082592337, "mean_env_wait_ms": 0.5675017606503691, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"learn_time_ms": 1489.582, "learn_throughput": 1.343, "update_time_ms": 7.212}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8841557502746582, "grad_norm": 4.8175859451293945, "td_error_abs": 0.5772064615885417, "q_taken_mean": -0.19415677897135417, "target_mean": -0.03645788065592448}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 172800, "num_steps_trained": 72, "num_agent_steps_trained": 345600, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 180, "training_iteration": 36, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-20-43", "timestamp": 1708860043, "time_this_iter_s": 10.628417730331421, "time_total_s": 379.75902462005615, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 379.75902462005615, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.864285714285717, "ram_util_percent": 10.928571428571429, "gpu_util_percent0": 0.032857142857142856, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -176.89932732159363, "episode_reward_min": -212.42805789033076, "episode_reward_mean": -192.4891490219023, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.90981749815074, -204.39738105685217, -207.12509502824733, -202.94207919500607, -210.13823833051367, -209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17957668552270192, "mean_inference_ms": 0.9840740489864686, "mean_action_processing_ms": 0.11421728012175762, "mean_env_wait_ms": 0.5674575261935465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 177600, "timesteps_this_iter": 0, "agent_timesteps_total": 177600, "timers": {"learn_time_ms": 1488.027, "learn_throughput": 1.344, "update_time_ms": 7.176}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7356907725334167, "grad_norm": 5.317285060882568, "td_error_abs": 0.5374852701822916, "q_taken_mean": 0.11287913004557291, "target_mean": 0.08013997395833333}}}, "num_steps_sampled": 177600, "num_agent_steps_sampled": 177600, "num_steps_trained": 74, "num_agent_steps_trained": 355200, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 185, "training_iteration": 37, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-20-54", "timestamp": 1708860054, "time_this_iter_s": 10.648106813430786, "time_total_s": 390.40713143348694, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 390.40713143348694, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.435714285714287, "ram_util_percent": 11.02142857142857, "gpu_util_percent0": 0.03785714285714286, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -171.74308706446806, "episode_reward_min": -212.42805789033076, "episode_reward_mean": -190.87317469865044, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.99985352634818, -212.42805789033076, -212.3350298878019, -202.798486314343, -208.97413056972218, -204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17960996669203, "mean_inference_ms": 0.9842775710206181, "mean_action_processing_ms": 0.11422009363455538, "mean_env_wait_ms": 0.5673998344391259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 182400, "timers": {"learn_time_ms": 1488.776, "learn_throughput": 1.343, "update_time_ms": 7.204}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.578194797039032, "grad_norm": 1.0780067443847656, "td_error_abs": 0.47271537272135417, "q_taken_mean": -0.11392148844401041, "target_mean": -0.08593556722005208}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 182400, "num_steps_trained": 76, "num_agent_steps_trained": 364800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 190, "training_iteration": 38, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-21-04", "timestamp": 1708860064, "time_this_iter_s": 10.661526918411255, "time_total_s": 401.0686583518982, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 401.0686583518982, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.96428571428571, "ram_util_percent": 11.014285714285714, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -207.98958979014895, "episode_reward_mean": -189.00883635225173, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.32651354364282, -200.19195270074883, -205.70439189879949, -204.96039890248946, -207.73006929714822, -187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17964546712959567, "mean_inference_ms": 0.9845410037464585, "mean_action_processing_ms": 0.11422411406943196, "mean_env_wait_ms": 0.5673313811546875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 187200, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"learn_time_ms": 1487.462, "learn_throughput": 1.345, "update_time_ms": 7.249}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.5521588325500488, "grad_norm": 10.00107479095459, "td_error_abs": 0.8754314778645833, "q_taken_mean": 0.0668957010904948, "target_mean": -0.09059764607747396}}}, "num_steps_sampled": 187200, "num_agent_steps_sampled": 187200, "num_steps_trained": 78, "num_agent_steps_trained": 374400, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 195, "training_iteration": 39, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-21-15", "timestamp": 1708860075, "time_this_iter_s": 10.74128007888794, "time_total_s": 411.80993843078613, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 411.80993843078613, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.828571428571426, "ram_util_percent": 11.214285714285717, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -207.98958979014895, "episode_reward_mean": -188.1049673854819, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.3343252530684, -183.2041201391306, -188.36532165921656, -183.7798979506336, -187.94995856434684, -205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17968173664278314, "mean_inference_ms": 0.984800265758727, "mean_action_processing_ms": 0.11422690460760464, "mean_env_wait_ms": 0.5672539568246769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"learn_time_ms": 1486.112, "learn_throughput": 1.346, "update_time_ms": 7.168}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.28583824634552, "grad_norm": 7.878363132476807, "td_error_abs": 0.8291326497395833, "q_taken_mean": -0.35878369140625, "target_mean": 0.052435587565104164}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 80, "num_agent_steps_trained": 384000, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 40, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-21-26", "timestamp": 1708860086, "time_this_iter_s": 10.548150062561035, "time_total_s": 422.35808849334717, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 422.35808849334717, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.414285714285715, "ram_util_percent": 11.185714285714285, "gpu_util_percent0": 0.012857142857142857, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -207.98958979014895, "episode_reward_mean": -188.15211778362234, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-205.2522685449527, -207.98958979014895, -199.93789450786159, -205.79122967144204, -202.34806229449387, -203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17973285341071318, "mean_inference_ms": 0.9850820517062455, "mean_action_processing_ms": 0.11423276699939487, "mean_env_wait_ms": 0.5672037271940408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 196800, "timesteps_this_iter": 0, "agent_timesteps_total": 196800, "timers": {"learn_time_ms": 1486.526, "learn_throughput": 1.345, "update_time_ms": 9.654}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.701570451259613, "grad_norm": 1.3936541080474854, "td_error_abs": 0.485533447265625, "q_taken_mean": 0.17542606608072916, "target_mean": 0.08023508707682292}}}, "num_steps_sampled": 196800, "num_agent_steps_sampled": 196800, "num_steps_trained": 82, "num_agent_steps_trained": 393600, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 205, "training_iteration": 41, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-21-36", "timestamp": 1708860096, "time_this_iter_s": 10.70092511177063, "time_total_s": 433.0590136051178, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 433.0590136051178, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.678571428571434, "ram_util_percent": 11.235714285714286, "gpu_util_percent0": 0.025, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -207.67034013154688, "episode_reward_mean": -187.4218764234176, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.87079793333626, -203.86270876823133, -207.25521347623672, -207.67034013154688, -205.06368139461787, -204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17979307547263965, "mean_inference_ms": 0.9853606782563757, "mean_action_processing_ms": 0.1142390421862751, "mean_env_wait_ms": 0.567159111640155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"learn_time_ms": 1488.298, "learn_throughput": 1.344, "update_time_ms": 9.702}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.652056097984314, "grad_norm": 0.9614299535751343, "td_error_abs": 0.46965962727864585, "q_taken_mean": 0.08267839558919271, "target_mean": 0.08082096354166667}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 201600, "num_steps_trained": 84, "num_agent_steps_trained": 403200, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 210, "training_iteration": 42, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-21-47", "timestamp": 1708860107, "time_this_iter_s": 10.545470476150513, "time_total_s": 443.6044840812683, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 443.6044840812683, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.78461538461539, "ram_util_percent": 11.307692307692308, "gpu_util_percent0": 0.024615384615384615, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -207.6457920863766, "episode_reward_mean": -186.44126644701194, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.5606120103099, -202.17833704420354, -205.20600403982596, -207.6457920863766, -205.98238910494072, -191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17984632344005613, "mean_inference_ms": 0.9856301347352207, "mean_action_processing_ms": 0.11424519805994915, "mean_env_wait_ms": 0.5671162341575742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 206400, "timesteps_this_iter": 0, "agent_timesteps_total": 206400, "timers": {"learn_time_ms": 1488.548, "learn_throughput": 1.344, "update_time_ms": 9.698}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6142690181732178, "grad_norm": 0.9203089475631714, "td_error_abs": 0.46180574544270836, "q_taken_mean": 0.14232240804036458, "target_mean": 0.08154062906901041}}}, "num_steps_sampled": 206400, "num_agent_steps_sampled": 206400, "num_steps_trained": 86, "num_agent_steps_trained": 412800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 215, "training_iteration": 43, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-21-57", "timestamp": 1708860117, "time_this_iter_s": 10.537484645843506, "time_total_s": 454.1419687271118, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 454.1419687271118, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.671428571428574, "ram_util_percent": 11.292857142857143, "gpu_util_percent0": 0.042857142857142864, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -196.04431158017508, "episode_reward_mean": -185.5115466256183, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.369104768728, -185.63428069289463, -183.46190362982694, -189.60448565124167, -183.84080182114235, -188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1798961982437941, "mean_inference_ms": 0.9858608087213091, "mean_action_processing_ms": 0.11424986011809489, "mean_env_wait_ms": 0.5670498710136255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 211200, "timesteps_this_iter": 0, "agent_timesteps_total": 211200, "timers": {"learn_time_ms": 1492.576, "learn_throughput": 1.34, "update_time_ms": 9.682}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.586017370223999, "grad_norm": 0.7039448618888855, "td_error_abs": 0.4641376139322917, "q_taken_mean": 0.08751713053385417, "target_mean": 0.08105167134602864}}}, "num_steps_sampled": 211200, "num_agent_steps_sampled": 211200, "num_steps_trained": 88, "num_agent_steps_trained": 422400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 220, "training_iteration": 44, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-22-08", "timestamp": 1708860128, "time_this_iter_s": 10.63112759590149, "time_total_s": 464.7730963230133, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 464.7730963230133, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.300000000000004, "ram_util_percent": 11.507142857142856, "gpu_util_percent0": 0.03, "vram_util_percent0": 0.025230771019345243}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -196.04431158017508, "episode_reward_mean": -185.55538070810738, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.62366552879996, -186.02092196094958, -187.86843979828666, -182.39695919768778, -182.15511622534896, -192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1799454591883614, "mean_inference_ms": 0.986107456808995, "mean_action_processing_ms": 0.11425460105085669, "mean_env_wait_ms": 0.5669878755059137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"learn_time_ms": 1489.608, "learn_throughput": 1.343, "update_time_ms": 9.702}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5863327980041504, "grad_norm": 1.2506266832351685, "td_error_abs": 0.479305419921875, "q_taken_mean": 0.1310796407063802, "target_mean": 0.15301968383789064}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 90, "num_agent_steps_trained": 432000, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 225, "training_iteration": 45, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-22-19", "timestamp": 1708860139, "time_this_iter_s": 10.513079166412354, "time_total_s": 475.28617548942566, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 475.28617548942566, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.44615384615384, "ram_util_percent": 11.5, "gpu_util_percent0": 0.019230769230769232, "vram_util_percent0": 0.02518717447916667}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -196.04431158017508, "episode_reward_mean": -185.57076027170618, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.9962790561886, -184.90035500382976, -186.30048714112047, -186.04588567934763, -187.4640040075757, -187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17999675944201052, "mean_inference_ms": 0.9863582701626311, "mean_action_processing_ms": 0.11425831184981082, "mean_env_wait_ms": 0.5669340407080672, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220800, "timesteps_this_iter": 0, "agent_timesteps_total": 220800, "timers": {"learn_time_ms": 1488.864, "learn_throughput": 1.343, "update_time_ms": 9.682}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5757781863212585, "grad_norm": 1.945313572883606, "td_error_abs": 0.4727027180989583, "q_taken_mean": 0.2289854736328125, "target_mean": 0.15361279296875}}}, "num_steps_sampled": 220800, "num_agent_steps_sampled": 220800, "num_steps_trained": 92, "num_agent_steps_trained": 441600, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 230, "training_iteration": 46, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-22-29", "timestamp": 1708860149, "time_this_iter_s": 10.639463663101196, "time_total_s": 485.92563915252686, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 485.92563915252686, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.628571428571433, "ram_util_percent": 11.549999999999999, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -196.04431158017508, "episode_reward_mean": -185.54235817143046, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.70583483271068, -186.53599299133737, -190.8511904723999, -187.59603472734526, -181.06770678661357, -189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18003996660912722, "mean_inference_ms": 0.9865864769208692, "mean_action_processing_ms": 0.11426161610922678, "mean_env_wait_ms": 0.566886635879061, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 225600, "timesteps_this_iter": 0, "agent_timesteps_total": 225600, "timers": {"learn_time_ms": 1489.88, "learn_throughput": 1.342, "update_time_ms": 9.721}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5685479044914246, "grad_norm": 2.762273073196411, "td_error_abs": 0.4754645589192708, "q_taken_mean": 0.055701802571614584, "target_mean": 0.15367837524414063}}}, "num_steps_sampled": 225600, "num_agent_steps_sampled": 225600, "num_steps_trained": 94, "num_agent_steps_trained": 451200, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 235, "training_iteration": 47, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-22-40", "timestamp": 1708860160, "time_this_iter_s": 10.661399126052856, "time_total_s": 496.5870382785797, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 496.5870382785797, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.485714285714284, "ram_util_percent": 11.614285714285712, "gpu_util_percent0": 0.03357142857142857, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -196.04431158017508, "episode_reward_mean": -185.63342307348262, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.6457531004275, -190.57240817443252, -186.03571314701603, -182.89112578934896, -187.3608568264782, -188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18008243579382438, "mean_inference_ms": 0.9867942992563152, "mean_action_processing_ms": 0.11426429347900796, "mean_env_wait_ms": 0.5668537208148904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 230400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"learn_time_ms": 1490.139, "learn_throughput": 1.342, "update_time_ms": 9.692}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5968647003173828, "grad_norm": 6.2996015548706055, "td_error_abs": 0.5120784912109375, "q_taken_mean": 0.377041259765625, "target_mean": 0.1526626485188802}}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230400, "num_steps_trained": 96, "num_agent_steps_trained": 460800, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 240, "training_iteration": 48, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-22-51", "timestamp": 1708860171, "time_this_iter_s": 10.58122181892395, "time_total_s": 507.16826009750366, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 507.16826009750366, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.728571428571428, "ram_util_percent": 11.6, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.66538554582843, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.73695072241458, -189.53868961762413, -192.0842376843719, -186.86196962320284, -193.06880085584615, -182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18013263136436652, "mean_inference_ms": 0.9870025007033045, "mean_action_processing_ms": 0.11426805429134833, "mean_env_wait_ms": 0.5668306752520428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 235200, "timesteps_this_iter": 0, "agent_timesteps_total": 235200, "timers": {"learn_time_ms": 1494.727, "learn_throughput": 1.338, "update_time_ms": 10.174}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3242063522338867, "grad_norm": 14.79898452758789, "td_error_abs": 0.9649873046875, "q_taken_mean": -0.1639520263671875, "target_mean": -0.12240084838867188}}}, "num_steps_sampled": 235200, "num_agent_steps_sampled": 235200, "num_steps_trained": 98, "num_agent_steps_trained": 470400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 245, "training_iteration": 49, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-23-01", "timestamp": 1708860181, "time_this_iter_s": 10.697549819946289, "time_total_s": 517.86580991745, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 517.86580991745, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.914285714285715, "ram_util_percent": 11.850000000000003, "gpu_util_percent0": 0.02428571428571429, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.48407919118785, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.2642585370779, -184.90201204943287, -187.83659685524373, -184.7403424034666, -184.09093543849198, -188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18018115371207924, "mean_inference_ms": 0.9872088926990498, "mean_action_processing_ms": 0.11427155729845684, "mean_env_wait_ms": 0.5667980995959953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"learn_time_ms": 1498.542, "learn_throughput": 1.335, "update_time_ms": 10.217}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9856194853782654, "grad_norm": 9.228458404541016, "td_error_abs": 0.8241622721354167, "q_taken_mean": -0.38755342610677085, "target_mean": 0.15916160074869792}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 100, "num_agent_steps_trained": 480000, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "evaluation": {"episode_reward_max": -164.65473283544074, "episode_reward_min": -176.79356896743332, "episode_reward_mean": -171.32834349981593, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.65277411002464, -171.4897259145258, -164.65473283544074, -171.22966528978205, -169.54863024957712, -169.8704422512028, -176.79356896743332, -173.4542804583811, -171.07070956163128, -170.5189053601604], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17332752574646104, "mean_inference_ms": 0.825249121941796, "mean_action_processing_ms": 0.10805464749435076, "mean_env_wait_ms": 0.5417946117295038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 250, "training_iteration": 50, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-23-28", "timestamp": 1708860208, "time_this_iter_s": 26.45366597175598, "time_total_s": 544.3194758892059, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 544.3194758892059, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.01764705882353, "ram_util_percent": 11.852941176470589, "gpu_util_percent0": 0.005588235294117647, "vram_util_percent0": 0.025187174479166664}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.5722498247868, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.7016602989444, -188.21127699659095, -196.04431158017508, -189.23653741092852, -185.7333127200809, -191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18022482955901725, "mean_inference_ms": 0.9874185033218609, "mean_action_processing_ms": 0.11427587420668602, "mean_env_wait_ms": 0.5667680398792854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 244800, "timesteps_this_iter": 0, "agent_timesteps_total": 244800, "timers": {"learn_time_ms": 1497.143, "learn_throughput": 1.336, "update_time_ms": 7.75}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9337207674980164, "grad_norm": 13.163857460021973, "td_error_abs": 0.682574951171875, "q_taken_mean": 0.7311756184895833, "target_mean": 0.15241287231445313}}}, "num_steps_sampled": 244800, "num_agent_steps_sampled": 244800, "num_steps_trained": 102, "num_agent_steps_trained": 489600, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 255, "training_iteration": 51, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-23-38", "timestamp": 1708860218, "time_this_iter_s": 10.592975616455078, "time_total_s": 554.912451505661, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 554.912451505661, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.515384615384615, "ram_util_percent": 11.907692307692308, "gpu_util_percent0": 0.02153846153846154, "vram_util_percent0": 0.02518717447916667}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.37488182540957, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.01208269456748, -184.78760204946408, -186.0837226916868, -189.3487822622238, -185.2868786097566, -186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18027380259649597, "mean_inference_ms": 0.9876033380751855, "mean_action_processing_ms": 0.1142793864335287, "mean_env_wait_ms": 0.5667461948302628, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"learn_time_ms": 1496.201, "learn_throughput": 1.337, "update_time_ms": 7.7}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6230291724205017, "grad_norm": 1.6546846628189087, "td_error_abs": 0.4788031005859375, "q_taken_mean": 0.11323399861653646, "target_mean": 0.15442599487304687}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 249600, "num_steps_trained": 104, "num_agent_steps_trained": 499200, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 260, "training_iteration": 52, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-23-49", "timestamp": 1708860229, "time_this_iter_s": 10.598156452178955, "time_total_s": 565.51060795784, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 565.51060795784, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.549999999999994, "ram_util_percent": 11.914285714285716, "gpu_util_percent0": 0.028571428571428574, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.25497052437157, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.25616309166836, -185.08028109772167, -189.0746669991079, -183.68110677225172, -186.1097510657609, -184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1803154552561036, "mean_inference_ms": 0.9878346975067153, "mean_action_processing_ms": 0.11428427388570724, "mean_env_wait_ms": 0.5667167412519448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 254400, "timesteps_this_iter": 0, "agent_timesteps_total": 254400, "timers": {"learn_time_ms": 1499.182, "learn_throughput": 1.334, "update_time_ms": 7.746}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.594235897064209, "grad_norm": 1.0474300384521484, "td_error_abs": 0.4731765950520833, "q_taken_mean": 0.19407269287109374, "target_mean": 0.1532864786783854}}}, "num_steps_sampled": 254400, "num_agent_steps_sampled": 254400, "num_steps_trained": 106, "num_agent_steps_trained": 508800, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 265, "training_iteration": 53, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-24-00", "timestamp": 1708860240, "time_this_iter_s": 10.737436056137085, "time_total_s": 576.248044013977, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 576.248044013977, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.735714285714288, "ram_util_percent": 11.900000000000002, "gpu_util_percent0": 0.042857142857142864, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.50039722404014, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.61207847526396, -185.3393916113191, -187.9518334255891, -185.31710325583686, -192.65420995804072, -183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.180356617696941, "mean_inference_ms": 0.9880840332726442, "mean_action_processing_ms": 0.11428917878748107, "mean_env_wait_ms": 0.5666816169091948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 259200, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"learn_time_ms": 1498.892, "learn_throughput": 1.334, "update_time_ms": 7.773}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5764240622520447, "grad_norm": 0.7835106253623962, "td_error_abs": 0.4677932942708333, "q_taken_mean": 0.18168137613932292, "target_mean": 0.15453640747070313}}}, "num_steps_sampled": 259200, "num_agent_steps_sampled": 259200, "num_steps_trained": 108, "num_agent_steps_trained": 518400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 270, "training_iteration": 54, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-24-10", "timestamp": 1708860250, "time_this_iter_s": 10.613559007644653, "time_total_s": 586.8616030216217, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 586.8616030216217, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.892857142857142, "ram_util_percent": 12.12857142857143, "gpu_util_percent0": 0.032857142857142856, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.3748828474787, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.98409612144593, -176.89932732159363, -182.03648194892338, -181.98345413016705, -180.09339039558506, -186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18039697538071625, "mean_inference_ms": 0.9883269897075202, "mean_action_processing_ms": 0.11429323024717535, "mean_env_wait_ms": 0.5666457751779409, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"learn_time_ms": 1503.326, "learn_throughput": 1.33, "update_time_ms": 10.807}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5525781512260437, "grad_norm": 0.571668267250061, "td_error_abs": 0.4598822021484375, "q_taken_mean": 0.17666634114583332, "target_mean": 0.15507952880859374}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 110, "num_agent_steps_trained": 528000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 275, "training_iteration": 55, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-24-21", "timestamp": 1708860261, "time_this_iter_s": 10.647681951522827, "time_total_s": 597.5092849731445, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 597.5092849731445, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.721428571428568, "ram_util_percent": 12.164285714285713, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.57121400599576, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.13110073528503, -188.48631854504487, -183.1247628550724, -189.47215581581622, -192.9009204509989, -171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18042280365516006, "mean_inference_ms": 0.9885746885863831, "mean_action_processing_ms": 0.11429687317883248, "mean_env_wait_ms": 0.5666027800122718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 268800, "timesteps_this_iter": 0, "agent_timesteps_total": 268800, "timers": {"learn_time_ms": 1503.65, "learn_throughput": 1.33, "update_time_ms": 10.85}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6057161688804626, "grad_norm": 1.301340103149414, "td_error_abs": 0.4952251383463542, "q_taken_mean": 0.1840880126953125, "target_mean": 0.20859267171223958}}}, "num_steps_sampled": 268800, "num_agent_steps_sampled": 268800, "num_steps_trained": 112, "num_agent_steps_trained": 537600, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 280, "training_iteration": 56, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-24-32", "timestamp": 1708860272, "time_this_iter_s": 10.592231273651123, "time_total_s": 608.1015162467957, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 608.1015162467957, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.23076923076923, "ram_util_percent": 12.207692307692309, "gpu_util_percent0": 0.02153846153846154, "vram_util_percent0": 0.02518717447916667}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -228.43569124949997, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.74308706446806, -174.6582398388051, -178.07419893441923, -173.65632588623012, -175.78332705966133, -172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18044573958038035, "mean_inference_ms": 0.9887988924823103, "mean_action_processing_ms": 0.11429836274093776, "mean_env_wait_ms": 0.5665612587282624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 273600, "timesteps_this_iter": 0, "agent_timesteps_total": 273600, "timers": {"learn_time_ms": 1503.918, "learn_throughput": 1.33, "update_time_ms": 10.82}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5721364617347717, "grad_norm": 1.094323754310608, "td_error_abs": 0.48038639322916665, "q_taken_mean": 0.23836409505208334, "target_mean": 0.2078143310546875}}}, "num_steps_sampled": 273600, "num_agent_steps_sampled": 273600, "num_steps_trained": 114, "num_agent_steps_trained": 547200, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 285, "training_iteration": 57, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-24-42", "timestamp": 1708860282, "time_this_iter_s": 10.617976188659668, "time_total_s": 618.7194924354553, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 618.7194924354553, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 30.78571428571428, "ram_util_percent": 12.285714285714288, "gpu_util_percent0": 0.025714285714285717, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -167.59584536321762, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -246.52081165511308, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.43899353639466, -167.59584536321762, -175.82481730132403, -173.0951636671288, -171.1469036806159, -180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18046874214107017, "mean_inference_ms": 0.9890238686859023, "mean_action_processing_ms": 0.11429997875303814, "mean_env_wait_ms": 0.5665136102079835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 278400, "timesteps_this_iter": 0, "agent_timesteps_total": 278400, "timers": {"learn_time_ms": 1505.3, "learn_throughput": 1.329, "update_time_ms": 10.865}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.149813175201416, "grad_norm": 10.549090385437012, "td_error_abs": 0.6533614501953126, "q_taken_mean": 0.21121067301432292, "target_mean": 0.18389125569661458}}}, "num_steps_sampled": 278400, "num_agent_steps_sampled": 278400, "num_steps_trained": 116, "num_agent_steps_trained": 556800, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 290, "training_iteration": 58, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-24-53", "timestamp": 1708860293, "time_this_iter_s": 10.737251996994019, "time_total_s": 629.4567444324493, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 629.4567444324493, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.757142857142856, "ram_util_percent": 12.228571428571428, "gpu_util_percent0": 0.02142857142857143, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -247.39853190824263, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.75100798713126, -191.69407529851748, -186.93188449462207, -184.8090927548807, -188.34036913069392, -185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18049564208462876, "mean_inference_ms": 0.9892146343183786, "mean_action_processing_ms": 0.1142991132239941, "mean_env_wait_ms": 0.5664457831113686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 283200, "timesteps_this_iter": 0, "agent_timesteps_total": 283200, "timers": {"learn_time_ms": 1500.825, "learn_throughput": 1.333, "update_time_ms": 10.341}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8640891909599304, "grad_norm": 4.6053266525268555, "td_error_abs": 0.6696374918619792, "q_taken_mean": -0.07024962361653646, "target_mean": 0.21565096028645833}}}, "num_steps_sampled": 283200, "num_agent_steps_sampled": 283200, "num_steps_trained": 118, "num_agent_steps_trained": 566400, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 295, "training_iteration": 59, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-25-04", "timestamp": 1708860304, "time_this_iter_s": 10.590222597122192, "time_total_s": 640.0469670295715, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 640.0469670295715, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 30.21538461538461, "ram_util_percent": 12.330769230769228, "gpu_util_percent0": 0.012307692307692308, "vram_util_percent0": 0.02518717447916667}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -247.4323163670543, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.42517950167195, -188.56512606893688, -189.03706714071978, -188.43507794655127, -183.88621272255523, -188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18052308660459274, "mean_inference_ms": 0.9893976031308267, "mean_action_processing_ms": 0.11429680546956962, "mean_env_wait_ms": 0.5663580966175541, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"learn_time_ms": 1497.373, "learn_throughput": 1.336, "update_time_ms": 10.312}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7717589735984802, "grad_norm": 9.495911598205566, "td_error_abs": 0.58766162109375, "q_taken_mean": 0.6381315104166667, "target_mean": 0.20620149739583332}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 120, "num_agent_steps_trained": 576000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 60, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-25-14", "timestamp": 1708860314, "time_this_iter_s": 10.417199850082397, "time_total_s": 650.4641668796539, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 650.4641668796539, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.89285714285714, "ram_util_percent": 12.14285714285714, "gpu_util_percent0": 0.007857142857142858, "vram_util_percent0": 0.025187174479166675}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -247.22163871846104, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.85426388971564, -184.99810463831818, -194.10410059389983, -191.674290674146, -188.66414899234587, -186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18053668788993213, "mean_inference_ms": 0.9895540529773119, "mean_action_processing_ms": 0.1142913771907315, "mean_env_wait_ms": 0.5662755568878612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 292800, "timesteps_this_iter": 0, "agent_timesteps_total": 292800, "timers": {"learn_time_ms": 1498.572, "learn_throughput": 1.335, "update_time_ms": 10.31}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6448163390159607, "grad_norm": 2.411367893218994, "td_error_abs": 0.49783760579427083, "q_taken_mean": 0.031879684448242185, "target_mean": 0.11850726318359375}}}, "num_steps_sampled": 292800, "num_agent_steps_sampled": 292800, "num_steps_trained": 122, "num_agent_steps_trained": 585600, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 305, "training_iteration": 61, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-25-25", "timestamp": 1708860325, "time_this_iter_s": 10.362995386123657, "time_total_s": 660.8271622657776, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 660.8271622657776, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 28.692307692307693, "ram_util_percent": 12.215384615384616, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.02518717447916667}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.56568168467635, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.73715651534377, -188.28832473964783, -181.33325778392722, -186.01876328707488, -187.28424173740896, -186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18054064538633408, "mean_inference_ms": 0.98970845713478, "mean_action_processing_ms": 0.11428331626099589, "mean_env_wait_ms": 0.5661954350588048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 297600, "timesteps_this_iter": 0, "agent_timesteps_total": 297600, "timers": {"learn_time_ms": 1495.429, "learn_throughput": 1.337, "update_time_ms": 10.294}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.081411361694336, "grad_norm": 8.546784400939941, "td_error_abs": 0.6682687581380208, "q_taken_mean": 0.16677815755208333, "target_mean": 0.1678721923828125}}}, "num_steps_sampled": 297600, "num_agent_steps_sampled": 297600, "num_steps_trained": 124, "num_agent_steps_trained": 595200, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 310, "training_iteration": 62, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-25-35", "timestamp": 1708860335, "time_this_iter_s": 10.429913520812988, "time_total_s": 671.2570757865906, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 671.2570757865906, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.54615384615385, "ram_util_percent": 12.23076923076923, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.02518717447916667}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.47152516789583, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.96208446322925, -183.83244780013652, -185.1289546501812, -186.59058127848343, -190.08708395426135, -184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18054772836657065, "mean_inference_ms": 0.9898859093197888, "mean_action_processing_ms": 0.11427767974441962, "mean_env_wait_ms": 0.5661350959193019, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 302400, "timesteps_this_iter": 0, "agent_timesteps_total": 302400, "timers": {"learn_time_ms": 1498.147, "learn_throughput": 1.335, "update_time_ms": 10.303}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6820164918899536, "grad_norm": 2.725109100341797, "td_error_abs": 0.5090008138020833, "q_taken_mean": 0.09410000610351563, "target_mean": 0.13351651000976564}}}, "num_steps_sampled": 302400, "num_agent_steps_sampled": 302400, "num_steps_trained": 126, "num_agent_steps_trained": 604800, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 315, "training_iteration": 63, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-25-46", "timestamp": 1708860346, "time_this_iter_s": 10.886185646057129, "time_total_s": 682.1432614326477, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 682.1432614326477, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 33.42857142857143, "ram_util_percent": 12.428571428571427, "gpu_util_percent0": 0.06642857142857143, "vram_util_percent0": 0.025303431919642856}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.25437383610284, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.12717919927834, -189.20463421079, -186.69858835968358, -186.40705011453406, -191.8565329284568, -183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1805608017063297, "mean_inference_ms": 0.9900608617241479, "mean_action_processing_ms": 0.1142732503523137, "mean_env_wait_ms": 0.5660903037273778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"learn_time_ms": 1507.018, "learn_throughput": 1.327, "update_time_ms": 10.399}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8223090171813965, "grad_norm": 5.304637432098389, "td_error_abs": 0.5731773274739583, "q_taken_mean": 0.4122473551432292, "target_mean": 0.11793919881184896}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 307200, "num_steps_trained": 128, "num_agent_steps_trained": 614400, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 320, "training_iteration": 64, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-25-57", "timestamp": 1708860357, "time_this_iter_s": 10.769024848937988, "time_total_s": 692.9122862815857, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 692.9122862815857, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 31.449999999999996, "ram_util_percent": 12.62142857142857, "gpu_util_percent0": 0.04, "vram_util_percent0": 0.025390625}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.2248565752995, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.0868580102243, -185.64526211379203, -190.5372395056788, -184.1016819022498, -185.23201753900483, -184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18059057579589996, "mean_inference_ms": 0.9902843291531884, "mean_action_processing_ms": 0.11427656801518678, "mean_env_wait_ms": 0.5661007094916808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"learn_time_ms": 1513.934, "learn_throughput": 1.321, "update_time_ms": 7.453}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.730573296546936, "grad_norm": 1.6581844091415405, "td_error_abs": 0.5188962809244791, "q_taken_mean": 0.15157686360677083, "target_mean": 0.20777935791015625}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 130, "num_agent_steps_trained": 624000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 325, "training_iteration": 65, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-26-08", "timestamp": 1708860368, "time_this_iter_s": 11.498240947723389, "time_total_s": 704.4105272293091, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 704.4105272293091, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.846666666666664, "ram_util_percent": 12.706666666666667, "gpu_util_percent0": 0.11800000000000002, "vram_util_percent0": 0.025390625}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.1230791222916, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.30954018297635, -186.5769075863337, -192.71889173683394, -188.8587112115093, -182.4027501428394, -188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18062438212087414, "mean_inference_ms": 0.9905512151943531, "mean_action_processing_ms": 0.11428500897009457, "mean_env_wait_ms": 0.5661416813882209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 316800, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"learn_time_ms": 1515.11, "learn_throughput": 1.32, "update_time_ms": 7.458}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6089589595794678, "grad_norm": 0.7832199931144714, "td_error_abs": 0.4854203694661458, "q_taken_mean": 0.21840596516927083, "target_mean": 0.2060792439778646}}}, "num_steps_sampled": 316800, "num_agent_steps_sampled": 316800, "num_steps_trained": 132, "num_agent_steps_trained": 633600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 330, "training_iteration": 66, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-26-19", "timestamp": 1708860379, "time_this_iter_s": 11.21694827079773, "time_total_s": 715.6274755001068, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 715.6274755001068, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.51428571428571, "ram_util_percent": 12.707142857142857, "gpu_util_percent0": 0.0692857142857143, "vram_util_percent0": 0.02539934430803572}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.1947422128811, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.90178483413595, -191.59640992318037, -193.79406642023284, -181.9493919374506, -186.62159690062614, -1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18066477764062655, "mean_inference_ms": 0.990825080842904, "mean_action_processing_ms": 0.11429655711973132, "mean_env_wait_ms": 0.5662161037869001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 321600, "timesteps_this_iter": 0, "agent_timesteps_total": 321600, "timers": {"learn_time_ms": 1519.359, "learn_throughput": 1.316, "update_time_ms": 7.528}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6270030736923218, "grad_norm": 1.457466959953308, "td_error_abs": 0.49339103190104167, "q_taken_mean": 0.2553264567057292, "target_mean": 0.28455523681640627}}}, "num_steps_sampled": 321600, "num_agent_steps_sampled": 321600, "num_steps_trained": 134, "num_agent_steps_trained": 643200, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 335, "training_iteration": 67, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-26-31", "timestamp": 1708860391, "time_this_iter_s": 11.102013349533081, "time_total_s": 726.7294888496399, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 726.7294888496399, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 34.050000000000004, "ram_util_percent": 12.9, "gpu_util_percent0": 0.10214285714285712, "vram_util_percent0": 0.027701241629464284}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -1087.2544479417697, "episode_reward_mean": -265.13686951845233, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1045.3813150368444, -1025.5815273952962, -1087.2544479417697, -1037.8012528929726, -1043.6835610053959, -189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1807082168432752, "mean_inference_ms": 0.9911267525042967, "mean_action_processing_ms": 0.11430943574640262, "mean_env_wait_ms": 0.5662949443397616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 326400, "timesteps_this_iter": 0, "agent_timesteps_total": 326400, "timers": {"learn_time_ms": 1516.183, "learn_throughput": 1.319, "update_time_ms": 7.477}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5971966981887817, "grad_norm": 1.0089235305786133, "td_error_abs": 0.48932840983072917, "q_taken_mean": 0.3104947509765625, "target_mean": 0.2831330159505208}}}, "num_steps_sampled": 326400, "num_agent_steps_sampled": 326400, "num_steps_trained": 136, "num_agent_steps_trained": 652800, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 340, "training_iteration": 68, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-26-41", "timestamp": 1708860401, "time_this_iter_s": 10.846462726593018, "time_total_s": 737.5759515762329, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 737.5759515762329, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 32.192857142857136, "ram_util_percent": 12.992857142857144, "gpu_util_percent0": 0.03214285714285715, "vram_util_percent0": 0.025614420572916675}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.08457725563375, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.13182655376806, -187.87655186886425, -182.9092564459113, -188.384040381846, -183.858337789017, -186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18075186722249048, "mean_inference_ms": 0.9914283080281067, "mean_action_processing_ms": 0.11432220298253411, "mean_env_wait_ms": 0.566398372228622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 331200, "timesteps_this_iter": 0, "agent_timesteps_total": 331200, "timers": {"learn_time_ms": 1520.364, "learn_throughput": 1.315, "update_time_ms": 8.011}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5794819593429565, "grad_norm": 0.5872416496276855, "td_error_abs": 0.487098876953125, "q_taken_mean": 0.2937242431640625, "target_mean": 0.28285673014322915}}}, "num_steps_sampled": 331200, "num_agent_steps_sampled": 331200, "num_steps_trained": 138, "num_agent_steps_trained": 662400, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 345, "training_iteration": 69, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-26-52", "timestamp": 1708860412, "time_this_iter_s": 10.895368099212646, "time_total_s": 748.4713196754456, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 748.4713196754456, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.95, "ram_util_percent": 13.014285714285714, "gpu_util_percent0": 0.012142857142857141, "vram_util_percent0": 0.025396437872023815}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.11807161013283, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.73479434049466, -184.12400608357726, -183.38588590885973, -187.8105507383516, -190.59597157232247, -190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1808029781787162, "mean_inference_ms": 0.9917884438452914, "mean_action_processing_ms": 0.11433990016765255, "mean_env_wait_ms": 0.5665157068944128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"learn_time_ms": 1535.846, "learn_throughput": 1.302, "update_time_ms": 8.272}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5589807629585266, "grad_norm": 0.6967922449111938, "td_error_abs": 0.4773929036458333, "q_taken_mean": 0.30251814778645836, "target_mean": 0.2813241170247396}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 140, "num_agent_steps_trained": 672000, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 350, "training_iteration": 70, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-27-04", "timestamp": 1708860424, "time_this_iter_s": 11.230855464935303, "time_total_s": 759.7021751403809, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 759.7021751403809, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 34.028571428571425, "ram_util_percent": 13.09285714285714, "gpu_util_percent0": 0.09500000000000001, "vram_util_percent0": 0.025431315104166668}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.07127882288057, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.46357947168582, -182.0918191200882, -185.62563769212727, -183.86158926953544, -186.14767351556702, -186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18086545825428169, "mean_inference_ms": 0.9922120461563566, "mean_action_processing_ms": 0.11436327357395511, "mean_env_wait_ms": 0.5666818168143997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340800, "timesteps_this_iter": 0, "agent_timesteps_total": 340800, "timers": {"learn_time_ms": 1544.229, "learn_throughput": 1.295, "update_time_ms": 8.313}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5502620935440063, "grad_norm": 0.49668624997138977, "td_error_abs": 0.4759222412109375, "q_taken_mean": 0.2898632405598958, "target_mean": 0.2813241170247396}}}, "num_steps_sampled": 340800, "num_agent_steps_sampled": 340800, "num_steps_trained": 142, "num_agent_steps_trained": 681600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 355, "training_iteration": 71, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-27-15", "timestamp": 1708860435, "time_this_iter_s": 11.589592456817627, "time_total_s": 771.2917675971985, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 771.2917675971985, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 35.13999999999999, "ram_util_percent": 13.12, "gpu_util_percent0": 0.11800000000000002, "vram_util_percent0": 0.025534396701388885}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.0661837746766, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.7545263155666, -185.37681179657937, -189.42508954715066, -182.28118173826405, -180.69032880632835, -193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18092762721809738, "mean_inference_ms": 0.9926528525585878, "mean_action_processing_ms": 0.1143883931593711, "mean_env_wait_ms": 0.5668596038433028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 345600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"learn_time_ms": 1559.329, "learn_throughput": 1.283, "update_time_ms": 8.437}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5672031044960022, "grad_norm": 0.6758384704589844, "td_error_abs": 0.4818482666015625, "q_taken_mean": 0.29431254069010415, "target_mean": 0.27958955891927084}}}, "num_steps_sampled": 345600, "num_agent_steps_sampled": 345600, "num_steps_trained": 144, "num_agent_steps_trained": 691200, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 360, "training_iteration": 72, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-27-26", "timestamp": 1708860446, "time_this_iter_s": 11.005501508712769, "time_total_s": 782.2972691059113, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 782.2972691059113, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 32.107142857142854, "ram_util_percent": 13.164285714285713, "gpu_util_percent0": 0.03571428571428571, "vram_util_percent0": 0.025309244791666664}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.22117925642618, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.2542355015264, -187.23892543398324, -188.90664585981307, -192.54959577432234, -192.79523642372266, -182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18098610767403614, "mean_inference_ms": 0.9930863229631848, "mean_action_processing_ms": 0.1144145653262749, "mean_env_wait_ms": 0.5670484298066981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 350400, "timesteps_this_iter": 0, "agent_timesteps_total": 350400, "timers": {"learn_time_ms": 1566.195, "learn_throughput": 1.277, "update_time_ms": 8.906}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5225571393966675, "grad_norm": 0.38162198662757874, "td_error_abs": 0.46913728841145835, "q_taken_mean": 0.2716024373372396, "target_mean": 0.28218513997395833}}}, "num_steps_sampled": 350400, "num_agent_steps_sampled": 350400, "num_steps_trained": 146, "num_agent_steps_trained": 700800, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 365, "training_iteration": 73, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-27-37", "timestamp": 1708860457, "time_this_iter_s": 11.062018632888794, "time_total_s": 793.3592877388, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 793.3592877388, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 32.728571428571435, "ram_util_percent": 13.228571428571428, "gpu_util_percent0": 0.07857142857142858, "vram_util_percent0": 0.025320870535714284}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -221.9823674126177, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.70622346873316, -183.83395863711434, -192.42014345409007, -181.50305030561324, -182.85980320435843, -182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18105441140875478, "mean_inference_ms": 0.9935479449458071, "mean_action_processing_ms": 0.11444429407300069, "mean_env_wait_ms": 0.5672535540791622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 355200, "timesteps_this_iter": 0, "agent_timesteps_total": 355200, "timers": {"learn_time_ms": 1575.827, "learn_throughput": 1.269, "update_time_ms": 8.876}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5392765402793884, "grad_norm": 0.8529637455940247, "td_error_abs": 0.47521402994791667, "q_taken_mean": 0.3003355712890625, "target_mean": 0.28206058756510416}}}, "num_steps_sampled": 355200, "num_agent_steps_sampled": 355200, "num_steps_trained": 148, "num_agent_steps_trained": 710400, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 370, "training_iteration": 74, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-27-49", "timestamp": 1708860469, "time_this_iter_s": 11.342190742492676, "time_total_s": 804.7014784812927, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 804.7014784812927, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 34.3, "ram_util_percent": 13.320000000000004, "gpu_util_percent0": 0.11133333333333333, "vram_util_percent0": 0.025349934895833332}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.0436403302583, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.47326103810525, -179.37485481582831, -184.54550246764265, -192.7555751766862, -185.48067227116255, -188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18113618569896223, "mean_inference_ms": 0.9940370577841545, "mean_action_processing_ms": 0.114479503350987, "mean_env_wait_ms": 0.5675025180110774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"learn_time_ms": 1583.315, "learn_throughput": 1.263, "update_time_ms": 8.845}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5609492659568787, "grad_norm": 0.36793965101242065, "td_error_abs": 0.48389017740885415, "q_taken_mean": 0.2657654012044271, "target_mean": 0.2806084187825521}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 150, "num_agent_steps_trained": 720000, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 375, "training_iteration": 75, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-28-00", "timestamp": 1708860480, "time_this_iter_s": 11.470183372497559, "time_total_s": 816.1716618537903, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 816.1716618537903, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 33.635714285714286, "ram_util_percent": 13.3, "gpu_util_percent0": 0.07357142857142858, "vram_util_percent0": 0.0252685546875}}
{"episode_reward_max": -178.91362251814738, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.05376047144804, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.75871366478128, -183.69298034524732, -178.91362251814738, -185.3204715588038, -189.87719466565682, -559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1812333854242617, "mean_inference_ms": 0.9945923057258945, "mean_action_processing_ms": 0.11452251874394506, "mean_env_wait_ms": 0.567790477236911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 364800, "timesteps_this_iter": 0, "agent_timesteps_total": 364800, "timers": {"learn_time_ms": 1584.641, "learn_throughput": 1.262, "update_time_ms": 8.81}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5629213452339172, "grad_norm": 0.8283485174179077, "td_error_abs": 0.4875723876953125, "q_taken_mean": 0.29934541829427086, "target_mean": 0.28037221272786456}}}, "num_steps_sampled": 364800, "num_agent_steps_sampled": 364800, "num_steps_trained": 152, "num_agent_steps_trained": 729600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 380, "training_iteration": 76, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-28-12", "timestamp": 1708860492, "time_this_iter_s": 11.731019496917725, "time_total_s": 827.902681350708, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 827.902681350708, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 35.93333333333333, "ram_util_percent": 13.486666666666666, "gpu_util_percent0": 0.16133333333333333, "vram_util_percent0": 0.02543674045138889}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -222.1199241676267, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559.7903247733923, -516.9749820260063, -531.1063932860095, -544.3142224145499, -530.241296844937, -191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1813380570500071, "mean_inference_ms": 0.99519492331308, "mean_action_processing_ms": 0.11457079663943162, "mean_env_wait_ms": 0.5681008507608276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 369600, "timesteps_this_iter": 0, "agent_timesteps_total": 369600, "timers": {"learn_time_ms": 1590.214, "learn_throughput": 1.258, "update_time_ms": 8.819}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.561858057975769, "grad_norm": 0.49566519260406494, "td_error_abs": 0.4804295654296875, "q_taken_mean": 0.2557660115559896, "target_mean": 0.2828375447591146}}}, "num_steps_sampled": 369600, "num_agent_steps_sampled": 369600, "num_steps_trained": 154, "num_agent_steps_trained": 739200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 385, "training_iteration": 77, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-28-24", "timestamp": 1708860504, "time_this_iter_s": 11.526345491409302, "time_total_s": 839.4290268421173, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 839.4290268421173, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 34.08, "ram_util_percent": 13.506666666666666, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.025431315104166668}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -204.6892608055168, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.36791082438128, -186.8888828909019, -190.650228362444, -182.91066206341, -196.056064720502, -191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1814359366218561, "mean_inference_ms": 0.9958091568940071, "mean_action_processing_ms": 0.11461988747698144, "mean_env_wait_ms": 0.5684225788217543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 374400, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"learn_time_ms": 1598.43, "learn_throughput": 1.251, "update_time_ms": 8.899}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5751797556877136, "grad_norm": 1.4197607040405273, "td_error_abs": 0.4930481770833333, "q_taken_mean": 0.30335319010416667, "target_mean": 0.35399344889322915}}}, "num_steps_sampled": 374400, "num_agent_steps_sampled": 374400, "num_steps_trained": 156, "num_agent_steps_trained": 748800, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 390, "training_iteration": 78, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-28-35", "timestamp": 1708860515, "time_this_iter_s": 11.077816247940063, "time_total_s": 850.5068430900574, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 850.5068430900574, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.264285714285705, "ram_util_percent": 13.535714285714283, "gpu_util_percent0": 0.04285714285714286, "vram_util_percent0": 0.0252685546875}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -204.54955453573177, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.17324423127292, -188.03618672962435, -188.53577649581678, -186.04407280516483, -182.11559528512814, -179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18153052306852463, "mean_inference_ms": 0.9964473371145611, "mean_action_processing_ms": 0.11467230661325743, "mean_env_wait_ms": 0.5687558263383883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 379200, "timesteps_this_iter": 0, "agent_timesteps_total": 379200, "timers": {"learn_time_ms": 1599.121, "learn_throughput": 1.251, "update_time_ms": 8.409}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5347850918769836, "grad_norm": 1.4532115459442139, "td_error_abs": 0.47695841471354167, "q_taken_mean": 0.39007474772135414, "target_mean": 0.3544784749348958}}}, "num_steps_sampled": 379200, "num_agent_steps_sampled": 379200, "num_steps_trained": 158, "num_agent_steps_trained": 758400, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 395, "training_iteration": 79, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-28-46", "timestamp": 1708860526, "time_this_iter_s": 11.098741292953491, "time_total_s": 861.6055843830109, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 861.6055843830109, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 33.09285714285714, "ram_util_percent": 13.614285714285712, "gpu_util_percent0": 0.05214285714285715, "vram_util_percent0": 0.0252685546875}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -204.5895830602996, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.8416969382253, -181.52291051852757, -181.29668531315477, -179.7916151550527, -191.8279905961477, -525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.181635515390154, "mean_inference_ms": 0.9971641538752891, "mean_action_processing_ms": 0.11473339676169379, "mean_env_wait_ms": 0.5691363692988162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"learn_time_ms": 1603.11, "learn_throughput": 1.248, "update_time_ms": 8.235}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5484960675239563, "grad_norm": 1.1173498630523682, "td_error_abs": 0.4821275227864583, "q_taken_mean": 0.31932651774088544, "target_mean": 0.34079097493489585}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 160, "num_agent_steps_trained": 768000, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 400, "training_iteration": 80, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-28-58", "timestamp": 1708860538, "time_this_iter_s": 11.869030952453613, "time_total_s": 873.4746153354645, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 873.4746153354645, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 35.74, "ram_util_percent": 13.659999999999998, "gpu_util_percent0": 0.12666666666666668, "vram_util_percent0": 0.025349934895833332}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -583.1203716108672, "episode_reward_mean": -204.80191534040543, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-525.5661572968463, -568.082646942524, -543.0086476026813, -562.9213819570389, -583.1203716108672, -186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18174729505442652, "mean_inference_ms": 0.9979142553398783, "mean_action_processing_ms": 0.1147980651134022, "mean_env_wait_ms": 0.569526601472977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 388800, "timesteps_this_iter": 0, "agent_timesteps_total": 388800, "timers": {"learn_time_ms": 1604.114, "learn_throughput": 1.247, "update_time_ms": 8.339}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5473691821098328, "grad_norm": 1.113254189491272, "td_error_abs": 0.4808927001953125, "q_taken_mean": 0.33596504720052084, "target_mean": 0.354843994140625}}}, "num_steps_sampled": 388800, "num_agent_steps_sampled": 388800, "num_steps_trained": 162, "num_agent_steps_trained": 777600, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 405, "training_iteration": 81, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-29-09", "timestamp": 1708860549, "time_this_iter_s": 10.994651317596436, "time_total_s": 884.4692666530609, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 884.4692666530609, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 32.44285714285714, "ram_util_percent": 13.72857142857143, "gpu_util_percent0": 0.010714285714285714, "vram_util_percent0": 0.025355747767857144}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.29092682373786, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.94200199800838, -184.4659048072438, -183.91832588550807, -183.59402465084298, -181.32583504375023, -185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18187112336051403, "mean_inference_ms": 0.9987100569917544, "mean_action_processing_ms": 0.11487010321817563, "mean_env_wait_ms": 0.5699505526708526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 393600, "timesteps_this_iter": 0, "agent_timesteps_total": 393600, "timers": {"learn_time_ms": 1605.015, "learn_throughput": 1.246, "update_time_ms": 8.437}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5578653216362, "grad_norm": 1.3373039960861206, "td_error_abs": 0.486161865234375, "q_taken_mean": 0.3902437744140625, "target_mean": 0.3437422688802083}}}, "num_steps_sampled": 393600, "num_agent_steps_sampled": 393600, "num_steps_trained": 164, "num_agent_steps_trained": 787200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 410, "training_iteration": 82, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-29-20", "timestamp": 1708860560, "time_this_iter_s": 11.567412853240967, "time_total_s": 896.0366795063019, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 896.0366795063019, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 35.44285714285714, "ram_util_percent": 13.757142857142856, "gpu_util_percent0": 0.06571428571428571, "vram_util_percent0": 0.025535946800595236}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.36890232400754, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.45363091598642, -184.63231585161867, -180.21026299629582, -179.59326417082386, -180.99654503226375, -179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18200252593490368, "mean_inference_ms": 0.9995101584267215, "mean_action_processing_ms": 0.1149431477187596, "mean_env_wait_ms": 0.5703838524614949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 398400, "timesteps_this_iter": 0, "agent_timesteps_total": 398400, "timers": {"learn_time_ms": 1615.59, "learn_throughput": 1.238, "update_time_ms": 8.066}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6883851885795593, "grad_norm": 1.243158221244812, "td_error_abs": 0.5078077799479167, "q_taken_mean": 0.31092140706380206, "target_mean": 0.32390277099609377}}}, "num_steps_sampled": 398400, "num_agent_steps_sampled": 398400, "num_steps_trained": 166, "num_agent_steps_trained": 796800, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 415, "training_iteration": 83, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-29-32", "timestamp": 1708860572, "time_this_iter_s": 11.489629745483398, "time_total_s": 907.5263092517853, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 907.5263092517853, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 34.62, "ram_util_percent": 13.84666666666667, "gpu_util_percent0": 0.11199999999999997, "vram_util_percent0": 0.0255126953125}}
{"episode_reward_max": -179.07243759974236, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.65676503459673, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.07243759974236, -185.64552569999768, -193.61813752245524, -186.70141445923412, -190.30474345097556, -181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18213486722571573, "mean_inference_ms": 1.0003330916251136, "mean_action_processing_ms": 0.11501784092530513, "mean_env_wait_ms": 0.5708070561447509, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 403200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"learn_time_ms": 1597.668, "learn_throughput": 1.252, "update_time_ms": 8.025}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6815434098243713, "grad_norm": 1.2444307804107666, "td_error_abs": 0.5056248372395833, "q_taken_mean": 0.3062428181966146, "target_mean": 0.35499055989583334}}}, "num_steps_sampled": 403200, "num_agent_steps_sampled": 403200, "num_steps_trained": 168, "num_agent_steps_trained": 806400, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 420, "training_iteration": 84, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-29-43", "timestamp": 1708860583, "time_this_iter_s": 10.990345001220703, "time_total_s": 918.516654253006, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 918.516654253006, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 31.971428571428568, "ram_util_percent": 13.821428571428573, "gpu_util_percent0": 0.08142857142857143, "vram_util_percent0": 0.025361560639880952}}
{"episode_reward_max": -179.4795469206381, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.51057055132213, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.2358396828798, -189.02677589715236, -181.82561748146455, -186.55031275471785, -179.78676795395185, -195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18224975452811115, "mean_inference_ms": 1.0010826069315835, "mean_action_processing_ms": 0.11508416288535141, "mean_env_wait_ms": 0.5711961937542039, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"learn_time_ms": 1584.897, "learn_throughput": 1.262, "update_time_ms": 7.983}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5710144639015198, "grad_norm": 0.6577986478805542, "td_error_abs": 0.48279793294270834, "q_taken_mean": 0.37002864583333334, "target_mean": 0.35814131673177085}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 170, "num_agent_steps_trained": 816000, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 425, "training_iteration": 85, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-29-53", "timestamp": 1708860593, "time_this_iter_s": 10.717724561691284, "time_total_s": 929.2343788146973, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 929.2343788146973, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 29.63076923076923, "ram_util_percent": 14.015384615384615, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0252685546875}}
{"episode_reward_max": -179.4795469206381, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.44336378880013, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.05081412415777, -181.45515959845997, -192.71021422679456, -187.83946786980013, -184.9774541002374, -184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18235058604256793, "mean_inference_ms": 1.0017837084004422, "mean_action_processing_ms": 0.11514452901931588, "mean_env_wait_ms": 0.5715568878911134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 412800, "timesteps_this_iter": 0, "agent_timesteps_total": 412800, "timers": {"learn_time_ms": 1579.726, "learn_throughput": 1.266, "update_time_ms": 8.108}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5933265089988708, "grad_norm": 0.8046400547027588, "td_error_abs": 0.4914569091796875, "q_taken_mean": 0.3378629353841146, "target_mean": 0.32802402750651044}}}, "num_steps_sampled": 412800, "num_agent_steps_sampled": 412800, "num_steps_trained": 172, "num_agent_steps_trained": 825600, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 430, "training_iteration": 86, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-30-04", "timestamp": 1708860604, "time_this_iter_s": 10.67287302017212, "time_total_s": 939.9072518348694, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 939.9072518348694, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 29.97142857142858, "ram_util_percent": 14.028571428571427, "gpu_util_percent0": 0.004285714285714286, "vram_util_percent0": 0.0252685546875}}
{"episode_reward_max": -179.4795469206381, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.4094905462465, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.2662046269559, -185.10481420932524, -185.46699324578032, -188.046630368982, -194.19133812169815, -180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1824551915988673, "mean_inference_ms": 1.0024922835307601, "mean_action_processing_ms": 0.11520402476436949, "mean_env_wait_ms": 0.5718884505940716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 417600, "timesteps_this_iter": 0, "agent_timesteps_total": 417600, "timers": {"learn_time_ms": 1575.082, "learn_throughput": 1.27, "update_time_ms": 8.143}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.725191593170166, "grad_norm": 1.635484218597412, "td_error_abs": 0.5168468017578125, "q_taken_mean": 0.3415555826822917, "target_mean": 0.3265272420247396}}}, "num_steps_sampled": 417600, "num_agent_steps_sampled": 417600, "num_steps_trained": 174, "num_agent_steps_trained": 835200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 435, "training_iteration": 87, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-30-15", "timestamp": 1708860615, "time_this_iter_s": 11.11053991317749, "time_total_s": 951.0177917480469, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 951.0177917480469, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 33.814285714285724, "ram_util_percent": 14.114285714285714, "gpu_util_percent0": 0.05714285714285715, "vram_util_percent0": 0.025390625000000003}}
{"episode_reward_max": -179.4795469206381, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.35984052488456, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.362117815849, -187.51180843476547, -186.95998872284554, -186.59061271070337, -193.04835030625287, -183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18256089128351857, "mean_inference_ms": 1.0031838292096316, "mean_action_processing_ms": 0.11526236669640029, "mean_env_wait_ms": 0.572210525425585, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 422400, "timesteps_this_iter": 0, "agent_timesteps_total": 422400, "timers": {"learn_time_ms": 1585.448, "learn_throughput": 1.261, "update_time_ms": 8.226}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6036267280578613, "grad_norm": 1.0832730531692505, "td_error_abs": 0.4886854654947917, "q_taken_mean": 0.3107401123046875, "target_mean": 0.35580037434895834}}}, "num_steps_sampled": 422400, "num_agent_steps_sampled": 422400, "num_steps_trained": 176, "num_agent_steps_trained": 844800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 440, "training_iteration": 88, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-30-26", "timestamp": 1708860626, "time_this_iter_s": 11.087996006011963, "time_total_s": 962.1057877540588, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 962.1057877540588, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.32857142857143, "ram_util_percent": 14.114285714285712, "gpu_util_percent0": 0.02428571428571429, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -179.4795469206381, "episode_reward_min": -195.52127768516104, "episode_reward_mean": -186.50607303825996, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.75828815249903, -186.3143887519899, -186.32383408379997, -183.59165981586943, -195.52127768516104, -189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18266261023434816, "mean_inference_ms": 1.0038665051888933, "mean_action_processing_ms": 0.11531901143038505, "mean_env_wait_ms": 0.5725152968222437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 427200, "timesteps_this_iter": 0, "agent_timesteps_total": 427200, "timers": {"learn_time_ms": 1586.13, "learn_throughput": 1.261, "update_time_ms": 8.309}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5526072382926941, "grad_norm": 1.4864130020141602, "td_error_abs": 0.4862775065104167, "q_taken_mean": 0.3852633056640625, "target_mean": 0.43020377604166665}}}, "num_steps_sampled": 427200, "num_agent_steps_sampled": 427200, "num_steps_trained": 178, "num_agent_steps_trained": 854400, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 445, "training_iteration": 89, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-30-37", "timestamp": 1708860637, "time_this_iter_s": 10.822169065475464, "time_total_s": 972.9279568195343, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 972.9279568195343, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 30.964285714285715, "ram_util_percent": 14.107142857142858, "gpu_util_percent0": 0.023571428571428573, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -179.4795469206381, "episode_reward_min": -194.94569580949783, "episode_reward_mean": -186.33708015744023, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.8613202885034, -184.97553988201582, -181.83624759424367, -183.20260721392629, -188.0962149396877, -187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18275956064494753, "mean_inference_ms": 1.0045025184263552, "mean_action_processing_ms": 0.11537107407270746, "mean_env_wait_ms": 0.5727990854641682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"learn_time_ms": 1572.898, "learn_throughput": 1.272, "update_time_ms": 8.249}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5997229814529419, "grad_norm": 2.281625986099243, "td_error_abs": 0.5045122884114583, "q_taken_mean": 0.492290283203125, "target_mean": 0.4274959716796875}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 180, "num_agent_steps_trained": 864000, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 450, "training_iteration": 90, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-30-48", "timestamp": 1708860648, "time_this_iter_s": 10.709808111190796, "time_total_s": 983.6377649307251, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 983.6377649307251, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 31.199999999999992, "ram_util_percent": 14.307692307692312, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -195.0844937427103, "episode_reward_mean": -186.36421050547727, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.52872564907494, -183.32890734434193, -188.25828815971192, -187.08875384795527, -181.47611924752692, -184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1828447067632356, "mean_inference_ms": 1.005080021422458, "mean_action_processing_ms": 0.11541702261465792, "mean_env_wait_ms": 0.5730380195402721, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 436800, "timesteps_this_iter": 0, "agent_timesteps_total": 436800, "timers": {"learn_time_ms": 1569.36, "learn_throughput": 1.274, "update_time_ms": 8.241}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6688399314880371, "grad_norm": 1.5858187675476074, "td_error_abs": 0.5130572102864583, "q_taken_mean": 0.33403450520833333, "target_mean": 0.39619193522135415}}}, "num_steps_sampled": 436800, "num_agent_steps_sampled": 436800, "num_steps_trained": 182, "num_agent_steps_trained": 873600, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 455, "training_iteration": 91, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-30-59", "timestamp": 1708860659, "time_this_iter_s": 10.830513715744019, "time_total_s": 994.4682786464691, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 994.4682786464691, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 30.914285714285715, "ram_util_percent": 14.314285714285718, "gpu_util_percent0": 0.02214285714285714, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -195.0844937427103, "episode_reward_mean": -186.3834498597463, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.87980347682677, -185.796967922447, -189.96661603019294, -194.72801695942246, -184.6560819899534, -179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18292235852637653, "mean_inference_ms": 1.0056356970097224, "mean_action_processing_ms": 0.11545982251805798, "mean_env_wait_ms": 0.573270115813418, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 441600, "timesteps_this_iter": 0, "agent_timesteps_total": 441600, "timers": {"learn_time_ms": 1556.954, "learn_throughput": 1.285, "update_time_ms": 8.029}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5708841681480408, "grad_norm": 1.1494861841201782, "td_error_abs": 0.4870731608072917, "q_taken_mean": 0.4591234537760417, "target_mean": 0.42928316243489584}}}, "num_steps_sampled": 441600, "num_agent_steps_sampled": 441600, "num_steps_trained": 184, "num_agent_steps_trained": 883200, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 460, "training_iteration": 92, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-31-10", "timestamp": 1708860670, "time_this_iter_s": 10.705978870391846, "time_total_s": 1005.174257516861, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1005.174257516861, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.507692307692306, "ram_util_percent": 14.415384615384616, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -317.47877975863616, "episode_reward_mean": -192.0325395981788, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.74106050515877, -188.50582610919602, -190.3669859767285, -189.41662041595796, -182.8329616054749, -190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18300328843386662, "mean_inference_ms": 1.0061803854303282, "mean_action_processing_ms": 0.11550158576476989, "mean_env_wait_ms": 0.5735034590843461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 446400, "timesteps_this_iter": 0, "agent_timesteps_total": 446400, "timers": {"learn_time_ms": 1549.923, "learn_throughput": 1.29, "update_time_ms": 7.97}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.150694727897644, "grad_norm": 6.704400062561035, "td_error_abs": 0.5183885904947917, "q_taken_mean": 0.3840430908203125, "target_mean": 0.4376709391276042}}}, "num_steps_sampled": 446400, "num_agent_steps_sampled": 446400, "num_steps_trained": 186, "num_agent_steps_trained": 892800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 465, "training_iteration": 93, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-31-21", "timestamp": 1708860681, "time_this_iter_s": 11.0854332447052, "time_total_s": 1016.2596907615662, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1016.2596907615662, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 31.771428571428572, "ram_util_percent": 14.414285714285715, "gpu_util_percent0": 0.027857142857142858, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -317.47877975863616, "episode_reward_mean": -192.12148933532157, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.28119169474274, -184.23263026725792, -183.48717482301467, -182.7877223270101, -188.66175172194693, -180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1830758449326638, "mean_inference_ms": 1.0066905399718247, "mean_action_processing_ms": 0.11553997851650324, "mean_env_wait_ms": 0.5737267546285945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 451200, "timesteps_this_iter": 0, "agent_timesteps_total": 451200, "timers": {"learn_time_ms": 1553.543, "learn_throughput": 1.287, "update_time_ms": 7.921}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9325615167617798, "grad_norm": 3.9396378993988037, "td_error_abs": 0.5420132242838541, "q_taken_mean": 0.5705394694010417, "target_mean": 0.4419710286458333}}}, "num_steps_sampled": 451200, "num_agent_steps_sampled": 451200, "num_steps_trained": 188, "num_agent_steps_trained": 902400, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 470, "training_iteration": 94, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-31-32", "timestamp": 1708860692, "time_this_iter_s": 10.86453628540039, "time_total_s": 1027.1242270469666, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1027.1242270469666, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.25714285714286, "ram_util_percent": 14.421428571428573, "gpu_util_percent0": 0.03928571428571429, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -317.47877975863616, "episode_reward_mean": -192.2087723204314, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.1179496428301, -188.76884761340477, -192.79375454114646, -180.95662195627324, -183.0047061347453, -185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642, -188.4575085397021, -178.9870134137208, -192.77786807549086, -188.8500005649824, -189.10637875105942], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18313686516193847, "mean_inference_ms": 1.0071694123564636, "mean_action_processing_ms": 0.11557363029735213, "mean_env_wait_ms": 0.5739233292717818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"learn_time_ms": 1553.535, "learn_throughput": 1.287, "update_time_ms": 7.953}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5641199350357056, "grad_norm": 2.1555237770080566, "td_error_abs": 0.4873361002604167, "q_taken_mean": 0.348947021484375, "target_mean": 0.4261096598307292}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 190, "num_agent_steps_trained": 912000, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 475, "training_iteration": 95, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-31-43", "timestamp": 1708860703, "time_this_iter_s": 10.94192123413086, "time_total_s": 1038.0661482810974, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1038.0661482810974, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 31.22142857142857, "ram_util_percent": 14.614285714285712, "gpu_util_percent0": 0.027857142857142858, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -317.47877975863616, "episode_reward_mean": -192.2136012876299, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.55531235016443, -187.22960928767773, -186.50442437095364, -185.47754500118467, -188.41246136052857, -190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642, -188.4575085397021, -178.9870134137208, -192.77786807549086, -188.8500005649824, -189.10637875105942, -182.01897492804014, -179.38824384179796, -186.46938619424768, -187.60885304217155, -190.63931860199446], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18318556231091848, "mean_inference_ms": 1.0075652825170942, "mean_action_processing_ms": 0.11559951359215229, "mean_env_wait_ms": 0.5740947537055338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"learn_time_ms": 1560.247, "learn_throughput": 1.282, "update_time_ms": 7.838}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5856003761291504, "grad_norm": 2.8369791507720947, "td_error_abs": 0.49600724283854164, "q_taken_mean": 0.5329105631510417, "target_mean": 0.425772216796875}}}, "num_steps_sampled": 460800, "num_agent_steps_sampled": 460800, "num_steps_trained": 192, "num_agent_steps_trained": 921600, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 480, "training_iteration": 96, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-31-53", "timestamp": 1708860713, "time_this_iter_s": 10.785188674926758, "time_total_s": 1048.8513369560242, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1048.8513369560242, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.330769230769235, "ram_util_percent": 14.630769230769232, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.02530924479166667}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -317.47877975863616, "episode_reward_mean": -192.23870549671608, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.90246858706686, -185.70416827687404, -185.73433455235903, -185.47585541826027, -191.5440562993414, -191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642, -188.4575085397021, -178.9870134137208, -192.77786807549086, -188.8500005649824, -189.10637875105942, -182.01897492804014, -179.38824384179796, -186.46938619424768, -187.60885304217155, -190.63931860199446, -188.8342858004971, -186.0648460269766, -184.38785538989686, -186.16338277001924, -190.23940329173402], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1832276271104946, "mean_inference_ms": 1.0079143159516435, "mean_action_processing_ms": 0.11562032817608707, "mean_env_wait_ms": 0.5742552693838849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 465600, "timesteps_this_iter": 0, "agent_timesteps_total": 465600, "timers": {"learn_time_ms": 1557.077, "learn_throughput": 1.284, "update_time_ms": 7.745}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.65622478723526, "grad_norm": 1.9096543788909912, "td_error_abs": 0.5118646240234375, "q_taken_mean": 0.3162660929361979, "target_mean": 0.3934779866536458}}}, "num_steps_sampled": 465600, "num_agent_steps_sampled": 465600, "num_steps_trained": 194, "num_agent_steps_trained": 931200, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 485, "training_iteration": 97, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-32-04", "timestamp": 1708860724, "time_this_iter_s": 10.968751430511475, "time_total_s": 1059.8200883865356, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1059.8200883865356, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 14.7, "gpu_util_percent0": 0.030714285714285715, "vram_util_percent0": 0.025309244791666675}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -317.47877975863616, "episode_reward_mean": -192.11336069806188, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.80012942285433, -188.9066262085084, -186.80322528133638, -179.4795469206381, -186.91359404980005, -185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642, -188.4575085397021, -178.9870134137208, -192.77786807549086, -188.8500005649824, -189.10637875105942, -182.01897492804014, -179.38824384179796, -186.46938619424768, -187.60885304217155, -190.63931860199446, -188.8342858004971, -186.0648460269766, -184.38785538989686, -186.16338277001924, -190.23940329173402, -189.6827479884588, -181.59078113562634, -183.3038767080665, -183.32912255998983, -188.91987487634637], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1832677478397341, "mean_inference_ms": 1.008251900472268, "mean_action_processing_ms": 0.11563992254746429, "mean_env_wait_ms": 0.5744074772475745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 470400, "timesteps_this_iter": 0, "agent_timesteps_total": 470400, "timers": {"learn_time_ms": 1541.795, "learn_throughput": 1.297, "update_time_ms": 7.607}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6217984557151794, "grad_norm": 1.124927043914795, "td_error_abs": 0.5034183349609375, "q_taken_mean": 0.45437744140625, "target_mean": 0.42464363606770833}}}, "num_steps_sampled": 470400, "num_agent_steps_sampled": 470400, "num_steps_trained": 196, "num_agent_steps_trained": 940800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 490, "training_iteration": 98, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-32-15", "timestamp": 1708860735, "time_this_iter_s": 11.016004800796509, "time_total_s": 1070.8360931873322, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1070.8360931873322, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.285714285714285, "ram_util_percent": 14.792857142857146, "gpu_util_percent0": 0.025714285714285717, "vram_util_percent0": 0.02392578125}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -591.0441990531031, "episode_reward_mean": -210.79574992018595, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.12647718080595, -186.89432745546944, -186.26826459303325, -191.079186332938, -190.53947244154, -183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642, -188.4575085397021, -178.9870134137208, -192.77786807549086, -188.8500005649824, -189.10637875105942, -182.01897492804014, -179.38824384179796, -186.46938619424768, -187.60885304217155, -190.63931860199446, -188.8342858004971, -186.0648460269766, -184.38785538989686, -186.16338277001924, -190.23940329173402, -189.6827479884588, -181.59078113562634, -183.3038767080665, -183.32912255998983, -188.91987487634637, -549.4822800604699, -560.2260349164642, -591.0441990531031, -536.0137201748041, -565.3758098906969], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18330590136415065, "mean_inference_ms": 1.0085646775027295, "mean_action_processing_ms": 0.11565756218041633, "mean_env_wait_ms": 0.5745567936908772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 475200, "timesteps_this_iter": 0, "agent_timesteps_total": 475200, "timers": {"learn_time_ms": 1542.12, "learn_throughput": 1.297, "update_time_ms": 8.199}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.2345211505889893, "grad_norm": 12.07692813873291, "td_error_abs": 0.8448771158854167, "q_taken_mean": 0.3900603841145833, "target_mean": 0.370042236328125}}}, "num_steps_sampled": 475200, "num_agent_steps_sampled": 475200, "num_steps_trained": 198, "num_agent_steps_trained": 950400, "last_target_update_ts": 475200, "num_steps_trained_this_iter": 0, "num_target_updates": 9}, "done": false, "episodes_total": 495, "training_iteration": 99, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-32-26", "timestamp": 1708860746, "time_this_iter_s": 10.877629041671753, "time_total_s": 1081.713722229004, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1081.713722229004, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.321428571428573, "ram_util_percent": 14.778571428571427, "gpu_util_percent0": 0.02785714285714286, "vram_util_percent0": 0.02392578125}}
{"episode_reward_max": -178.25259536097118, "episode_reward_min": -591.0441990531031, "episode_reward_mean": -210.59005460270785, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.58351894260556, -184.2135685909511, -188.99266458754516, -191.33350185218333, -187.39087255840374, -186.34272868318715, -182.89358501201858, -189.83680639340525, -181.52253505974573, -191.00469859484804, -189.3319507022241, -185.93388946412728, -184.98024100614492, -181.63329753148264, -186.16426370834128, -186.39182081186388, -187.348284928766, -190.01472861509993, -193.08958278272164, -182.82787288745527, -184.295498446544, -181.68490422799206, -187.0091188848928, -182.81531053271564, -184.91797831279908, -183.35944483738385, -182.37329934094262, -180.61130819506772, -184.8643142643194, -180.4962708802564, -189.37969303062238, -190.55755353419684, -184.73400200405354, -189.19329563157305, -184.78124146364033, -190.956532760895, -185.34613421604885, -182.96995464726265, -186.25121627119313, -186.58714054115003, -194.94569580949783, -190.24282555090076, -185.58113966375015, -192.4343218160726, -185.89214648773128, -185.30942010219056, -183.32407323938966, -181.3927528529318, -185.74234212767468, -182.84157208515654, -181.4104587454547, -186.16807886628683, -195.0844937427103, -189.76933800666401, -178.25259536097118, -182.04820694930305, -186.243644075101, -188.723041151686, -181.53193235412638, -191.05790514529377, -310.11067209642556, -307.6938260626989, -301.78654834442233, -267.8666339599129, -317.47877975863616, -192.37673772111538, -192.94617185674625, -189.14777286225961, -183.8421983596008, -181.44554752706642, -188.4575085397021, -178.9870134137208, -192.77786807549086, -188.8500005649824, -189.10637875105942, -182.01897492804014, -179.38824384179796, -186.46938619424768, -187.60885304217155, -190.63931860199446, -188.8342858004971, -186.0648460269766, -184.38785538989686, -186.16338277001924, -190.23940329173402, -189.6827479884588, -181.59078113562634, -183.3038767080665, -183.32912255998983, -188.91987487634637, -549.4822800604699, -560.2260349164642, -591.0441990531031, -536.0137201748041, -565.3758098906969, -186.40484073508898, -180.57094481833425, -181.93724944273134, -181.89452295361886, -188.53063830621122], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18333534355636727, "mean_inference_ms": 1.0088065379340188, "mean_action_processing_ms": 0.11566811515206661, "mean_env_wait_ms": 0.5746695068792037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"learn_time_ms": 1541.287, "learn_throughput": 1.298, "update_time_ms": 8.207}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9083829522132874, "grad_norm": 5.8678693771362305, "td_error_abs": 0.69307958984375, "q_taken_mean": 0.35471651204427085, "target_mean": 0.6076457926432292}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 200, "num_agent_steps_trained": 960000, "last_target_update_ts": 475200, "num_steps_trained_this_iter": 0, "num_target_updates": 9}, "evaluation": {"episode_reward_max": -170.2497017569876, "episode_reward_min": -175.90752317601732, "episode_reward_mean": -172.4326497819109, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.3843553839886, -173.36443131594828, -170.416751884006, -171.09951966399566, -173.2387293713694, -175.90752317601732, -171.21840381503307, -173.06205380875903, -170.2497017569876, -172.38502764300375], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17450209812760126, "mean_inference_ms": 0.8374660389230038, "mean_action_processing_ms": 0.10868097542412647, "mean_env_wait_ms": 0.5531821000837398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 500, "training_iteration": 100, "trial_id": "06fcf_00000", "experiment_id": "354bf716ef4049568157f6706caa486e", "date": "2024-02-25_17-32-54", "timestamp": 1708860774, "time_this_iter_s": 27.209320545196533, "time_total_s": 1108.9230427742004, "pid": 17094, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1108.9230427742004, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 31.04117647058823, "ram_util_percent": 14.99705882352941, "gpu_util_percent0": 0.022941176470588236, "vram_util_percent0": 0.02392578125}}
