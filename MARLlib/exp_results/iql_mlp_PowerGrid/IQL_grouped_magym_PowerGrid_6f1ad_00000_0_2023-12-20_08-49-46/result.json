{"episode_reward_max": -743.600452252025, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -765.1543807800692, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20033809570566546, "mean_inference_ms": 1.0214458271070277, "mean_action_processing_ms": 0.11062398785482955, "mean_env_wait_ms": 0.5844546902564264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 4800, "timers": {"learn_time_ms": 1385.371, "learn_throughput": 1.444, "update_time_ms": 6.879}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.0032432079315186, "grad_norm": 1.9835008382797241, "td_error_abs": 0.8904519856770833, "q_taken_mean": -0.000918877363204956, "target_mean": -0.08596099853515625}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 4800, "num_steps_trained": 2, "num_agent_steps_trained": 9600, "last_target_update_ts": 0}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-49-57", "timestamp": 1703040597, "time_this_iter_s": 10.763121366500854, "time_total_s": 10.763121366500854, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 10.763121366500854, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.89333333333333, "ram_util_percent": 50.54666666666666, "gpu_util_percent0": 0.02866666666666667, "vram_util_percent0": 0.020426432291666668}}
{"episode_reward_max": -669.0963388299501, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -733.875465454644, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20125589422381768, "mean_inference_ms": 1.0235612772009746, "mean_action_processing_ms": 0.11109940955846428, "mean_env_wait_ms": 0.5852261549823821, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"learn_time_ms": 1384.621, "learn_throughput": 1.444, "update_time_ms": 7.164}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7418919801712036, "grad_norm": 1.9396398067474365, "td_error_abs": 0.70929736328125, "q_taken_mean": -0.04275633239746094, "target_mean": -0.08693373616536458}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 9600, "num_steps_trained": 4, "num_agent_steps_trained": 19200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 2, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-50-08", "timestamp": 1703040608, "time_this_iter_s": 10.933948993682861, "time_total_s": 21.697070360183716, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 21.697070360183716, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.46, "ram_util_percent": 52.93333333333333, "gpu_util_percent0": 0.020000000000000004, "vram_util_percent0": 0.02043185763888889}}
{"episode_reward_max": -606.4166057582667, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -706.5470683394251, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20312140921933933, "mean_inference_ms": 1.031827432623044, "mean_action_processing_ms": 0.11226308657093147, "mean_env_wait_ms": 0.5899831764741755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"learn_time_ms": 1375.083, "learn_throughput": 1.454, "update_time_ms": 7.14}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3124622106552124, "grad_norm": 9.452842712402344, "td_error_abs": 0.9755843912760417, "q_taken_mean": -0.12281561279296875, "target_mean": -0.08297104899088542}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 14400, "num_steps_trained": 6, "num_agent_steps_trained": 28800, "last_target_update_ts": 14400, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-50-19", "timestamp": 1703040619, "time_this_iter_s": 11.414944410324097, "time_total_s": 33.11201477050781, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 33.11201477050781, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.626666666666665, "ram_util_percent": 52.95333333333333, "gpu_util_percent0": 0.04666666666666666, "vram_util_percent0": 0.02140299479166667}}
{"episode_reward_max": -528.2065999620158, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -666.2921883505668, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20431943869140112, "mean_inference_ms": 1.039787015451388, "mean_action_processing_ms": 0.11334632323443028, "mean_env_wait_ms": 0.594637500840069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"learn_time_ms": 1439.724, "learn_throughput": 1.389, "update_time_ms": 7.365}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8224883675575256, "grad_norm": 2.7372303009033203, "td_error_abs": 0.7708409016927084, "q_taken_mean": 0.011329322814941407, "target_mean": 0.15820167032877605}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 19200, "num_steps_trained": 8, "num_agent_steps_trained": 38400, "last_target_update_ts": 14400, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-50-31", "timestamp": 1703040631, "time_this_iter_s": 11.828588485717773, "time_total_s": 44.940603256225586, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 44.940603256225586, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.9375, "ram_util_percent": 53.7, "gpu_util_percent0": 0.040625, "vram_util_percent0": 0.021402994791666668}}
{"episode_reward_max": -452.6418022986124, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -625.1029398907602, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20499255870032687, "mean_inference_ms": 1.0445575660679338, "mean_action_processing_ms": 0.11398818412693176, "mean_env_wait_ms": 0.5972959693793141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"learn_time_ms": 1414.834, "learn_throughput": 1.414, "update_time_ms": 7.456}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7031198740005493, "grad_norm": 1.0391367673873901, "td_error_abs": 0.565614501953125, "q_taken_mean": 0.14512581380208334, "target_mean": 0.16387013753255208}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 10, "num_agent_steps_trained": 48000, "last_target_update_ts": 14400, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 25, "training_iteration": 5, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-50-42", "timestamp": 1703040642, "time_this_iter_s": 11.159308195114136, "time_total_s": 56.09991145133972, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 56.09991145133972, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.92142857142857, "ram_util_percent": 53.70000000000001, "gpu_util_percent0": 0.05071428571428571, "vram_util_percent0": 0.021519252232142856}}
{"episode_reward_max": -407.62043309104587, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -591.0570740734571, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20594512811823856, "mean_inference_ms": 1.050244255559579, "mean_action_processing_ms": 0.11475856998614288, "mean_env_wait_ms": 0.6007992680013048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"learn_time_ms": 1413.451, "learn_throughput": 1.415, "update_time_ms": 7.568}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6638138294219971, "grad_norm": 1.0734355449676514, "td_error_abs": 0.5196241455078126, "q_taken_mean": 0.24006673177083335, "target_mean": 0.1657552490234375}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 28800, "num_steps_trained": 12, "num_agent_steps_trained": 57600, "last_target_update_ts": 28800, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 30, "training_iteration": 6, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-50-54", "timestamp": 1703040654, "time_this_iter_s": 12.072081565856934, "time_total_s": 68.17199301719666, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 68.17199301719666, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.28125, "ram_util_percent": 53.80625, "gpu_util_percent0": 0.074375, "vram_util_percent0": 0.02154541015625}}
{"episode_reward_max": -324.8726712573378, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -554.9987161137917, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20689832350909343, "mean_inference_ms": 1.056250243977697, "mean_action_processing_ms": 0.11557613695462082, "mean_env_wait_ms": 0.6046566876892787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 33600, "timers": {"learn_time_ms": 1398.512, "learn_throughput": 1.43, "update_time_ms": 7.444}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9278624057769775, "grad_norm": 2.8697128295898438, "td_error_abs": 0.6640184733072917, "q_taken_mean": 0.2597808837890625, "target_mean": 0.5327836100260417}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 33600, "num_steps_trained": 14, "num_agent_steps_trained": 67200, "last_target_update_ts": 28800, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 35, "training_iteration": 7, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-51-06", "timestamp": 1703040666, "time_this_iter_s": 12.184743642807007, "time_total_s": 80.35673666000366, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 80.35673666000366, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.5375, "ram_util_percent": 53.9, "gpu_util_percent0": 0.03875, "vram_util_percent0": 0.021402994791666668}}
{"episode_reward_max": -262.8143207532167, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -519.479715702474, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20749069600879264, "mean_inference_ms": 1.0603773602898978, "mean_action_processing_ms": 0.1161021379553426, "mean_env_wait_ms": 0.6070539384057427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"learn_time_ms": 1405.638, "learn_throughput": 1.423, "update_time_ms": 7.442}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9098325371742249, "grad_norm": 2.9264209270477295, "td_error_abs": 0.5693121337890625, "q_taken_mean": 0.58499365234375, "target_mean": 0.5271114095052083}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 16, "num_agent_steps_trained": 76800, "last_target_update_ts": 28800, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 40, "training_iteration": 8, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-51-18", "timestamp": 1703040678, "time_this_iter_s": 11.175686836242676, "time_total_s": 91.53242349624634, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 91.53242349624634, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.10666666666667, "ram_util_percent": 54.11333333333334, "gpu_util_percent0": 0.014, "vram_util_percent0": 0.02140299479166667}}
{"episode_reward_max": -207.011699114684, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -486.40415310500214, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.208113970334373, "mean_inference_ms": 1.0643446168195914, "mean_action_processing_ms": 0.11661826558981175, "mean_env_wait_ms": 0.6095380121265284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"learn_time_ms": 1420.106, "learn_throughput": 1.408, "update_time_ms": 7.436}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.0289610624313354, "grad_norm": 1.6574392318725586, "td_error_abs": 0.5546269124348958, "q_taken_mean": 0.4289512939453125, "target_mean": 0.5248646647135417}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 43200, "num_steps_trained": 18, "num_agent_steps_trained": 86400, "last_target_update_ts": 43200, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 45, "training_iteration": 9, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-51-30", "timestamp": 1703040690, "time_this_iter_s": 12.21226167678833, "time_total_s": 103.74468517303467, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 103.74468517303467, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.48125, "ram_util_percent": 54.30625, "gpu_util_percent0": 0.104375, "vram_util_percent0": 0.021494547526041668}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -455.6713931961118, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20862922173377593, "mean_inference_ms": 1.0674486691103093, "mean_action_processing_ms": 0.11702000343427434, "mean_env_wait_ms": 0.6115332661615247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"learn_time_ms": 1412.147, "learn_throughput": 1.416, "update_time_ms": 7.401}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.056337833404541, "grad_norm": 1.8375736474990845, "td_error_abs": 0.5848175048828125, "q_taken_mean": 0.47902925618489584, "target_mean": 0.4911361897786458}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 20, "num_agent_steps_trained": 96000, "last_target_update_ts": 43200, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 50, "training_iteration": 10, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-51-41", "timestamp": 1703040701, "time_this_iter_s": 11.384444236755371, "time_total_s": 115.12912940979004, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 115.12912940979004, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.29333333333334, "ram_util_percent": 54.41999999999999, "gpu_util_percent0": 0.026000000000000002, "vram_util_percent0": 0.02145724826388889}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -432.1760391341423, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20898309059841902, "mean_inference_ms": 1.0699064054961203, "mean_action_processing_ms": 0.11732408910246363, "mean_env_wait_ms": 0.6130797916926594, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 52800, "timers": {"learn_time_ms": 1423.441, "learn_throughput": 1.405, "update_time_ms": 7.457}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8769994974136353, "grad_norm": 0.964668869972229, "td_error_abs": 0.45620491536458335, "q_taken_mean": 0.49167362467447917, "target_mean": 0.4671617431640625}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 52800, "num_steps_trained": 22, "num_agent_steps_trained": 105600, "last_target_update_ts": 43200, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 55, "training_iteration": 11, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-51-53", "timestamp": 1703040713, "time_this_iter_s": 11.442689657211304, "time_total_s": 126.57181906700134, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 126.57181906700134, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 43.31333333333334, "ram_util_percent": 54.646666666666675, "gpu_util_percent0": 0.02466666666666667, "vram_util_percent0": 0.021511501736111112}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -411.6070059172586, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2093534468888323, "mean_inference_ms": 1.072447176820368, "mean_action_processing_ms": 0.11763763982117625, "mean_env_wait_ms": 0.6146055521871155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"learn_time_ms": 1435.597, "learn_throughput": 1.393, "update_time_ms": 7.6}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8614577651023865, "grad_norm": 1.2238048315048218, "td_error_abs": 0.49474491373697915, "q_taken_mean": 0.606413818359375, "target_mean": 0.4540714111328125}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 57600, "num_steps_trained": 24, "num_agent_steps_trained": 115200, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-52-05", "timestamp": 1703040725, "time_this_iter_s": 12.199660301208496, "time_total_s": 138.77147936820984, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 138.77147936820984, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 58.54375, "ram_util_percent": 54.8125, "gpu_util_percent0": 0.030625000000000003, "vram_util_percent0": 0.021484375}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -393.9794525212595, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20982219655602097, "mean_inference_ms": 1.0755172043968975, "mean_action_processing_ms": 0.11803140225848123, "mean_env_wait_ms": 0.6164377956296911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 62400, "timers": {"learn_time_ms": 1454.177, "learn_throughput": 1.375, "update_time_ms": 7.711}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8935869932174683, "grad_norm": 1.4995813369750977, "td_error_abs": 0.5148479817708334, "q_taken_mean": 0.4652811279296875, "target_mean": 0.39083357747395836}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 62400, "num_steps_trained": 26, "num_agent_steps_trained": 124800, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 65, "training_iteration": 13, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-52-18", "timestamp": 1703040738, "time_this_iter_s": 13.173790454864502, "time_total_s": 151.94526982307434, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 151.94526982307434, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 58.8764705882353, "ram_util_percent": 54.976470588235294, "gpu_util_percent0": 0.06588235294117648, "vram_util_percent0": 0.021402994791666668}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -378.9753742536888, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2102773850142072, "mean_inference_ms": 1.078408741541677, "mean_action_processing_ms": 0.11841213148033956, "mean_env_wait_ms": 0.6182190519490859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"learn_time_ms": 1434.227, "learn_throughput": 1.394, "update_time_ms": 7.904}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8679225444793701, "grad_norm": 1.5136830806732178, "td_error_abs": 0.49958935546875, "q_taken_mean": 0.5266818440755209, "target_mean": 0.3796561686197917}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 67200, "num_steps_trained": 28, "num_agent_steps_trained": 134400, "last_target_update_ts": 57600, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 70, "training_iteration": 14, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-52-30", "timestamp": 1703040750, "time_this_iter_s": 12.196998119354248, "time_total_s": 164.1422679424286, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 164.1422679424286, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 55.193749999999994, "ram_util_percent": 55.1125, "gpu_util_percent0": 0.06125, "vram_util_percent0": 0.021504720052083336}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -365.4473689665037, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21064023095443896, "mean_inference_ms": 1.0807202476179285, "mean_action_processing_ms": 0.11871014182256659, "mean_env_wait_ms": 0.6196357468673676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"learn_time_ms": 1436.654, "learn_throughput": 1.392, "update_time_ms": 7.828}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8961124420166016, "grad_norm": 1.0699199438095093, "td_error_abs": 0.6444059244791667, "q_taken_mean": 0.31951190185546874, "target_mean": 0.3471883138020833}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 30, "num_agent_steps_trained": 144000, "last_target_update_ts": 72000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 75, "training_iteration": 15, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-52-41", "timestamp": 1703040761, "time_this_iter_s": 11.193039655685425, "time_total_s": 175.335307598114, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 175.335307598114, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.22, "ram_util_percent": 55.31333333333332, "gpu_util_percent0": 0.012000000000000002, "vram_util_percent0": 0.021511501736111112}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -354.22614805013325, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715, -185.93547886962185, -186.8552150498848, -185.43023187191056, -185.1995523917796, -186.11869333968667], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21090068218547672, "mean_inference_ms": 1.082437536684379, "mean_action_processing_ms": 0.11893208622371301, "mean_env_wait_ms": 0.6206822179792345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"learn_time_ms": 1429.515, "learn_throughput": 1.399, "update_time_ms": 7.826}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8959769010543823, "grad_norm": 1.261576771736145, "td_error_abs": 0.5078468424479167, "q_taken_mean": 0.37868741861979166, "target_mean": 0.305093017578125}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 32, "num_agent_steps_trained": 153600, "last_target_update_ts": 72000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 80, "training_iteration": 16, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-52-52", "timestamp": 1703040772, "time_this_iter_s": 10.900649785995483, "time_total_s": 186.2359573841095, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 186.2359573841095, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 36.90714285714286, "ram_util_percent": 55.50714285714286, "gpu_util_percent0": 0.002142857142857143, "vram_util_percent0": 0.021402994791666668}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -343.965007458016, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715, -185.93547886962185, -186.8552150498848, -185.43023187191056, -185.1995523917796, -186.11869333968667, -182.1787485124579, -179.7377147469476, -181.3843785862157, -177.4564941167893, -178.17645395828606], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21110438397356066, "mean_inference_ms": 1.0836936516853508, "mean_action_processing_ms": 0.11909454466006218, "mean_env_wait_ms": 0.621460917104721, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 81600, "timers": {"learn_time_ms": 1430.397, "learn_throughput": 1.398, "update_time_ms": 7.916}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9125559329986572, "grad_norm": 1.5387736558914185, "td_error_abs": 0.5367832845052083, "q_taken_mean": 0.435921142578125, "target_mean": 0.27131309000651044}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 81600, "num_steps_trained": 34, "num_agent_steps_trained": 163200, "last_target_update_ts": 72000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 85, "training_iteration": 17, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-53-03", "timestamp": 1703040783, "time_this_iter_s": 10.85535478591919, "time_total_s": 197.0913121700287, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 197.0913121700287, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.75714285714286, "ram_util_percent": 55.60000000000001, "gpu_util_percent0": 0.006428571428571429, "vram_util_percent0": 0.020647321428571428}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -335.0791009261496, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715, -185.93547886962185, -186.8552150498848, -185.43023187191056, -185.1995523917796, -186.11869333968667, -182.1787485124579, -179.7377147469476, -181.3843785862157, -177.4564941167893, -178.17645395828606, -185.61863845404963, -183.56009824502567, -184.5504568424813, -180.62069979652983, -185.7435560840188], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2112591006896977, "mean_inference_ms": 1.0846768014447579, "mean_action_processing_ms": 0.11921347687800454, "mean_env_wait_ms": 0.6220067314128629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"learn_time_ms": 1419.313, "learn_throughput": 1.409, "update_time_ms": 7.89}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9133732318878174, "grad_norm": 1.6536812782287598, "td_error_abs": 0.5237400309244792, "q_taken_mean": 0.17354597981770833, "target_mean": 0.2761600545247396}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 86400, "num_steps_trained": 36, "num_agent_steps_trained": 172800, "last_target_update_ts": 86400, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 90, "training_iteration": 18, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-53-14", "timestamp": 1703040794, "time_this_iter_s": 10.976646900177002, "time_total_s": 208.0679590702057, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 208.0679590702057, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.38666666666666, "ram_util_percent": 55.72666666666668, "gpu_util_percent0": 0.015333333333333332, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -327.3673930810567, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715, -185.93547886962185, -186.8552150498848, -185.43023187191056, -185.1995523917796, -186.11869333968667, -182.1787485124579, -179.7377147469476, -181.3843785862157, -177.4564941167893, -178.17645395828606, -185.61863845404963, -183.56009824502567, -184.5504568424813, -180.62069979652983, -185.7435560840188, -191.59046054091547, -190.1500248247324, -192.32038542095353, -180.63881063424708, -188.08357792607612], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21137403483395753, "mean_inference_ms": 1.0853994306307426, "mean_action_processing_ms": 0.11929674024590747, "mean_env_wait_ms": 0.622364280961042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 91200, "timers": {"learn_time_ms": 1398.565, "learn_throughput": 1.43, "update_time_ms": 7.865}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8378055691719055, "grad_norm": 0.9567272663116455, "td_error_abs": 0.5007226155598958, "q_taken_mean": 0.611572509765625, "target_mean": 0.5524433186848958}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 91200, "num_steps_trained": 38, "num_agent_steps_trained": 182400, "last_target_update_ts": 86400, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 95, "training_iteration": 19, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-53-25", "timestamp": 1703040805, "time_this_iter_s": 10.929285526275635, "time_total_s": 218.99724459648132, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 218.99724459648132, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.4, "ram_util_percent": 55.90714285714285, "gpu_util_percent0": 0.008571428571428572, "vram_util_percent0": 0.020589192708333336}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -809.6379247979762, "episode_reward_mean": -320.1407282424701, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.6379247979762, -746.4091199034316, -743.600452252025, -759.0162265671951, -767.1081803797183, -669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715, -185.93547886962185, -186.8552150498848, -185.43023187191056, -185.1995523917796, -186.11869333968667, -182.1787485124579, -179.7377147469476, -181.3843785862157, -177.4564941167893, -178.17645395828606, -185.61863845404963, -183.56009824502567, -184.5504568424813, -180.62069979652983, -185.7435560840188, -191.59046054091547, -190.1500248247324, -192.32038542095353, -180.63881063424708, -188.08357792607612, -183.2898882886817, -182.76315449447475, -183.6164829906581, -182.85928396732888, -181.64167180548338], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21145731110277036, "mean_inference_ms": 1.0859009718661938, "mean_action_processing_ms": 0.11935270197811854, "mean_env_wait_ms": 0.6226124680759587, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"learn_time_ms": 1398.255, "learn_throughput": 1.43, "update_time_ms": 7.864}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8694549798965454, "grad_norm": 1.0302577018737793, "td_error_abs": 0.5250694580078125, "q_taken_mean": 0.5410598958333334, "target_mean": 0.4687869873046875}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 40, "num_agent_steps_trained": 192000, "last_target_update_ts": 86400, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 100, "training_iteration": 20, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-53-36", "timestamp": 1703040816, "time_this_iter_s": 10.91704511642456, "time_total_s": 229.91428971290588, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 229.91428971290588, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.5, "ram_util_percent": 56.042857142857144, "gpu_util_percent0": 0.012142857142857144, "vram_util_percent0": 0.020589192708333336}}
{"episode_reward_max": -171.53862984542363, "episode_reward_min": -730.5558542439999, "episode_reward_mean": -291.0911791154782, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.0963388299501, -703.9726446267508, -689.834115256726, -730.5558542439999, -719.5237976886679, -656.6941530878153, -663.2579009844327, -606.4166057582667, -681.5819798189, -651.5007308955234, -550.7763210321057, -548.8757320513323, -528.2065999620158, -543.1200579210636, -556.6590309534404, -454.9165660054974, -452.6418022986124, -480.24718016434656, -456.4529202717563, -457.4712615174575, -422.6489603153764, -407.62043309104587, -427.08645146133534, -411.6255708572955, -435.1573092096552, -339.5691528600738, -324.8726712573378, -351.7102763381634, -328.6110129558304, -348.47972836759027, -262.8143207532167, -282.0867388184438, -279.02362363544074, -265.90160706387326, -264.40727384527696, -227.55111839467332, -221.28588084511173, -207.011699114684, -223.91074272862235, -229.23882054304576, -174.2912227822082, -179.43886143768606, -171.53862984542363, -193.65304647255073, -176.4610095426197, -198.10391910177992, -196.5186951057686, -198.89615240748148, -194.46083575159332, -198.1328902056127, -189.37433988882148, -188.963481321671, -178.740101435854, -179.143291301849, -190.51698870949215, -184.50193990151442, -179.06072918194943, -177.5863608142492, -182.19681678949888, -188.89821215914608, -186.6986217231573, -187.52390396728308, -185.67170250367374, -181.13001733885667, -178.587538343382, -173.64206546162845, -173.2161949289986, -175.66963769096967, -178.0380779700209, -179.71049867793715, -185.93547886962185, -186.8552150498848, -185.43023187191056, -185.1995523917796, -186.11869333968667, -182.1787485124579, -179.7377147469476, -181.3843785862157, -177.4564941167893, -178.17645395828606, -185.61863845404963, -183.56009824502567, -184.5504568424813, -180.62069979652983, -185.7435560840188, -191.59046054091547, -190.1500248247324, -192.32038542095353, -180.63881063424708, -188.08357792607612, -183.2898882886817, -182.76315449447475, -183.6164829906581, -182.85928396732888, -181.64167180548338, -187.65742919653357, -180.70584903055075, -186.74960952529102, -182.0041669412695, -183.6999365075104], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21207709556521903, "mean_inference_ms": 1.0895050785611184, "mean_action_processing_ms": 0.11982436467661557, "mean_env_wait_ms": 0.6246412407290057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"learn_time_ms": 1380.979, "learn_throughput": 1.448, "update_time_ms": 7.828}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8145156502723694, "grad_norm": 0.8874239325523376, "td_error_abs": 0.5221917317708333, "q_taken_mean": 0.5489530843098959, "target_mean": 0.5442831217447917}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 100800, "num_steps_trained": 42, "num_agent_steps_trained": 201600, "last_target_update_ts": 100800, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": true, "episodes_total": 105, "training_iteration": 21, "trial_id": "6f1ad_00000", "experiment_id": "9c6ee746c2d444c29697a45d9089456a", "date": "2023-12-20_08-53-47", "timestamp": 1703040827, "time_this_iter_s": 10.911048650741577, "time_total_s": 240.82533836364746, "pid": 86806, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 105, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 105, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 10500, "buffer_size": 1050, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 210, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 240.82533836364746, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 36.685714285714276, "ram_util_percent": 56.24285714285714, "gpu_util_percent0": 0.005714285714285714, "vram_util_percent0": 0.020589192708333336}}
