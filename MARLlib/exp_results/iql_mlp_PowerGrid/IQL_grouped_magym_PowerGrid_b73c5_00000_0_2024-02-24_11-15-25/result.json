{"episode_reward_max": -738.8431574050936, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -761.4076318736254, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20227174232951306, "mean_inference_ms": 1.0532441173954386, "mean_action_processing_ms": 0.11317583574340691, "mean_env_wait_ms": 0.6003411577841989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 4800, "timesteps_this_iter": 0, "agent_timesteps_total": 4800, "timers": {"learn_time_ms": 1604.255, "learn_throughput": 1.247, "update_time_ms": 6.871}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9975069761276245, "grad_norm": 1.9786014556884766, "td_error_abs": 0.8941622721354167, "q_taken_mean": -0.0009188220500946045, "target_mean": -0.03709031168619792}}}, "num_steps_sampled": 4800, "num_agent_steps_sampled": 4800, "num_steps_trained": 2, "num_agent_steps_trained": 9600, "last_target_update_ts": 0}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-15-36", "timestamp": 1708751736, "time_this_iter_s": 11.252259254455566, "time_total_s": 11.252259254455566, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 11.252259254455566, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.8625, "ram_util_percent": 6.6, "gpu_util_percent0": 0.095, "vram_util_percent0": 0.024149576822916668}}
{"episode_reward_max": -676.7564710236552, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -729.4181203097918, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20129137091448382, "mean_inference_ms": 1.0463707260875408, "mean_action_processing_ms": 0.11312741318197302, "mean_env_wait_ms": 0.6018498108127937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"learn_time_ms": 1546.133, "learn_throughput": 1.294, "update_time_ms": 6.805}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7446545362472534, "grad_norm": 1.8881268501281738, "td_error_abs": 0.7328857421875, "q_taken_mean": -0.05556467692057292, "target_mean": -0.042274439493815104}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 9600, "num_steps_trained": 4, "num_agent_steps_trained": 19200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 2, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-15-47", "timestamp": 1708751747, "time_this_iter_s": 11.087010383605957, "time_total_s": 22.339269638061523, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 22.339269638061523, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.71333333333333, "ram_util_percent": 7.480000000000001, "gpu_util_percent0": 0.052, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -608.7048904462324, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -702.6474163689049, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20186879407916505, "mean_inference_ms": 1.044952171898358, "mean_action_processing_ms": 0.11319506071672686, "mean_env_wait_ms": 0.6031971138591452, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 14400, "timesteps_this_iter": 0, "agent_timesteps_total": 14400, "timers": {"learn_time_ms": 1534.46, "learn_throughput": 1.303, "update_time_ms": 6.853}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.277725338935852, "grad_norm": 9.105466842651367, "td_error_abs": 0.96304931640625, "q_taken_mean": -0.08491678873697917, "target_mean": -0.03882012176513672}}}, "num_steps_sampled": 14400, "num_agent_steps_sampled": 14400, "num_steps_trained": 6, "num_agent_steps_trained": 28800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-15-59", "timestamp": 1708751759, "time_this_iter_s": 11.206063508987427, "time_total_s": 33.54533314704895, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 33.54533314704895, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.38666666666667, "ram_util_percent": 7.480000000000002, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -533.8770244717471, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -663.0625748711439, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20217853639649994, "mean_inference_ms": 1.0442499386698452, "mean_action_processing_ms": 0.11325275604328618, "mean_env_wait_ms": 0.6040823145106662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"learn_time_ms": 1525.7, "learn_throughput": 1.311, "update_time_ms": 7.02}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7640124559402466, "grad_norm": 1.968319296836853, "td_error_abs": 0.6853636067708333, "q_taken_mean": 0.026156527201334635, "target_mean": -0.037001108805338544}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 19200, "num_steps_trained": 8, "num_agent_steps_trained": 38400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-16-10", "timestamp": 1708751770, "time_this_iter_s": 11.149068832397461, "time_total_s": 44.69440197944641, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 44.69440197944641, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.233333333333334, "ram_util_percent": 7.619999999999998, "gpu_util_percent0": 0.050666666666666665, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -451.29505731713516, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -623.2621188793098, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2025648175096125, "mean_inference_ms": 1.0441039095342333, "mean_action_processing_ms": 0.11329036909570613, "mean_env_wait_ms": 0.6048065222755682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"learn_time_ms": 1514.345, "learn_throughput": 1.321, "update_time_ms": 6.995}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6948930621147156, "grad_norm": 0.9637869000434875, "td_error_abs": 0.5472490641276042, "q_taken_mean": 0.0891820068359375, "target_mean": -0.032582733154296876}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 10, "num_agent_steps_trained": 48000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 5, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-16-21", "timestamp": 1708751781, "time_this_iter_s": 11.253571033477783, "time_total_s": 55.947973012924194, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 55.947973012924194, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.36, "ram_util_percent": 7.700000000000001, "gpu_util_percent0": 0.058666666666666666, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -402.26488591066277, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -588.500881251721, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20284333158371914, "mean_inference_ms": 1.0442278414977642, "mean_action_processing_ms": 0.1133111688562635, "mean_env_wait_ms": 0.6050311330742851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"learn_time_ms": 1513.397, "learn_throughput": 1.322, "update_time_ms": 9.572}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6646531224250793, "grad_norm": 1.0063515901565552, "td_error_abs": 0.5280104166666667, "q_taken_mean": 0.07217238871256511, "target_mean": -0.03702604675292969}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 28800, "num_steps_trained": 12, "num_agent_steps_trained": 57600, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 6, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-16-32", "timestamp": 1708751792, "time_this_iter_s": 11.154124736785889, "time_total_s": 67.10209774971008, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 67.10209774971008, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.11333333333334, "ram_util_percent": 7.700000000000001, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -402.26488591066277, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -564.9336289054712, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20306693778123347, "mean_inference_ms": 1.0443764925550072, "mean_action_processing_ms": 0.11332633706542015, "mean_env_wait_ms": 0.6053795274738322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 33600, "timesteps_this_iter": 0, "agent_timesteps_total": 33600, "timers": {"learn_time_ms": 1510.437, "learn_throughput": 1.324, "update_time_ms": 11.327}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5907115936279297, "grad_norm": 0.9864504933357239, "td_error_abs": 0.470671875, "q_taken_mean": 0.06208545939127604, "target_mean": -0.032043909708658856}}}, "num_steps_sampled": 33600, "num_agent_steps_sampled": 33600, "num_steps_trained": 14, "num_agent_steps_trained": 67200, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 7, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-16-43", "timestamp": 1708751803, "time_this_iter_s": 11.205401182174683, "time_total_s": 78.30749893188477, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 78.30749893188477, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.32666666666667, "ram_util_percent": 7.799999999999999, "gpu_util_percent0": 0.058, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -223.85166902552558, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -524.5490066100356, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20328456787475074, "mean_inference_ms": 1.0448286139451195, "mean_action_processing_ms": 0.11337985878830219, "mean_env_wait_ms": 0.6058272184688893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"learn_time_ms": 1509.451, "learn_throughput": 1.325, "update_time_ms": 10.815}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5136351585388184, "grad_norm": 0.7576375007629395, "td_error_abs": 0.42810026041666666, "q_taken_mean": 0.01249614969889323, "target_mean": -0.03264493306477865}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 16, "num_agent_steps_trained": 76800, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 8, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-16-55", "timestamp": 1708751815, "time_this_iter_s": 11.417418479919434, "time_total_s": 89.7249174118042, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 89.7249174118042, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.5, "ram_util_percent": 7.813333333333333, "gpu_util_percent0": 0.051333333333333335, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -223.85166902552558, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -501.68195864031804, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20357446951551791, "mean_inference_ms": 1.045743914972641, "mean_action_processing_ms": 0.11347911892027408, "mean_env_wait_ms": 0.6065974258860761, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 43200, "timesteps_this_iter": 0, "agent_timesteps_total": 43200, "timers": {"learn_time_ms": 1522.265, "learn_throughput": 1.314, "update_time_ms": 10.385}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5827157497406006, "grad_norm": 3.93986177444458, "td_error_abs": 0.4682836100260417, "q_taken_mean": 0.24610713704427084, "target_mean": -0.029877423604329427}}}, "num_steps_sampled": 43200, "num_agent_steps_sampled": 43200, "num_steps_trained": 18, "num_agent_steps_trained": 86400, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 9, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-17-07", "timestamp": 1708751827, "time_this_iter_s": 11.757025241851807, "time_total_s": 101.481942653656, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 101.481942653656, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.38, "ram_util_percent": 7.900000000000002, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.0240478515625}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -469.05276669953395, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20399878335038046, "mean_inference_ms": 1.0473717447795148, "mean_action_processing_ms": 0.11364817082686579, "mean_env_wait_ms": 0.607786676065454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"learn_time_ms": 1551.943, "learn_throughput": 1.289, "update_time_ms": 10.235}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8361330032348633, "grad_norm": 3.6835973262786865, "td_error_abs": 0.5531869303385417, "q_taken_mean": -0.06022707112630208, "target_mean": -0.030884847005208334}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 20, "num_agent_steps_trained": 96000, "last_target_update_ts": 0, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 10, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-17-19", "timestamp": 1708751839, "time_this_iter_s": 12.399900436401367, "time_total_s": 113.88184309005737, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 113.88184309005737, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.37647058823529, "ram_util_percent": 8.0, "gpu_util_percent0": 0.05764705882352941, "vram_util_percent0": 0.024514590992647058}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -444.4148869570053, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20444919583395138, "mean_inference_ms": 1.049215992639916, "mean_action_processing_ms": 0.11382910543629897, "mean_env_wait_ms": 0.6089624903142776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 52800, "timesteps_this_iter": 0, "agent_timesteps_total": 52800, "timers": {"learn_time_ms": 1549.067, "learn_throughput": 1.291, "update_time_ms": 10.273}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.034417748451233, "grad_norm": 2.3807928562164307, "td_error_abs": 0.5833396809895833, "q_taken_mean": 0.08551609293619791, "target_mean": -0.0463524424235026}}}, "num_steps_sampled": 52800, "num_agent_steps_sampled": 52800, "num_steps_trained": 22, "num_agent_steps_trained": 105600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 55, "training_iteration": 11, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-17-31", "timestamp": 1708751851, "time_this_iter_s": 11.978014469146729, "time_total_s": 125.8598575592041, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 125.8598575592041, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.90625, "ram_util_percent": 8.00625, "gpu_util_percent0": 0.053125, "vram_util_percent0": 0.024073282877604164}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -422.98689404724547, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.204841982419971, "mean_inference_ms": 1.0508736526894422, "mean_action_processing_ms": 0.11399244964812134, "mean_env_wait_ms": 0.6100203528992574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"learn_time_ms": 1560.023, "learn_throughput": 1.282, "update_time_ms": 10.279}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8317107558250427, "grad_norm": 1.2401916980743408, "td_error_abs": 0.47769954427083333, "q_taken_mean": -0.03670567321777344, "target_mean": -0.0319097900390625}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 57600, "num_steps_trained": 24, "num_agent_steps_trained": 115200, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-17-43", "timestamp": 1708751863, "time_this_iter_s": 11.619685411453247, "time_total_s": 137.47954297065735, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 137.47954297065735, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.7, "ram_util_percent": 8.09333333333333, "gpu_util_percent0": 0.043333333333333335, "vram_util_percent0": 0.023901367187500005}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -404.65003364827925, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20518806559630037, "mean_inference_ms": 1.0524355566390422, "mean_action_processing_ms": 0.11415110420097979, "mean_env_wait_ms": 0.6109616730668299, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 62400, "timesteps_this_iter": 0, "agent_timesteps_total": 62400, "timers": {"learn_time_ms": 1562.781, "learn_throughput": 1.28, "update_time_ms": 10.316}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8497540950775146, "grad_norm": 3.948779582977295, "td_error_abs": 0.5172190755208333, "q_taken_mean": 0.16132194010416667, "target_mean": -0.05396401468912761}}}, "num_steps_sampled": 62400, "num_agent_steps_sampled": 62400, "num_steps_trained": 26, "num_agent_steps_trained": 124800, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 65, "training_iteration": 13, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-17-54", "timestamp": 1708751874, "time_this_iter_s": 11.599284648895264, "time_total_s": 149.0788276195526, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 149.0788276195526, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.61333333333333, "ram_util_percent": 8.040000000000001, "gpu_util_percent0": 0.056, "vram_util_percent0": 0.02384440104166667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -390.30711300113006, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20553229490755978, "mean_inference_ms": 1.0537946153529834, "mean_action_processing_ms": 0.1142869592776655, "mean_env_wait_ms": 0.6117785233760786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"learn_time_ms": 1561.277, "learn_throughput": 1.281, "update_time_ms": 10.338}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.040442943572998, "grad_norm": 11.353413581848145, "td_error_abs": 0.6660916748046875, "q_taken_mean": -0.5155938313802083, "target_mean": -0.03471133677164714}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 67200, "num_steps_trained": 28, "num_agent_steps_trained": 134400, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 70, "training_iteration": 14, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-18-06", "timestamp": 1708751886, "time_this_iter_s": 11.50950813293457, "time_total_s": 160.58833575248718, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 160.58833575248718, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.975, "ram_util_percent": 8.2, "gpu_util_percent0": 0.045, "vram_util_percent0": 0.023844401041666668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -377.0085659396196, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20585774500521364, "mean_inference_ms": 1.0550609674898601, "mean_action_processing_ms": 0.11441345322726183, "mean_env_wait_ms": 0.612499532398625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"learn_time_ms": 1573.456, "learn_throughput": 1.271, "update_time_ms": 10.396}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7803667187690735, "grad_norm": 1.1599305868148804, "td_error_abs": 0.42384037272135416, "q_taken_mean": 0.07810125732421876, "target_mean": -0.04818682352701823}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 30, "num_agent_steps_trained": 144000, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 75, "training_iteration": 15, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-18-18", "timestamp": 1708751898, "time_this_iter_s": 11.63051152229309, "time_total_s": 172.21884727478027, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 172.21884727478027, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.76, "ram_util_percent": 8.18, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.02384440104166667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -365.02092461304755, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061505529038198, "mean_inference_ms": 1.056236781629465, "mean_action_processing_ms": 0.11453107211318429, "mean_env_wait_ms": 0.6131293784978986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"learn_time_ms": 1590.889, "learn_throughput": 1.257, "update_time_ms": 8.934}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8701754808425903, "grad_norm": 6.990480422973633, "td_error_abs": 0.5606979573567709, "q_taken_mean": 0.3066368815104167, "target_mean": -0.0548782958984375}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 32, "num_agent_steps_trained": 153600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 80, "training_iteration": 16, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-18-29", "timestamp": 1708751909, "time_this_iter_s": 11.681447744369507, "time_total_s": 183.90029501914978, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 183.90029501914978, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.287499999999994, "ram_util_percent": 8.174999999999999, "gpu_util_percent0": 0.041249999999999995, "vram_util_percent0": 0.023844401041666668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -354.8505370312164, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20642890374866169, "mean_inference_ms": 1.0573268829972953, "mean_action_processing_ms": 0.11464167137664359, "mean_env_wait_ms": 0.6137575589991615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 81600, "timesteps_this_iter": 0, "agent_timesteps_total": 81600, "timers": {"learn_time_ms": 1597.307, "learn_throughput": 1.252, "update_time_ms": 7.465}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8596199750900269, "grad_norm": 1.7823482751846313, "td_error_abs": 0.5068408203125, "q_taken_mean": -0.18233176676432292, "target_mean": -0.09444054158528646}}}, "num_steps_sampled": 81600, "num_agent_steps_sampled": 81600, "num_steps_trained": 34, "num_agent_steps_trained": 163200, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 85, "training_iteration": 17, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-18-41", "timestamp": 1708751921, "time_this_iter_s": 11.67394757270813, "time_total_s": 195.5742425918579, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 195.5742425918579, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 37.96666666666666, "ram_util_percent": 8.22, "gpu_util_percent0": 0.042666666666666665, "vram_util_percent0": 0.02372233072916667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -346.6788202149805, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20669195381635863, "mean_inference_ms": 1.0584552767895612, "mean_action_processing_ms": 0.11474864988014241, "mean_env_wait_ms": 0.614350445383169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"learn_time_ms": 1607.651, "learn_throughput": 1.244, "update_time_ms": 7.456}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7952304482460022, "grad_norm": 1.7622002363204956, "td_error_abs": 0.4518472086588542, "q_taken_mean": -0.07485535176595053, "target_mean": -0.030999888102213543}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 86400, "num_steps_trained": 36, "num_agent_steps_trained": 172800, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 90, "training_iteration": 18, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-18-53", "timestamp": 1708751933, "time_this_iter_s": 11.854854583740234, "time_total_s": 207.42909717559814, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 207.42909717559814, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.33125, "ram_util_percent": 8.318750000000001, "gpu_util_percent0": 0.055, "vram_util_percent0": 0.023478190104166668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -339.47485141352416, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20694665995902134, "mean_inference_ms": 1.059512282810033, "mean_action_processing_ms": 0.11484808192402766, "mean_env_wait_ms": 0.6149265294775942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 91200, "timesteps_this_iter": 0, "agent_timesteps_total": 91200, "timers": {"learn_time_ms": 1608.73, "learn_throughput": 1.243, "update_time_ms": 7.528}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6430971026420593, "grad_norm": 1.982743740081787, "td_error_abs": 0.40436311848958334, "q_taken_mean": 0.13037502034505208, "target_mean": -0.02819908396402995}}}, "num_steps_sampled": 91200, "num_agent_steps_sampled": 91200, "num_steps_trained": 38, "num_agent_steps_trained": 182400, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 95, "training_iteration": 19, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-19-05", "timestamp": 1708751945, "time_this_iter_s": 11.77002215385437, "time_total_s": 219.19911932945251, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 219.19911932945251, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.75999999999999, "ram_util_percent": 8.393333333333336, "gpu_util_percent0": 0.036000000000000004, "vram_util_percent0": 0.02347819010416667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -787.5984964458308, "episode_reward_mean": -332.4525716034083, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.5984964458308, -763.7371890133669, -738.8431574050936, -742.556858471229, -774.302458032607, -676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20720944879638586, "mean_inference_ms": 1.060614014214293, "mean_action_processing_ms": 0.11495294358283713, "mean_env_wait_ms": 0.6155397529695997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"learn_time_ms": 1584.992, "learn_throughput": 1.262, "update_time_ms": 7.353}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9734337329864502, "grad_norm": 2.615138530731201, "td_error_abs": 0.5231494954427083, "q_taken_mean": -0.045774210611979164, "target_mean": -0.114208740234375}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 40, "num_agent_steps_trained": 192000, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 100, "training_iteration": 20, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-19-17", "timestamp": 1708751957, "time_this_iter_s": 12.16150951385498, "time_total_s": 231.3606288433075, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 231.3606288433075, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 8.462499999999999, "gpu_util_percent0": 0.0475, "vram_util_percent0": 0.023264567057291668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -726.3750101266364, "episode_reward_mean": -304.43935369079685, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-676.7564710236552, -692.147128004703, -686.3034540112673, -726.3750101266364, -705.560980563529, -657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2077135687359636, "mean_inference_ms": 1.06207280664289, "mean_action_processing_ms": 0.11514312942304424, "mean_env_wait_ms": 0.6169134036449841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100800, "timesteps_this_iter": 0, "agent_timesteps_total": 100800, "timers": {"learn_time_ms": 1579.353, "learn_throughput": 1.266, "update_time_ms": 7.384}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8062142729759216, "grad_norm": 3.370323657989502, "td_error_abs": 0.4919584147135417, "q_taken_mean": -0.21348468017578126, "target_mean": -0.048960367838541664}}}, "num_steps_sampled": 100800, "num_agent_steps_sampled": 100800, "num_steps_trained": 42, "num_agent_steps_trained": 201600, "last_target_update_ts": 52800, "num_steps_trained_this_iter": 0, "num_target_updates": 1}, "done": false, "episodes_total": 105, "training_iteration": 21, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-19-29", "timestamp": 1708751969, "time_this_iter_s": 11.662493705749512, "time_total_s": 243.023122549057, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 243.023122549057, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.09375, "ram_util_percent": 8.51875, "gpu_util_percent0": 0.0475, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -678.9463023687381, "episode_reward_mean": -279.640486851811, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-657.3140482491776, -657.7715029190282, -608.7048904462324, -678.9463023687381, -642.7932984524801, -547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20832979110750005, "mean_inference_ms": 1.0642619840060898, "mean_action_processing_ms": 0.11533866453394818, "mean_env_wait_ms": 0.6181606954412118, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"learn_time_ms": 1581.337, "learn_throughput": 1.265, "update_time_ms": 7.439}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6747922897338867, "grad_norm": 1.5552923679351807, "td_error_abs": 0.4298285725911458, "q_taken_mean": 0.05984988403320313, "target_mean": -0.08053470865885416}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 105600, "num_steps_trained": 44, "num_agent_steps_trained": 211200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 110, "training_iteration": 22, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-19-40", "timestamp": 1708751980, "time_this_iter_s": 11.769108772277832, "time_total_s": 254.79223132133484, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 254.79223132133484, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 37.64666666666666, "ram_util_percent": 8.686666666666666, "gpu_util_percent0": 0.042666666666666665, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -558.6511268310688, "episode_reward_mean": -257.7763124612534, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-547.4302908965138, -542.244989343895, -533.8770244717471, -539.336820346077, -558.6511268310688, -464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20880945998028502, "mean_inference_ms": 1.0663150748983445, "mean_action_processing_ms": 0.11552146147612362, "mean_env_wait_ms": 0.6193076820597521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 110400, "timesteps_this_iter": 0, "agent_timesteps_total": 110400, "timers": {"learn_time_ms": 1589.976, "learn_throughput": 1.258, "update_time_ms": 7.473}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6077633500099182, "grad_norm": 2.1772193908691406, "td_error_abs": 0.42012056477864584, "q_taken_mean": -0.04523173014322917, "target_mean": 0.01840643056233724}}}, "num_steps_sampled": 110400, "num_agent_steps_sampled": 110400, "num_steps_trained": 46, "num_agent_steps_trained": 220800, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 115, "training_iteration": 23, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-19-52", "timestamp": 1708751992, "time_this_iter_s": 11.761670589447021, "time_total_s": 266.55390191078186, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 266.55390191078186, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.012499999999996, "ram_util_percent": 8.69375, "gpu_util_percent0": 0.0475, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -477.8684612917609, "episode_reward_mean": -240.8460083711624, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-464.6501844371263, -466.6951666300552, -477.8684612917609, -451.29505731713516, -459.7926048837906, -423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20929464519234525, "mean_inference_ms": 1.068388039090474, "mean_action_processing_ms": 0.11570088876959553, "mean_env_wait_ms": 0.6204418170327441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"learn_time_ms": 1602.654, "learn_throughput": 1.248, "update_time_ms": 7.466}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5530593991279602, "grad_norm": 6.086976528167725, "td_error_abs": 0.42958390299479166, "q_taken_mean": 0.28147391764322915, "target_mean": 0.019091439565022787}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 115200, "num_steps_trained": 48, "num_agent_steps_trained": 230400, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 120, "training_iteration": 24, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-20-04", "timestamp": 1708752004, "time_this_iter_s": 11.739829301834106, "time_total_s": 278.29373121261597, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 278.29373121261597, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 38.01333333333333, "ram_util_percent": 8.780000000000001, "gpu_util_percent0": 0.044000000000000004, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -432.3330608495339, "episode_reward_mean": -226.90686502110853, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-423.8974594466477, -407.0803516640202, -420.93931673995934, -402.26488591066277, -419.29145180760094, -419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20974073349447328, "mean_inference_ms": 1.0704113575146572, "mean_action_processing_ms": 0.11588081042060136, "mean_env_wait_ms": 0.6215524607786397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"learn_time_ms": 1607.422, "learn_throughput": 1.244, "update_time_ms": 7.47}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3602262735366821, "grad_norm": 5.884766578674316, "td_error_abs": 0.8497279459635416, "q_taken_mean": -0.13054486083984376, "target_mean": -0.14419364420572917}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 50, "num_agent_steps_trained": 240000, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 125, "training_iteration": 25, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-20-16", "timestamp": 1708752016, "time_this_iter_s": 11.823189735412598, "time_total_s": 290.11692094802856, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 290.11692094802856, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 37.4125, "ram_util_percent": 8.850000000000001, "gpu_util_percent0": 0.044375, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -432.3330608495339, "episode_reward_mean": -215.4375240870071, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-419.4826785666877, -421.3556219834709, -427.99591635343097, -416.48329638673385, -432.3330608495339, -226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21018448507606965, "mean_inference_ms": 1.0724119821321825, "mean_action_processing_ms": 0.11606445382151544, "mean_env_wait_ms": 0.6227252712534636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"learn_time_ms": 1596.253, "learn_throughput": 1.253, "update_time_ms": 7.527}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9865982532501221, "grad_norm": 3.8923306465148926, "td_error_abs": 0.6166496175130208, "q_taken_mean": -0.31610249837239585, "target_mean": -0.09479482014973958}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 124800, "num_steps_trained": 52, "num_agent_steps_trained": 249600, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 130, "training_iteration": 26, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-20-27", "timestamp": 1708752027, "time_this_iter_s": 11.728918075561523, "time_total_s": 301.8458390235901, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 301.8458390235901, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.86, "ram_util_percent": 8.893333333333336, "gpu_util_percent0": 0.03266666666666667, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -324.5289885591128, "episode_reward_mean": -203.64693758984177, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-226.98969714572377, -251.78197780953994, -277.96515242202645, -223.85166902552558, -228.6947563071133, -324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21062576368228558, "mean_inference_ms": 1.0744160004388001, "mean_action_processing_ms": 0.11625017623639325, "mean_env_wait_ms": 0.6238225153909803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 129600, "timesteps_this_iter": 0, "agent_timesteps_total": 129600, "timers": {"learn_time_ms": 1598.547, "learn_throughput": 1.251, "update_time_ms": 7.501}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7870603203773499, "grad_norm": 1.7211815118789673, "td_error_abs": 0.49418806966145834, "q_taken_mean": -0.0012641784350077311, "target_mean": -0.08386371866861979}}}, "num_steps_sampled": 129600, "num_agent_steps_sampled": 129600, "num_steps_trained": 54, "num_agent_steps_trained": 259200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 135, "training_iteration": 27, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-20-39", "timestamp": 1708752039, "time_this_iter_s": 11.632763385772705, "time_total_s": 313.4786024093628, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 313.4786024093628, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 37.946666666666665, "ram_util_percent": 9.086666666666666, "gpu_util_percent0": 0.04533333333333334, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -324.5289885591128, "episode_reward_mean": -200.8812615513739, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324.5289885591128, -318.99081471104193, -311.57638521805376, -316.69160330220626, -321.9400826224739, -173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21104329086732462, "mean_inference_ms": 1.0762876234510919, "mean_action_processing_ms": 0.11641955551555969, "mean_env_wait_ms": 0.6248500153048554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"learn_time_ms": 1597.244, "learn_throughput": 1.252, "update_time_ms": 7.565}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.761982262134552, "grad_norm": 1.1765385866165161, "td_error_abs": 0.49216792805989584, "q_taken_mean": -0.10390833536783854, "target_mean": -0.0856168212890625}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 134400, "num_steps_trained": 56, "num_agent_steps_trained": 268800, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 140, "training_iteration": 28, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-20-51", "timestamp": 1708752051, "time_this_iter_s": 11.617766857147217, "time_total_s": 325.09636926651, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 325.09636926651, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 37.15, "ram_util_percent": 9.025, "gpu_util_percent0": 0.049375, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -171.32157309937188, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -194.26567609559805, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.8107045074119, -171.32157309937188, -175.28364359616404, -181.28072664649304, -175.25354831295135, -197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21141424864062203, "mean_inference_ms": 1.0779372218268712, "mean_action_processing_ms": 0.11656533109550903, "mean_env_wait_ms": 0.6257049218761775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 139200, "timesteps_this_iter": 0, "agent_timesteps_total": 139200, "timers": {"learn_time_ms": 1588.758, "learn_throughput": 1.259, "update_time_ms": 7.553}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7287827134132385, "grad_norm": 1.164413571357727, "td_error_abs": 0.49707373046875, "q_taken_mean": -0.045963704427083335, "target_mean": -0.08764910888671874}}}, "num_steps_sampled": 139200, "num_agent_steps_sampled": 139200, "num_steps_trained": 58, "num_agent_steps_trained": 278400, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 145, "training_iteration": 29, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-21-03", "timestamp": 1708752063, "time_this_iter_s": 11.785320520401001, "time_total_s": 336.881689786911, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 336.881689786911, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 38.49333333333333, "ram_util_percent": 9.180000000000001, "gpu_util_percent0": 0.04666666666666667, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -180.4444641508247, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -194.96889899307223, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-197.89668963152786, -199.17698799239503, -197.35742870028238, -196.24595497930906, -199.50338635507862, -188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21169445363342526, "mean_inference_ms": 1.0791498475148618, "mean_action_processing_ms": 0.11666680907958156, "mean_env_wait_ms": 0.6262642723716465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"learn_time_ms": 1583.779, "learn_throughput": 1.263, "update_time_ms": 7.624}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6884921789169312, "grad_norm": 1.1873949766159058, "td_error_abs": 0.48126005045572917, "q_taken_mean": -0.10414536539713541, "target_mean": -0.08393273417154948}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 60, "num_agent_steps_trained": 288000, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 150, "training_iteration": 30, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-21-14", "timestamp": 1708752074, "time_this_iter_s": 11.556671857833862, "time_total_s": 348.4383616447449, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 348.4383616447449, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 37.906666666666666, "ram_util_percent": 9.206666666666669, "gpu_util_percent0": 0.043333333333333335, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -180.4444641508247, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -194.35859556230218, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.34925126830416, -193.95459448276216, -181.94476185261541, -181.3738939795379, -190.77235861621378, -187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21191319325668442, "mean_inference_ms": 1.0801004141726709, "mean_action_processing_ms": 0.11674732121749477, "mean_env_wait_ms": 0.6267126663982527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 148800, "timesteps_this_iter": 0, "agent_timesteps_total": 148800, "timers": {"learn_time_ms": 1593.368, "learn_throughput": 1.255, "update_time_ms": 7.614}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6660107970237732, "grad_norm": 1.3351340293884277, "td_error_abs": 0.48319437662760417, "q_taken_mean": -0.03496680450439453, "target_mean": -0.08496599833170573}}}, "num_steps_sampled": 148800, "num_agent_steps_sampled": 148800, "num_steps_trained": 62, "num_agent_steps_trained": 297600, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 155, "training_iteration": 31, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-21-26", "timestamp": 1708752086, "time_this_iter_s": 11.690658807754517, "time_total_s": 360.1290204524994, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 360.1290204524994, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 37.14375, "ram_util_percent": 9.243749999999999, "gpu_util_percent0": 0.035625000000000004, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -180.4444641508247, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -194.45201727821504, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.1958509499007, -182.69668618369764, -180.4444641508247, -185.2274351930816, -187.47410782591572, -204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2121112674865956, "mean_inference_ms": 1.0809839242858714, "mean_action_processing_ms": 0.1168220426339556, "mean_env_wait_ms": 0.6271165688972953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 153600, "timers": {"learn_time_ms": 1588.391, "learn_throughput": 1.259, "update_time_ms": 7.645}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.642304539680481, "grad_norm": 1.5870919227600098, "td_error_abs": 0.4825826416015625, "q_taken_mean": -0.13157737223307292, "target_mean": -0.08545858764648437}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 153600, "num_steps_trained": 64, "num_agent_steps_trained": 307200, "last_target_update_ts": 105600, "num_steps_trained_this_iter": 0, "num_target_updates": 2}, "done": false, "episodes_total": 160, "training_iteration": 32, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-21-37", "timestamp": 1708752097, "time_this_iter_s": 11.648208856582642, "time_total_s": 371.77722930908203, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 371.77722930908203, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.593333333333334, "ram_util_percent": 9.34, "gpu_util_percent0": 0.051333333333333335, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -181.18317189352152, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -194.5701679898336, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.12846017281717, -211.14475309870352, -200.91922909305293, -202.61134042437956, -200.4419401520036, -190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21230463684878476, "mean_inference_ms": 1.08180494113698, "mean_action_processing_ms": 0.11688722362191042, "mean_env_wait_ms": 0.627498459477016, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 158400, "timesteps_this_iter": 0, "agent_timesteps_total": 158400, "timers": {"learn_time_ms": 1588.388, "learn_throughput": 1.259, "update_time_ms": 7.633}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6124165654182434, "grad_norm": 2.2167041301727295, "td_error_abs": 0.475949951171875, "q_taken_mean": -0.006170790354410807, "target_mean": -0.08520303853352865}}}, "num_steps_sampled": 158400, "num_agent_steps_sampled": 158400, "num_steps_trained": 66, "num_agent_steps_trained": 316800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 165, "training_iteration": 33, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-21-49", "timestamp": 1708752109, "time_this_iter_s": 11.815832376480103, "time_total_s": 383.59306168556213, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 383.59306168556213, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.02, "ram_util_percent": 9.386666666666667, "gpu_util_percent0": 0.04333333333333334, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -180.86180576586753, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -193.6477337777336, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.5495468575562, -192.63989455552715, -194.0262406949541, -188.6640890604932, -188.2647642238286, -185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.212468398564123, "mean_inference_ms": 1.0826404725653953, "mean_action_processing_ms": 0.11695448282644007, "mean_env_wait_ms": 0.627871638403835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 163200, "timers": {"learn_time_ms": 1589.689, "learn_throughput": 1.258, "update_time_ms": 7.652}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6322504281997681, "grad_norm": 1.2131298780441284, "td_error_abs": 0.4979085693359375, "q_taken_mean": -0.21413970947265626, "target_mean": -0.173620849609375}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 163200, "num_steps_trained": 68, "num_agent_steps_trained": 326400, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 170, "training_iteration": 34, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-22-01", "timestamp": 1708752121, "time_this_iter_s": 11.746527433395386, "time_total_s": 395.3395891189575, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 395.3395891189575, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.131249999999994, "ram_util_percent": 9.450000000000001, "gpu_util_percent0": 0.040624999999999994, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -179.9879618765908, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -193.44624410207183, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.88667002613815, -184.9288318729292, -187.27059988209396, -182.59634459287153, -185.349077198307, -191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21262108616679204, "mean_inference_ms": 1.083432243207661, "mean_action_processing_ms": 0.11701688079408376, "mean_env_wait_ms": 0.6282333185567646, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"learn_time_ms": 1578.576, "learn_throughput": 1.267, "update_time_ms": 7.683}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6070034503936768, "grad_norm": 2.012190341949463, "td_error_abs": 0.4915380045572917, "q_taken_mean": -0.12030098470052084, "target_mean": -0.17291766357421876}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 70, "num_agent_steps_trained": 336000, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 175, "training_iteration": 35, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-22-13", "timestamp": 1708752133, "time_this_iter_s": 11.734203577041626, "time_total_s": 407.07379269599915, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 407.07379269599915, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 37.65333333333333, "ram_util_percent": 9.526666666666666, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -176.90018220530445, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -193.27040331050864, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.49069377988712, -194.45757727082443, -192.4923610099832, -188.0390404708262, -194.14200607806404, -211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21277029041894222, "mean_inference_ms": 1.0842117834683997, "mean_action_processing_ms": 0.1170754875633872, "mean_env_wait_ms": 0.628600821572738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"learn_time_ms": 1581.964, "learn_throughput": 1.264, "update_time_ms": 7.619}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7995580434799194, "grad_norm": 2.741119861602783, "td_error_abs": 0.5504249674479167, "q_taken_mean": -0.2872590128580729, "target_mean": -0.20446449788411458}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 172800, "num_steps_trained": 72, "num_agent_steps_trained": 345600, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 180, "training_iteration": 36, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-22-25", "timestamp": 1708752145, "time_this_iter_s": 11.792555809020996, "time_total_s": 418.86634850502014, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 418.86634850502014, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 37.9125, "ram_util_percent": 9.6125, "gpu_util_percent0": 0.053125000000000006, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -176.90018220530445, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -193.13186218774132, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-211.5057017895477, -202.93681887466926, -206.21170437335144, -206.4076538450418, -211.73629281224214, -209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21290620330386578, "mean_inference_ms": 1.0849703317968602, "mean_action_processing_ms": 0.11712911094787665, "mean_env_wait_ms": 0.6289018561292226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 177600, "timesteps_this_iter": 0, "agent_timesteps_total": 177600, "timers": {"learn_time_ms": 1588.174, "learn_throughput": 1.259, "update_time_ms": 7.707}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6843745708465576, "grad_norm": 3.116307497024536, "td_error_abs": 0.5084446614583333, "q_taken_mean": -0.11080718994140625, "target_mean": -0.17328800455729168}}}, "num_steps_sampled": 177600, "num_agent_steps_sampled": 177600, "num_steps_trained": 74, "num_agent_steps_trained": 355200, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 185, "training_iteration": 37, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-22-36", "timestamp": 1708752156, "time_this_iter_s": 11.747307538986206, "time_total_s": 430.61365604400635, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 430.61365604400635, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 37.720000000000006, "ram_util_percent": 9.586666666666666, "gpu_util_percent0": 0.048, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -176.90018220530445, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -191.8998744778131, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-209.68922188079586, -211.58313631121192, -212.60720629816453, -209.81870777256705, -205.31879267381518, -199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2130317587184181, "mean_inference_ms": 1.085613334743159, "mean_action_processing_ms": 0.117175030412623, "mean_env_wait_ms": 0.6291674821783428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 182400, "timers": {"learn_time_ms": 1587.957, "learn_throughput": 1.259, "update_time_ms": 7.615}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5890072584152222, "grad_norm": 4.3052754402160645, "td_error_abs": 0.47915852864583336, "q_taken_mean": -0.34708740234375, "target_mean": -0.20337241617838542}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 182400, "num_steps_trained": 76, "num_agent_steps_trained": 364800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 190, "training_iteration": 38, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-22-48", "timestamp": 1708752168, "time_this_iter_s": 11.711136102676392, "time_total_s": 442.32479214668274, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 442.32479214668274, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.82000000000001, "ram_util_percent": 9.786666666666667, "gpu_util_percent0": 0.043333333333333335, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -176.90018220530445, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -190.61572888998174, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.49754519122135, -198.1976140285794, -196.19955518499785, -199.6566817609554, -201.59487989027474, -203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21314327546613257, "mean_inference_ms": 1.0862477817137923, "mean_action_processing_ms": 0.11721931909868476, "mean_env_wait_ms": 0.6294098371233947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 187200, "timesteps_this_iter": 0, "agent_timesteps_total": 187200, "timers": {"learn_time_ms": 1596.67, "learn_throughput": 1.253, "update_time_ms": 7.626}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7624363899230957, "grad_norm": 5.774759769439697, "td_error_abs": 0.54638623046875, "q_taken_mean": 0.010099774678548177, "target_mean": -0.17486083984375}}}, "num_steps_sampled": 187200, "num_agent_steps_sampled": 187200, "num_steps_trained": 78, "num_agent_steps_trained": 374400, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 195, "training_iteration": 39, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-23-00", "timestamp": 1708752180, "time_this_iter_s": 11.94269609451294, "time_total_s": 454.2674882411957, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 454.2674882411957, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 37.36875, "ram_util_percent": 9.787500000000001, "gpu_util_percent0": 0.049375, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -189.35577992243518, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.28839375322153, -196.24798784184907, -202.96523978447357, -200.2366030439114, -202.97814368353275, -199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21323343484210203, "mean_inference_ms": 1.0867922894097501, "mean_action_processing_ms": 0.1172522280473199, "mean_env_wait_ms": 0.6295848764527603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"learn_time_ms": 1607.668, "learn_throughput": 1.244, "update_time_ms": 7.626}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6593589782714844, "grad_norm": 6.7029194831848145, "td_error_abs": 0.5281837565104167, "q_taken_mean": -0.45387650553385417, "target_mean": -0.22551786295572918}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 80, "num_agent_steps_trained": 384000, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 200, "training_iteration": 40, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-23-12", "timestamp": 1708752192, "time_this_iter_s": 12.075037717819214, "time_total_s": 466.3425259590149, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 466.3425259590149, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 38.46, "ram_util_percent": 9.833333333333334, "gpu_util_percent0": 0.035333333333333335, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -188.59649607865288, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.2108291334808, -210.79329434353542, -200.93740655864622, -194.33763590666052, -201.97719388887825, -206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21332049072271683, "mean_inference_ms": 1.0873296025619206, "mean_action_processing_ms": 0.11728614099917112, "mean_env_wait_ms": 0.6297417875067797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 196800, "timesteps_this_iter": 0, "agent_timesteps_total": 196800, "timers": {"learn_time_ms": 1645.531, "learn_throughput": 1.215, "update_time_ms": 7.746}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8925235271453857, "grad_norm": 5.69830322265625, "td_error_abs": 0.6038742268880208, "q_taken_mean": -0.013517000834147136, "target_mean": -0.18112544759114582}}}, "num_steps_sampled": 196800, "num_agent_steps_sampled": 196800, "num_steps_trained": 82, "num_agent_steps_trained": 393600, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 205, "training_iteration": 41, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-23-25", "timestamp": 1708752205, "time_this_iter_s": 12.351537704467773, "time_total_s": 478.69406366348267, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 478.69406366348267, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 37.975, "ram_util_percent": 9.89375, "gpu_util_percent0": 0.040625, "vram_util_percent0": 0.023234049479166668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -225.5739011827818, "episode_reward_mean": -187.834912626662, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.3961838263242, -214.90096867056496, -208.93307557376173, -225.5739011827818, -203.30847412647122, -206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2133934172820209, "mean_inference_ms": 1.0878266951986686, "mean_action_processing_ms": 0.11731854541270374, "mean_env_wait_ms": 0.629876756818361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"learn_time_ms": 1638.0, "learn_throughput": 1.221, "update_time_ms": 7.713}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6277252435684204, "grad_norm": 2.9658477306365967, "td_error_abs": 0.49616487630208334, "q_taken_mean": -0.31783915201822915, "target_mean": -0.20162027994791668}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 201600, "num_steps_trained": 84, "num_agent_steps_trained": 403200, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 210, "training_iteration": 42, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-23-36", "timestamp": 1708752216, "time_this_iter_s": 11.55415391921997, "time_total_s": 490.24821758270264, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 490.24821758270264, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.779999999999994, "ram_util_percent": 9.933333333333334, "gpu_util_percent0": 0.044000000000000004, "vram_util_percent0": 0.02323404947916667}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -210.22444215421916, "episode_reward_mean": -186.55795916968404, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.32181521090413, -204.14042580859646, -210.22444215421916, -203.9165595486527, -203.90660015782794, -183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2134700546263462, "mean_inference_ms": 1.0883269246428051, "mean_action_processing_ms": 0.11735028561783023, "mean_env_wait_ms": 0.6299907008421711, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 206400, "timesteps_this_iter": 0, "agent_timesteps_total": 206400, "timers": {"learn_time_ms": 1639.537, "learn_throughput": 1.22, "update_time_ms": 7.732}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6027826070785522, "grad_norm": 1.416303277015686, "td_error_abs": 0.4773964436848958, "q_taken_mean": -0.12949861653645833, "target_mean": -0.17298111979166667}}}, "num_steps_sampled": 206400, "num_agent_steps_sampled": 206400, "num_steps_trained": 86, "num_agent_steps_trained": 412800, "last_target_update_ts": 158400, "num_steps_trained_this_iter": 0, "num_target_updates": 3}, "done": false, "episodes_total": 215, "training_iteration": 43, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-23-48", "timestamp": 1708752228, "time_this_iter_s": 11.750499725341797, "time_total_s": 501.99871730804443, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 501.99871730804443, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 37.449999999999996, "ram_util_percent": 10.1875, "gpu_util_percent0": 0.034375, "vram_util_percent0": 0.020678202311197918}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -194.74939844549817, "episode_reward_mean": -185.61861984558124, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.9392562819909, -185.3097188248813, -186.4646163200294, -188.05262306190713, -182.62092506566975, -187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21355111095939727, "mean_inference_ms": 1.0887899240858645, "mean_action_processing_ms": 0.1173805836540653, "mean_env_wait_ms": 0.6300733514454094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 211200, "timesteps_this_iter": 0, "agent_timesteps_total": 211200, "timers": {"learn_time_ms": 1635.831, "learn_throughput": 1.223, "update_time_ms": 7.743}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5449886322021484, "grad_norm": 1.196281909942627, "td_error_abs": 0.4634022216796875, "q_taken_mean": -0.20556803385416667, "target_mean": -0.17240303548177083}}}, "num_steps_sampled": 211200, "num_agent_steps_sampled": 211200, "num_steps_trained": 88, "num_agent_steps_trained": 422400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 220, "training_iteration": 44, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-24-00", "timestamp": 1708752240, "time_this_iter_s": 11.713368654251099, "time_total_s": 513.7120859622955, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 513.7120859622955, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 38.14666666666667, "ram_util_percent": 10.186666666666667, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.0205078125}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -195.25607461439657, "episode_reward_mean": -185.7995413211216, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.09585461162226, -185.57225758857015, -185.7399499085583, -184.54276909793623, -183.58854095205962, -189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21362255692297707, "mean_inference_ms": 1.0892448287695777, "mean_action_processing_ms": 0.11741044762680602, "mean_env_wait_ms": 0.6301378832956726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"learn_time_ms": 1638.511, "learn_throughput": 1.221, "update_time_ms": 7.813}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5300477743148804, "grad_norm": 1.2365918159484863, "td_error_abs": 0.4711634521484375, "q_taken_mean": -0.12096256510416667, "target_mean": -0.08071364339192709}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 90, "num_agent_steps_trained": 432000, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 225, "training_iteration": 45, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-24-11", "timestamp": 1708752251, "time_this_iter_s": 11.681747674942017, "time_total_s": 525.3938336372375, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 525.3938336372375, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 38.486666666666665, "ram_util_percent": 10.360000000000003, "gpu_util_percent0": 0.036000000000000004, "vram_util_percent0": 0.02035590277777778}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -195.25607461439657, "episode_reward_mean": -185.85211447821092, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.97638466064114, -187.21024659933494, -186.43330353282647, -184.89904642585964, -190.07294320466477, -185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21368924820767723, "mean_inference_ms": 1.0896620717760035, "mean_action_processing_ms": 0.11743889835411317, "mean_env_wait_ms": 0.6302221248946455, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220800, "timesteps_this_iter": 0, "agent_timesteps_total": 220800, "timers": {"learn_time_ms": 1643.437, "learn_throughput": 1.217, "update_time_ms": 7.813}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5042821168899536, "grad_norm": 1.796093225479126, "td_error_abs": 0.4566979573567708, "q_taken_mean": -0.0337319590250651, "target_mean": -0.0799300537109375}}}, "num_steps_sampled": 220800, "num_agent_steps_sampled": 220800, "num_steps_trained": 92, "num_agent_steps_trained": 441600, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 230, "training_iteration": 46, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-24-23", "timestamp": 1708752263, "time_this_iter_s": 11.770675420761108, "time_total_s": 537.1645090579987, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 537.1645090579987, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.419999999999995, "ram_util_percent": 10.386666666666668, "gpu_util_percent0": 0.043333333333333335, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -600.9508813821168, "episode_reward_mean": -205.47636171010782, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.82165959171718, -188.62259580600755, -188.35008682924658, -187.49210727941897, -182.42919935675397, -191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21376105862698286, "mean_inference_ms": 1.0901221193442017, "mean_action_processing_ms": 0.11747234987147687, "mean_env_wait_ms": 0.6303542311248027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 225600, "timesteps_this_iter": 0, "agent_timesteps_total": 225600, "timers": {"learn_time_ms": 1637.089, "learn_throughput": 1.222, "update_time_ms": 7.731}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5658786296844482, "grad_norm": 0.9807358384132385, "td_error_abs": 0.47789676920572915, "q_taken_mean": -0.18783607991536458, "target_mean": -0.15088372802734376}}}, "num_steps_sampled": 225600, "num_agent_steps_sampled": 225600, "num_steps_trained": 94, "num_agent_steps_trained": 451200, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 235, "training_iteration": 47, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-24-35", "timestamp": 1708752275, "time_this_iter_s": 12.280645847320557, "time_total_s": 549.4451549053192, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 549.4451549053192, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 10.43125, "gpu_util_percent0": 0.042499999999999996, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -608.8044302386701, "episode_reward_mean": -225.2725006082345, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.66105632329752, -190.0081504288597, -181.18317189352152, -182.43184807858805, -186.88510211103414, -188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2138392648116778, "mean_inference_ms": 1.0905932555731028, "mean_action_processing_ms": 0.11750525971140377, "mean_env_wait_ms": 0.6304617184664137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 230400, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"learn_time_ms": 1639.444, "learn_throughput": 1.22, "update_time_ms": 7.824}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.344783067703247, "grad_norm": 15.690702438354492, "td_error_abs": 0.864515380859375, "q_taken_mean": -0.03154720052083333, "target_mean": -0.14110196940104167}}}, "num_steps_sampled": 230400, "num_agent_steps_sampled": 230400, "num_steps_trained": 96, "num_agent_steps_trained": 460800, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 240, "training_iteration": 48, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-24-47", "timestamp": 1708752287, "time_this_iter_s": 11.667315244674683, "time_total_s": 561.1124701499939, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 561.1124701499939, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 37.32000000000001, "ram_util_percent": 10.493333333333332, "gpu_util_percent0": 0.05266666666666666, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -608.8044302386701, "episode_reward_mean": -225.23307532468905, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.43318508345033, -185.80694641088843, -191.24644809844162, -188.0845657000438, -193.70134061698243, -184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21390577977616562, "mean_inference_ms": 1.0910483146016603, "mean_action_processing_ms": 0.11753642899141373, "mean_env_wait_ms": 0.6305428036034192, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 235200, "timesteps_this_iter": 0, "agent_timesteps_total": 235200, "timers": {"learn_time_ms": 1640.113, "learn_throughput": 1.219, "update_time_ms": 7.84}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7109521627426147, "grad_norm": 1.9933621883392334, "td_error_abs": 0.5388290608723958, "q_taken_mean": -0.13918777465820312, "target_mean": -0.06902633158365885}}}, "num_steps_sampled": 235200, "num_agent_steps_sampled": 235200, "num_steps_trained": 98, "num_agent_steps_trained": 470400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 245, "training_iteration": 49, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-24-59", "timestamp": 1708752299, "time_this_iter_s": 11.738578796386719, "time_total_s": 572.8510489463806, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 572.8510489463806, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 37.13125, "ram_util_percent": 10.55, "gpu_util_percent0": 0.048125, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -608.8044302386701, "episode_reward_mean": -225.13485194935777, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.05139164916199, -187.4831707174685, -190.81045782256598, -184.61521574871875, -182.1898686436751, -191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21396616407575828, "mean_inference_ms": 1.0915088459851106, "mean_action_processing_ms": 0.11756708922516187, "mean_env_wait_ms": 0.6306307886662527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"learn_time_ms": 1640.087, "learn_throughput": 1.219, "update_time_ms": 7.77}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7183807492256165, "grad_norm": 9.019072532653809, "td_error_abs": 0.5573070068359375, "q_taken_mean": 0.28155218505859375, "target_mean": -0.08255697631835937}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 100, "num_agent_steps_trained": 480000, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "evaluation": {"episode_reward_max": -579.4877300010642, "episode_reward_min": -665.1199475827249, "episode_reward_mean": -624.8375317350217, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-645.0577170585173, -622.9831987992716, -579.4877300010642, -634.3348905153666, -625.2181219681567, -601.4403246112653, -665.1199475827249, -633.7380084132274, -618.0931455313538, -622.90223286927], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21509867933265564, "mean_inference_ms": 0.9559433282185268, "mean_action_processing_ms": 0.11737775509586659, "mean_env_wait_ms": 0.6623447171078041, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 250, "training_iteration": 50, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-25-30", "timestamp": 1708752330, "time_this_iter_s": 30.62705373764038, "time_total_s": 603.478102684021, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 603.478102684021, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.01025641025641, "ram_util_percent": 10.612820512820516, "gpu_util_percent0": 0.05230769230769232, "vram_util_percent0": 0.02018229166666666}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -247.3567788549265, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.15273965927025, -185.87108581792685, -193.51354214681453, -187.5819551341046, -187.6177090326064, -191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21402401879553554, "mean_inference_ms": 1.0919388538553654, "mean_action_processing_ms": 0.11759499068637652, "mean_env_wait_ms": 0.6307222768194172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 244800, "timesteps_this_iter": 0, "agent_timesteps_total": 244800, "timers": {"learn_time_ms": 1603.597, "learn_throughput": 1.247, "update_time_ms": 7.65}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6387415528297424, "grad_norm": 4.055575370788574, "td_error_abs": 0.5136396891276042, "q_taken_mean": -0.4346888834635417, "target_mean": -0.29440627034505207}}}, "num_steps_sampled": 244800, "num_agent_steps_sampled": 244800, "num_steps_trained": 102, "num_agent_steps_trained": 489600, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 255, "training_iteration": 51, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-25-41", "timestamp": 1708752341, "time_this_iter_s": 11.617412328720093, "time_total_s": 615.0955150127411, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 615.0955150127411, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 38.086666666666666, "ram_util_percent": 10.626666666666667, "gpu_util_percent0": 0.048, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -264.79758951588315, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.5422956855653, -183.8852664132628, -187.67875672375732, -186.6056731703985, -185.14162347228884, -187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21409060586567324, "mean_inference_ms": 1.092382430019135, "mean_action_processing_ms": 0.11762186415992705, "mean_env_wait_ms": 0.6308051683096777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 249600, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"learn_time_ms": 1621.399, "learn_throughput": 1.234, "update_time_ms": 7.727}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.4775091409683228, "grad_norm": 16.109519958496094, "td_error_abs": 0.943267822265625, "q_taken_mean": -0.11671062215169271, "target_mean": -0.19495554606119792}}}, "num_steps_sampled": 249600, "num_agent_steps_sampled": 249600, "num_steps_trained": 104, "num_agent_steps_trained": 499200, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 260, "training_iteration": 52, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-25-53", "timestamp": 1708752353, "time_this_iter_s": 11.852773904800415, "time_total_s": 626.9482889175415, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 626.9482889175415, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 37.63125, "ram_util_percent": 10.793750000000001, "gpu_util_percent0": 0.0375, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.5682302761467, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.80425015276015, -187.38680007063124, -185.95586455037326, -180.86180576586753, -184.99358119132094, -183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21415229186968077, "mean_inference_ms": 1.092795622944609, "mean_action_processing_ms": 0.11764513138127847, "mean_env_wait_ms": 0.630875403933453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 254400, "timesteps_this_iter": 0, "agent_timesteps_total": 254400, "timers": {"learn_time_ms": 1618.899, "learn_throughput": 1.235, "update_time_ms": 7.736}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3427914381027222, "grad_norm": 16.300762176513672, "td_error_abs": 0.7623346354166667, "q_taken_mean": 0.19029484049479167, "target_mean": -0.19469608561197918}}}, "num_steps_sampled": 254400, "num_agent_steps_sampled": 254400, "num_steps_trained": 106, "num_agent_steps_trained": 508800, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 265, "training_iteration": 53, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-26-05", "timestamp": 1708752365, "time_this_iter_s": 11.781146049499512, "time_total_s": 638.729434967041, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 638.729434967041, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 38.23333333333334, "ram_util_percent": 10.76, "gpu_util_percent0": 0.03133333333333334, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.73937483473134, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.85164275482393, -179.9879618765908, -187.76959317879397, -189.48767519195667, -192.89869482402048, -184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21421886852070215, "mean_inference_ms": 1.0931961337760177, "mean_action_processing_ms": 0.1176679572695875, "mean_env_wait_ms": 0.6309644998028312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 259200, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"learn_time_ms": 1627.164, "learn_throughput": 1.229, "update_time_ms": 8.103}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7535965442657471, "grad_norm": 1.6115460395812988, "td_error_abs": 0.6351746419270833, "q_taken_mean": -0.2615313720703125, "target_mean": -0.13692112223307293}}}, "num_steps_sampled": 259200, "num_agent_steps_sampled": 259200, "num_steps_trained": 108, "num_agent_steps_trained": 518400, "last_target_update_ts": 211200, "num_steps_trained_this_iter": 0, "num_target_updates": 4}, "done": false, "episodes_total": 270, "training_iteration": 54, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-26-17", "timestamp": 1708752377, "time_this_iter_s": 11.96704912185669, "time_total_s": 650.6964840888977, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 650.6964840888977, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 38.059999999999995, "ram_util_percent": 10.973333333333333, "gpu_util_percent0": 0.048, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.4357392527712, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.05705410234245, -176.90018220530445, -183.94856128332913, -180.6319335348232, -182.909713290218, -187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2142862083148162, "mean_inference_ms": 1.0936417013333095, "mean_action_processing_ms": 0.11769424970243039, "mean_env_wait_ms": 0.6310810917609883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"learn_time_ms": 1633.607, "learn_throughput": 1.224, "update_time_ms": 8.014}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.9150148630142212, "grad_norm": 7.413561820983887, "td_error_abs": 0.6211704508463541, "q_taken_mean": 0.30021818033854164, "target_mean": -0.14692410278320311}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 110, "num_agent_steps_trained": 528000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 275, "training_iteration": 55, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-26-29", "timestamp": 1708752389, "time_this_iter_s": 12.272815704345703, "time_total_s": 662.9692997932434, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 662.9692997932434, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.9875, "ram_util_percent": 10.95, "gpu_util_percent0": 0.048125, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.60638136993, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.36811474292324, -190.3858002829728, -184.05133168103444, -190.21292118042402, -194.74939844549817, -182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21435223757578156, "mean_inference_ms": 1.094055813257997, "mean_action_processing_ms": 0.11771970949556387, "mean_env_wait_ms": 0.6312075302540735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 268800, "timesteps_this_iter": 0, "agent_timesteps_total": 268800, "timers": {"learn_time_ms": 1626.256, "learn_throughput": 1.23, "update_time_ms": 8.137}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7880110740661621, "grad_norm": 2.9695725440979004, "td_error_abs": 0.5561100260416667, "q_taken_mean": -0.24102250162760416, "target_mean": -0.08381944274902343}}}, "num_steps_sampled": 268800, "num_agent_steps_sampled": 268800, "num_steps_trained": 112, "num_agent_steps_trained": 537600, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 280, "training_iteration": 56, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-26-41", "timestamp": 1708752401, "time_this_iter_s": 11.921007633209229, "time_total_s": 674.8903074264526, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 674.8903074264526, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.90625, "ram_util_percent": 10.993749999999999, "gpu_util_percent0": 0.051875000000000004, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.4638362004514, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.94143115061507, -180.95813490958045, -185.50076856657398, -180.03537204838216, -186.16369402688252, -185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21440993964960373, "mean_inference_ms": 1.0944449613626113, "mean_action_processing_ms": 0.11774461119626657, "mean_env_wait_ms": 0.6313408165330946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 273600, "timesteps_this_iter": 0, "agent_timesteps_total": 273600, "timers": {"learn_time_ms": 1628.142, "learn_throughput": 1.228, "update_time_ms": 8.21}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6621276140213013, "grad_norm": 2.694531202316284, "td_error_abs": 0.5052701416015625, "q_taken_mean": 0.01701805369059245, "target_mean": -0.08190877278645833}}}, "num_steps_sampled": 273600, "num_agent_steps_sampled": 273600, "num_steps_trained": 114, "num_agent_steps_trained": 547200, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 285, "training_iteration": 57, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-26-53", "timestamp": 1708752413, "time_this_iter_s": 11.702590227127075, "time_total_s": 686.5928976535797, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 686.5928976535797, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 37.559999999999995, "ram_util_percent": 11.07333333333333, "gpu_util_percent0": 0.03933333333333333, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.6146584527606, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.5695048286795, -179.325179052631, -190.26933359988092, -182.472233695618, -182.9662549766093, -167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21446881067524484, "mean_inference_ms": 1.0948261060527562, "mean_action_processing_ms": 0.1177697774951133, "mean_env_wait_ms": 0.6314788921330899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 278400, "timesteps_this_iter": 0, "agent_timesteps_total": 278400, "timers": {"learn_time_ms": 1623.706, "learn_throughput": 1.232, "update_time_ms": 8.206}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6298914551734924, "grad_norm": 1.1956727504730225, "td_error_abs": 0.49538883463541666, "q_taken_mean": -0.12967644246419271, "target_mean": -0.1150068359375}}}, "num_steps_sampled": 278400, "num_agent_steps_sampled": 278400, "num_steps_trained": 116, "num_agent_steps_trained": 556800, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 290, "training_iteration": 58, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-27-05", "timestamp": 1708752425, "time_this_iter_s": 11.798444271087646, "time_total_s": 698.3913419246674, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 698.3913419246674, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.99333333333333, "ram_util_percent": 11.113333333333332, "gpu_util_percent0": 0.04400000000000001, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -167.79596561238105, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -282.89195171820694, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.79596561238105, -174.27433770366008, -174.42560813843156, -177.17910653342813, -175.47636131347463, -185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21452934454973768, "mean_inference_ms": 1.0951852123038968, "mean_action_processing_ms": 0.11779301297085493, "mean_env_wait_ms": 0.6315977650355568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 283200, "timesteps_this_iter": 0, "agent_timesteps_total": 283200, "timers": {"learn_time_ms": 1615.35, "learn_throughput": 1.238, "update_time_ms": 8.227}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6059653162956238, "grad_norm": 1.1868581771850586, "td_error_abs": 0.4921346842447917, "q_taken_mean": -0.1257039082845052, "target_mean": -0.08411962381998699}}}, "num_steps_sampled": 283200, "num_agent_steps_sampled": 283200, "num_steps_trained": 118, "num_agent_steps_trained": 566400, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 295, "training_iteration": 59, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-27-17", "timestamp": 1708752437, "time_this_iter_s": 11.85286569595337, "time_total_s": 710.2442076206207, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 710.2442076206207, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 38.06666666666667, "ram_util_percent": 11.126666666666667, "gpu_util_percent0": 0.04266666666666666, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.14514367078678, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.55007817738317, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.35713132927447, -187.08705268735088, -187.4624623352191, -186.67504491247203, -183.20629246443832, -188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21457799417565177, "mean_inference_ms": 1.0955053978690719, "mean_action_processing_ms": 0.1178131944908596, "mean_env_wait_ms": 0.631697019048184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"learn_time_ms": 1620.948, "learn_throughput": 1.234, "update_time_ms": 8.409}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5970239639282227, "grad_norm": 1.9234241247177124, "td_error_abs": 0.49250272623697916, "q_taken_mean": -0.024503041585286458, "target_mean": -0.11541590372721354}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 120, "num_agent_steps_trained": 576000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 300, "training_iteration": 60, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-27-29", "timestamp": 1708752449, "time_this_iter_s": 11.95914077758789, "time_total_s": 722.2033483982086, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 722.2033483982086, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.64375, "ram_util_percent": 11.2, "gpu_util_percent0": 0.036875, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.14514367078678, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.6073435178035, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.53201352718605, -182.34087082708618, -189.66647499339481, -187.51009677164146, -183.04855851280522, -186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21463015159932142, "mean_inference_ms": 1.0958418064494777, "mean_action_processing_ms": 0.11783475486291856, "mean_env_wait_ms": 0.6318032154597032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 292800, "timesteps_this_iter": 0, "agent_timesteps_total": 292800, "timers": {"learn_time_ms": 1617.756, "learn_throughput": 1.236, "update_time_ms": 8.38}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5984683036804199, "grad_norm": 2.662195920944214, "td_error_abs": 0.5001407063802084, "q_taken_mean": -0.1980087890625, "target_mean": -0.08493684895833334}}}, "num_steps_sampled": 292800, "num_agent_steps_sampled": 292800, "num_steps_trained": 122, "num_agent_steps_trained": 585600, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 305, "training_iteration": 61, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-27-41", "timestamp": 1708752461, "time_this_iter_s": 12.184385538101196, "time_total_s": 734.3877339363098, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 734.3877339363098, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 38.42666666666667, "ram_util_percent": 11.306666666666668, "gpu_util_percent0": 0.044000000000000004, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.14514367078678, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.73384585692236, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.33638966832888, -189.29598050056143, -180.93568702876914, -183.95558717174038, -190.89361331270302, -186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2146795968285705, "mean_inference_ms": 1.096188621304751, "mean_action_processing_ms": 0.1178583401558906, "mean_env_wait_ms": 0.6319126717312794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 297600, "timesteps_this_iter": 0, "agent_timesteps_total": 297600, "timers": {"learn_time_ms": 1619.863, "learn_throughput": 1.235, "update_time_ms": 8.358}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6052088737487793, "grad_norm": 3.3710343837738037, "td_error_abs": 0.5052773030598958, "q_taken_mean": 0.025351018269856772, "target_mean": -0.11948078409830729}}}, "num_steps_sampled": 297600, "num_agent_steps_sampled": 297600, "num_steps_trained": 124, "num_agent_steps_trained": 595200, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 310, "training_iteration": 62, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-27-53", "timestamp": 1708752473, "time_this_iter_s": 11.98054051399231, "time_total_s": 746.3682744503021, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 746.3682744503021, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 37.6, "ram_util_percent": 11.25625, "gpu_util_percent0": 0.04125, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.14514367078678, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.61991351253016, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.602810647236, -184.10106399014208, -187.1932808284055, -186.9550555650997, -189.72369943903965, -184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21472697540559643, "mean_inference_ms": 1.096553678237943, "mean_action_processing_ms": 0.11788295788984465, "mean_env_wait_ms": 0.6320173228287593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 302400, "timesteps_this_iter": 0, "agent_timesteps_total": 302400, "timers": {"learn_time_ms": 1617.062, "learn_throughput": 1.237, "update_time_ms": 8.329}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6499000191688538, "grad_norm": 2.4424734115600586, "td_error_abs": 0.5101776936848958, "q_taken_mean": -0.22707952880859375, "target_mean": -0.23228523763020834}}}, "num_steps_sampled": 302400, "num_agent_steps_sampled": 302400, "num_steps_trained": 126, "num_agent_steps_trained": 604800, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 315, "training_iteration": 63, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-28-05", "timestamp": 1708752485, "time_this_iter_s": 11.792537450790405, "time_total_s": 758.1608119010925, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 758.1608119010925, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 38.43333333333333, "ram_util_percent": 11.5, "gpu_util_percent0": 0.050666666666666665, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.14514367078678, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.54281065959907, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.73136670523832, -190.18668404972084, -188.37692657699978, -185.92823516216754, -195.25607461439657, -183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147599185106973, "mean_inference_ms": 1.0969512879486738, "mean_action_processing_ms": 0.11790873543631031, "mean_env_wait_ms": 0.6321251424362655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"learn_time_ms": 1614.894, "learn_throughput": 1.238, "update_time_ms": 7.96}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6321532130241394, "grad_norm": 2.348330497741699, "td_error_abs": 0.5031654459635416, "q_taken_mean": -0.16810519409179686, "target_mean": -0.08206934102376302}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 307200, "num_steps_trained": 128, "num_agent_steps_trained": 614400, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 320, "training_iteration": 64, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-28-16", "timestamp": 1708752496, "time_this_iter_s": 11.85477328300476, "time_total_s": 770.0155851840973, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 770.0155851840973, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 37.873333333333335, "ram_util_percent": 11.506666666666666, "gpu_util_percent0": 0.050666666666666665, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.14514367078678, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.51751320050516, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.4079959330985, -189.07023846604503, -188.02530408039684, -182.70105556817907, -188.5920938199559, -579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.214789490101265, "mean_inference_ms": 1.0973411448039727, "mean_action_processing_ms": 0.11793342500840749, "mean_env_wait_ms": 0.6322239668032354, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"learn_time_ms": 1610.27, "learn_throughput": 1.242, "update_time_ms": 8.033}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5653530359268188, "grad_norm": 1.5560262203216553, "td_error_abs": 0.48210416666666667, "q_taken_mean": -0.03814924875895182, "target_mean": -0.07974796040852865}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 130, "num_agent_steps_trained": 624000, "last_target_update_ts": 264000, "num_steps_trained_this_iter": 0, "num_target_updates": 5}, "done": false, "episodes_total": 325, "training_iteration": 65, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-28-28", "timestamp": 1708752508, "time_this_iter_s": 11.66957139968872, "time_total_s": 781.685156583786, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 781.685156583786, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 38.266666666666666, "ram_util_percent": 11.513333333333332, "gpu_util_percent0": 0.044000000000000004, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -176.10993289057765, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -283.1673619361716, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-579.7536488591417, -568.3152733553125, -600.9508813821168, -598.7748113980377, -553.2220326184072, -577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21483017301148485, "mean_inference_ms": 1.097753947635416, "mean_action_processing_ms": 0.1179574458319882, "mean_env_wait_ms": 0.632322751859446, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 316800, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"learn_time_ms": 1613.368, "learn_throughput": 1.24, "update_time_ms": 7.918}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5733901262283325, "grad_norm": 3.1481332778930664, "td_error_abs": 0.49430464680989583, "q_taken_mean": -0.15343026733398438, "target_mean": -0.23181046549479167}}}, "num_steps_sampled": 316800, "num_agent_steps_sampled": 316800, "num_steps_trained": 132, "num_agent_steps_trained": 633600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 330, "training_iteration": 66, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-28-40", "timestamp": 1708752520, "time_this_iter_s": 11.987472295761108, "time_total_s": 793.6726288795471, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 793.6726288795471, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 38.20666666666667, "ram_util_percent": 11.57333333333333, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.020182291666666668}}
{"episode_reward_max": -174.52413630466606, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -263.29442612405825, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-577.260806831739, -577.5037777458359, -608.8044302386701, -558.8967054793463, -589.8638183802216, -187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148739432634491, "mean_inference_ms": 1.0981753050985612, "mean_action_processing_ms": 0.11798234197699375, "mean_env_wait_ms": 0.6324508077512635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 321600, "timesteps_this_iter": 0, "agent_timesteps_total": 321600, "timers": {"learn_time_ms": 1619.881, "learn_throughput": 1.235, "update_time_ms": 7.938}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7809100151062012, "grad_norm": 2.992689847946167, "td_error_abs": 0.5571042073567708, "q_taken_mean": -0.22944917805989584, "target_mean": -0.17523116048177084}}}, "num_steps_sampled": 321600, "num_agent_steps_sampled": 321600, "num_steps_trained": 134, "num_agent_steps_trained": 643200, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 335, "training_iteration": 67, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-28-53", "timestamp": 1708752533, "time_this_iter_s": 12.84825587272644, "time_total_s": 806.5208847522736, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 806.5208847522736, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 41.07058823529412, "ram_util_percent": 11.676470588235293, "gpu_util_percent0": 0.06058823529411765, "vram_util_percent0": 0.0207974303002451}}
{"episode_reward_max": -174.52413630466606, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -243.53208295328423, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.3562306692985, -179.86459419585836, -192.8098233499191, -178.90512076541526, -189.29103150026583, -189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21491856297280887, "mean_inference_ms": 1.0986044025778414, "mean_action_processing_ms": 0.1180106464398779, "mean_env_wait_ms": 0.6326258491730464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 326400, "timesteps_this_iter": 0, "agent_timesteps_total": 326400, "timers": {"learn_time_ms": 1632.026, "learn_throughput": 1.225, "update_time_ms": 8.144}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.5983089208602905, "grad_norm": 4.579559803009033, "td_error_abs": 0.5090537109375, "q_taken_mean": -0.16431502278645832, "target_mean": -0.31421223958333333}}}, "num_steps_sampled": 326400, "num_agent_steps_sampled": 326400, "num_steps_trained": 136, "num_agent_steps_trained": 652800, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 340, "training_iteration": 68, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-29-05", "timestamp": 1708752545, "time_this_iter_s": 12.216415405273438, "time_total_s": 818.737300157547, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 818.737300157547, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 37.86000000000001, "ram_util_percent": 11.706666666666667, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -174.52413630466606, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -243.3813501159737, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.8273774536043, -189.8827271278761, -186.4890739646778, -186.4517432397981, -184.79922659072304, -619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21497119668978196, "mean_inference_ms": 1.0990355523822104, "mean_action_processing_ms": 0.11803949335521775, "mean_env_wait_ms": 0.6328173910796254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 331200, "timesteps_this_iter": 0, "agent_timesteps_total": 331200, "timers": {"learn_time_ms": 1627.263, "learn_throughput": 1.229, "update_time_ms": 8.069}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7627081871032715, "grad_norm": 7.096773624420166, "td_error_abs": 0.5819679361979166, "q_taken_mean": -0.4815808919270833, "target_mean": -0.1840115966796875}}}, "num_steps_sampled": 331200, "num_agent_steps_sampled": 331200, "num_steps_trained": 138, "num_agent_steps_trained": 662400, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 345, "training_iteration": 69, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-29-17", "timestamp": 1708752557, "time_this_iter_s": 11.939924955368042, "time_total_s": 830.677225112915, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 830.677225112915, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 37.225, "ram_util_percent": 11.7375, "gpu_util_percent0": 0.03125, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -174.52413630466606, "episode_reward_min": -652.0084611658641, "episode_reward_mean": -243.25281076388373, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-619.5413289891618, -618.4592781201726, -630.3268761139975, -652.0084611658641, -631.0068507492604, -528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21502277920951227, "mean_inference_ms": 1.099451315591952, "mean_action_processing_ms": 0.11806771598580337, "mean_env_wait_ms": 0.6330108607220614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"learn_time_ms": 1615.566, "learn_throughput": 1.238, "update_time_ms": 7.924}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7427853345870972, "grad_norm": 10.869796752929688, "td_error_abs": 0.59471337890625, "q_taken_mean": 0.05112507629394531, "target_mean": -0.31759523518880206}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 140, "num_agent_steps_trained": 672000, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 350, "training_iteration": 70, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-29-29", "timestamp": 1708752569, "time_this_iter_s": 11.70462942123413, "time_total_s": 842.3818545341492, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 842.3818545341492, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 37.96666666666667, "ram_util_percent": 11.82666666666667, "gpu_util_percent0": 0.02066666666666667, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -565.3149000567693, "episode_reward_mean": -220.44418755810563, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-528.1853619996782, -534.7046291745872, -542.3207677228786, -531.2558755069592, -553.3514634822878, -534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21507895542257807, "mean_inference_ms": 1.0998913202623846, "mean_action_processing_ms": 0.11809654863392836, "mean_env_wait_ms": 0.633199031337897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340800, "timesteps_this_iter": 0, "agent_timesteps_total": 340800, "timers": {"learn_time_ms": 1610.848, "learn_throughput": 1.242, "update_time_ms": 7.97}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.821600079536438, "grad_norm": 14.597765922546387, "td_error_abs": 0.6487301839192708, "q_taken_mean": -0.6744583333333334, "target_mean": -0.21023771158854165}}}, "num_steps_sampled": 340800, "num_agent_steps_sampled": 340800, "num_steps_trained": 142, "num_agent_steps_trained": 681600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 355, "training_iteration": 71, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-29-41", "timestamp": 1708752581, "time_this_iter_s": 11.759883880615234, "time_total_s": 854.1417384147644, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 854.1417384147644, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 36.91333333333334, "ram_util_percent": 11.820000000000002, "gpu_util_percent0": 0.010000000000000002, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -565.3149000567693, "episode_reward_mean": -202.8191162960446, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-534.9919845373986, -559.1453479064731, -565.3149000567693, -546.7364608497141, -505.7289981412731, -192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151361403122594, "mean_inference_ms": 1.1003325128202741, "mean_action_processing_ms": 0.11812485623423989, "mean_env_wait_ms": 0.6333944221080998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 345600, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"learn_time_ms": 1605.419, "learn_throughput": 1.246, "update_time_ms": 7.952}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6767211556434631, "grad_norm": 7.958095073699951, "td_error_abs": 0.557108642578125, "q_taken_mean": -0.06369545491536459, "target_mean": -0.3199622192382813}}}, "num_steps_sampled": 345600, "num_agent_steps_sampled": 345600, "num_steps_trained": 144, "num_agent_steps_trained": 691200, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 360, "training_iteration": 72, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-29-53", "timestamp": 1708752593, "time_this_iter_s": 11.919262170791626, "time_total_s": 866.061000585556, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 866.061000585556, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 37.39999999999999, "ram_util_percent": 11.993333333333332, "gpu_util_percent0": 0.028000000000000004, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -196.43747056197043, "episode_reward_mean": -184.64343374126838, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.08239701265006, -186.16276413860973, -185.8501773739187, -190.14617389863352, -189.87524516560475, -178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21519291000218627, "mean_inference_ms": 1.100772278291551, "mean_action_processing_ms": 0.11815328534726299, "mean_env_wait_ms": 0.6336015430198525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 350400, "timesteps_this_iter": 0, "agent_timesteps_total": 350400, "timers": {"learn_time_ms": 1612.499, "learn_throughput": 1.24, "update_time_ms": 7.965}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.049911379814148, "grad_norm": 2.6862640380859375, "td_error_abs": 0.6264459635416667, "q_taken_mean": -0.3063115234375, "target_mean": -0.20274576822916668}}}, "num_steps_sampled": 350400, "num_agent_steps_sampled": 350400, "num_steps_trained": 146, "num_agent_steps_trained": 700800, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 365, "training_iteration": 73, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-30-05", "timestamp": 1708752605, "time_this_iter_s": 11.899475336074829, "time_total_s": 877.9604759216309, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 877.9604759216309, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 37.28, "ram_util_percent": 12.006666666666666, "gpu_util_percent0": 0.018666666666666668, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -196.43747056197043, "episode_reward_mean": -184.54671913631748, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.90309490746037, -176.14514367078678, -187.72526969834763, -178.54973954519107, -182.30876180838345, -182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152390624821996, "mean_inference_ms": 1.1012060050734458, "mean_action_processing_ms": 0.11817968801215806, "mean_env_wait_ms": 0.6337845443355179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 355200, "timesteps_this_iter": 0, "agent_timesteps_total": 355200, "timers": {"learn_time_ms": 1611.716, "learn_throughput": 1.241, "update_time_ms": 7.961}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7927832007408142, "grad_norm": 2.197655200958252, "td_error_abs": 0.5593533121744791, "q_taken_mean": -0.2340704345703125, "target_mean": -0.32380198160807294}}}, "num_steps_sampled": 355200, "num_agent_steps_sampled": 355200, "num_steps_trained": 148, "num_agent_steps_trained": 710400, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 370, "training_iteration": 74, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-30-17", "timestamp": 1708752617, "time_this_iter_s": 11.779467344284058, "time_total_s": 889.7399432659149, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 889.7399432659149, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 37.519999999999996, "ram_util_percent": 12.106666666666662, "gpu_util_percent0": 0.026000000000000002, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.88565954166438, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.02836229538852, -178.58193185296392, -182.92627176384264, -196.42947736296026, -185.54561285674274, -189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21528103302753387, "mean_inference_ms": 1.1016242544191048, "mean_action_processing_ms": 0.11820451901663008, "mean_env_wait_ms": 0.6339590507090643, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"learn_time_ms": 1608.402, "learn_throughput": 1.243, "update_time_ms": 7.883}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.2174551486968994, "grad_norm": 12.028658866882324, "td_error_abs": 0.7457259928385417, "q_taken_mean": -0.3488916015625, "target_mean": -0.3488094889322917}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 150, "num_agent_steps_trained": 720000, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 375, "training_iteration": 75, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-30-29", "timestamp": 1708752629, "time_this_iter_s": 12.24367094039917, "time_total_s": 901.9836142063141, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 901.9836142063141, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 37.41875, "ram_util_percent": 12.11875, "gpu_util_percent0": 0.021875000000000002, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -204.03159285797904, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.99876781402014, -188.05828120038097, -178.53646617367215, -189.4167535992131, -186.50278059770855, -192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21532453672470603, "mean_inference_ms": 1.1020358599636086, "mean_action_processing_ms": 0.11822790980957726, "mean_env_wait_ms": 0.6341212252433384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 364800, "timesteps_this_iter": 0, "agent_timesteps_total": 364800, "timers": {"learn_time_ms": 1604.308, "learn_throughput": 1.247, "update_time_ms": 7.83}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7197758555412292, "grad_norm": 3.253396987915039, "td_error_abs": 0.5422184244791667, "q_taken_mean": -0.2649474080403646, "target_mean": -0.3091189168294271}}}, "num_steps_sampled": 364800, "num_agent_steps_sampled": 364800, "num_steps_trained": 152, "num_agent_steps_trained": 729600, "last_target_update_ts": 316800, "num_steps_trained_this_iter": 0, "num_target_updates": 6}, "done": false, "episodes_total": 380, "training_iteration": 76, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-30-41", "timestamp": 1708752641, "time_this_iter_s": 11.77304482460022, "time_total_s": 913.7566590309143, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 913.7566590309143, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 37.21333333333334, "ram_util_percent": 12.193333333333332, "gpu_util_percent0": 0.009333333333333334, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -204.07794476386994, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.7936835101313, -180.9254907701197, -182.17552841610126, -187.930343425031, -186.8565798115696, -188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153768016270496, "mean_inference_ms": 1.1024575365748785, "mean_action_processing_ms": 0.11825085290611975, "mean_env_wait_ms": 0.6342834168429325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 369600, "timesteps_this_iter": 0, "agent_timesteps_total": 369600, "timers": {"learn_time_ms": 1606.473, "learn_throughput": 1.245, "update_time_ms": 7.862}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7662270665168762, "grad_norm": 7.408027172088623, "td_error_abs": 0.5767355143229167, "q_taken_mean": 0.017126309712727866, "target_mean": -0.32253348795572917}}}, "num_steps_sampled": 369600, "num_agent_steps_sampled": 369600, "num_steps_trained": 154, "num_agent_steps_trained": 739200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 385, "training_iteration": 77, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-30-53", "timestamp": 1708752653, "time_this_iter_s": 11.952577114105225, "time_total_s": 925.7092361450195, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 925.7092361450195, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 37.97333333333333, "ram_util_percent": 12.226666666666665, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.9084466911414, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.5159498818829, -187.95786197353098, -191.84662934255988, -183.98590968736767, -196.02548181271777, -190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154222832709474, "mean_inference_ms": 1.1028704785517258, "mean_action_processing_ms": 0.11827288689489558, "mean_env_wait_ms": 0.6344427474492624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 374400, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"learn_time_ms": 1636.09, "learn_throughput": 1.222, "update_time_ms": 7.738}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7989985346794128, "grad_norm": 3.9714510440826416, "td_error_abs": 0.5743133951822916, "q_taken_mean": -0.5301060384114583, "target_mean": -0.3879770914713542}}}, "num_steps_sampled": 374400, "num_agent_steps_sampled": 374400, "num_steps_trained": 156, "num_agent_steps_trained": 748800, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 390, "training_iteration": 78, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-31-05", "timestamp": 1708752665, "time_this_iter_s": 12.267038106918335, "time_total_s": 937.9762742519379, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 937.9762742519379, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 37.025, "ram_util_percent": 12.2625, "gpu_util_percent0": 0.035, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.78999265936287, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.91663777582235, -186.15992216231518, -187.86229029230918, -188.63939083281983, -181.38578415572752, -185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21546224094736527, "mean_inference_ms": 1.1032806147907146, "mean_action_processing_ms": 0.1182950227947645, "mean_env_wait_ms": 0.6346067583255373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 379200, "timesteps_this_iter": 0, "agent_timesteps_total": 379200, "timers": {"learn_time_ms": 1651.123, "learn_throughput": 1.211, "update_time_ms": 7.781}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8394862413406372, "grad_norm": 9.207120895385742, "td_error_abs": 0.6263515625, "q_taken_mean": -0.2817933349609375, "target_mean": -0.5970585123697917}}}, "num_steps_sampled": 379200, "num_agent_steps_sampled": 379200, "num_steps_trained": 158, "num_agent_steps_trained": 758400, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 395, "training_iteration": 79, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-31-17", "timestamp": 1708752677, "time_this_iter_s": 11.943493843078613, "time_total_s": 949.9197680950165, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 949.9197680950165, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 37.61333333333334, "ram_util_percent": 12.340000000000003, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.5929500408376, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.74753079073398, -185.71435483405676, -184.69709497170905, -183.8357144053218, -195.51982276896248, -186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21550096981757008, "mean_inference_ms": 1.1036717131431295, "mean_action_processing_ms": 0.11831677841160604, "mean_env_wait_ms": 0.634777351470734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"learn_time_ms": 1676.91, "learn_throughput": 1.193, "update_time_ms": 8.306}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8280453085899353, "grad_norm": 2.6826670169830322, "td_error_abs": 0.5768717854817709, "q_taken_mean": -0.5342926839192709, "target_mean": -0.39093310546875}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 160, "num_agent_steps_trained": 768000, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 400, "training_iteration": 80, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-31-29", "timestamp": 1708752689, "time_this_iter_s": 12.121960639953613, "time_total_s": 962.0417287349701, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 962.0417287349701, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 37.00625, "ram_util_percent": 12.34375, "gpu_util_percent0": 0.024375, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.35110556677964, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.23022344008405, -190.38665251863316, -185.7442359034306, -190.2445691035202, -191.1425675783341, -186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21553232793723648, "mean_inference_ms": 1.1040193260433704, "mean_action_processing_ms": 0.11833423626165322, "mean_env_wait_ms": 0.6349295579086287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 388800, "timesteps_this_iter": 0, "agent_timesteps_total": 388800, "timers": {"learn_time_ms": 1677.109, "learn_throughput": 1.193, "update_time_ms": 8.343}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.8373992443084717, "grad_norm": 3.234654188156128, "td_error_abs": 0.5790059000651042, "q_taken_mean": -0.29902398681640624, "target_mean": -0.3885663655598958}}}, "num_steps_sampled": 388800, "num_agent_steps_sampled": 388800, "num_steps_trained": 162, "num_agent_steps_trained": 777600, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 405, "training_iteration": 81, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-31-41", "timestamp": 1708752701, "time_this_iter_s": 11.8758385181427, "time_total_s": 973.9175672531128, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 973.9175672531128, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 36.673333333333325, "ram_util_percent": 12.54, "gpu_util_percent0": 0.004666666666666667, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.22983220525865, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.41756947815432, -185.3122939578416, -183.33950432567528, -182.53947388032074, -182.41518160088387, -185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21556836801109203, "mean_inference_ms": 1.1043446768594065, "mean_action_processing_ms": 0.11835019744411099, "mean_env_wait_ms": 0.6350799573368855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 393600, "timesteps_this_iter": 0, "agent_timesteps_total": 393600, "timers": {"learn_time_ms": 1678.381, "learn_throughput": 1.192, "update_time_ms": 8.376}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7611725330352783, "grad_norm": 1.0068880319595337, "td_error_abs": 0.5583040364583334, "q_taken_mean": -0.4824068603515625, "target_mean": -0.48162980143229167}}}, "num_steps_sampled": 393600, "num_agent_steps_sampled": 393600, "num_steps_trained": 164, "num_agent_steps_trained": 787200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 410, "training_iteration": 82, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-31-53", "timestamp": 1708752713, "time_this_iter_s": 11.820967197418213, "time_total_s": 985.738534450531, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 985.738534450531, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 37.75333333333332, "ram_util_percent": 12.553333333333333, "gpu_util_percent0": 0.020000000000000004, "vram_util_percent0": 0.020589192708333332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.46574280768766, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.19228805400763, -186.98065133891959, -188.1412909867409, -183.90018956858384, -182.65120522857308, -180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21560667595234204, "mean_inference_ms": 1.1046714195741718, "mean_action_processing_ms": 0.11836703799584003, "mean_env_wait_ms": 0.6352369305450469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 398400, "timesteps_this_iter": 0, "agent_timesteps_total": 398400, "timers": {"learn_time_ms": 1676.853, "learn_throughput": 1.193, "update_time_ms": 8.445}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6359086632728577, "grad_norm": 0.5710368752479553, "td_error_abs": 0.5119228515625, "q_taken_mean": -0.46603125, "target_mean": -0.4793898111979167}}}, "num_steps_sampled": 398400, "num_agent_steps_sampled": 398400, "num_steps_trained": 166, "num_agent_steps_trained": 796800, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 415, "training_iteration": 83, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-32-05", "timestamp": 1708752725, "time_this_iter_s": 12.11424732208252, "time_total_s": 997.8527817726135, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 997.8527817726135, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 38.88, "ram_util_percent": 12.613333333333332, "gpu_util_percent0": 0.06333333333333334, "vram_util_percent0": 0.020467122395833332}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.52317721796678, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.06884446155613, -187.54182140697202, -196.43747056197043, -184.86285498292466, -193.03854978570251, -176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21564486145609585, "mean_inference_ms": 1.1049977951186698, "mean_action_processing_ms": 0.11838320697151553, "mean_env_wait_ms": 0.6353853814689068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 403200, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"learn_time_ms": 1675.614, "learn_throughput": 1.194, "update_time_ms": 8.446}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.62424236536026, "grad_norm": 0.4744446873664856, "td_error_abs": 0.5104244791666667, "q_taken_mean": -0.48148429361979167, "target_mean": -0.4793898111979167}}}, "num_steps_sampled": 403200, "num_agent_steps_sampled": 403200, "num_steps_trained": 168, "num_agent_steps_trained": 806400, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 420, "training_iteration": 84, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-32-17", "timestamp": 1708752737, "time_this_iter_s": 11.859392881393433, "time_total_s": 1009.712174654007, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1009.712174654007, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 38.126666666666665, "ram_util_percent": 12.7, "gpu_util_percent0": 0.035333333333333335, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.32635186143966, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.10993289057765, -183.5472748550743, -177.48496089755488, -182.67368744277897, -176.96570534833046, -184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21568612596715767, "mean_inference_ms": 1.105337785230788, "mean_action_processing_ms": 0.11839996269600755, "mean_env_wait_ms": 0.635536335277921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"learn_time_ms": 1688.313, "learn_throughput": 1.185, "update_time_ms": 8.452}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6390949487686157, "grad_norm": 0.7958846092224121, "td_error_abs": 0.5260653483072917, "q_taken_mean": -0.468279052734375, "target_mean": -0.47738326009114584}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 170, "num_agent_steps_trained": 816000, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 425, "training_iteration": 85, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-32-29", "timestamp": 1708752749, "time_this_iter_s": 11.988936185836792, "time_total_s": 1021.7011108398438, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1021.7011108398438, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 38.20666666666667, "ram_util_percent": 12.693333333333333, "gpu_util_percent0": 0.038000000000000006, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.63864641898738, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.2155003546255, -174.52413630466606, -187.03901944910032, -184.64173676427825, -183.30267352901285, -181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21572079315124484, "mean_inference_ms": 1.1056795752445945, "mean_action_processing_ms": 0.11841835752021684, "mean_env_wait_ms": 0.6356980108271819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 412800, "timesteps_this_iter": 0, "agent_timesteps_total": 412800, "timers": {"learn_time_ms": 1679.817, "learn_throughput": 1.191, "update_time_ms": 8.432}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6388434767723083, "grad_norm": 0.4490357041358948, "td_error_abs": 0.5226725667317709, "q_taken_mean": -0.487642578125, "target_mean": -0.47560843912760414}}}, "num_steps_sampled": 412800, "num_agent_steps_sampled": 412800, "num_steps_trained": 172, "num_agent_steps_trained": 825600, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 430, "training_iteration": 86, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-32-41", "timestamp": 1708752761, "time_this_iter_s": 12.071184396743774, "time_total_s": 1033.7722952365875, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1033.7722952365875, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 36.49375, "ram_util_percent": 12.756250000000001, "gpu_util_percent0": 0.004375, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.92433170252022, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.76885663259762, -186.02588421838777, -186.27517857049344, -187.464454991051, -194.56084718588312, -178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21574091750599078, "mean_inference_ms": 1.1059579160733102, "mean_action_processing_ms": 0.11842820665617121, "mean_env_wait_ms": 0.6357971266838626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 417600, "timesteps_this_iter": 0, "agent_timesteps_total": 417600, "timers": {"learn_time_ms": 1675.065, "learn_throughput": 1.194, "update_time_ms": 8.4}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6568483710289001, "grad_norm": 0.6738343238830566, "td_error_abs": 0.5257618408203125, "q_taken_mean": -0.46377644856770833, "target_mean": -0.4755647379557292}}}, "num_steps_sampled": 417600, "num_agent_steps_sampled": 417600, "num_steps_trained": 174, "num_agent_steps_trained": 835200, "last_target_update_ts": 369600, "num_steps_trained_this_iter": 0, "num_target_updates": 7}, "done": false, "episodes_total": 435, "training_iteration": 87, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-32-53", "timestamp": 1708752773, "time_this_iter_s": 11.93381142616272, "time_total_s": 1045.7061066627502, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1045.7061066627502, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 37.739999999999995, "ram_util_percent": 12.846666666666671, "gpu_util_percent0": 0.028666666666666667, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -203.82608360939136, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.41847457108747, -183.96363312835712, -184.50199512112215, -179.06282911242243, -187.20658481671592, -184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21575450654321357, "mean_inference_ms": 1.1062229369560794, "mean_action_processing_ms": 0.11843460257124266, "mean_env_wait_ms": 0.6358580121285836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 422400, "timesteps_this_iter": 0, "agent_timesteps_total": 422400, "timers": {"learn_time_ms": 1640.845, "learn_throughput": 1.219, "update_time_ms": 8.373}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6394206881523132, "grad_norm": 0.7188215851783752, "td_error_abs": 0.5237649332682291, "q_taken_mean": -0.5059390869140625, "target_mean": -0.4804493408203125}}}, "num_steps_sampled": 422400, "num_agent_steps_sampled": 422400, "num_steps_trained": 176, "num_agent_steps_trained": 844800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 440, "training_iteration": 88, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-33-05", "timestamp": 1708752785, "time_this_iter_s": 11.777427673339844, "time_total_s": 1057.48353433609, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1057.48353433609, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 37.61333333333333, "ram_util_percent": 12.806666666666668, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -204.267475075289, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.33679944141247, -187.01745851408387, -180.91724158532475, -182.6375922907066, -189.68712133615068, -176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21576287458101912, "mean_inference_ms": 1.1064799814079018, "mean_action_processing_ms": 0.11844078100904237, "mean_env_wait_ms": 0.63592133890334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 427200, "timesteps_this_iter": 0, "agent_timesteps_total": 427200, "timers": {"learn_time_ms": 1649.067, "learn_throughput": 1.213, "update_time_ms": 8.641}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6193304657936096, "grad_norm": 1.4803880453109741, "td_error_abs": 0.5207762858072916, "q_taken_mean": -0.44931766764322917, "target_mean": -0.3917729899088542}}}, "num_steps_sampled": 427200, "num_agent_steps_sampled": 427200, "num_steps_trained": 178, "num_agent_steps_trained": 854400, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 445, "training_iteration": 89, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-33-17", "timestamp": 1708752797, "time_this_iter_s": 12.150577545166016, "time_total_s": 1069.634111881256, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1069.634111881256, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 37.71333333333333, "ram_util_percent": 13.02, "gpu_util_percent0": 0.028000000000000004, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -168.21854748894057, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -204.2315712644186, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.66812460432732, -175.85252092513235, -168.21854748894057, -172.19959597767533, -177.541685564573, -186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21577871880028368, "mean_inference_ms": 1.1067467306958394, "mean_action_processing_ms": 0.11844904521993088, "mean_env_wait_ms": 0.636000440485326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"learn_time_ms": 1622.023, "learn_throughput": 1.233, "update_time_ms": 8.869}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6682723164558411, "grad_norm": 2.686215400695801, "td_error_abs": 0.5349513346354167, "q_taken_mean": -0.3320577392578125, "target_mean": -0.395427490234375}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 180, "num_agent_steps_trained": 864000, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 450, "training_iteration": 90, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-33-29", "timestamp": 1708752809, "time_this_iter_s": 12.080740928649902, "time_total_s": 1081.714852809906, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1081.714852809906, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 37.2625, "ram_util_percent": 13.03125, "gpu_util_percent0": 0.04, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -172.42543364338545, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -222.83655498786837, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.8411046498416, -184.53178703589666, -185.77940295669413, -186.87084236446816, -183.28783467339215, -176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21579359611977975, "mean_inference_ms": 1.107006267987979, "mean_action_processing_ms": 0.11845668518514284, "mean_env_wait_ms": 0.6360747169102531, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 436800, "timesteps_this_iter": 0, "agent_timesteps_total": 436800, "timers": {"learn_time_ms": 1627.185, "learn_throughput": 1.229, "update_time_ms": 12.42}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 1.3880059719085693, "grad_norm": 14.119912147521973, "td_error_abs": 0.8834271647135417, "q_taken_mean": -0.45964896647135417, "target_mean": -0.41852010091145836}}}, "num_steps_sampled": 436800, "num_agent_steps_sampled": 436800, "num_steps_trained": 182, "num_agent_steps_trained": 873600, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 455, "training_iteration": 91, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-33-41", "timestamp": 1708752821, "time_this_iter_s": 11.772143840789795, "time_total_s": 1093.4869966506958, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1093.4869966506958, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 36.35333333333333, "ram_util_percent": 13.113333333333332, "gpu_util_percent0": 0.004666666666666667, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -172.42543364338545, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -222.90921095081012, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.92636768016192, -181.43154239760676, -180.64949693656743, -182.91659535628074, -172.42543364338545, -180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2158149089995013, "mean_inference_ms": 1.1072482625254907, "mean_action_processing_ms": 0.1184635113900948, "mean_env_wait_ms": 0.6361427945015368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 441600, "timesteps_this_iter": 0, "agent_timesteps_total": 441600, "timers": {"learn_time_ms": 1613.212, "learn_throughput": 1.24, "update_time_ms": 15.595}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7550336718559265, "grad_norm": 6.597527503967285, "td_error_abs": 0.5836120198567708, "q_taken_mean": -0.13715358479817708, "target_mean": -0.3941318359375}}}, "num_steps_sampled": 441600, "num_agent_steps_sampled": 441600, "num_steps_trained": 184, "num_agent_steps_trained": 883200, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 460, "training_iteration": 92, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-33-53", "timestamp": 1708752833, "time_this_iter_s": 11.862670183181763, "time_total_s": 1105.3496668338776, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1105.3496668338776, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 37.49333333333333, "ram_util_percent": 13.146666666666665, "gpu_util_percent0": 0.02266666666666667, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -223.15452763643555, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.40184349309223, -189.04746482574666, -193.21056924054906, -189.77476195561226, -182.01065757932466, -572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21583788179618357, "mean_inference_ms": 1.1074893398562593, "mean_action_processing_ms": 0.1184701586164713, "mean_env_wait_ms": 0.6362099959906117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 446400, "timesteps_this_iter": 0, "agent_timesteps_total": 446400, "timers": {"learn_time_ms": 1613.924, "learn_throughput": 1.239, "update_time_ms": 15.572}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7486862540245056, "grad_norm": 3.9494616985321045, "td_error_abs": 0.5642888997395833, "q_taken_mean": -0.5941899007161459, "target_mean": -0.439245849609375}}}, "num_steps_sampled": 446400, "num_agent_steps_sampled": 446400, "num_steps_trained": 186, "num_agent_steps_trained": 892800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 465, "training_iteration": 93, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-34-05", "timestamp": 1708752845, "time_this_iter_s": 11.958047866821289, "time_total_s": 1117.3077147006989, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1117.3077147006989, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 38.18666666666666, "ram_util_percent": 13.206666666666667, "gpu_util_percent0": 0.028000000000000004, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -593.9572833421121, "episode_reward_mean": -223.20290159270735, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-572.7561112977459, -550.6143181713294, -563.8693344565518, -556.3290028971255, -593.9572833421121, -187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21586406789996304, "mean_inference_ms": 1.1077283460282112, "mean_action_processing_ms": 0.11847683937229092, "mean_env_wait_ms": 0.6362812491753883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 451200, "timesteps_this_iter": 0, "agent_timesteps_total": 451200, "timers": {"learn_time_ms": 1617.035, "learn_throughput": 1.237, "update_time_ms": 15.574}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6952050924301147, "grad_norm": 1.596685528755188, "td_error_abs": 0.5320045979817708, "q_taken_mean": -0.3467261555989583, "target_mean": -0.39655611165364585}}}, "num_steps_sampled": 451200, "num_agent_steps_sampled": 451200, "num_steps_trained": 188, "num_agent_steps_trained": 902400, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 470, "training_iteration": 94, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-34-17", "timestamp": 1708752857, "time_this_iter_s": 11.894042730331421, "time_total_s": 1129.2017574310303, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1129.2017574310303, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 37.76, "ram_util_percent": 13.280000000000001, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -582.6620777451216, "episode_reward_mean": -204.15724216927873, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.63777605685127, -192.9070677544726, -191.73651629580235, -181.94649979960832, -185.87712785662737, -186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158, -187.3190959024735, -180.14324465286782, -189.9754280799152, -188.6279951123127, -186.89434407442798], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21588540456442368, "mean_inference_ms": 1.1079285427405932, "mean_action_processing_ms": 0.11847960314088653, "mean_env_wait_ms": 0.63633115170925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"learn_time_ms": 1605.876, "learn_throughput": 1.245, "update_time_ms": 15.614}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6104354858398438, "grad_norm": 0.8794326782226562, "td_error_abs": 0.515191162109375, "q_taken_mean": -0.427098388671875, "target_mean": -0.39857796223958336}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 190, "num_agent_steps_trained": 912000, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 475, "training_iteration": 95, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-34-28", "timestamp": 1708752868, "time_this_iter_s": 11.899650812149048, "time_total_s": 1141.1014082431793, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1141.1014082431793, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 37.980000000000004, "ram_util_percent": 13.32666666666667, "gpu_util_percent0": 0.016, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -582.6620777451216, "episode_reward_mean": -204.02674541781147, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.82512198897768, -187.12508373849147, -186.26636120503304, -187.67093606053825, -189.26073698104153, -184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158, -187.3190959024735, -180.14324465286782, -189.9754280799152, -188.6279951123127, -186.89434407442798, -179.4190844578846, -181.5387495804801, -187.38544974435067, -186.99261483822417, -191.71941399569405], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21590531224204967, "mean_inference_ms": 1.108141849086656, "mean_action_processing_ms": 0.11848266728663387, "mean_env_wait_ms": 0.6363723689916162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460800, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"learn_time_ms": 1614.785, "learn_throughput": 1.239, "update_time_ms": 15.689}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6170429587364197, "grad_norm": 1.5511751174926758, "td_error_abs": 0.5225262451171875, "q_taken_mean": -0.361293701171875, "target_mean": -0.39863232421875}}}, "num_steps_sampled": 460800, "num_agent_steps_sampled": 460800, "num_steps_trained": 192, "num_agent_steps_trained": 921600, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 480, "training_iteration": 96, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-34-40", "timestamp": 1708752880, "time_this_iter_s": 11.857028007507324, "time_total_s": 1152.9584362506866, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1152.9584362506866, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 36.82000000000001, "ram_util_percent": 13.413333333333334, "gpu_util_percent0": 0.009333333333333334, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -582.6620777451216, "episode_reward_mean": -203.95849241418296, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.13474988268177, -179.6805005483729, -184.81284727849982, -180.056588141211, -185.04713280933746, -190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158, -187.3190959024735, -180.14324465286782, -189.9754280799152, -188.6279951123127, -186.89434407442798, -179.4190844578846, -181.5387495804801, -187.38544974435067, -186.99261483822417, -191.71941399569405, -187.7357022002461, -183.33666192979075, -186.2188150434951, -184.6784108709962, -188.35334956670468], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21592333937582203, "mean_inference_ms": 1.1083482411483054, "mean_action_processing_ms": 0.11848644322959151, "mean_env_wait_ms": 0.6364208412053272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 465600, "timesteps_this_iter": 0, "agent_timesteps_total": 465600, "timers": {"learn_time_ms": 1614.962, "learn_throughput": 1.238, "update_time_ms": 15.686}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7106969952583313, "grad_norm": 1.1715052127838135, "td_error_abs": 0.5377431640625, "q_taken_mean": -0.45071464029947916, "target_mean": -0.44507470703125}}}, "num_steps_sampled": 465600, "num_agent_steps_sampled": 465600, "num_steps_trained": 194, "num_agent_steps_trained": 931200, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 485, "training_iteration": 97, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-34-52", "timestamp": 1708752892, "time_this_iter_s": 11.951451301574707, "time_total_s": 1164.9098875522614, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1164.9098875522614, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 37.586666666666666, "ram_util_percent": 13.42, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -582.6620777451216, "episode_reward_mean": -204.10727614422368, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.18979523901132, -189.45716363990024, -187.90846603439306, -181.21142223428558, -187.71958237261026, -178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158, -187.3190959024735, -180.14324465286782, -189.9754280799152, -188.6279951123127, -186.89434407442798, -179.4190844578846, -181.5387495804801, -187.38544974435067, -186.99261483822417, -191.71941399569405, -187.7357022002461, -183.33666192979075, -186.2188150434951, -184.6784108709962, -188.35334956670468, -186.33020803293684, -184.28514364265342, -183.88614050372544, -187.79093265551657, -186.31776682935183], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2159462865436331, "mean_inference_ms": 1.108555105270197, "mean_action_processing_ms": 0.11849067611474431, "mean_env_wait_ms": 0.6364709569886514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 470400, "timesteps_this_iter": 0, "agent_timesteps_total": 470400, "timers": {"learn_time_ms": 1608.934, "learn_throughput": 1.243, "update_time_ms": 15.615}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6755709648132324, "grad_norm": 1.582794189453125, "td_error_abs": 0.5309683430989584, "q_taken_mean": -0.4434346110026042, "target_mean": -0.39903125}}}, "num_steps_sampled": 470400, "num_agent_steps_sampled": 470400, "num_steps_trained": 196, "num_agent_steps_trained": 940800, "last_target_update_ts": 422400, "num_steps_trained_this_iter": 0, "num_target_updates": 8}, "done": false, "episodes_total": 490, "training_iteration": 98, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-35-04", "timestamp": 1708752904, "time_this_iter_s": 11.963284730911255, "time_total_s": 1176.8731722831726, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1176.8731722831726, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 37.946666666666665, "ram_util_percent": 13.606666666666664, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -582.6620777451216, "episode_reward_mean": -204.06830684142705, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.40033770687214, -181.12418361916764, -181.41833334921725, -187.78131450620066, -186.5355941850132, -177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158, -187.3190959024735, -180.14324465286782, -189.9754280799152, -188.6279951123127, -186.89434407442798, -179.4190844578846, -181.5387495804801, -187.38544974435067, -186.99261483822417, -191.71941399569405, -187.7357022002461, -183.33666192979075, -186.2188150434951, -184.6784108709962, -188.35334956670468, -186.33020803293684, -184.28514364265342, -183.88614050372544, -187.79093265551657, -186.31776682935183, -188.03308890134872, -184.7257434841456, -188.69224118960054, -183.78719227552742, -187.35123338990894], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21596843580327404, "mean_inference_ms": 1.1087647205366868, "mean_action_processing_ms": 0.11849497150806874, "mean_env_wait_ms": 0.6365133379131871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 475200, "timesteps_this_iter": 0, "agent_timesteps_total": 475200, "timers": {"learn_time_ms": 1592.239, "learn_throughput": 1.256, "update_time_ms": 15.305}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.7359201908111572, "grad_norm": 2.845600128173828, "td_error_abs": 0.54563232421875, "q_taken_mean": -0.36803995768229164, "target_mean": -0.4435272623697917}}}, "num_steps_sampled": 475200, "num_agent_steps_sampled": 475200, "num_steps_trained": 198, "num_agent_steps_trained": 950400, "last_target_update_ts": 475200, "num_steps_trained_this_iter": 0, "num_target_updates": 9}, "done": false, "episodes_total": 495, "training_iteration": 99, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-35-16", "timestamp": 1708752916, "time_this_iter_s": 11.860148429870605, "time_total_s": 1188.7333207130432, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1188.7333207130432, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 37.70666666666666, "ram_util_percent": 13.59333333333333, "gpu_util_percent0": 0.026000000000000006, "vram_util_percent0": 0.0203857421875}}
{"episode_reward_max": -177.90559106200712, "episode_reward_min": -582.6620777451216, "episode_reward_mean": -204.2725297899323, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.90559106200712, -179.51621808642145, -182.76103738086496, -187.62524399633034, -183.52197983936398, -185.5041872319306, -183.2909763387701, -188.60648859552145, -181.50193175920512, -192.71732846647856, -192.2050954129729, -188.6481409540039, -187.4071710714689, -185.98980837427658, -189.36486767305382, -181.45110657993882, -186.83185235643518, -187.9443482825112, -192.72191221711094, -183.65984676874137, -184.08013767630916, -180.99628263848558, -190.03234873511605, -182.59849025747926, -184.55974623902222, -186.04681058171704, -184.27400052789363, -184.5395540048961, -188.96691761967028, -184.18373445491196, -190.207141590914, -189.1302656619196, -186.83977488052685, -186.93891528393843, -189.17549733766785, -189.14727898997873, -183.3238816221609, -186.6480088136383, -182.9846597547288, -184.16658310502422, -195.8247170822013, -191.63020997098695, -185.68401278321758, -194.12999782081954, -190.02372568224024, -184.41841869402757, -186.61589078434912, -181.72678365279057, -184.9192166973501, -183.3255222521196, -525.4465826441674, -552.6132620940772, -582.6620777451216, -569.8276332818039, -500.4292911404608, -183.3237655438009, -188.7919748240786, -188.24958708734565, -184.40962397421413, -189.80161654502314, -183.50727385494676, -185.00069441368547, -181.09304035860754, -180.2246503133653, -189.055445635946, -194.27350030824545, -190.21832378420996, -187.18913281240765, -183.3693770954805, -184.232358721158, -187.3190959024735, -180.14324465286782, -189.9754280799152, -188.6279951123127, -186.89434407442798, -179.4190844578846, -181.5387495804801, -187.38544974435067, -186.99261483822417, -191.71941399569405, -187.7357022002461, -183.33666192979075, -186.2188150434951, -184.6784108709962, -188.35334956670468, -186.33020803293684, -184.28514364265342, -183.88614050372544, -187.79093265551657, -186.31776682935183, -188.03308890134872, -184.7257434841456, -188.69224118960054, -183.78719227552742, -187.35123338990894, -188.9290305342675, -184.39484242821797, -185.51442142432703, -187.03339429045704, -189.81036953972875], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21599076616319177, "mean_inference_ms": 1.1089771212850845, "mean_action_processing_ms": 0.11849846460756258, "mean_env_wait_ms": 0.636550480457133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"learn_time_ms": 1599.623, "learn_throughput": 1.25, "update_time_ms": 14.588}, "info": {"learner": {"default_policy": {"learner_stats": {"loss": 0.6927507519721985, "grad_norm": 3.0857958793640137, "td_error_abs": 0.542830810546875, "q_taken_mean": -0.5112069905598958, "target_mean": -0.384431396484375}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 200, "num_agent_steps_trained": 960000, "last_target_update_ts": 475200, "num_steps_trained_this_iter": 0, "num_target_updates": 9}, "evaluation": {"episode_reward_max": -167.56846519814363, "episode_reward_min": -176.75217494172145, "episode_reward_mean": -171.4709092828499, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.18450996733972, -171.1728982315, -168.5818231747965, -169.8817209788081, -173.0245831170238, -176.75217494172145, -171.48267563761158, -171.9999429398277, -167.56846519814363, -173.06029864172643], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21608208226732933, "mean_inference_ms": 0.9607177781261547, "mean_action_processing_ms": 0.11570372560869732, "mean_env_wait_ms": 0.6397076804379263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 500, "training_iteration": 100, "trial_id": "b73c5_00000", "experiment_id": "e58e26878035480a885a8fdaac625a08", "date": "2024-02-24_11-35-47", "timestamp": 1708752947, "time_this_iter_s": 30.377981185913086, "time_total_s": 1219.1113018989563, "pid": 5095, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 2, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 500, "lstm_cell_size": 64, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128", "mixer_embedding": 256, "mixer_arch": "qmix"}, "algorithm": "iql", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": "rmsprop", "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "grouped_magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.05, "epsilon_timesteps": 50000}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "mixer": null, "mixing_embed_dim": 32, "double_q": true, "target_network_update_freq": 50000, "buffer_size": 5000, "optim_alpha": 0.99, "optim_eps": 1e-05, "grad_norm_clipping": 10, "learning_starts": 1000, "worker_side_prioritization": false, "reward_standardize": true, "training_intensity": null}, "time_since_restore": 1219.1113018989563, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 38.174358974358974, "ram_util_percent": 13.661538461538461, "gpu_util_percent0": 0.011282051282051283, "vram_util_percent0": 0.0203857421875}}
