{
  "checkpoints": [
    "{\n  \"trainable_name\": \"IQL\",\n  \"trial_id\": \"523f7_00000\",\n  \"config\": {\n    \"model\": {\n      \"max_seq_len\": 1,\n      \"custom_model_config\": {\n        \"env\": \"magym\",\n        \"env_args\": {\n          \"max_steps\": 960,\n          \"map_name\": \"PowerGrid\"\n        },\n        \"mask_flag\": false,\n        \"global_state_flag\": false,\n        \"opp_action_in_cc\": true,\n        \"agent_level_batch_update\": true,\n        \"force_coop\": false,\n        \"local_mode\": true,\n        \"share_policy\": \"all\",\n        \"evaluation_interval\": 50,\n        \"framework\": \"torch\",\n        \"num_workers\": 5,\n        \"num_gpus\": 0,\n        \"num_cpus_per_worker\": 1,\n        \"num_gpus_per_worker\": 0,\n        \"checkpoint_freq\": 50,\n        \"checkpoint_end\": true,\n        \"restore_path\": {\n          \"model_path\": \"\",\n          \"params_path\": \"\"\n        },\n        \"stop_iters\": 9999999,\n        \"stop_timesteps\": 2000000,\n        \"stop_reward\": 999999,\n        \"seed\": 321,\n        \"local_dir\": \"\",\n        \"model_arch_args\": {\n          \"hidden_state_size\": 256,\n          \"core_arch\": \"mlp\",\n          \"fc_layer\": 2,\n          \"out_dim_fc_0\": 128,\n          \"out_dim_fc_1\": 64,\n          \"encode_layer\": \"128-128\",\n          \"mixer_embedding\": 256,\n          \"mixer_arch\": \"qmix\"\n        },\n        \"algorithm\": \"iql\",\n        \"space_obs\": {\n          \"_type\": \"CLOUDPICKLE_FALLBACK\",\n          \"value\": \"8005950a020000000000008c0f67796d2e7370616365732e64696374948c04446963749493942981947d94288c06737061636573948c0b636f6c6c656374696f6e73948c0b4f726465726564446963749493942952948c036f6273948c0e67796d2e7370616365732e626f78948c03426f789493942981947d94288c056474797065948c056e756d707994681093948c02663494898887945294284b038c013c944e4e4e4affffffff4affffffff4b007494628c065f7368617065944b0685948c036c6f77948c126e756d70792e636f72652e6e756d65726963948c0b5f66726f6d62756666657294939428961800000000000000faed6b3a00000000000070410000004100002041000020419468128c02663494898887945294284b0368164e4e4e4affffffff4affffffff4b007494624b0685948c014394749452948c046869676894681d28961800000000000000bc74933b00000041000070410000004100002041000020419468214b0685946824749452948c0d626f756e6465645f62656c6f7794681d289606000000000000000101010101019468128c02623194898887945294284b038c017c944e4e4e4affffffff4affffffff4b007494624b0685946824749452948c0d626f756e6465645f61626f766594681d289606000000000000000101010101019468304b0685946824749452948c0a5f6e705f72616e646f6d944e75627368184e68104e683b4e75622e\"\n        },\n        \"space_act\": {\n          \"_type\": \"CLOUDPICKLE_FALLBACK\",\n          \"value\": \"80059582000000000000008c1367796d2e7370616365732e6469736372657465948c0844697363726574659493942981947d94288c016e944b098c065f736861706594298c056474797065948c056e756d707994680793948c02693894898887945294284b038c013c944e4e4e4affffffff4affffffff4b007494628c0a5f6e705f72616e646f6d944e75622e\"\n        },\n        \"num_agents\": 5,\n        \"episode_limit\": 1,\n        \"policy_mapping_info\": {\n          \"Checkers\": {\n            \"description\": \"two team cooperate\",\n            \"team_prefix\": [\n              \"red_\",\n              \"blue_\"\n            ],\n            \"all_agents_one_policy\": true,\n            \"one_agent_one_policy\": true\n          },\n          \"Switch2\": {\n            \"description\": \"two team cooperate\",\n            \"team_prefix\": [\n              \"red_\",\n              \"blue_\"\n            ],\n            \"all_agents_one_policy\": true,\n            \"one_agent_one_policy\": true\n          },\n          \"PowerGrid\": {\n            \"description\": \"five team cooperate\",\n            \"team_prefix\": [\n              \"1\",\n              \"2\",\n              \"3\",\n              \"4\",\n              \"5\"\n            ],\n            \"all_agents_one_policy\": true,\n            \"one_agent_one_policy\": true\n          }\n        },\n        \"agent_name_ls\": [\n          \"1\",\n          \"2\",\n          \"3\",\n          \"4\",\n          \"5\"\n        ]\n      }\n    },\n    \"seed\": 321,\n    \"env\": \"grouped_magym_PowerGrid\",\n    \"num_gpus_per_worker\": 0,\n    \"num_gpus\": 0,\n    \"num_workers\": 5,\n    \"multiagent\": {\n      \"policies\": null,\n      \"policy_mapping_fn\": null\n    },\n    \"framework\": \"torch\",\n    \"evaluation_interval\": 50,\n    \"simple_optimizer\": false\n  },\n  \"local_dir\": \"/home/cail005/Documents/nZEC/MARLlib/exp_results/iql_mlp_PowerGrid\",\n  \"evaluated_params\": {},\n  \"experiment_tag\": \"0\",\n  \"location\": {\n    \"_type\": \"CLOUDPICKLE_FALLBACK\",\n    \"value\": \"8005953a000000000000008c0e7261792e74756e652e747269616c948c084c6f636174696f6e9493942981947d94288c08686f73746e616d65944e8c03706964944e75622e\"\n  },\n  \"resources\": {\n    \"cpu\": 1,\n    \"gpu\": 0,\n    \"memory\": 0,\n    \"object_store_memory\": 0,\n    \"extra_cpu\": 0,\n    \"extra_gpu\": 0,\n    \"extra_memory\": 0,\n    \"extra_object_store_memory\": 0,\n    \"custom_resources\": {},\n    \"extra_custom_resources\": {}\n  },\n  \"placement_group_factory\": {\n    \"_type\": \"CLOUDPICKLE_FALLBACK\",\n    \"value\": \"80059520010000000000008c1f7261792e74756e652e7574696c732e706c6163656d656e745f67726f757073948c15506c6163656d656e7447726f7570466163746f72799493942981947d94288c085f62756e646c6573945d94287d94288c0343505594473ff00000000000008c0347505594470000000000000000757d94286808473ff00000000000006809470000000000000000757d94286808473ff00000000000006809470000000000000000757d94286808473ff00000000000006809470000000000000000757d94286808473ff00000000000006809470000000000000000757d94286808473ff0000000000000680947000000000000000075658c095f7374726174656779948c045041434b948c055f6172677394298c075f6b7761726773947d9475622e\"\n  },\n  \"stopping_criterion\": {\n    \"episode_reward_mean\": 999999,\n    \"timesteps_total\": 2000000,\n    \"training_iteration\": 9999999,\n    \"stop_timesteps\": 96000\n  },\n  \"log_to_file\": [\n    null,\n    null\n  ],\n  \"max_failures\": 0,\n  \"_last_result\": {},\n  \"_default_result_or_future\": null,\n  \"last_update_time\": -Infinity,\n  \"metric_analysis\": {},\n  \"n_steps\": [\n    5,\n    10\n  ],\n  \"metric_n_steps\": {},\n  \"export_formats\": [],\n  \"status\": \"ERROR\",\n  \"start_time\": 1703002742.230949,\n  \"logdir\": \"/home/cail005/Documents/nZEC/MARLlib/exp_results/iql_mlp_PowerGrid/IQL_grouped_magym_PowerGrid_523f7_00000_0_2023-12-19_22-19-01\",\n  \"runner\": null,\n  \"last_debug\": 0,\n  \"error_file\": \"/home/cail005/Documents/nZEC/MARLlib/exp_results/iql_mlp_PowerGrid/IQL_grouped_magym_PowerGrid_523f7_00000_0_2023-12-19_22-19-01/error.txt\",\n  \"error_msg\": \"Traceback (most recent call last):\\n  File \\\"/home/cail005/anaconda3/envs/marl/lib/python3.8/site-packages/ray/tune/trial_runner.py\\\", line 898, in _process_trial\\n    decision = self._process_trial_result(trial, result)\\n  File \\\"/home/cail005/anaconda3/envs/marl/lib/python3.8/site-packages/ray/tune/trial_runner.py\\\", line 947, in _process_trial_result\\n    result) or trial.should_stop(flat_result):\\n  File \\\"/home/cail005/anaconda3/envs/marl/lib/python3.8/site-packages/ray/tune/trial.py\\\", line 603, in should_stop\\n    raise TuneError(\\nray.tune.error.TuneError: Stopping criteria stop_timesteps not provided in result {'episode_reward_max': -748.3982755609339, 'episode_reward_min': -797.0497149202544, 'episode_reward_mean': -767.2200162815927, 'episode_len_mean': 960.0, 'episodes_this_iter': 5, 'num_healthy_workers': 5, 'timesteps_total': 4800, 'timesteps_this_iter': 0, 'agent_timesteps_total': 4800, 'done': False, 'episodes_total': 5, 'training_iteration': 1, 'trial_id': '523f7_00000', 'experiment_id': 'e5764c9950504b189330075542e61cc4', 'date': '2023-12-19_22-19-14', 'timestamp': 1703002754, 'time_this_iter_s': 12.145829200744629, 'time_total_s': 12.145829200744629, 'pid': 80420, 'hostname': 'HPC005', 'node_ip': '10.33.1.26', 'time_since_restore': 12.145829200744629, 'timesteps_since_restore': 0, 'iterations_since_restore': 1, 'hist_stats/episode_reward': [-797.0497149202544, -752.1552538729462, -748.3982755609339, -762.2545777006725, -776.242259353157], 'hist_stats/episode_lengths': [960, 960, 960, 960, 960], 'sampler_perf/mean_raw_obs_processing_ms': 0.20015926936662654, 'sampler_perf/mean_inference_ms': 1.0284755778238253, 'sampler_perf/mean_action_processing_ms': 0.11314661024016222, 'sampler_perf/mean_env_wait_ms': 0.5996095774449121, 'sampler_perf/mean_env_render_ms': 0.0, 'timers/learn_time_ms': 2612.858, 'timers/learn_throughput': 0.765, 'timers/update_time_ms': 6.894, 'info/num_steps_sampled': 4800, 'info/num_agent_steps_sampled': 4800, 'info/num_steps_trained': 2, 'info/num_agent_steps_trained': 9600, 'info/last_target_update_ts': 4800, 'info/num_target_updates': 1, 'config/num_workers': 5, 'config/num_envs_per_worker': 1, 'config/create_env_on_driver': False, 'config/rollout_fragment_length': 1, 'config/batch_mode': 'complete_episodes', 'config/gamma': 0.99, 'config/lr': 0.0005, 'config/train_batch_size': 2, 'config/optimizer': 'rmsprop', 'config/horizon': None, 'config/soft_horizon': False, 'config/no_done_at_end': False, 'config/env': 'grouped_magym_PowerGrid', 'config/observation_space': None, 'config/action_space': None, 'config/remote_worker_envs': False, 'config/remote_env_batch_wait_ms': 0, 'config/env_task_fn': None, 'config/render_env': False, 'config/record_env': False, 'config/clip_rewards': None, 'config/normalize_actions': True, 'config/clip_actions': False, 'config/preprocessor_pref': 'deepmind', 'config/log_level': 'WARN', 'config/callbacks': <class 'ray.rllib.agents.callbacks.DefaultCallbacks'>, 'config/ignore_worker_failures': False, 'config/log_sys_usage': True, 'config/fake_sampler': False, 'config/framework': 'torch', 'config/eager_tracing': False, 'config/explore': True, 'config/evaluation_interval': 50, 'config/evaluation_num_episodes': 10, 'config/evaluation_parallel_to_training': False, 'config/in_evaluation': False, 'config/evaluation_num_workers': 0, 'config/custom_eval_function': None, 'config/sample_async': False, 'config/sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'config/observation_filter': 'NoFilter', 'config/synchronize_filters': True, 'config/compress_observations': False, 'config/collect_metrics_timeout': 180, 'config/metrics_smoothing_episodes': 100, 'config/min_iter_time_s': 1, 'config/timesteps_per_iteration': 1000, 'config/seed': 321, 'config/num_gpus': 0, 'config/_fake_gpus': False, 'config/num_cpus_per_worker': 1, 'config/num_gpus_per_worker': 0, 'config/num_cpus_for_driver': 1, 'config/placement_strategy': 'PACK', 'config/input': 'sampler', 'config/actions_in_input_normalized': False, 'config/input_evaluation': ['is', 'wis'], 'config/postprocess_inputs': False, 'config/shuffle_buffer_size': 0, 'config/output': None, 'config/output_compress_columns': ['obs', 'new_obs'], 'config/output_max_file_size': 67108864, 'config/logger_config': None, 'config/_tf_policy_handles_more_than_one_loss': False, 'config/_disable_preprocessor_api': False, 'config/simple_optimizer': False, 'config/monitor': -1, 'config/mixer': None, 'config/mixing_embed_dim': 32, 'config/double_q': True, 'config/target_network_update_freq': 100, 'config/buffer_size': 10, 'config/optim_alpha': 0.99, 'config/optim_eps': 1e-05, 'config/grad_norm_clipping': 10, 'config/learning_starts': 2, 'config/worker_side_prioritization': False, 'config/reward_standardize': True, 'config/training_intensity': None, 'perf/cpu_util_percent': 38.10588235294117, 'perf/ram_util_percent': 44.61764705882353, 'perf/gpu_util_percent0': 0.02058823529411765, 'perf/vram_util_percent0': 0.020263671875, 'config/model/_use_default_native_models': False, 'config/model/_disable_preprocessor_api': False, 'config/model/fcnet_hiddens': [256, 256], 'config/model/fcnet_activation': 'tanh', 'config/model/conv_filters': None, 'config/model/conv_activation': 'relu', 'config/model/post_fcnet_hiddens': [], 'config/model/post_fcnet_activation': 'relu', 'config/model/free_log_std': False, 'config/model/no_final_linear': False, 'config/model/vf_share_layers': True, 'config/model/use_lstm': False, 'config/model/max_seq_len': 1, 'config/model/lstm_cell_size': 64, 'config/model/lstm_use_prev_action': False, 'config/model/lstm_use_prev_reward': False, 'config/model/_time_major': False, 'config/model/use_attention': False, 'config/model/attention_num_transformer_units': 1, 'config/model/attention_dim': 64, 'config/model/attention_num_heads': 1, 'config/model/attention_head_dim': 32, 'config/model/attention_memory_inference': 50, 'config/model/attention_memory_training': 50, 'config/model/attention_position_wise_mlp_dim': 32, 'config/model/attention_init_gru_gate_bias': 2.0, 'config/model/attention_use_n_prev_actions': 0, 'config/model/attention_use_n_prev_rewards': 0, 'config/model/framestack': True, 'config/model/dim': 84, 'config/model/grayscale': False, 'config/model/zero_mean': True, 'config/model/custom_model': None, 'config/model/custom_action_dist': None, 'config/model/custom_preprocessor': None, 'config/model/lstm_use_prev_action_reward': -1, 'config/exploration_config/type': 'EpsilonGreedy', 'config/exploration_config/initial_epsilon': 1.0, 'config/exploration_config/final_epsilon': 0.05, 'config/exploration_config/epsilon_timesteps': 50000, 'config/evaluation_config/explore': False, 'config/tf_session_args/intra_op_parallelism_threads': 2, 'config/tf_session_args/inter_op_parallelism_threads': 2, 'config/tf_session_args/log_device_placement': False, 'config/tf_session_args/allow_soft_placement': True, 'config/local_tf_session_args/intra_op_parallelism_threads': 8, 'config/local_tf_session_args/inter_op_parallelism_threads': 8, 'config/multiagent/policy_map_capacity': 100, 'config/multiagent/policy_map_cache': None, 'config/multiagent/policy_mapping_fn': None, 'config/multiagent/policies_to_train': None, 'config/multiagent/observation_fn': None, 'config/multiagent/replay_mode': 'independent', 'config/multiagent/count_steps_by': 'env_steps', 'config/model/custom_model_config/env': 'magym', 'config/model/custom_model_config/mask_flag': False, 'config/model/custom_model_config/global_state_flag': False, 'config/model/custom_model_config/opp_action_in_cc': True, 'config/model/custom_model_config/agent_level_batch_update': True, 'config/model/custom_model_config/force_coop': False, 'config/model/custom_model_config/local_mode': True, 'config/model/custom_model_config/share_policy': 'all', 'config/model/custom_model_config/evaluation_interval': 50, 'config/model/custom_model_config/framework': 'torch', 'config/model/custom_model_config/num_workers': 5, 'config/model/custom_model_config/num_gpus': 0, 'config/model/custom_model_config/num_cpus_per_worker': 1, 'config/model/custom_model_config/num_gpus_per_worker': 0, 'config/model/custom_model_config/checkpoint_freq': 50, 'config/model/custom_model_config/checkpoint_end': True, 'config/model/custom_model_config/stop_iters': 9999999, 'config/model/custom_model_config/stop_timesteps': 2000000, 'config/model/custom_model_config/stop_reward': 999999, 'config/model/custom_model_config/seed': 321, 'config/model/custom_model_config/local_dir': '', 'config/model/custom_model_config/algorithm': 'iql', 'config/model/custom_model_config/space_obs': Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32)), 'config/model/custom_model_config/space_act': Discrete(9), 'config/model/custom_model_config/num_agents': 5, 'config/model/custom_model_config/episode_limit': 1, 'config/model/custom_model_config/agent_name_ls': ['1', '2', '3', '4', '5'], 'config/tf_session_args/gpu_options/allow_growth': True, 'config/tf_session_args/device_count/CPU': 1, 'config/multiagent/policies/default_policy': PolicySpec(policy_class=<class 'marllib.marl.algos.core.VD.iql_vdn_qmix.JointQPolicy'>, observation_space=None, action_space=None, config={}), 'info/learner/default_policy/learner_stats/loss': 1.0009145736694336, 'info/learner/default_policy/learner_stats/grad_norm': 1.9839861392974854, 'info/learner/default_policy/learner_stats/td_error_abs': 0.9021177571614584, 'info/learner/default_policy/learner_stats/q_taken_mean': -0.000919022798538208, 'info/learner/default_policy/learner_stats/target_mean': 0.005946451187133789, 'config/model/custom_model_config/env_args/max_steps': 960, 'config/model/custom_model_config/env_args/map_name': 'PowerGrid', 'config/model/custom_model_config/restore_path/model_path': '', 'config/model/custom_model_config/restore_path/params_path': '', 'config/model/custom_model_config/model_arch_args/hidden_state_size': 256, 'config/model/custom_model_config/model_arch_args/core_arch': 'mlp', 'config/model/custom_model_config/model_arch_args/fc_layer': 2, 'config/model/custom_model_config/model_arch_args/out_dim_fc_0': 128, 'config/model/custom_model_config/model_arch_args/out_dim_fc_1': 64, 'config/model/custom_model_config/model_arch_args/encode_layer': '128-128', 'config/model/custom_model_config/model_arch_args/mixer_embedding': 256, 'config/model/custom_model_config/model_arch_args/mixer_arch': 'qmix', 'config/model/custom_model_config/policy_mapping_info/Checkers/description': 'two team cooperate', 'config/model/custom_model_config/policy_mapping_info/Checkers/team_prefix': ('red_', 'blue_'), 'config/model/custom_model_config/policy_mapping_info/Checkers/all_agents_one_policy': True, 'config/model/custom_model_config/policy_mapping_info/Checkers/one_agent_one_policy': True, 'config/model/custom_model_config/policy_mapping_info/Switch2/description': 'two team cooperate', 'config/model/custom_model_config/policy_mapping_info/Switch2/team_prefix': ('red_', 'blue_'), 'config/model/custom_model_config/policy_mapping_info/Switch2/all_agents_one_policy': True, 'config/model/custom_model_config/policy_mapping_info/Switch2/one_agent_one_policy': True, 'config/model/custom_model_config/policy_mapping_info/PowerGrid/description': 'five team cooperate', 'config/model/custom_model_config/policy_mapping_info/PowerGrid/team_prefix': ('1', '2', '3', '4', '5'), 'config/model/custom_model_config/policy_mapping_info/PowerGrid/all_agents_one_policy': True, 'config/model/custom_model_config/policy_mapping_info/PowerGrid/one_agent_one_policy': True}.\\n\",\n  \"trial_name_creator\": null,\n  \"custom_trial_name\": null,\n  \"custom_dirname\": null,\n  \"saving_to\": null,\n  \"remote_checkpoint_dir_prefix\": null,\n  \"sync_to_cloud\": null,\n  \"checkpoint_freq\": 50,\n  \"checkpoint_at_end\": true,\n  \"keep_checkpoints_num\": null,\n  \"checkpoint_score_attr\": \"training_iteration\",\n  \"sync_on_checkpoint\": true,\n  \"checkpoint_manager\": {\n    \"_type\": \"CLOUDPICKLE_FALLBACK\",\n    \"value\": \"80059566010000000000008c1b7261792e74756e652e636865636b706f696e745f6d616e61676572948c11436865636b706f696e744d616e616765729493942981947d94288c146b6565705f636865636b706f696e74735f6e756d94477ff00000000000008c165f636865636b706f696e745f73636f72655f6465736394898c165f636865636b706f696e745f73636f72655f61747472948c12747261696e696e675f697465726174696f6e948c1c6e65776573745f70657273697374656e745f636865636b706f696e749468008c0a436865636b706f696e749493942981947d94288c0773746f72616765948c0a70657273697374656e74948c0576616c7565944e8c06726573756c74947d9475628c195f6e65776573745f6d656d6f72795f636865636b706f696e7494680b2981947d9428680e8c066d656d6f72799468104e68117d9475628c115f626573745f636865636b706f696e7473945d948c0b5f6d656d62657273686970948f9475622e\"\n  },\n  \"restore_path\": null,\n  \"restoring_from\": null,\n  \"num_failures\": 1,\n  \"has_new_resources\": false,\n  \"results\": \"80054e2e\",\n  \"best_result\": \"80054e2e\",\n  \"param_config\": \"80054e2e\",\n  \"extra_arg\": \"80054e2e\",\n  \"_state_json\": null,\n  \"_state_valid\": false\n}"
  ],
  "runner_data": {
    "_max_pending_trials": 16,
    "_metric": null,
    "_total_time": 12.145829200744629,
    "_iteration": 3,
    "_has_errored": true,
    "_fail_fast": false,
    "_server_port": null,
    "_cached_trial_decisions": {},
    "_queued_trial_decisions": {},
    "_updated_queue": true,
    "_result_wait_time": 1,
    "_should_stop_experiment": false,
    "_local_checkpoint_dir": "/home/cail005/Documents/nZEC/MARLlib/exp_results/iql_mlp_PowerGrid",
    "_remote_checkpoint_dir": null,
    "_stopper": {
      "_type": "CLOUDPICKLE_FALLBACK",
      "value": "80059527000000000000008c107261792e74756e652e73746f70706572948c0b4e6f6f7053746f707065729493942981942e"
    },
    "_resumed": false,
    "_start_time": 1703002741.8443549,
    "_last_checkpoint_time": -Infinity,
    "_session_str": "2023-12-19_22-19-01",
    "checkpoint_file": "/home/cail005/Documents/nZEC/MARLlib/exp_results/iql_mlp_PowerGrid/experiment_state-2023-12-19_22-19-01.json",
    "_checkpoint_period": "auto",
    "launch_web_server": false
  },
  "stats": {
    "start_time": 1703002741.8443549,
    "timestamp": 1703002754.3849387
  }
}