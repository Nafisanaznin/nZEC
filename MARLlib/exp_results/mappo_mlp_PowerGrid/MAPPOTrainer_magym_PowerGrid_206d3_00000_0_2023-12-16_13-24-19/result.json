{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 8718.303, "sample_throughput": 2294.024, "load_time_ms": 0.561, "load_throughput": 35635548.003, "learn_time_ms": 997.855, "learn_throughput": 20042.988, "update_time_ms": 8.238}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 107.9365005493164, "policy_loss": -0.0005186998605726245, "vf_loss": 107.95893096923828, "vf_explained_var": -2.0384788513183594e-05, "kl": 0.00029797626367442445, "entropy": 2.196892738342285, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-24-29", "timestamp": 1702711469, "time_this_iter_s": 9.712210893630981, "time_total_s": 9.712210893630981, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984089700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.712210893630981, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.9, "ram_util_percent": 50.57142857142857, "gpu_util_percent0": 0.014285714285714287, "vram_util_percent0": 0.01583426339285714}}
{"episode_reward_max": -769.8845881561185, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -787.5991142551395, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32101040851466733, "mean_inference_ms": 1.1644037867396564, "mean_action_processing_ms": 0.0887622392453081, "mean_env_wait_ms": 0.5466010554145082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 9075.714, "sample_throughput": 2203.683, "load_time_ms": 0.413, "load_throughput": 48391162.388, "learn_time_ms": 974.272, "learn_throughput": 20528.148, "update_time_ms": 8.93}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 85.49197387695312, "policy_loss": -0.0006219173550605639, "vf_loss": 85.51449966430664, "vf_explained_var": -0.0002983212471008301, "kl": 0.0003031129552599765, "entropy": 2.1933984756469727, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5, "training_iteration": 2, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-24-39", "timestamp": 1702711479, "time_this_iter_s": 9.362988233566284, "time_total_s": 19.075199127197266, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798422a040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.075199127197266, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.8, "ram_util_percent": 51.783333333333324, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -700.899942500692, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -759.7973971681266, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3207225192034936, "mean_inference_ms": 1.1606938125127868, "mean_action_processing_ms": 0.08846080249036278, "mean_env_wait_ms": 0.5454598638179964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 9184.272, "sample_throughput": 2177.636, "load_time_ms": 0.351, "load_throughput": 56910502.035, "learn_time_ms": 979.009, "learn_throughput": 20428.825, "update_time_ms": 8.738}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 68.1824951171875, "policy_loss": -0.0008667904071515409, "vf_loss": 68.20519256591797, "vf_explained_var": 0.000398784875869751, "kl": 0.00042566182038894507, "entropy": 2.1841989755630493, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 3, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-24-48", "timestamp": 1702711488, "time_this_iter_s": 9.414638042449951, "time_total_s": 28.489837169647217, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841619d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28.489837169647217, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.53076923076923, "ram_util_percent": 52.17692307692309, "gpu_util_percent0": 0.004615384615384616, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -645.2389320904115, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -730.2557201340138, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32042710678252495, "mean_inference_ms": 1.1590994209848973, "mean_action_processing_ms": 0.08825373052391533, "mean_env_wait_ms": 0.5444177691009056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 9253.277, "sample_throughput": 2161.397, "load_time_ms": 0.32, "load_throughput": 62566533.657, "learn_time_ms": 971.882, "learn_throughput": 20578.621, "update_time_ms": 8.419}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 62.22048759460449, "policy_loss": -0.0005343070905681202, "vf_loss": 62.24267768859863, "vf_explained_var": 0.00016683340072631836, "kl": 0.0005313884915560396, "entropy": 2.1662652492523193, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 4, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-24-57", "timestamp": 1702711497, "time_this_iter_s": 9.396338939666748, "time_total_s": 37.886176109313965, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984089820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37.886176109313965, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.800000000000004, "ram_util_percent": 52.7, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -597.9559957891646, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -702.1433046202656, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3202865680663164, "mean_inference_ms": 1.1579855609856193, "mean_action_processing_ms": 0.08809800072243998, "mean_env_wait_ms": 0.5436342747592814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 9286.997, "sample_throughput": 2153.549, "load_time_ms": 0.301, "load_throughput": 66470744.849, "learn_time_ms": 966.393, "learn_throughput": 20695.521, "update_time_ms": 8.268}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 50.58206748962402, "policy_loss": -0.0007153003936650748, "vf_loss": 50.60416030883789, "vf_explained_var": -0.00046062469482421875, "kl": 0.0005925945471042327, "entropy": 2.1383566856384277, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 5, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-25-07", "timestamp": 1702711507, "time_this_iter_s": 9.39295244216919, "time_total_s": 47.279128551483154, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99c5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 47.279128551483154, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.74166666666667, "ram_util_percent": 52.64166666666666, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -553.9327308415195, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -675.5497341606168, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3200283539372304, "mean_inference_ms": 1.1571453760848565, "mean_action_processing_ms": 0.08797785151898418, "mean_env_wait_ms": 0.5430346602210027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 9305.216, "sample_throughput": 2149.332, "load_time_ms": 0.291, "load_throughput": 68740300.464, "learn_time_ms": 970.017, "learn_throughput": 20618.199, "update_time_ms": 8.446}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 48.060447692871094, "policy_loss": -0.0009621955699294915, "vf_loss": 48.0823974609375, "vf_explained_var": 0.000357210636138916, "kl": 0.000679884848678286, "entropy": 2.099382758140564, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 6, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-25-16", "timestamp": 1702711516, "time_this_iter_s": 9.416118621826172, "time_total_s": 56.695247173309326, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798416e9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 56.695247173309326, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.884615384615383, "ram_util_percent": 52.41538461538461, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -553.9327308415195, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -675.5497341606168, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3200283539372304, "mean_inference_ms": 1.1571453760848565, "mean_action_processing_ms": 0.08797785151898418, "mean_env_wait_ms": 0.5430346602210027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 9326.541, "sample_throughput": 2144.418, "load_time_ms": 0.282, "load_throughput": 70978189.29, "learn_time_ms": 968.521, "learn_throughput": 20650.047, "update_time_ms": 8.397}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 36.36393737792969, "policy_loss": -0.0012936111450194687, "vf_loss": 36.38569641113281, "vf_explained_var": -0.00022298097610473633, "kl": 0.000803999138478062, "entropy": 2.0465705394744873, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 7, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-25-26", "timestamp": 1702711526, "time_this_iter_s": 9.404050588607788, "time_total_s": 66.09929776191711, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798416e5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.09929776191711, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.71538461538462, "ram_util_percent": 52.83076923076922, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -437.7990613133412, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -641.9523606428521, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3198043077137179, "mean_inference_ms": 1.156465319534881, "mean_action_processing_ms": 0.08791290207363156, "mean_env_wait_ms": 0.5425918661737473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 9350.155, "sample_throughput": 2139.002, "load_time_ms": 0.274, "load_throughput": 72960278.321, "learn_time_ms": 969.469, "learn_throughput": 20629.86, "update_time_ms": 8.345}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 22.121455192565918, "policy_loss": -0.00153677843939512, "vf_loss": 22.142767906188965, "vf_explained_var": -0.0005951523780822754, "kl": 0.0008842092347319253, "entropy": 1.9779821038246155, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 8, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-25-35", "timestamp": 1702711535, "time_this_iter_s": 9.506498336791992, "time_total_s": 75.6057960987091, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984237e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 75.6057960987091, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.916666666666668, "ram_util_percent": 52.85833333333332, "gpu_util_percent0": 0.004166666666666667, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -394.05463320337066, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -608.4350170097548, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31968732163673863, "mean_inference_ms": 1.1559555085610476, "mean_action_processing_ms": 0.08786259290826365, "mean_env_wait_ms": 0.5423948884264334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 9369.071, "sample_throughput": 2134.683, "load_time_ms": 0.269, "load_throughput": 74411070.373, "learn_time_ms": 971.235, "learn_throughput": 20592.331, "update_time_ms": 8.307}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 15.614205360412598, "policy_loss": -0.0007481071244921367, "vf_loss": 15.633935928344727, "vf_explained_var": 0.00028637051582336426, "kl": 0.0008095359731579155, "entropy": 1.898180365562439, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 9, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-25-45", "timestamp": 1702711545, "time_this_iter_s": 9.4901282787323, "time_total_s": 85.0959243774414, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79935720d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 85.0959243774414, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.77692307692308, "ram_util_percent": 52.9076923076923, "gpu_util_percent0": 0.013846153846153845, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -330.6747169257905, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -576.6383529659513, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3196394257514248, "mean_inference_ms": 1.1554772375842826, "mean_action_processing_ms": 0.08780892890627802, "mean_env_wait_ms": 0.542222413510882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 9378.244, "sample_throughput": 2132.595, "load_time_ms": 0.292, "load_throughput": 68450493.676, "learn_time_ms": 971.183, "learn_throughput": 20593.432, "update_time_ms": 8.331}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 11.656019687652588, "policy_loss": -0.0011289993248873031, "vf_loss": 11.675323009490967, "vf_explained_var": -3.993511199951172e-05, "kl": 0.0006572390696573116, "entropy": 1.8174362182617188, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 10, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-25-54", "timestamp": 1702711554, "time_this_iter_s": 9.42299747467041, "time_total_s": 94.51892185211182, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79842304c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 94.51892185211182, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.753846153846155, "ram_util_percent": 53.23846153846153, "gpu_util_percent0": 0.014615384615384615, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -260.15491483229073, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -544.5127868708273, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3196463150896576, "mean_inference_ms": 1.155102080842179, "mean_action_processing_ms": 0.08776029853328465, "mean_env_wait_ms": 0.542048408616259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 9453.246, "sample_throughput": 2115.675, "load_time_ms": 0.258, "load_throughput": 77485756.512, "learn_time_ms": 967.288, "learn_throughput": 20676.363, "update_time_ms": 8.274}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 7.048476457595825, "policy_loss": -0.0009879097081721966, "vf_loss": 7.066859483718872, "vf_explained_var": -0.00015085935592651367, "kl": 0.0005726430667516436, "entropy": 1.739557921886444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 11, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-26-04", "timestamp": 1702711564, "time_this_iter_s": 9.429666757583618, "time_total_s": 103.94858860969543, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984230700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 103.94858860969543, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.49166666666667, "ram_util_percent": 53.275, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -210.35999056146807, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -514.4243854732329, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31963978323438264, "mean_inference_ms": 1.154884418613348, "mean_action_processing_ms": 0.08771870116701884, "mean_env_wait_ms": 0.5419067191019735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 9458.672, "sample_throughput": 2114.462, "load_time_ms": 0.253, "load_throughput": 78907045.433, "learn_time_ms": 969.122, "learn_throughput": 20637.235, "update_time_ms": 8.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 4.776568651199341, "policy_loss": -0.0007847709454580354, "vf_loss": 4.793991804122925, "vf_explained_var": 4.8041343688964844e-05, "kl": 0.0005025363604136412, "entropy": 1.6638460755348206, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 12, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-26-13", "timestamp": 1702711573, "time_this_iter_s": 9.472208976745605, "time_total_s": 113.42079758644104, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984089b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 113.42079758644104, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.94615384615384, "ram_util_percent": 53.25384615384616, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -210.35999056146807, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -514.4243854732329, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31963978323438264, "mean_inference_ms": 1.154884418613348, "mean_action_processing_ms": 0.08771870116701884, "mean_env_wait_ms": 0.5419067191019735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 9469.074, "sample_throughput": 2112.139, "load_time_ms": 0.253, "load_throughput": 78973903.22, "learn_time_ms": 967.808, "learn_throughput": 20665.26, "update_time_ms": 8.191}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 3.6710606813430786, "policy_loss": -0.0005892499916271277, "vf_loss": 3.6875948905944824, "vf_explained_var": -0.00010645389556884766, "kl": 0.00041951780344617884, "entropy": 1.5945119261741638, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 13, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-26-23", "timestamp": 1702711583, "time_this_iter_s": 9.487781524658203, "time_total_s": 122.90857911109924, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99cb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 122.90857911109924, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.876923076923074, "ram_util_percent": 53.26923076923077, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -183.28597028470205, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -486.61261246763615, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31962536603059427, "mean_inference_ms": 1.1547697404098722, "mean_action_processing_ms": 0.08768527177162584, "mean_env_wait_ms": 0.5418381474863718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 9473.209, "sample_throughput": 2111.217, "load_time_ms": 0.253, "load_throughput": 79055772.312, "learn_time_ms": 970.344, "learn_throughput": 20611.25, "update_time_ms": 8.245}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 2.1542783975601196, "policy_loss": -0.0002926557644737926, "vf_loss": 2.16989266872406, "vf_explained_var": 0.00029587745666503906, "kl": 0.0003176334179830764, "entropy": 1.5321511030197144, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 55, "training_iteration": 14, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-26-32", "timestamp": 1702711592, "time_this_iter_s": 9.474757194519043, "time_total_s": 132.3833363056183, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984237a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 132.3833363056183, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.033333333333335, "ram_util_percent": 53.21666666666667, "gpu_util_percent0": 0.0033333333333333335, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -177.99210640381597, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -462.0999398920076, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31961348182021576, "mean_inference_ms": 1.1546652443758112, "mean_action_processing_ms": 0.08765571891978301, "mean_env_wait_ms": 0.5418091996807175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 9479.98, "sample_throughput": 2109.709, "load_time_ms": 0.254, "load_throughput": 78862536.429, "learn_time_ms": 973.11, "learn_throughput": 20552.657, "update_time_ms": 8.288}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 1.2970731854438782, "policy_loss": -0.00019838333642119288, "vf_loss": 1.3120632767677307, "vf_explained_var": -0.00044924020767211914, "kl": 0.0002395827099752612, "entropy": 1.4791690111160278, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 15, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-26-42", "timestamp": 1702711602, "time_this_iter_s": 9.463657140731812, "time_total_s": 141.8469934463501, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 141.8469934463501, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.72307692307692, "ram_util_percent": 53.35384615384615, "gpu_util_percent0": 0.00923076923076923, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -439.87644717845455, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3196198348017122, "mean_inference_ms": 1.1546001349739052, "mean_action_processing_ms": 0.08763266800733129, "mean_env_wait_ms": 0.5418257538228776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 9495.398, "sample_throughput": 2106.283, "load_time_ms": 0.252, "load_throughput": 79369930.93, "learn_time_ms": 971.164, "learn_throughput": 20593.848, "update_time_ms": 8.346}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 1.260764718055725, "policy_loss": -4.1765594307907605e-05, "vf_loss": 1.275162398815155, "vf_explained_var": -0.0004971027374267578, "kl": 0.00013443209544340695, "entropy": 1.4355964660644531, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 65, "training_iteration": 16, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-26-51", "timestamp": 1702711611, "time_this_iter_s": 9.524346590042114, "time_total_s": 151.3713400363922, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 151.3713400363922, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.969230769230766, "ram_util_percent": 53.353846153846135, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -421.0075064094521, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31963467726497335, "mean_inference_ms": 1.1546158833898186, "mean_action_processing_ms": 0.08761428503584273, "mean_env_wait_ms": 0.5418647163885958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 9507.824, "sample_throughput": 2103.531, "load_time_ms": 0.252, "load_throughput": 79422533.611, "learn_time_ms": 974.096, "learn_throughput": 20531.865, "update_time_ms": 8.41}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 1.165444791316986, "policy_loss": 1.517829866060083e-05, "vf_loss": 1.1794626712799072, "vf_explained_var": 0.00014483928680419922, "kl": 5.956202957935197e-05, "entropy": 1.403328776359558, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 17, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-01", "timestamp": 1702711621, "time_this_iter_s": 9.574601173400879, "time_total_s": 160.9459412097931, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 160.9459412097931, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.876923076923074, "ram_util_percent": 53.369230769230754, "gpu_util_percent0": 0.0015384615384615385, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -404.56661300034426, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3196421788466189, "mean_inference_ms": 1.1546704347708274, "mean_action_processing_ms": 0.08759921459985165, "mean_env_wait_ms": 0.5418926306740006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 9510.134, "sample_throughput": 2103.02, "load_time_ms": 0.252, "load_throughput": 79392466.402, "learn_time_ms": 974.76, "learn_throughput": 20517.874, "update_time_ms": 8.356}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 1.0375174283981323, "policy_loss": 3.1395913607568104e-05, "vf_loss": 1.0513129234313965, "vf_explained_var": -0.0002796649932861328, "kl": 2.275391070205579e-05, "entropy": 1.3826923370361328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 18, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-10", "timestamp": 1702711630, "time_this_iter_s": 9.50573468208313, "time_total_s": 170.45167589187622, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798424d5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 170.45167589187622, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.683333333333334, "ram_util_percent": 53.33333333333332, "gpu_util_percent0": 0.004166666666666667, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -404.56661300034426, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3196421788466189, "mean_inference_ms": 1.1546704347708274, "mean_action_processing_ms": 0.08759921459985165, "mean_env_wait_ms": 0.5418926306740006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 9510.097, "sample_throughput": 2103.028, "load_time_ms": 0.252, "load_throughput": 79460149.664, "learn_time_ms": 972.962, "learn_throughput": 20555.793, "update_time_ms": 8.405}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 1.0917599201202393, "policy_loss": -3.833007909292974e-06, "vf_loss": 1.1055244207382202, "vf_explained_var": -0.0003535747528076172, "kl": 4.3410597042936594e-05, "entropy": 1.3760517239570618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 19, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-20", "timestamp": 1702711640, "time_this_iter_s": 9.4807288646698, "time_total_s": 179.93240475654602, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c611af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 179.93240475654602, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.77692307692308, "ram_util_percent": 53.26923076923076, "gpu_util_percent0": 0.01846153846153846, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -390.18094453815985, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3196619462502971, "mean_inference_ms": 1.1547146016499332, "mean_action_processing_ms": 0.08758311862942761, "mean_env_wait_ms": 0.5419198100745202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 9511.642, "sample_throughput": 2102.686, "load_time_ms": 0.223, "load_throughput": 89669780.866, "learn_time_ms": 976.601, "learn_throughput": 20479.194, "update_time_ms": 8.395}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 0.9255667924880981, "policy_loss": 3.323345245442866e-05, "vf_loss": 0.9393227994441986, "vf_explained_var": 0.00012806057929992676, "kl": 4.2818810620737224e-05, "entropy": 1.3789225220680237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 20, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-29", "timestamp": 1702711649, "time_this_iter_s": 9.4911470413208, "time_total_s": 189.42355179786682, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984161280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 189.42355179786682, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.846153846153847, "ram_util_percent": 53.38461538461539, "gpu_util_percent0": 0.013846153846153845, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -377.6236733394634, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31969156954809264, "mean_inference_ms": 1.154767757612052, "mean_action_processing_ms": 0.08756696846266565, "mean_env_wait_ms": 0.5419298546530193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 9518.578, "sample_throughput": 2101.154, "load_time_ms": 0.223, "load_throughput": 89583596.754, "learn_time_ms": 979.244, "learn_throughput": 20423.918, "update_time_ms": 8.434}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 0.8356766998767853, "policy_loss": -6.267585700925338e-05, "vf_loss": 0.849574625492096, "vf_explained_var": -0.0005308985710144043, "kl": 4.681662266259323e-05, "entropy": 1.3835158348083496, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 85, "training_iteration": 21, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-39", "timestamp": 1702711659, "time_this_iter_s": 9.494894981384277, "time_total_s": 198.9184467792511, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798424d5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 198.9184467792511, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.858333333333334, "ram_util_percent": 53.383333333333326, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -366.27919561388927, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31972617458604324, "mean_inference_ms": 1.1548433232150015, "mean_action_processing_ms": 0.08755462675959952, "mean_env_wait_ms": 0.5419378329261116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 9526.248, "sample_throughput": 2099.462, "load_time_ms": 0.224, "load_throughput": 89354580.315, "learn_time_ms": 981.595, "learn_throughput": 20375.001, "update_time_ms": 8.328}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 0.8330585956573486, "policy_loss": -3.488120951811169e-05, "vf_loss": 0.8469918966293335, "vf_explained_var": -0.00043773651123046875, "kl": 6.623585677956179e-05, "entropy": 1.3898359537124634, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 90, "training_iteration": 22, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-48", "timestamp": 1702711668, "time_this_iter_s": 9.545830249786377, "time_total_s": 208.46427702903748, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99c5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 208.46427702903748, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.676923076923075, "ram_util_percent": 53.54615384615385, "gpu_util_percent0": 0.013846153846153848, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -356.16527218511465, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31975778116269976, "mean_inference_ms": 1.1549046799223655, "mean_action_processing_ms": 0.08754316835428025, "mean_env_wait_ms": 0.5419317681576348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 9523.4, "sample_throughput": 2100.09, "load_time_ms": 0.225, "load_throughput": 88909464.759, "learn_time_ms": 982.184, "learn_throughput": 20362.773, "update_time_ms": 8.349}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005, "total_loss": 0.8055128157138824, "policy_loss": 2.348613750768891e-05, "vf_loss": 0.8194508850574493, "vf_explained_var": -0.00022673606872558594, "kl": 4.8957498856250226e-05, "entropy": 1.3961588144302368, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 95, "training_iteration": 23, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-27-58", "timestamp": 1702711678, "time_this_iter_s": 9.444011449813843, "time_total_s": 217.90828847885132, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99cb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 217.90828847885132, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.37692307692307, "ram_util_percent": 53.46923076923077, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -347.00401270637633, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197804357702603, "mean_inference_ms": 1.154967801468558, "mean_action_processing_ms": 0.08753340582202838, "mean_env_wait_ms": 0.5419402792461568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 9526.406, "sample_throughput": 2099.428, "load_time_ms": 0.225, "load_throughput": 88843550.095, "learn_time_ms": 982.452, "learn_throughput": 20357.23, "update_time_ms": 8.378}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 0.7106844186782837, "policy_loss": -2.8875159370223002e-05, "vf_loss": 0.7247457206249237, "vf_explained_var": -0.00024962425231933594, "kl": 3.061259837577879e-05, "entropy": 1.403242290019989, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 24, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-28-07", "timestamp": 1702711687, "time_this_iter_s": 9.504826784133911, "time_total_s": 227.41311526298523, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984081c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 227.41311526298523, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.03333333333333, "ram_util_percent": 53.725, "gpu_util_percent0": 0.013333333333333334, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -803.6379558943471, "episode_reward_mean": -347.00401270637633, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6153821316639, -803.6379558943471, -791.7608733340893, -778.0967717594785, -769.8845881561185, -733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197804357702603, "mean_inference_ms": 1.154967801468558, "mean_action_processing_ms": 0.08753340582202838, "mean_env_wait_ms": 0.5419402792461568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 9528.518, "sample_throughput": 2098.962, "load_time_ms": 0.224, "load_throughput": 89088870.008, "learn_time_ms": 982.686, "learn_throughput": 20352.38, "update_time_ms": 8.575}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005, "total_loss": 0.7222098708152771, "policy_loss": -7.702979903001506e-05, "vf_loss": 0.736425518989563, "vf_explained_var": -0.00041031837463378906, "kl": 3.640513193636785e-05, "entropy": 1.4138616919517517, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 25, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-28-17", "timestamp": 1702711697, "time_this_iter_s": 9.487311124801636, "time_total_s": 236.90042638778687, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841f6700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 236.90042638778687, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.799999999999997, "ram_util_percent": 53.83076923076923, "gpu_util_percent0": 0.007692307692307693, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -747.5365620282599, "episode_reward_mean": -316.2942796429404, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733.3122476760456, -738.8936078311933, -700.899942500692, -739.3360403693778, -747.5365620282599, -659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197425553911395, "mean_inference_ms": 1.1545667234222667, "mean_action_processing_ms": 0.08746032461307808, "mean_env_wait_ms": 0.5417129183627621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 9523.263, "sample_throughput": 2100.12, "load_time_ms": 0.224, "load_throughput": 89117263.359, "learn_time_ms": 987.239, "learn_throughput": 20258.523, "update_time_ms": 8.488}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 0.6449079811573029, "policy_loss": 4.91199473673376e-06, "vf_loss": 0.6591773331165314, "vf_explained_var": -4.297494888305664e-05, "kl": 3.6397664423093445e-05, "entropy": 1.4274324178695679, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 105, "training_iteration": 26, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-28-26", "timestamp": 1702711706, "time_this_iter_s": 9.514691591262817, "time_total_s": 246.41511797904968, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841f63a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 246.41511797904968, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.9, "ram_util_percent": 54.01538461538462, "gpu_util_percent0": 0.004615384615384616, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -693.7882113738302, "episode_reward_mean": -288.37177410142715, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-659.3858345338223, -684.8846599586046, -672.5641923722729, -693.7882113738302, -645.2389320904115, -611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197353178469961, "mean_inference_ms": 1.1545710484968383, "mean_action_processing_ms": 0.08741693440596242, "mean_env_wait_ms": 0.5416068939505836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 9528.038, "sample_throughput": 2099.068, "load_time_ms": 0.224, "load_throughput": 89307015.863, "learn_time_ms": 987.494, "learn_throughput": 20253.292, "update_time_ms": 8.376}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 0.6334825754165649, "policy_loss": -7.842254559520256e-06, "vf_loss": 0.6478863060474396, "vf_explained_var": -0.00039440393447875977, "kl": 4.4528198901439e-05, "entropy": 1.4395889043807983, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 110, "training_iteration": 27, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-28-36", "timestamp": 1702711716, "time_this_iter_s": 9.581430673599243, "time_total_s": 255.99654865264893, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841c85e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 255.99654865264893, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 29.858333333333334, "ram_util_percent": 54.07500000000001, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -641.932521703143, "episode_reward_mean": -263.3965226900564, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-611.8273066786619, -597.9559957891646, -641.932521703143, -606.8001870142058, -630.5142792099266, -577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197691075653031, "mean_inference_ms": 1.1546653581229371, "mean_action_processing_ms": 0.08739018288327277, "mean_env_wait_ms": 0.5416117733688651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 9539.61, "sample_throughput": 2096.522, "load_time_ms": 0.224, "load_throughput": 89335548.456, "learn_time_ms": 989.21, "learn_throughput": 20218.152, "update_time_ms": 8.562}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 0.7078956067562103, "policy_loss": -5.8654593274809486e-05, "vf_loss": 0.7224624156951904, "vf_explained_var": -0.0002461075782775879, "kl": 6.681915893391732e-05, "entropy": 1.450808048248291, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 115, "training_iteration": 28, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-28-46", "timestamp": 1702711726, "time_this_iter_s": 9.636413097381592, "time_total_s": 265.6329617500305, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798424d670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.6329617500305, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.907692307692304, "ram_util_percent": 53.93076923076922, "gpu_util_percent0": 0.008461538461538461, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -588.0104946459137, "episode_reward_mean": -241.2896238469957, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-577.1924542321126, -553.9327308415195, -562.8826545482319, -563.8589273423339, -588.0104946459137, -437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31980491234700326, "mean_inference_ms": 1.1548112706498121, "mean_action_processing_ms": 0.08737201728107216, "mean_env_wait_ms": 0.541678659312581, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 9540.299, "sample_throughput": 2096.37, "load_time_ms": 0.224, "load_throughput": 89364099.286, "learn_time_ms": 990.896, "learn_throughput": 20183.756, "update_time_ms": 8.508}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005, "total_loss": 0.6312616467475891, "policy_loss": -0.0001792326027758584, "vf_loss": 0.646041601896286, "vf_explained_var": -0.00014531612396240234, "kl": 0.00014485102036143616, "entropy": 1.460074543952942, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 29, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-28-55", "timestamp": 1702711735, "time_this_iter_s": 9.486948251724243, "time_total_s": 275.11991000175476, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99c5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 275.11991000175476, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.5, "ram_util_percent": 54.03076923076924, "gpu_util_percent0": 0.0023076923076923075, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -493.2085695685738, "episode_reward_mean": -221.5661593341232, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31989608639723977, "mean_inference_ms": 1.155054152086802, "mean_action_processing_ms": 0.0873629337926475, "mean_env_wait_ms": 0.541791093510382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 9564.018, "sample_throughput": 2091.171, "load_time_ms": 0.225, "load_throughput": 89032137.55, "learn_time_ms": 988.786, "learn_throughput": 20226.824, "update_time_ms": 8.525}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005, "total_loss": 0.6240688562393188, "policy_loss": 0.00010424766880445802, "vf_loss": 0.6386263966560364, "vf_explained_var": -0.00036209821701049805, "kl": 0.0001116346206830876, "entropy": 1.4661798477172852, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 30, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-29-05", "timestamp": 1702711745, "time_this_iter_s": 9.689507484436035, "time_total_s": 284.8094174861908, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841c8820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 284.8094174861908, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 31.22307692307692, "ram_util_percent": 54.07692307692309, "gpu_util_percent0": 0.013846153846153845, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -493.2085695685738, "episode_reward_mean": -221.5661593341232, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-437.7990613133412, -473.3304383789147, -493.2085695685738, -487.45842604784593, -478.0309699614692, -400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31989608639723977, "mean_inference_ms": 1.155054152086802, "mean_action_processing_ms": 0.0873629337926475, "mean_env_wait_ms": 0.541791093510382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 9640.932, "sample_throughput": 2074.488, "load_time_ms": 0.225, "load_throughput": 88843550.095, "learn_time_ms": 991.812, "learn_throughput": 20165.117, "update_time_ms": 8.51}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005, "total_loss": 0.5059768408536911, "policy_loss": -3.8643647247482704e-05, "vf_loss": 0.5207451581954956, "vf_explained_var": -0.0007454156875610352, "kl": 5.8398304760398645e-05, "entropy": 1.4729664325714111, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 31, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-29-15", "timestamp": 1702711755, "time_this_iter_s": 10.310856819152832, "time_total_s": 295.1202743053436, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99cb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 295.1202743053436, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 35.74615384615384, "ram_util_percent": 54.14615384615385, "gpu_util_percent0": 0.06153846153846154, "vram_util_percent0": 0.015850360576923076}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -436.6224235042331, "episode_reward_mean": -206.50235395674645, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.06054475078184, -394.05463320337066, -436.6224235042331, -403.4125810063596, -402.50459359110624, -369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3200835529924936, "mean_inference_ms": 1.1556339552809407, "mean_action_processing_ms": 0.08737001506660201, "mean_env_wait_ms": 0.5420324131053598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 9694.725, "sample_throughput": 2062.978, "load_time_ms": 0.225, "load_throughput": 88693254.388, "learn_time_ms": 993.142, "learn_throughput": 20138.103, "update_time_ms": 8.589}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005, "total_loss": 0.6249322593212128, "policy_loss": -3.068027579011812e-05, "vf_loss": 0.6397349834442139, "vf_explained_var": -1.823902130126953e-05, "kl": 5.7892173553231174e-05, "entropy": 1.477206826210022, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 130, "training_iteration": 32, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-29-25", "timestamp": 1702711765, "time_this_iter_s": 10.06797456741333, "time_total_s": 305.18824887275696, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841f6310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 305.18824887275696, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.82857142857143, "ram_util_percent": 54.10000000000001, "gpu_util_percent0": 0.0742857142857143, "vram_util_percent0": 0.015927269345238092}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -369.6819119961267, "episode_reward_mean": -194.88735369240558, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-369.6819119961267, -349.4192040068658, -330.6747169257905, -359.9799119279056, -360.5527784399435, -260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.320313053876597, "mean_inference_ms": 1.1564253477384814, "mean_action_processing_ms": 0.08739147572649043, "mean_env_wait_ms": 0.5423158417358623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 9800.569, "sample_throughput": 2040.698, "load_time_ms": 0.227, "load_throughput": 88078622.428, "learn_time_ms": 1006.336, "learn_throughput": 19874.086, "update_time_ms": 8.645}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005, "total_loss": 0.6240922212600708, "policy_loss": -4.2984010116597915e-05, "vf_loss": 0.6389533579349518, "vf_explained_var": -0.00011289119720458984, "kl": 4.111298004061403e-05, "entropy": 1.4818198084831238, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 135, "training_iteration": 33, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-29-36", "timestamp": 1702711776, "time_this_iter_s": 10.616925954818726, "time_total_s": 315.8051748275757, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79841c8c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 315.8051748275757, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.99999999999999, "ram_util_percent": 54.02142857142858, "gpu_util_percent0": 0.13285714285714287, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -165.86063621913374, "episode_reward_min": -311.9270779398067, "episode_reward_mean": -185.99402274054017, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260.15491483229073, -287.9614738166359, -302.73955430428526, -311.9270779398067, -274.7582696561625, -259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3205666955800826, "mean_inference_ms": 1.1573602276981063, "mean_action_processing_ms": 0.08742630819453391, "mean_env_wait_ms": 0.5426422157240642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 9870.623, "sample_throughput": 2026.215, "load_time_ms": 0.229, "load_throughput": 87508950.553, "learn_time_ms": 1005.796, "learn_throughput": 19884.755, "update_time_ms": 8.667}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005, "total_loss": 0.6197983920574188, "policy_loss": 2.7111052682826653e-06, "vf_loss": 0.6346761882305145, "vf_explained_var": -0.0005310773849487305, "kl": 3.789207991559962e-05, "entropy": 1.4880489706993103, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 34, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-29-46", "timestamp": 1702711786, "time_this_iter_s": 10.064828157424927, "time_total_s": 325.8700029850006, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798c99cb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 325.8700029850006, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.784615384615385, "ram_util_percent": 54.19230769230769, "gpu_util_percent0": 0.0676923076923077, "vram_util_percent0": 0.015837840544871792}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -259.97015077014277, "episode_reward_mean": -180.2036384224223, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-259.97015077014277, -210.35999056146807, -251.21221916849674, -251.66429630521336, -244.93720766908783, -191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32083763119426395, "mean_inference_ms": 1.1584106937553498, "mean_action_processing_ms": 0.08747249833626557, "mean_env_wait_ms": 0.5430369138363268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 9938.713, "sample_throughput": 2012.333, "load_time_ms": 0.228, "load_throughput": 87572899.05, "learn_time_ms": 1006.893, "learn_throughput": 19863.093, "update_time_ms": 8.465}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005, "total_loss": 0.5140031278133392, "policy_loss": -6.865596678196084e-05, "vf_loss": 0.5289885103702545, "vf_explained_var": 0.00011733174324035645, "kl": 3.8587512453558404e-05, "entropy": 1.491676390171051, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 145, "training_iteration": 35, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-29-56", "timestamp": 1702711796, "time_this_iter_s": 10.173254251480103, "time_total_s": 336.0432572364807, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798422af70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 336.0432572364807, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 33.79230769230769, "ram_util_percent": 54.24615384615385, "gpu_util_percent0": 0.0576923076923077, "vram_util_percent0": 0.015787760416666664}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -236.76210504007383, "episode_reward_mean": -176.76452460302374, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3211993618060605, "mean_inference_ms": 1.1597122358695922, "mean_action_processing_ms": 0.08754194663496025, "mean_env_wait_ms": 0.5435544125939743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 10110.695, "sample_throughput": 1978.103, "load_time_ms": 0.239, "load_throughput": 83510283.723, "learn_time_ms": 1011.008, "learn_throughput": 19782.239, "update_time_ms": 8.406}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005, "total_loss": 0.5597069263458252, "policy_loss": -2.746410441467617e-05, "vf_loss": 0.5747461318969727, "vf_explained_var": -0.0004686713218688965, "kl": 4.8902528094529885e-05, "entropy": 1.501171886920929, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 36, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-30-08", "timestamp": 1702711808, "time_this_iter_s": 11.241032123565674, "time_total_s": 347.2842893600464, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798422a5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 347.2842893600464, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 51.71333333333334, "ram_util_percent": 54.44666666666667, "gpu_util_percent0": 0.03866666666666667, "vram_util_percent0": 0.017377387152777774}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -236.76210504007383, "episode_reward_mean": -176.76452460302374, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.9948838695242, -216.04403419099202, -214.3874186730533, -236.76210504007383, -183.28597028470205, -203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3211993618060605, "mean_inference_ms": 1.1597122358695922, "mean_action_processing_ms": 0.08754194663496025, "mean_env_wait_ms": 0.5435544125939743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 10261.824, "sample_throughput": 1948.971, "load_time_ms": 0.24, "load_throughput": 83269882.867, "learn_time_ms": 1015.477, "learn_throughput": 19695.169, "update_time_ms": 8.626}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005, "total_loss": 0.6218903362751007, "policy_loss": 4.406661842359938e-05, "vf_loss": 0.6369118988513947, "vf_explained_var": -0.0010408759117126465, "kl": 3.117033359451016e-05, "entropy": 1.5065668821334839, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 37, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-30-19", "timestamp": 1702711819, "time_this_iter_s": 11.090243101119995, "time_total_s": 358.3745324611664, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798422a280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 358.3745324611664, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 56.00666666666667, "ram_util_percent": 54.60000000000001, "gpu_util_percent0": 0.004, "vram_util_percent0": 0.017865668402777778}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -175.458464902218, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.37081548321683, -192.67455535512346, -189.8346261006043, -177.99210640381597, -198.43060445770806, -165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217357510654077, "mean_inference_ms": 1.1615167329087415, "mean_action_processing_ms": 0.0876496624610026, "mean_env_wait_ms": 0.5442448138155689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 10418.259, "sample_throughput": 1919.706, "load_time_ms": 0.241, "load_throughput": 82924159.747, "learn_time_ms": 1016.971, "learn_throughput": 19666.244, "update_time_ms": 8.604}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005, "total_loss": 0.5188576281070709, "policy_loss": -2.2463417856499746e-05, "vf_loss": 0.5339005589485168, "vf_explained_var": -0.00016301870346069336, "kl": 7.414479393119677e-06, "entropy": 1.5020424723625183, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 155, "training_iteration": 38, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-30-30", "timestamp": 1702711830, "time_this_iter_s": 11.171335935592651, "time_total_s": 369.54586839675903, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f798422a940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 369.54586839675903, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.42857142857142, "ram_util_percent": 54.70000000000001, "gpu_util_percent0": 0.018571428571428572, "vram_util_percent0": 0.017868768601190476}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -174.57651734718453, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.86063621913374, -184.02143297906173, -169.49003329545346, -174.97657030011365, -171.62400028533418, -176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32234787070958554, "mean_inference_ms": 1.1635988084221671, "mean_action_processing_ms": 0.08777752245550964, "mean_env_wait_ms": 0.54501058744102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 10587.677, "sample_throughput": 1888.988, "load_time_ms": 0.244, "load_throughput": 82104414.212, "learn_time_ms": 1016.493, "learn_throughput": 19675.5, "update_time_ms": 8.989}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005, "total_loss": 0.7253105342388153, "policy_loss": 3.458023201119431e-07, "vf_loss": 0.7403615713119507, "vf_explained_var": -0.00030666589736938477, "kl": 1.2266387130033252e-05, "entropy": 1.5051392316818237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 39, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-30-41", "timestamp": 1702711841, "time_this_iter_s": 11.159029483795166, "time_total_s": 380.7048978805542, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 380.7048978805542, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 51.92666666666666, "ram_util_percent": 54.53333333333334, "gpu_util_percent0": 0.08133333333333333, "vram_util_percent0": 0.017995876736111114}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -175.47580198879027, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.0974644914164, -173.96626321663638, -175.90005655592688, -175.53914948036228, -177.05344831775713, -174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3230072244959784, "mean_inference_ms": 1.1658148315569266, "mean_action_processing_ms": 0.08791362976589438, "mean_env_wait_ms": 0.5458013837529212, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 10681.645, "sample_throughput": 1872.371, "load_time_ms": 0.245, "load_throughput": 81784225.407, "learn_time_ms": 1022.546, "learn_throughput": 19559.023, "update_time_ms": 8.94}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005, "total_loss": 0.7741235196590424, "policy_loss": -1.9811820637594124e-05, "vf_loss": 0.7891975343227386, "vf_explained_var": -0.0005604028701782227, "kl": 5.9349245349338275e-06, "entropy": 1.5054192543029785, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 165, "training_iteration": 40, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-30-52", "timestamp": 1702711852, "time_this_iter_s": 10.685522317886353, "time_total_s": 391.39042019844055, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 391.39042019844055, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 38.82857142857143, "ram_util_percent": 54.51428571428572, "gpu_util_percent0": 0.14071428571428574, "vram_util_percent0": 0.017892020089285716}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -175.58038402541075, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.80408667301307, -173.5188979360054, -171.18473864216608, -177.1607621737756, -175.30204093921597, -174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32371852076920044, "mean_inference_ms": 1.1681572267751028, "mean_action_processing_ms": 0.0880619897570145, "mean_env_wait_ms": 0.5466622167388288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 10748.508, "sample_throughput": 1860.723, "load_time_ms": 0.244, "load_throughput": 81912000.781, "learn_time_ms": 1030.6, "learn_throughput": 19406.176, "update_time_ms": 9.128}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005, "total_loss": 0.5650469064712524, "policy_loss": -5.6907271605233234e-05, "vf_loss": 0.5801122486591339, "vf_explained_var": 2.1278858184814453e-05, "kl": 1.596510419688002e-05, "entropy": 1.5008448362350464, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 41, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-31-03", "timestamp": 1702711863, "time_this_iter_s": 10.998696088790894, "time_total_s": 402.38911628723145, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79935d3700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 402.38911628723145, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 43.193333333333335, "ram_util_percent": 54.553333333333335, "gpu_util_percent0": 0.13133333333333333, "vram_util_percent0": 0.018017578125}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -176.0123838002518, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3244370644170245, "mean_inference_ms": 1.1704907239394406, "mean_action_processing_ms": 0.08821076679277054, "mean_env_wait_ms": 0.5475421636528552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 10746.871, "sample_throughput": 1861.007, "load_time_ms": 0.244, "load_throughput": 82008094.633, "learn_time_ms": 1027.512, "learn_throughput": 19464.487, "update_time_ms": 9.165}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005, "total_loss": 0.6016024649143219, "policy_loss": -7.021217037683769e-05, "vf_loss": 0.6167312264442444, "vf_explained_var": -5.900859832763672e-06, "kl": 7.795550299927179e-05, "entropy": 1.5058552026748657, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 42, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-31-13", "timestamp": 1702711873, "time_this_iter_s": 9.931427240371704, "time_total_s": 412.32054352760315, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 412.32054352760315, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 36.138461538461534, "ram_util_percent": 54.56923076923078, "gpu_util_percent0": 0.016923076923076923, "vram_util_percent0": 0.017759665464743588}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -176.0123838002518, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.0938553981645, -173.40634794343353, -173.82090197769543, -178.41943254383781, -172.23905016383492, -180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3244370644170245, "mean_inference_ms": 1.1704907239394406, "mean_action_processing_ms": 0.08821076679277054, "mean_env_wait_ms": 0.5475421636528552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"sample_time_ms": 10639.704, "sample_throughput": 1879.751, "load_time_ms": 0.243, "load_throughput": 82321962.709, "learn_time_ms": 1015.604, "learn_throughput": 19692.708, "update_time_ms": 9.077}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005, "total_loss": 0.40395674109458923, "policy_loss": 4.8754881170509634e-05, "vf_loss": 0.41909125447273254, "vf_explained_var": -0.0022084712982177734, "kl": 6.463440010112675e-05, "entropy": 1.518327236175537, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 860000, "num_steps_trained": 860000, "num_agent_steps_trained": 860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 43, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-31-22", "timestamp": 1702711882, "time_this_iter_s": 9.457909107208252, "time_total_s": 421.7784526348114, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984237a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 421.7784526348114, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 54.574999999999996, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.017740885416666664}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -176.13130452021858, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.0255085203238, -177.1544663894902, -177.54906316622666, -172.24761698434097, -176.560015741223, -174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3251183152087457, "mean_inference_ms": 1.1727377662525922, "mean_action_processing_ms": 0.08835233754009242, "mean_env_wait_ms": 0.5483673313587881, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 10573.27, "sample_throughput": 1891.562, "load_time_ms": 0.244, "load_throughput": 81944007.033, "learn_time_ms": 1014.021, "learn_throughput": 19723.458, "update_time_ms": 9.051}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005, "total_loss": 0.5818181931972504, "policy_loss": -0.00011813488013601159, "vf_loss": 0.59712353348732, "vf_explained_var": 0.000273287296295166, "kl": 7.461273786057987e-05, "entropy": 1.5187195539474487, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 880000, "num_steps_trained": 880000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 44, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-31-32", "timestamp": 1702711892, "time_this_iter_s": 9.50622010231018, "time_total_s": 431.2846727371216, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79935720d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 431.2846727371216, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.17692307692308, "ram_util_percent": 54.646153846153865, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.017440404647435896}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -176.1354266132754, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.68928175521515, -176.31995172296868, -174.33341374018437, -171.66641708726502, -170.1063070900032, -175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319, -176.31689583237727, -174.3346311070547, -190.22653766322975, -170.51809473411012, -172.55272077051475], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3257808637565735, "mean_inference_ms": 1.1749152060252905, "mean_action_processing_ms": 0.08849071515044506, "mean_env_wait_ms": 0.5491826516946091, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 10499.576, "sample_throughput": 1904.839, "load_time_ms": 0.244, "load_throughput": 81928000.781, "learn_time_ms": 1013.254, "learn_throughput": 19738.387, "update_time_ms": 9.067}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005, "total_loss": 0.6198991537094116, "policy_loss": 7.519206857541094e-05, "vf_loss": 0.6350492238998413, "vf_explained_var": -0.0003802180290222168, "kl": 6.744511427880795e-05, "entropy": 1.522532045841217, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 185, "training_iteration": 45, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-31-41", "timestamp": 1702711901, "time_this_iter_s": 9.448955059051514, "time_total_s": 440.7336277961731, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f79935d3700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 440.7336277961731, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 29.116666666666664, "ram_util_percent": 54.666666666666664, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016764322916666664}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -176.74439178380456, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.98698081026419, -174.72949875412274, -170.44957297732992, -174.79475657853786, -174.61244321559656, -171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319, -176.31689583237727, -174.3346311070547, -190.22653766322975, -170.51809473411012, -172.55272077051475, -205.98195009073174, -176.91211176012732, -207.44819186732485, -170.51419065259412, -167.15544407777813], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32643374847230205, "mean_inference_ms": 1.177051566419932, "mean_action_processing_ms": 0.08862360644423972, "mean_env_wait_ms": 0.5499855858097744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"sample_time_ms": 10345.404, "sample_throughput": 1933.226, "load_time_ms": 0.233, "load_throughput": 85825741.764, "learn_time_ms": 1004.636, "learn_throughput": 19907.704, "update_time_ms": 9.02}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005, "total_loss": 0.652167409658432, "policy_loss": -7.55825056319992e-06, "vf_loss": 0.6674233973026276, "vf_explained_var": -0.00047218799591064453, "kl": 2.432420720477335e-05, "entropy": 1.5248417258262634, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 920000, "num_steps_trained": 920000, "num_agent_steps_trained": 920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 46, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-31-51", "timestamp": 1702711911, "time_this_iter_s": 9.64193081855774, "time_total_s": 450.37555861473083, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984237a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 450.37555861473083, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.299999999999997, "ram_util_percent": 54.8, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.016764322916666664}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -211.93364895525116, "episode_reward_mean": -177.1228334233, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.20689686776052, -173.73415285520872, -175.7678450892326, -173.35486932615322, -170.63664891339394, -175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319, -176.31689583237727, -174.3346311070547, -190.22653766322975, -170.51809473411012, -172.55272077051475, -205.98195009073174, -176.91211176012732, -207.44819186732485, -170.51419065259412, -167.15544407777813, -195.0121039251238, -180.3216125090244, -191.12508996427133, -172.2059272079392, -169.75268267903257], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.327072851188056, "mean_inference_ms": 1.1791545324774524, "mean_action_processing_ms": 0.08875225066133659, "mean_env_wait_ms": 0.5507746442753988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"sample_time_ms": 10178.955, "sample_throughput": 1964.838, "load_time_ms": 0.233, "load_throughput": 86001722.37, "learn_time_ms": 999.457, "learn_throughput": 20010.865, "update_time_ms": 9.361}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005, "total_loss": 0.5602234601974487, "policy_loss": -4.0219116013026635e-05, "vf_loss": 0.5755078196525574, "vf_explained_var": -0.0005421638488769531, "kl": 1.0154631421177562e-05, "entropy": 1.5244186520576477, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 940000, "num_steps_trained": 940000, "num_agent_steps_trained": 940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 195, "training_iteration": 47, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-32-00", "timestamp": 1702711920, "time_this_iter_s": 9.469102144241333, "time_total_s": 459.84466075897217, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c738ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 459.84466075897217, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 29.299999999999997, "ram_util_percent": 54.784615384615385, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.016764322916666664}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -212.7608678598374, "episode_reward_mean": -177.99513389646512, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319, -176.31689583237727, -174.3346311070547, -190.22653766322975, -170.51809473411012, -172.55272077051475, -205.98195009073174, -176.91211176012732, -207.44819186732485, -170.51419065259412, -167.15544407777813, -195.0121039251238, -180.3216125090244, -191.12508996427133, -172.2059272079392, -169.75268267903257, -179.5005737046195, -212.7608678598374, -181.66888511723, -178.0013487118407, -199.99878497473892], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.327702723962199, "mean_inference_ms": 1.1812105148685026, "mean_action_processing_ms": 0.08887580357708572, "mean_env_wait_ms": 0.5515276889137414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 10006.241, "sample_throughput": 1998.753, "load_time_ms": 0.232, "load_throughput": 86116497.28, "learn_time_ms": 996.059, "learn_throughput": 20079.125, "update_time_ms": 9.282}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005, "total_loss": 0.6823325157165527, "policy_loss": -1.7651557817188746e-05, "vf_loss": 0.697573333978653, "vf_explained_var": 0.00033473968505859375, "kl": 3.492638136126658e-05, "entropy": 1.522318422794342, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 48, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-32-10", "timestamp": 1702711930, "time_this_iter_s": 9.457411766052246, "time_total_s": 469.3020725250244, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984089670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 469.3020725250244, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.36666666666667, "ram_util_percent": 54.958333333333336, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016764322916666664}}
{"episode_reward_max": -164.7887100419613, "episode_reward_min": -212.7608678598374, "episode_reward_mean": -177.99513389646512, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.93697664050345, -169.39571750696845, -172.53929636008118, -174.78654681143885, -174.36372761310926, -174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319, -176.31689583237727, -174.3346311070547, -190.22653766322975, -170.51809473411012, -172.55272077051475, -205.98195009073174, -176.91211176012732, -207.44819186732485, -170.51419065259412, -167.15544407777813, -195.0121039251238, -180.3216125090244, -191.12508996427133, -172.2059272079392, -169.75268267903257, -179.5005737046195, -212.7608678598374, -181.66888511723, -178.0013487118407, -199.99878497473892], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.327702723962199, "mean_inference_ms": 1.1812105148685026, "mean_action_processing_ms": 0.08887580357708572, "mean_env_wait_ms": 0.5515276889137414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"sample_time_ms": 9831.168, "sample_throughput": 2034.346, "load_time_ms": 0.23, "load_throughput": 87036812.617, "learn_time_ms": 995.846, "learn_throughput": 20083.43, "update_time_ms": 8.884}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005, "total_loss": 0.3691907227039337, "policy_loss": 3.88202671430804e-06, "vf_loss": 0.38443969190120697, "vf_explained_var": -0.0009448528289794922, "kl": 2.612836679372066e-05, "entropy": 1.5252870321273804, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 980000, "num_steps_trained": 980000, "num_agent_steps_trained": 980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 49, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-32-19", "timestamp": 1702711939, "time_this_iter_s": 9.442416191101074, "time_total_s": 478.7444887161255, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f7984237e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 478.7444887161255, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.125, "ram_util_percent": 54.849999999999994, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016764322916666664}}
{"episode_reward_max": -162.8077657739374, "episode_reward_min": -212.7608678598374, "episode_reward_mean": -178.33415184269077, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.42897787322093, -172.76994507122683, -174.93388660435508, -170.4870620742854, -175.10797463115796, -169.60942837674608, -170.69662508935107, -172.26560941907258, -172.5036563709517, -173.2613699357408, -171.2950699683396, -176.29468105232502, -172.13226732553605, -177.4020669195636, -181.2163208232741, -176.00825377216128, -172.7672660373994, -170.80169098516956, -185.4303349650615, -168.52326456306554, -172.8468699245952, -168.94041041027623, -169.62682939919245, -180.24581042601594, -171.78700737239228, -166.7436306169743, -177.96679713904126, -178.01683117997635, -175.00342277389004, -177.42406791188571, -190.89406728610015, -170.86754084779034, -167.07117382764903, -179.1781487101969, -172.96449743835223, -165.49800787888913, -174.45938888024617, -164.7887100419613, -170.48042463690217, -183.27632729939629, -179.4694367307872, -170.85649952374817, -175.42231302325607, -176.92048127782522, -171.56375197893928, -211.93364895525116, -171.90369907294973, -188.96373156775772, -169.02142698833816, -170.04593539346618, -173.38169135396862, -171.41831864878796, -169.96559455296097, -183.10788986747264, -176.23445787393993, -174.02150133166785, -200.2566966072428, -195.25518953048206, -184.6876603574948, -201.68008941277571, -174.24439488839351, -173.06753442020945, -173.56813579361082, -190.76294211404053, -177.3715785078946, -176.9281202587096, -175.7475221493685, -211.6590262817867, -181.38795333293587, -169.447881825478, -166.15775863293302, -173.99850493836473, -185.01519215334932, -178.1936460174655, -180.5065582815319, -176.31689583237727, -174.3346311070547, -190.22653766322975, -170.51809473411012, -172.55272077051475, -205.98195009073174, -176.91211176012732, -207.44819186732485, -170.51419065259412, -167.15544407777813, -195.0121039251238, -180.3216125090244, -191.12508996427133, -172.2059272079392, -169.75268267903257, -179.5005737046195, -212.7608678598374, -181.66888511723, -178.0013487118407, -199.99878497473892, -196.9490647102664, -187.12292532711922, -162.8077657739374, -176.30093357142567, -177.7433701719152], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3283098995121726, "mean_inference_ms": 1.1831765007186474, "mean_action_processing_ms": 0.0889956245963667, "mean_env_wait_ms": 0.5522498405770176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"sample_time_ms": 9719.98, "sample_throughput": 2057.617, "load_time_ms": 0.231, "load_throughput": 86712921.232, "learn_time_ms": 988.028, "learn_throughput": 20242.349, "update_time_ms": 8.899}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005, "total_loss": 0.6989689469337463, "policy_loss": -9.616851957883199e-06, "vf_loss": 0.7142021656036377, "vf_explained_var": -0.00021988153457641602, "kl": 7.497629013530904e-06, "entropy": 1.5223625302314758, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 1000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 1000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -168.21701296423046, "episode_reward_min": -194.01238484148328, "episode_reward_mean": -181.08553285044542, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.8761873234501, -194.01238484148328, -168.21701296423046, -191.1126691642513, -178.09280786810388, -187.1516971002401, -183.49243619532436, -177.98601060360753, -170.1958648264651, -171.71825761729806], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29302164857902324, "mean_inference_ms": 1.1798090617391743, "mean_action_processing_ms": 0.08536152461707226, "mean_env_wait_ms": 0.5363246672179052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 205, "training_iteration": 50, "trial_id": "206d3_00000", "experiment_id": "e7e209a18f2e4c41b89cddd7dcb4ba93", "date": "2023-12-16_13-32-49", "timestamp": 1702711969, "time_this_iter_s": 29.674456119537354, "time_total_s": 508.41894483566284, "pid": 41379, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f795c5dcdc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 508.41894483566284, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.135, "ram_util_percent": 54.87750000000001, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016764322916666668}}
