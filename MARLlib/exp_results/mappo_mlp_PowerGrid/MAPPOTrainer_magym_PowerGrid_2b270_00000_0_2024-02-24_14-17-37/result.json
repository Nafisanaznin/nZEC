{"episode_reward_max": -750.4665545320418, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -770.4172208741871, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3326759874262497, "mean_inference_ms": 1.2392999726453258, "mean_action_processing_ms": 0.0940858759567467, "mean_env_wait_ms": 0.5842467872706958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 10882.493, "sample_throughput": 2205.377, "load_time_ms": 0.587, "load_throughput": 40870197.32, "learn_time_ms": 986.908, "learn_throughput": 24318.383, "update_time_ms": 8.754}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 214.92364311218262, "policy_loss": -0.006955246033612639, "vf_loss": 214.95167922973633, "vf_explained_var": 8.945167064666748e-05, "kl": 0.004219914021561681, "entropy": 2.1928193271160126, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-17-49", "timestamp": 1708762669, "time_this_iter_s": 11.857976913452148, "time_total_s": 11.857976913452148, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5415db80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11.857976913452148, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.470588235294116, "ram_util_percent": 8.170588235294119, "gpu_util_percent0": 0.14941176470588236, "vram_util_percent0": 0.03153243719362745}}
{"episode_reward_max": -676.4076128581493, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -732.5815411450376, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3340355035462666, "mean_inference_ms": 1.243513614616782, "mean_action_processing_ms": 0.09470108678812107, "mean_env_wait_ms": 0.5874706823439328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 11468.196, "sample_throughput": 2092.744, "load_time_ms": 0.402, "load_throughput": 59705395.018, "learn_time_ms": 953.386, "learn_throughput": 25173.436, "update_time_ms": 8.036}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 164.91921424865723, "policy_loss": 0.02037427551113069, "vf_loss": 164.9199390411377, "vf_explained_var": 0.00014015287160873413, "kl": 0.005781939275315284, "entropy": 2.1671375930309296, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 2, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-18-01", "timestamp": 1708762681, "time_this_iter_s": 11.955872058868408, "time_total_s": 23.813848972320557, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e73660670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 23.813848972320557, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.725, "ram_util_percent": 8.343750000000002, "gpu_util_percent0": 0.09062500000000001, "vram_util_percent0": 0.03212738037109375}}
{"episode_reward_max": -558.7231576864593, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -680.6829299748914, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3318274761041884, "mean_inference_ms": 1.2350501947024337, "mean_action_processing_ms": 0.09426320460371701, "mean_env_wait_ms": 0.5849207192790243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 11367.03, "sample_throughput": 2111.369, "load_time_ms": 0.344, "load_throughput": 69824251.561, "learn_time_ms": 942.123, "learn_throughput": 25474.387, "update_time_ms": 8.025}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 99.44268703460693, "policy_loss": 0.003966201562434435, "vf_loss": 99.45887851715088, "vf_explained_var": 9.991228580474854e-06, "kl": 0.008281363964861621, "entropy": 2.098805218935013, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-18-12", "timestamp": 1708762692, "time_this_iter_s": 11.138615131378174, "time_total_s": 34.95246410369873, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5415df70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 34.95246410369873, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.459999999999997, "ram_util_percent": 8.386666666666668, "gpu_util_percent0": 0.04133333333333333, "vram_util_percent0": 0.029112413194444443}}
{"episode_reward_max": -470.8707893050686, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -632.5085782369539, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33016880380668556, "mean_inference_ms": 1.2277622131580999, "mean_action_processing_ms": 0.0938102473652754, "mean_env_wait_ms": 0.5824079368079399, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 11339.638, "sample_throughput": 2116.47, "load_time_ms": 0.313, "load_throughput": 76637454.13, "learn_time_ms": 937.692, "learn_throughput": 25594.749, "update_time_ms": 8.198}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 60.67412567138672, "policy_loss": 0.02895237342454493, "vf_loss": 60.66473197937012, "vf_explained_var": -5.4135918617248535e-05, "kl": 0.005934220124178685, "entropy": 2.015065550804138, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-18-23", "timestamp": 1708762703, "time_this_iter_s": 11.23919415473938, "time_total_s": 46.19165825843811, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404d0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 46.19165825843811, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.419999999999998, "ram_util_percent": 8.386666666666668, "gpu_util_percent0": 0.04800000000000001, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -374.1679998588412, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -586.192943179451, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32876308236348156, "mean_inference_ms": 1.221667242819367, "mean_action_processing_ms": 0.09350257061366771, "mean_env_wait_ms": 0.5804977068603449, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 11321.18, "sample_throughput": 2119.92, "load_time_ms": 0.298, "load_throughput": 80646768.146, "learn_time_ms": 938.542, "learn_throughput": 25571.584, "update_time_ms": 8.117}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 31.434706926345825, "policy_loss": -0.014773765578866005, "vf_loss": 31.467840433120728, "vf_explained_var": -9.648501873016357e-06, "kl": 0.006401262011711623, "entropy": 1.9000059515237808, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 5, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-18-34", "timestamp": 1708762714, "time_this_iter_s": 11.239191770553589, "time_total_s": 57.4308500289917, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1709f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 57.4308500289917, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.4125, "ram_util_percent": 8.39375, "gpu_util_percent0": 0.043125, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -262.5574769068553, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -538.8370945302379, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3276975663369895, "mean_inference_ms": 1.216819451140755, "mean_action_processing_ms": 0.09323895382426702, "mean_env_wait_ms": 0.5787590322873201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 11311.349, "sample_throughput": 2121.763, "load_time_ms": 0.284, "load_throughput": 84401869.201, "learn_time_ms": 934.688, "learn_throughput": 25677.015, "update_time_ms": 8.261}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 12.155706882476807, "policy_loss": 0.0943976768758148, "vf_loss": 12.077791571617126, "vf_explained_var": -7.594376802444458e-05, "kl": 0.008885524739912165, "entropy": 1.7370103597640991, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 144000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 6, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-18-46", "timestamp": 1708762726, "time_this_iter_s": 11.214178323745728, "time_total_s": 68.64502835273743, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426bdc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 68.64502835273743, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.15333333333333, "ram_util_percent": 8.453333333333335, "gpu_util_percent0": 0.04800000000000001, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -188.26082801984077, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -491.495162518311, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3267906521212741, "mean_inference_ms": 1.2131193249534256, "mean_action_processing_ms": 0.09300094680757208, "mean_env_wait_ms": 0.5773585640283642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"sample_time_ms": 11311.034, "sample_throughput": 2121.822, "load_time_ms": 0.276, "load_throughput": 87068215.989, "learn_time_ms": 932.625, "learn_throughput": 25733.818, "update_time_ms": 8.162}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 1.624553233385086, "policy_loss": -0.051059131510555744, "vf_loss": 1.691000610589981, "vf_explained_var": -0.0003057420253753662, "kl": 0.0039896733395991535, "entropy": 1.5787281095981598, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 168000, "num_agent_steps_trained": 168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 7, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-18-57", "timestamp": 1708762737, "time_this_iter_s": 11.285019874572754, "time_total_s": 79.93004822731018, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cf820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 79.93004822731018, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.226666666666667, "ram_util_percent": 8.446666666666667, "gpu_util_percent0": 0.04, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -167.22453738882723, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -451.9214001009115, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32604983496354467, "mean_inference_ms": 1.2100181300801331, "mean_action_processing_ms": 0.09282526146909735, "mean_env_wait_ms": 0.5762078772069803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 11307.288, "sample_throughput": 2122.525, "load_time_ms": 0.272, "load_throughput": 88320505.374, "learn_time_ms": 933.28, "learn_throughput": 25715.756, "update_time_ms": 8.129}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 0.6205035075545311, "policy_loss": 0.0201900452375412, "vf_loss": 0.615049384534359, "vf_explained_var": -0.0001214146614074707, "kl": 0.001320881800767837, "entropy": 1.4801997393369675, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 192000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 8, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-19-08", "timestamp": 1708762748, "time_this_iter_s": 11.273402690887451, "time_total_s": 91.20345091819763, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae064fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 91.20345091819763, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.375, "ram_util_percent": 8.46875, "gpu_util_percent0": 0.045, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -167.2105947824646, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -421.13583916519406, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32542515023705404, "mean_inference_ms": 1.2073720706439746, "mean_action_processing_ms": 0.09266645378371816, "mean_env_wait_ms": 0.5751902540565856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 11302.475, "sample_throughput": 2123.429, "load_time_ms": 0.267, "load_throughput": 90029778.794, "learn_time_ms": 932.595, "learn_throughput": 25734.648, "update_time_ms": 8.077}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 0.5625281408429146, "policy_loss": -0.005022946861572564, "vf_loss": 0.582207165658474, "vf_explained_var": -3.3676624298095703e-06, "kl": 0.0010189039055777116, "entropy": 1.4681531190872192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 216000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 9, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-19-20", "timestamp": 1708762760, "time_this_iter_s": 11.226280689239502, "time_total_s": 102.42973160743713, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae162dd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 102.42973160743713, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.266666666666666, "ram_util_percent": 8.493333333333334, "gpu_util_percent0": 0.04733333333333334, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -167.2105947824646, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -396.45344366432005, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3248926754011942, "mean_inference_ms": 1.2050867906009386, "mean_action_processing_ms": 0.09252185323117092, "mean_env_wait_ms": 0.5743248469047527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 11299.325, "sample_throughput": 2124.021, "load_time_ms": 0.262, "load_throughput": 91578689.956, "learn_time_ms": 931.429, "learn_throughput": 25766.853, "update_time_ms": 8.096}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 0.5697233974933624, "policy_loss": 0.03550737182740704, "vf_loss": 0.5491181164979935, "vf_explained_var": -0.00010655075311660767, "kl": 0.001589581173775792, "entropy": 1.4921948611736298, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 10, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-19-31", "timestamp": 1708762771, "time_this_iter_s": 11.23995852470398, "time_total_s": 113.66969013214111, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae162df70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 113.66969013214111, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.486666666666665, "ram_util_percent": 8.486666666666668, "gpu_util_percent0": 0.04866666666666667, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -376.98125216628887, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.324463802670125, "mean_inference_ms": 1.203133799157199, "mean_action_processing_ms": 0.09239004147834338, "mean_env_wait_ms": 0.5736280241672452, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"sample_time_ms": 11344.599, "sample_throughput": 2115.544, "load_time_ms": 0.226, "load_throughput": 106353191.759, "learn_time_ms": 927.102, "learn_throughput": 25887.127, "update_time_ms": 8.607}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 0.8039957024157047, "policy_loss": 0.08545488165691495, "vf_loss": 0.7338862717151642, "vf_explained_var": 2.890080213546753e-05, "kl": 0.0021703243518719217, "entropy": 1.5359028726816177, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 264000, "num_agent_steps_trained": 264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 55, "training_iteration": 11, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-19-42", "timestamp": 1708762782, "time_this_iter_s": 11.3396577835083, "time_total_s": 125.00934791564941, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 125.00934791564941, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 30.46875, "ram_util_percent": 8.5, "gpu_util_percent0": 0.04625, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -361.80299332299614, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3241026566247341, "mean_inference_ms": 1.201439629503559, "mean_action_processing_ms": 0.09226986777336468, "mean_env_wait_ms": 0.5730610865878478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 11275.024, "sample_throughput": 2128.599, "load_time_ms": 0.226, "load_throughput": 106330723.566, "learn_time_ms": 930.61, "learn_throughput": 25789.526, "update_time_ms": 8.636}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 0.8468916602432728, "policy_loss": -0.01879771240055561, "vf_loss": 0.8812868818640709, "vf_explained_var": -0.00023937225341796875, "kl": 0.0003612345343487755, "entropy": 1.559864491224289, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 288000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-19-53", "timestamp": 1708762793, "time_this_iter_s": 11.338386535644531, "time_total_s": 136.34773445129395, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5410e700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 136.34773445129395, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 8.5, "gpu_util_percent0": 0.04666666666666667, "vram_util_percent0": 0.02880859375}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -348.2638869010839, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3239767759301781, "mean_inference_ms": 1.2005685333487155, "mean_action_processing_ms": 0.09221885214584181, "mean_env_wait_ms": 0.5728311485870518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"sample_time_ms": 11384.42, "sample_throughput": 2108.144, "load_time_ms": 0.226, "load_throughput": 106117748.261, "learn_time_ms": 938.821, "learn_throughput": 25563.991, "update_time_ms": 8.875}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 0.6329235434532166, "policy_loss": 0.037256505333061796, "vf_loss": 0.6108394861221313, "vf_explained_var": -1.656264066696167e-05, "kl": 0.0012270980974304901, "entropy": 1.5174347013235092, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 312000, "num_agent_steps_trained": 312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 65, "training_iteration": 13, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-20-06", "timestamp": 1708762806, "time_this_iter_s": 12.283542394638062, "time_total_s": 148.631276845932, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cf940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 148.631276845932, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.629411764705885, "ram_util_percent": 8.582352941176469, "gpu_util_percent0": 0.1476470588235294, "vram_util_percent0": 0.02964633118872549}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -336.84440166800766, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32407046696788405, "mean_inference_ms": 1.200465992722329, "mean_action_processing_ms": 0.09222157341277346, "mean_env_wait_ms": 0.5729169581288677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 11522.697, "sample_throughput": 2082.846, "load_time_ms": 0.239, "load_throughput": 100262247.012, "learn_time_ms": 951.523, "learn_throughput": 25222.733, "update_time_ms": 8.781}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 0.5721178203821182, "policy_loss": -0.07605470134876668, "vf_loss": 0.6629445403814316, "vf_explained_var": -0.00024071335792541504, "kl": 0.0008501072292795842, "entropy": 1.4772685766220093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 336000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 14, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-20-18", "timestamp": 1708762818, "time_this_iter_s": 12.65634536743164, "time_total_s": 161.28762221336365, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e541e5a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 161.28762221336365, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.400000000000006, "ram_util_percent": 8.535294117647059, "gpu_util_percent0": 0.2023529411764706, "vram_util_percent0": 0.029282513786764705}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -326.21754231661913, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3241742550075435, "mean_inference_ms": 1.200545323360521, "mean_action_processing_ms": 0.09223160204715075, "mean_env_wait_ms": 0.5730199350091602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 11587.608, "sample_throughput": 2071.178, "load_time_ms": 0.24, "load_throughput": 100052972.866, "learn_time_ms": 950.346, "learn_throughput": 25253.957, "update_time_ms": 8.805}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 0.7210745327174664, "policy_loss": 0.040196814807131886, "vf_loss": 0.6953346133232117, "vf_explained_var": -6.256252527236938e-05, "kl": 0.00033527867341842654, "entropy": 1.4457048028707504, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 15, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-20-30", "timestamp": 1708762830, "time_this_iter_s": 11.747586011886597, "time_total_s": 173.03520822525024, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cf790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 173.03520822525024, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.162499999999994, "ram_util_percent": 8.6125, "gpu_util_percent0": 0.047499999999999994, "vram_util_percent0": 0.029070536295572914}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -316.55208563300874, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32426874022630764, "mean_inference_ms": 1.2006114751938628, "mean_action_processing_ms": 0.09224047274000409, "mean_env_wait_ms": 0.5731403335666706, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 11619.753, "sample_throughput": 2065.448, "load_time_ms": 0.24, "load_throughput": 99795078.814, "learn_time_ms": 951.927, "learn_throughput": 25212.024, "update_time_ms": 8.78}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 0.5637172237038612, "policy_loss": -0.00021438137628138065, "vf_loss": 0.5784157440066338, "vf_explained_var": -4.032254219055176e-05, "kl": 0.0006758960858870844, "entropy": 1.4484262466430664, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 384000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 16, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-20-42", "timestamp": 1708762842, "time_this_iter_s": 11.557831287384033, "time_total_s": 184.59303951263428, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae06a7e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 184.59303951263428, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.94, "ram_util_percent": 8.619999999999997, "gpu_util_percent0": 0.06066666666666667, "vram_util_percent0": 0.028645833333333325}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -308.0207266899913, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32432243542344086, "mean_inference_ms": 1.2005492447633772, "mean_action_processing_ms": 0.09223581474386101, "mean_env_wait_ms": 0.5731936094667982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"sample_time_ms": 11613.524, "sample_throughput": 2066.556, "load_time_ms": 0.24, "load_throughput": 99933779.41, "learn_time_ms": 954.718, "learn_throughput": 25138.325, "update_time_ms": 8.779}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 0.5823623761534691, "policy_loss": 0.02859704673755914, "vf_loss": 0.5684786438941956, "vf_explained_var": -0.00015085935592651367, "kl": 0.00027116171269224443, "entropy": 1.4713314920663834, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 408000, "num_agent_steps_trained": 408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 85, "training_iteration": 17, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-20-53", "timestamp": 1708762853, "time_this_iter_s": 11.238083362579346, "time_total_s": 195.83112287521362, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cf9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 195.83112287521362, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 30.22666666666667, "ram_util_percent": 8.680000000000001, "gpu_util_percent0": 0.03066666666666667, "vram_util_percent0": 0.028645833333333325}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -301.0078171869789, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3243420249209572, "mean_inference_ms": 1.2003831421943378, "mean_action_processing_ms": 0.09221992548174075, "mean_env_wait_ms": 0.5731958182289364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 11609.445, "sample_throughput": 2067.282, "load_time_ms": 0.238, "load_throughput": 100966194.584, "learn_time_ms": 954.922, "learn_throughput": 25132.934, "update_time_ms": 8.758}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 0.5942314751446247, "policy_loss": -0.056031559593975544, "vf_loss": 0.6651589497923851, "vf_explained_var": -0.00032719969749450684, "kl": 0.0006595209721431683, "entropy": 1.4895941764116287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 432000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 90, "training_iteration": 18, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-21-04", "timestamp": 1708762864, "time_this_iter_s": 11.206676721572876, "time_total_s": 207.0377995967865, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1571f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 207.0377995967865, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.15625, "ram_util_percent": 8.6875, "gpu_util_percent0": 0.021875, "vram_util_percent0": 0.028645833333333332}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -294.7779014997945, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32432848699746003, "mean_inference_ms": 1.2001033345901282, "mean_action_processing_ms": 0.0921947411090972, "mean_env_wait_ms": 0.5731690448019411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"sample_time_ms": 11600.125, "sample_throughput": 2068.943, "load_time_ms": 0.237, "load_throughput": 101250549.185, "learn_time_ms": 955.341, "learn_throughput": 25121.912, "update_time_ms": 8.75}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 0.6996302604675293, "policy_loss": 0.016987172013614327, "vf_loss": 0.6971782818436623, "vf_explained_var": -0.00011745840311050415, "kl": 0.0019264837162839, "entropy": 1.4535252451896667, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 456000, "num_agent_steps_trained": 456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 95, "training_iteration": 19, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-21-16", "timestamp": 1708762876, "time_this_iter_s": 11.134882688522339, "time_total_s": 218.17268228530884, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cfc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 218.17268228530884, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.66, "ram_util_percent": 8.68, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.028645833333333325}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -793.4300591419671, "episode_reward_mean": -288.6570699464582, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2833488573536, -762.8695687513198, -752.036573088253, -750.4665545320418, -793.4300591419671, -683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3242882899040604, "mean_inference_ms": 1.1997448247685716, "mean_action_processing_ms": 0.09216145308752743, "mean_env_wait_ms": 0.5730897999488658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 11583.773, "sample_throughput": 2071.864, "load_time_ms": 0.237, "load_throughput": 101362698.62, "learn_time_ms": 957.593, "learn_throughput": 25062.845, "update_time_ms": 8.818}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 0.507092647254467, "policy_loss": -0.013063237303867936, "vf_loss": 0.5342954397201538, "vf_explained_var": -0.0003066137433052063, "kl": 0.00012878205679064947, "entropy": 1.4139565080404282, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 20, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-21-27", "timestamp": 1708762887, "time_this_iter_s": 11.09531569480896, "time_total_s": 229.2679979801178, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cfee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 229.2679979801178, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 28.886666666666667, "ram_util_percent": 8.7, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.028645833333333325}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -717.3507804745767, "episode_reward_mean": -258.6545321823601, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-683.741187725658, -702.8169574294286, -693.4127685916275, -717.3507804745767, -676.4076128581493, -580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3237987916943089, "mean_inference_ms": 1.1973028892086601, "mean_action_processing_ms": 0.09202252255441966, "mean_env_wait_ms": 0.5724040965809865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 504000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 11554.794, "sample_throughput": 2077.06, "load_time_ms": 0.238, "load_throughput": 100935822.721, "learn_time_ms": 956.291, "learn_throughput": 25096.958, "update_time_ms": 8.354}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 0.5569054186344147, "policy_loss": 0.016722487285733223, "vf_loss": 0.5547084659337997, "vf_explained_var": 5.9992074966430664e-05, "kl": 0.0024696522590128556, "entropy": 1.452552855014801, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 504000, "num_agent_steps_sampled": 504000, "num_steps_trained": 504000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 105, "training_iteration": 21, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-21-38", "timestamp": 1708762898, "time_this_iter_s": 11.007987260818481, "time_total_s": 240.27598524093628, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1571af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 240.27598524093628, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 28.76, "ram_util_percent": 8.7, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.028645833333333325}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -583.2872027460073, "episode_reward_mean": -232.8878736769849, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-580.6397589918292, -583.2872027460073, -558.7231576864593, -580.6611606741527, -581.1172580745467, -482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.323188607246473, "mean_inference_ms": 1.1944557067927852, "mean_action_processing_ms": 0.09182135729048302, "mean_env_wait_ms": 0.5714028104131432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 528000, "timesteps_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"sample_time_ms": 11572.521, "sample_throughput": 2073.878, "load_time_ms": 0.238, "load_throughput": 100743891.113, "learn_time_ms": 953.114, "learn_throughput": 25180.611, "update_time_ms": 8.354}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 0.6854617558419704, "policy_loss": 0.046690681017935276, "vf_loss": 0.6539102122187614, "vf_explained_var": -0.0001958608627319336, "kl": 0.0040976824887574564, "entropy": 1.513915240764618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 528000, "num_agent_steps_sampled": 528000, "num_steps_trained": 528000, "num_agent_steps_trained": 528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 110, "training_iteration": 22, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-21-49", "timestamp": 1708762909, "time_this_iter_s": 11.499579906463623, "time_total_s": 251.7755651473999, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15713a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 251.7755651473999, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 33.36, "ram_util_percent": 8.72, "gpu_util_percent0": 0.060000000000000005, "vram_util_percent0": 0.029077148437500002}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -534.1078472646852, "episode_reward_mean": -214.5279271807563, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-482.59615863208654, -470.8707893050686, -480.559073964548, -534.1078472646852, -471.79374594931664, -379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3229884874271564, "mean_inference_ms": 1.193108177709078, "mean_action_processing_ms": 0.09171903001915592, "mean_env_wait_ms": 0.5709574153854677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 552000, "timesteps_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"sample_time_ms": 11501.301, "sample_throughput": 2086.721, "load_time_ms": 0.238, "load_throughput": 101016854.992, "learn_time_ms": 951.667, "learn_throughput": 25218.913, "update_time_ms": 8.09}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 1.511679008603096, "policy_loss": 0.08432715813978575, "vf_loss": 1.4427110850811005, "vf_explained_var": -0.00012579560279846191, "kl": 0.002187049993209289, "entropy": 1.5359309017658234, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552000, "num_agent_steps_sampled": 552000, "num_steps_trained": 552000, "num_agent_steps_trained": 552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 115, "training_iteration": 23, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-22-01", "timestamp": 1708762921, "time_this_iter_s": 11.586974143981934, "time_total_s": 263.36253929138184, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15b0040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 263.36253929138184, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.9125, "ram_util_percent": 8.80625, "gpu_util_percent0": 0.10437500000000001, "vram_util_percent0": 0.029497782389322918}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -429.18361447634624, "episode_reward_mean": -199.63019452548033, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-379.92716498367486, -409.5132423523271, -374.1679998588412, -429.18361447634624, -411.8599930760112, -344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3228913336861599, "mean_inference_ms": 1.1923706030290449, "mean_action_processing_ms": 0.09165992270278495, "mean_env_wait_ms": 0.5707549425845309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 11385.198, "sample_throughput": 2108.0, "load_time_ms": 0.224, "load_throughput": 106906644.01, "learn_time_ms": 939.692, "learn_throughput": 25540.275, "update_time_ms": 8.098}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 0.6703783050179482, "policy_loss": 0.018012380227446556, "vf_loss": 0.6672801412642002, "vf_explained_var": -0.00031938403844833374, "kl": 0.0011002741498777335, "entropy": 1.4914240092039108, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 576000, "num_steps_trained": 576000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 24, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-22-12", "timestamp": 1708762932, "time_this_iter_s": 11.39790391921997, "time_total_s": 274.7604432106018, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e89b1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 274.7604432106018, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 8.913333333333336, "gpu_util_percent0": 0.04466666666666666, "vram_util_percent0": 0.02754177517361112}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -344.41696581417455, "episode_reward_mean": -188.84499605371195, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-344.41696581417455, -302.38693389442363, -291.20516403797393, -309.7227157674302, -262.5574769068553, -194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3228853929365259, "mean_inference_ms": 1.1920347321092073, "mean_action_processing_ms": 0.09160534136044607, "mean_env_wait_ms": 0.5706313153553257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 11325.463, "sample_throughput": 2119.119, "load_time_ms": 0.223, "load_throughput": 107776548.18, "learn_time_ms": 940.0, "learn_throughput": 25531.907, "update_time_ms": 8.081}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 0.6773313730955124, "policy_loss": 0.008289531338959932, "vf_loss": 0.6837225928902626, "vf_explained_var": -0.0004535764455795288, "kl": 0.0005534013817308225, "entropy": 1.468072235584259, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 25, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-22-24", "timestamp": 1708762944, "time_this_iter_s": 11.276187419891357, "time_total_s": 286.03663063049316, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15bdca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 286.03663063049316, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.566666666666663, "ram_util_percent": 8.946666666666667, "gpu_util_percent0": 0.04466666666666666, "vram_util_percent0": 0.026529947916666675}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -227.68472136085916, "episode_reward_mean": -182.42785509805165, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.75114233184942, -188.26082801984077, -227.68472136085916, -199.6130118892964, -226.908148631903, -180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32290334894059003, "mean_inference_ms": 1.1919073989001234, "mean_action_processing_ms": 0.09156825854290032, "mean_env_wait_ms": 0.5706257913670194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 624000, "timesteps_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"sample_time_ms": 11296.835, "sample_throughput": 2124.489, "load_time_ms": 0.229, "load_throughput": 104966940.563, "learn_time_ms": 940.715, "learn_throughput": 25512.501, "update_time_ms": 8.123}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 0.5411776900291443, "policy_loss": -0.006609145551919937, "vf_loss": 0.5622778311371803, "vf_explained_var": -0.0002044886350631714, "kl": 0.0003484075641370793, "entropy": 1.4491005837917328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 624000, "num_agent_steps_sampled": 624000, "num_steps_trained": 624000, "num_agent_steps_trained": 624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 130, "training_iteration": 26, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-22-35", "timestamp": 1708762955, "time_this_iter_s": 11.279191732406616, "time_total_s": 297.3158223628998, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15cdd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 297.3158223628998, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.53125, "ram_util_percent": 8.98125, "gpu_util_percent0": 0.042499999999999996, "vram_util_percent0": 0.026529947916666668}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -218.53020395780857, "episode_reward_mean": -180.7622065636306, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.92809183250264, -171.47101313922244, -180.56486837081016, -167.22453738882723, -174.33680516421833, -181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32297448551716434, "mean_inference_ms": 1.1918314281484137, "mean_action_processing_ms": 0.09154597364462798, "mean_env_wait_ms": 0.5706735214315429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 648000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 11308.845, "sample_throughput": 2122.233, "load_time_ms": 0.231, "load_throughput": 103691075.402, "learn_time_ms": 938.306, "learn_throughput": 25578.008, "update_time_ms": 8.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 0.6053350791335106, "policy_loss": 0.024276256328448653, "vf_loss": 0.5956661030650139, "vf_explained_var": -0.00047215819358825684, "kl": 0.00028353864797792117, "entropy": 1.4607312232255936, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 648000, "num_agent_steps_sampled": 648000, "num_steps_trained": 648000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 135, "training_iteration": 27, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-22-46", "timestamp": 1708762966, "time_this_iter_s": 11.325487613677979, "time_total_s": 308.64130997657776, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15bddc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 308.64130997657776, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.320000000000004, "ram_util_percent": 8.973333333333334, "gpu_util_percent0": 0.044000000000000004, "vram_util_percent0": 0.026529947916666675}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -218.53020395780857, "episode_reward_mean": -180.82458810446653, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.07391171596976, -169.4952803476166, -179.48680513323131, -167.2105947824646, -176.9901664179932, -172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3230605951060206, "mean_inference_ms": 1.191863505088799, "mean_action_processing_ms": 0.09151996665228858, "mean_env_wait_ms": 0.5707500737945012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"sample_time_ms": 11316.266, "sample_throughput": 2120.841, "load_time_ms": 0.232, "load_throughput": 103467258.711, "learn_time_ms": 938.535, "learn_throughput": 25571.768, "update_time_ms": 8.125}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005, "total_loss": 0.5760581754148006, "policy_loss": 0.007256325334310532, "vf_loss": 0.5835259929299355, "vf_explained_var": -3.609806299209595e-05, "kl": 0.000419959462777425, "entropy": 1.4724149107933044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 672000, "num_steps_trained": 672000, "num_agent_steps_trained": 672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 28, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-22-58", "timestamp": 1708762978, "time_this_iter_s": 11.306905746459961, "time_total_s": 319.9482157230377, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15cd940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 319.9482157230377, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.71333333333333, "ram_util_percent": 8.993333333333334, "gpu_util_percent0": 0.050666666666666665, "vram_util_percent0": 0.026529947916666675}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -218.53020395780857, "episode_reward_mean": -180.8653526732753, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.82849742727086, -178.74694395714747, -173.0607881204161, -177.96619458981934, -168.95699668760918, -190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3231663917303804, "mean_inference_ms": 1.1919765709135222, "mean_action_processing_ms": 0.09150383070407703, "mean_env_wait_ms": 0.5708707498889379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 696000, "timesteps_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"sample_time_ms": 11333.654, "sample_throughput": 2117.587, "load_time_ms": 0.232, "load_throughput": 103488532.95, "learn_time_ms": 938.978, "learn_throughput": 25559.692, "update_time_ms": 8.101}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 0.6111132502555847, "policy_loss": 0.02579267608234659, "vf_loss": 0.6004473716020584, "vf_explained_var": 9.815394878387451e-05, "kl": 0.001468272427541939, "entropy": 1.5126808881759644, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 696000, "num_agent_steps_sampled": 696000, "num_steps_trained": 696000, "num_agent_steps_trained": 696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 145, "training_iteration": 29, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-23-09", "timestamp": 1708762989, "time_this_iter_s": 11.313246726989746, "time_total_s": 331.26146245002747, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5415de50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 331.26146245002747, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.346666666666668, "ram_util_percent": 9.0, "gpu_util_percent0": 0.05533333333333333, "vram_util_percent0": 0.026529947916666675}}
{"episode_reward_max": -166.77431671352844, "episode_reward_min": -218.53020395780857, "episode_reward_mean": -181.6894666643158, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.0345419611489, -178.92399599305202, -195.16331310302272, -180.40051815913358, -166.77431671352844, -187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3232807237067588, "mean_inference_ms": 1.1921459355498685, "mean_action_processing_ms": 0.09149603386462968, "mean_env_wait_ms": 0.5710168258877684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 11356.802, "sample_throughput": 2113.271, "load_time_ms": 0.232, "load_throughput": 103669717.817, "learn_time_ms": 938.767, "learn_throughput": 25565.446, "update_time_ms": 8.095}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005, "total_loss": 0.7204761691391468, "policy_loss": -0.054457992780953646, "vf_loss": 0.7907551974058151, "vf_explained_var": -9.576231241226196e-05, "kl": 0.0008762035696827097, "entropy": 1.582100734114647, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 30, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-23-20", "timestamp": 1708763000, "time_this_iter_s": 11.31940221786499, "time_total_s": 342.58086466789246, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae06a0430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 342.58086466789246, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 9.05625, "gpu_util_percent0": 0.045625, "vram_util_percent0": 0.026529947916666668}}
{"episode_reward_max": -167.2462312973609, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -182.80176377404248, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.87475006496774, -211.9225021480715, -190.8583087381725, -182.48103407632428, -201.07413520634134, -186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3233968844068169, "mean_inference_ms": 1.192403324930745, "mean_action_processing_ms": 0.0914972155710037, "mean_env_wait_ms": 0.5711602360591808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 744000, "timesteps_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"sample_time_ms": 11412.717, "sample_throughput": 2102.917, "load_time_ms": 0.23, "load_throughput": 104455012.971, "learn_time_ms": 938.99, "learn_throughput": 25559.371, "update_time_ms": 7.935}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 1.5200837701559067, "policy_loss": 0.0654274607077241, "vf_loss": 1.470496691763401, "vf_explained_var": -0.0003312230110168457, "kl": 0.003490687644477748, "entropy": 1.5840335041284561, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 744000, "num_agent_steps_sampled": 744000, "num_steps_trained": 744000, "num_agent_steps_trained": 744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 155, "training_iteration": 31, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-23-32", "timestamp": 1708763012, "time_this_iter_s": 11.565686702728271, "time_total_s": 354.1465513706207, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404df70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 354.1465513706207, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 33.25333333333334, "ram_util_percent": 9.02, "gpu_util_percent0": 0.09333333333333334, "vram_util_percent0": 0.026578776041666658}}
{"episode_reward_max": -167.2462312973609, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -181.64760116404696, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.24560332714452, -186.465309341578, -184.4505385394421, -190.80446918350313, -181.00712879901926, -187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32352782875668773, "mean_inference_ms": 1.1927431455333075, "mean_action_processing_ms": 0.091507794083157, "mean_env_wait_ms": 0.571318605047015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 11428.267, "sample_throughput": 2100.056, "load_time_ms": 0.23, "load_throughput": 104563515.114, "learn_time_ms": 943.775, "learn_throughput": 25429.797, "update_time_ms": 8.022}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 0.6113525032997131, "policy_loss": 0.02918153500650078, "vf_loss": 0.5964335799217224, "vf_explained_var": -0.0001727864146232605, "kl": 0.008866248330167803, "entropy": 1.426262080669403, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 768000, "num_steps_trained": 768000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 32, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-23-44", "timestamp": 1708763024, "time_this_iter_s": 11.704259395599365, "time_total_s": 365.8508107662201, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e89b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 365.8508107662201, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.3875, "ram_util_percent": 9.037500000000001, "gpu_util_percent0": 0.074375, "vram_util_percent0": 0.026743570963541668}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -180.9104053489995, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.7630722560524, -188.70956660807116, -181.52588941211303, -175.4504570859059, -208.5064828279384, -175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32358874148489314, "mean_inference_ms": 1.192902848287129, "mean_action_processing_ms": 0.09149769644314017, "mean_env_wait_ms": 0.571369816188686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 792000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 11517.592, "sample_throughput": 2083.769, "load_time_ms": 0.229, "load_throughput": 104694015.601, "learn_time_ms": 940.637, "learn_throughput": 25514.617, "update_time_ms": 8.025}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 0.5360037758946419, "policy_loss": -0.007545852393377572, "vf_loss": 0.5571248158812523, "vf_explained_var": -0.00040728598833084106, "kl": 0.00023634838333808084, "entropy": 1.3575163930654526, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 792000, "num_agent_steps_sampled": 792000, "num_steps_trained": 792000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 165, "training_iteration": 33, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-23-56", "timestamp": 1708763036, "time_this_iter_s": 12.398010969161987, "time_total_s": 378.2488217353821, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e541e59d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 378.2488217353821, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.256249999999994, "ram_util_percent": 9.087499999999999, "gpu_util_percent0": 0.15812500000000002, "vram_util_percent0": 0.02649688720703125}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -180.2110196290606, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.41272301005253, -190.40090607796856, -182.14129387437927, -168.60279473415903, -170.64983928933833, -170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3235018103870189, "mean_inference_ms": 1.1925911815524142, "mean_action_processing_ms": 0.09145283249456591, "mean_env_wait_ms": 0.571214598859368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 816000, "timesteps_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"sample_time_ms": 11507.331, "sample_throughput": 2085.627, "load_time_ms": 0.229, "load_throughput": 104912241.793, "learn_time_ms": 943.364, "learn_throughput": 25440.858, "update_time_ms": 8.121}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 0.5771849229931831, "policy_loss": 0.009812865871936083, "vf_loss": 0.5813406258821487, "vf_explained_var": -0.0002333521842956543, "kl": 0.0005617231209729678, "entropy": 1.3968537002801895, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 816000, "num_agent_steps_sampled": 816000, "num_steps_trained": 816000, "num_agent_steps_trained": 816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 34, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-24-07", "timestamp": 1708763047, "time_this_iter_s": 11.353581428527832, "time_total_s": 389.6024031639099, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404d700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 389.6024031639099, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.806250000000002, "ram_util_percent": 9.09375, "gpu_util_percent0": 0.02125, "vram_util_percent0": 0.025716145833333332}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -179.94322031880066, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.93135378387487, -171.82920493409313, -169.4285821848078, -167.7256442999712, -177.93639169151965, -167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3234091488452215, "mean_inference_ms": 1.192193720356847, "mean_action_processing_ms": 0.09140559274267894, "mean_env_wait_ms": 0.5710581564447607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 11552.471, "sample_throughput": 2077.478, "load_time_ms": 0.229, "load_throughput": 104824842.237, "learn_time_ms": 941.858, "learn_throughput": 25481.536, "update_time_ms": 8.14}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005, "total_loss": 0.5182452313601971, "policy_loss": -0.023404101375490427, "vf_loss": 0.5559654459357262, "vf_explained_var": 5.2094459533691406e-05, "kl": 0.0022277633894848548, "entropy": 1.4316107779741287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 35, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-24-19", "timestamp": 1708763059, "time_this_iter_s": 11.68486762046814, "time_total_s": 401.28727078437805, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e8b83a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 401.28727078437805, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 33.49999999999999, "ram_util_percent": 9.12, "gpu_util_percent0": 0.10000000000000002, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -180.37817272814556, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.2462312973609, -174.02111431582878, -170.53173666291502, -174.314381575441, -171.48145415701677, -177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3233027285669112, "mean_inference_ms": 1.1917290024640015, "mean_action_processing_ms": 0.09135281475470093, "mean_env_wait_ms": 0.5708506036153872, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 864000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 11530.032, "sample_throughput": 2081.521, "load_time_ms": 0.222, "load_throughput": 107868941.277, "learn_time_ms": 940.444, "learn_throughput": 25519.857, "update_time_ms": 8.016}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005, "total_loss": 0.6672254502773285, "policy_loss": -0.006105542881414294, "vf_loss": 0.6881769448518753, "vf_explained_var": -0.0002622529864311218, "kl": 0.000809623262623127, "entropy": 1.4845967441797256, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 864000, "num_agent_steps_sampled": 864000, "num_steps_trained": 864000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 36, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-24-30", "timestamp": 1708763070, "time_this_iter_s": 11.053340435028076, "time_total_s": 412.3406112194061, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5415ddc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 412.3406112194061, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 28.940000000000005, "ram_util_percent": 9.106666666666664, "gpu_util_percent0": 0.004, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -180.42562236466136, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.2250839973823, -173.28331808049532, -167.9113917715948, -192.1154054078192, -198.40657892154974, -182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3232044627437217, "mean_inference_ms": 1.1912873524369316, "mean_action_processing_ms": 0.09130458202214031, "mean_env_wait_ms": 0.5706715546739914, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 888000, "timesteps_this_iter": 0, "agent_timesteps_total": 888000, "timers": {"sample_time_ms": 11496.916, "sample_throughput": 2087.516, "load_time_ms": 0.22, "load_throughput": 109001944.775, "learn_time_ms": 939.298, "learn_throughput": 25550.993, "update_time_ms": 7.998}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005, "total_loss": 0.5317017771303654, "policy_loss": -0.01640136889182031, "vf_loss": 0.5631652250885963, "vf_explained_var": -0.00011046230792999268, "kl": 0.00040272138720792716, "entropy": 1.5062087774276733, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 888000, "num_agent_steps_sampled": 888000, "num_steps_trained": 888000, "num_agent_steps_trained": 888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 185, "training_iteration": 37, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-24-41", "timestamp": 1708763081, "time_this_iter_s": 10.99808406829834, "time_total_s": 423.33869528770447, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e89b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 423.33869528770447, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.800000000000004, "ram_util_percent": 9.139999999999997, "gpu_util_percent0": 0.004, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -220.64884863803184, "episode_reward_mean": -180.20325064915727, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.92801410814735, -180.0555974089343, -180.01484808130772, -191.39221274093615, -178.80642331305427, -172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3231176615986458, "mean_inference_ms": 1.1908956408058475, "mean_action_processing_ms": 0.0912628050189635, "mean_env_wait_ms": 0.5705164364347722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 912000, "timesteps_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"sample_time_ms": 11478.078, "sample_throughput": 2090.942, "load_time_ms": 0.22, "load_throughput": 109214816.101, "learn_time_ms": 941.831, "learn_throughput": 25482.29, "update_time_ms": 8.433}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005, "total_loss": 0.5819482617080212, "policy_loss": -0.02497143903747201, "vf_loss": 0.6225509867072105, "vf_explained_var": -0.00027777254581451416, "kl": 0.0009069809178611082, "entropy": 1.5631269663572311, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 912000, "num_agent_steps_sampled": 912000, "num_steps_trained": 912000, "num_agent_steps_trained": 912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 38, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-24-52", "timestamp": 1708763092, "time_this_iter_s": 11.162156105041504, "time_total_s": 434.500851392746, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5410e940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 434.500851392746, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.993333333333332, "ram_util_percent": 9.126666666666663, "gpu_util_percent0": 0.004, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -181.91873491439435, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.20522578091237, -169.21903091582953, -173.6941283314625, -170.60275206022692, -176.08521507691077, -169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3230690241469057, "mean_inference_ms": 1.1906631196691226, "mean_action_processing_ms": 0.09123347185827078, "mean_env_wait_ms": 0.5704023730945991, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 936000, "timesteps_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"sample_time_ms": 11515.214, "sample_throughput": 2084.199, "load_time_ms": 0.22, "load_throughput": 109202968.106, "learn_time_ms": 943.317, "learn_throughput": 25442.124, "update_time_ms": 8.489}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005, "total_loss": 2.0815849974751472, "policy_loss": 0.09159675613045692, "vf_loss": 2.0058279260993004, "vf_explained_var": -0.00021241605281829834, "kl": 0.0011587204739046397, "entropy": 1.5839591324329376, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 936000, "num_agent_steps_sampled": 936000, "num_steps_trained": 936000, "num_agent_steps_trained": 936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 195, "training_iteration": 39, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-25-04", "timestamp": 1708763104, "time_this_iter_s": 11.665717840194702, "time_total_s": 446.1665692329407, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e73660670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 446.1665692329407, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.53125, "ram_util_percent": 9.11875, "gpu_util_percent0": 0.11312500000000002, "vram_util_percent0": 0.027173360188802086}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -182.93947292080102, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.8881140777125, -172.8092976544374, -168.02532229236184, -171.34482516528627, -169.76476877132544, -184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.323040922145625, "mean_inference_ms": 1.1905110984189629, "mean_action_processing_ms": 0.09121263936683002, "mean_env_wait_ms": 0.5703456325639622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 11515.633, "sample_throughput": 2084.123, "load_time_ms": 0.221, "load_throughput": 108789901.654, "learn_time_ms": 941.259, "learn_throughput": 25497.752, "update_time_ms": 8.369}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005, "total_loss": 0.9440093152225018, "policy_loss": 0.024135572835803032, "vf_loss": 0.9348466619849205, "vf_explained_var": -0.00016460567712783813, "kl": 0.0024843711550649288, "entropy": 1.4972962141036987, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 40, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-25-15", "timestamp": 1708763115, "time_this_iter_s": 11.2872896194458, "time_total_s": 457.4538588523865, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 457.4538588523865, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.8, "ram_util_percent": 9.2, "gpu_util_percent0": 0.019333333333333334, "vram_util_percent0": 0.027018229166666675}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -182.96421491108123, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.32378052213997, -188.879940878661, -172.62070996647012, -179.06276493445563, -172.17626024018725, -208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3230395715457665, "mean_inference_ms": 1.190472998247464, "mean_action_processing_ms": 0.09120123632528399, "mean_env_wait_ms": 0.5703248894480193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 984000, "timesteps_this_iter": 0, "agent_timesteps_total": 984000, "timers": {"sample_time_ms": 11485.956, "sample_throughput": 2089.508, "load_time_ms": 0.221, "load_throughput": 108520155.239, "learn_time_ms": 942.761, "learn_throughput": 25457.154, "update_time_ms": 8.386}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005, "total_loss": 0.580986637622118, "policy_loss": 0.03860530396923423, "vf_loss": 0.5567392259836197, "vf_explained_var": -0.0005910918116569519, "kl": 0.0018099049240025977, "entropy": 1.4357891380786896, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 984000, "num_agent_steps_sampled": 984000, "num_steps_trained": 984000, "num_agent_steps_trained": 984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 205, "training_iteration": 41, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-25-27", "timestamp": 1708763127, "time_this_iter_s": 11.310242414474487, "time_total_s": 468.76410126686096, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e8b83a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 468.76410126686096, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.266666666666666, "ram_util_percent": 9.193333333333332, "gpu_util_percent0": 0.017333333333333333, "vram_util_percent0": 0.02641059027777777}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -182.57580587075105, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.751392129714, -211.7038941065139, -216.53304080557365, -218.53020395780857, -192.91535755052618, -199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3230148771880582, "mean_inference_ms": 1.1903851519711686, "mean_action_processing_ms": 0.09118732536941819, "mean_env_wait_ms": 0.5702888114918488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1008000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 11447.821, "sample_throughput": 2096.469, "load_time_ms": 0.219, "load_throughput": 109345313.926, "learn_time_ms": 938.071, "learn_throughput": 25584.422, "update_time_ms": 8.306}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005, "total_loss": 0.5868822857737541, "policy_loss": 0.033872248022817075, "vf_loss": 0.5673372596502304, "vf_explained_var": -3.533065319061279e-05, "kl": 0.0010958065007695417, "entropy": 1.4327217489480972, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1008000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 1008000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 210, "training_iteration": 42, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-25-38", "timestamp": 1708763138, "time_this_iter_s": 11.261430025100708, "time_total_s": 480.02553129196167, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15071f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 480.02553129196167, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 29.966666666666665, "ram_util_percent": 9.2, "gpu_util_percent0": 0.034, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -180.78025240322145, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-199.5342682235552, -181.038665882132, -198.58177637585928, -181.909402977694, -189.0902361288692, -182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32297784554702014, "mean_inference_ms": 1.1902654156771082, "mean_action_processing_ms": 0.09116995484102709, "mean_env_wait_ms": 0.5702414021130264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1032000, "timesteps_this_iter": 0, "agent_timesteps_total": 1032000, "timers": {"sample_time_ms": 11341.496, "sample_throughput": 2116.123, "load_time_ms": 0.22, "load_throughput": 109309692.692, "learn_time_ms": 935.861, "learn_throughput": 25644.839, "update_time_ms": 8.312}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005, "total_loss": 0.5112287104129791, "policy_loss": -0.05540896626189351, "vf_loss": 0.5815223902463913, "vf_explained_var": -2.4020671844482422e-05, "kl": 0.0013822592590951276, "entropy": 1.488470271229744, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1032000, "num_agent_steps_sampled": 1032000, "num_steps_trained": 1032000, "num_agent_steps_trained": 1032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 215, "training_iteration": 43, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-25-49", "timestamp": 1708763149, "time_this_iter_s": 11.359965562820435, "time_total_s": 491.3854968547821, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cf820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 491.3854968547821, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.146666666666665, "ram_util_percent": 9.22, "gpu_util_percent0": 0.035333333333333335, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -181.226532216347, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.0370499806731, -183.18076618170252, -175.48207871049644, -198.66587044498877, -186.76640225250105, -174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3229396110997419, "mean_inference_ms": 1.190118041345982, "mean_action_processing_ms": 0.09115540918050184, "mean_env_wait_ms": 0.5701836853445114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1056000, "timesteps_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"sample_time_ms": 11325.432, "sample_throughput": 2119.124, "load_time_ms": 0.223, "load_throughput": 107592235.998, "learn_time_ms": 932.271, "learn_throughput": 25743.601, "update_time_ms": 8.181}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005, "total_loss": 0.9287462830543518, "policy_loss": 0.04715871423832141, "vf_loss": 0.896831214427948, "vf_explained_var": -0.00032736361026763916, "kl": 0.001244837724683626, "entropy": 1.5243628323078156, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1056000, "num_agent_steps_sampled": 1056000, "num_steps_trained": 1056000, "num_agent_steps_trained": 1056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 44, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-26-01", "timestamp": 1708763161, "time_this_iter_s": 11.179495096206665, "time_total_s": 502.56499195098877, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426b3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 502.56499195098877, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.30666666666667, "ram_util_percent": 9.273333333333335, "gpu_util_percent0": 0.020666666666666667, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -181.16439921781904, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.5488757370059, -170.12269386420186, -172.32497456055668, -173.95614951676646, -177.62246717630282, -170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3229068572401964, "mean_inference_ms": 1.1899810705400158, "mean_action_processing_ms": 0.09114343324824793, "mean_env_wait_ms": 0.5701414884767743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1080000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 11279.012, "sample_throughput": 2127.846, "load_time_ms": 0.238, "load_throughput": 100733809.667, "learn_time_ms": 933.787, "learn_throughput": 25701.806, "update_time_ms": 8.175}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005, "total_loss": 0.8135451376438141, "policy_loss": 0.0450683725066483, "vf_loss": 0.7831218019127846, "vf_explained_var": -0.00029840320348739624, "kl": 0.00245437927455161, "entropy": 1.4645033031702042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1080000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 1080000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 225, "training_iteration": 45, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-26-12", "timestamp": 1708763172, "time_this_iter_s": 11.271301031112671, "time_total_s": 513.8362929821014, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 513.8362929821014, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.166666666666664, "ram_util_percent": 9.293333333333331, "gpu_util_percent0": 0.03933333333333334, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -181.21023607688912, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.79491575711702, -174.6923340946135, -175.8309933287338, -178.33171821185786, -171.00303739931732, -176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32288505446200483, "mean_inference_ms": 1.1898594874229158, "mean_action_processing_ms": 0.0911299019699382, "mean_env_wait_ms": 0.57011138709454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1104000, "timesteps_this_iter": 0, "agent_timesteps_total": 1104000, "timers": {"sample_time_ms": 11305.744, "sample_throughput": 2122.815, "load_time_ms": 0.24, "load_throughput": 100182420.382, "learn_time_ms": 937.474, "learn_throughput": 25600.716, "update_time_ms": 8.167}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005, "total_loss": 0.6038315892219543, "policy_loss": -0.0049111639527836815, "vf_loss": 0.6229332834482193, "vf_explained_var": -0.00028877705335617065, "kl": 0.0011370681780841461, "entropy": 1.4190534353256226, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1104000, "num_agent_steps_sampled": 1104000, "num_steps_trained": 1104000, "num_agent_steps_trained": 1104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 230, "training_iteration": 46, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-26-23", "timestamp": 1708763183, "time_this_iter_s": 11.322094202041626, "time_total_s": 525.1583871841431, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae06a7e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 525.1583871841431, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.225, "ram_util_percent": 9.293750000000001, "gpu_util_percent0": 0.015625, "vram_util_percent0": 0.025716145833333332}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -181.20763230568207, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.9641561984556, -173.2532298951123, -172.63905790412355, -181.79760904868647, -176.10941693279543, -175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32286387311154136, "mean_inference_ms": 1.1897478777198982, "mean_action_processing_ms": 0.09111688704820085, "mean_env_wait_ms": 0.5700775731279945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1128000, "timesteps_this_iter": 0, "agent_timesteps_total": 1128000, "timers": {"sample_time_ms": 11336.125, "sample_throughput": 2117.126, "load_time_ms": 0.242, "load_throughput": 99371466.93, "learn_time_ms": 939.856, "learn_throughput": 25535.827, "update_time_ms": 8.179}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005, "total_loss": 0.6407115049660206, "policy_loss": 0.040833781473338604, "vf_loss": 0.6138376072049141, "vf_explained_var": -0.0003629326820373535, "kl": 0.0007231801851199718, "entropy": 1.395987331867218, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1128000, "num_agent_steps_sampled": 1128000, "num_steps_trained": 1128000, "num_agent_steps_trained": 1128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 235, "training_iteration": 47, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-26-35", "timestamp": 1708763195, "time_this_iter_s": 11.289252042770386, "time_total_s": 536.4476392269135, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e89b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 536.4476392269135, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.246666666666666, "ram_util_percent": 9.286666666666667, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -181.21191924698815, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.74483207958878, -175.20194680588875, -178.030162039047, -174.96823328665957, -174.38804106697447, -190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3228448704827321, "mean_inference_ms": 1.189630075654683, "mean_action_processing_ms": 0.09110411515235352, "mean_env_wait_ms": 0.5700573314020057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1152000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 11350.324, "sample_throughput": 2114.477, "load_time_ms": 0.241, "load_throughput": 99459832.032, "learn_time_ms": 936.553, "learn_throughput": 25625.897, "update_time_ms": 7.762}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005, "total_loss": 0.5588482692837715, "policy_loss": 0.002189676510170102, "vf_loss": 0.5704042688012123, "vf_explained_var": -0.00014879554510116577, "kl": 0.0014156716940469244, "entropy": 1.3745651245117188, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 1152000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 48, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-26-46", "timestamp": 1708763206, "time_this_iter_s": 11.238973379135132, "time_total_s": 547.6866126060486, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e8b83a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 547.6866126060486, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.973333333333333, "ram_util_percent": 9.306666666666667, "gpu_util_percent0": 0.034666666666666665, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -180.99943772025813, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.4978087662228, -176.68940377058382, -176.28015425979385, -194.79626874698084, -215.70718434272757, -181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32282144146453673, "mean_inference_ms": 1.1895206890246945, "mean_action_processing_ms": 0.09109125944952468, "mean_env_wait_ms": 0.5700394829849597, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1176000, "timesteps_this_iter": 0, "agent_timesteps_total": 1176000, "timers": {"sample_time_ms": 11306.721, "sample_throughput": 2122.631, "load_time_ms": 0.242, "load_throughput": 99302846.996, "learn_time_ms": 934.043, "learn_throughput": 25694.742, "update_time_ms": 7.786}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005, "total_loss": 0.5530526004731655, "policy_loss": 0.018803770628437633, "vf_loss": 0.5480891093611717, "vf_explained_var": -0.00020763278007507324, "kl": 0.0016339919668046654, "entropy": 1.384031057357788, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1176000, "num_agent_steps_sampled": 1176000, "num_steps_trained": 1176000, "num_agent_steps_trained": 1176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 245, "training_iteration": 49, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-26-57", "timestamp": 1708763217, "time_this_iter_s": 11.245315074920654, "time_total_s": 558.9319276809692, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e73660670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 558.9319276809692, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.553333333333338, "ram_util_percent": 9.360000000000001, "gpu_util_percent0": 0.018666666666666668, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -165.25946166036263, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -180.07198069381357, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.0726812709599, -220.64884863803184, -220.45752512815145, -206.74645790468966, -193.60088396071765, -167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32281109035498706, "mean_inference_ms": 1.1894343937345206, "mean_action_processing_ms": 0.09107850971078726, "mean_env_wait_ms": 0.570026043655789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1200000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 11316.219, "sample_throughput": 2120.85, "load_time_ms": 0.241, "load_throughput": 99459832.032, "learn_time_ms": 934.991, "learn_throughput": 25668.709, "update_time_ms": 7.828}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005, "total_loss": 0.46584953740239143, "policy_loss": -0.039048798847943544, "vf_loss": 0.5192214027047157, "vf_explained_var": -0.00029274821281433105, "kl": 0.0014167972462673095, "entropy": 1.432307779788971, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1200000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 1200000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -165.58903297118832, "episode_reward_min": -195.44671283860683, "episode_reward_mean": -180.21293559145514, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.5441481820994, -173.92467878601516, -195.44671283860683, -177.93430320507397, -187.1848711273207, -167.32233663799016, -174.6144970180966, -191.23754384956774, -165.58903297118832, -184.33123129859243], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3030702429827942, "mean_inference_ms": 1.2155310485080162, "mean_action_processing_ms": 0.08838338884707851, "mean_env_wait_ms": 0.5584760403064449, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 250, "training_iteration": 50, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-27-29", "timestamp": 1708763249, "time_this_iter_s": 32.26338601112366, "time_total_s": 591.1953136920929, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e541e5a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 591.1953136920929, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.116279069767437, "ram_util_percent": 9.379069767441859, "gpu_util_percent0": 0.034186046511627904, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -178.95210491372447, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.41077269276622, -176.19093848575537, -170.8832984597182, -175.16569479564208, -169.14376480045098, -168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3227939915221444, "mean_inference_ms": 1.1893109574297, "mean_action_processing_ms": 0.09106313555655524, "mean_env_wait_ms": 0.5700125938957121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1224000, "timesteps_this_iter": 0, "agent_timesteps_total": 1224000, "timers": {"sample_time_ms": 13416.98, "sample_throughput": 1788.778, "load_time_ms": 0.241, "load_throughput": 99785186.36, "learn_time_ms": 933.361, "learn_throughput": 25713.524, "update_time_ms": 7.87}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005, "total_loss": 0.6015852205455303, "policy_loss": -0.017769341327948496, "vf_loss": 0.6345814913511276, "vf_explained_var": -4.873424768447876e-05, "kl": 0.002285346793645726, "entropy": 1.5226942300796509, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1224000, "num_agent_steps_sampled": 1224000, "num_steps_trained": 1224000, "num_agent_steps_trained": 1224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 255, "training_iteration": 51, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-27-41", "timestamp": 1708763261, "time_this_iter_s": 11.42666506767273, "time_total_s": 602.6219787597656, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404d940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 602.6219787597656, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.513333333333332, "ram_util_percent": 9.393333333333336, "gpu_util_percent0": 0.034666666666666665, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -180.006564296286, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.8381281378855, -176.17770756937094, -170.74845039797043, -165.25946166036263, -174.22971992034746, -165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3227598361101971, "mean_inference_ms": 1.1891441833782226, "mean_action_processing_ms": 0.09104407162665447, "mean_env_wait_ms": 0.5699685574407075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1248000, "timesteps_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"sample_time_ms": 13424.271, "sample_throughput": 1787.807, "load_time_ms": 0.242, "load_throughput": 99165891.045, "learn_time_ms": 934.478, "learn_throughput": 25682.775, "update_time_ms": 7.938}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005, "total_loss": 0.8244370128959417, "policy_loss": -0.043797366321086884, "vf_loss": 0.883368007838726, "vf_explained_var": -0.000254213809967041, "kl": 0.0014591311919205895, "entropy": 1.513363167643547, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1248000, "num_agent_steps_sampled": 1248000, "num_steps_trained": 1248000, "num_agent_steps_trained": 1248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 52, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-27-52", "timestamp": 1708763272, "time_this_iter_s": 11.334243774414062, "time_total_s": 613.9562225341797, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404df70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 613.9562225341797, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.220000000000002, "ram_util_percent": 9.433333333333335, "gpu_util_percent0": 0.04266666666666667, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -179.99916523724846, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.85711722724636, -182.74307762870893, -176.28971271981814, -172.14981787409363, -174.97717074632155, -167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3226839177183152, "mean_inference_ms": 1.1887828500044784, "mean_action_processing_ms": 0.09101103072025722, "mean_env_wait_ms": 0.5698679550135018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1272000, "timesteps_this_iter": 0, "agent_timesteps_total": 1272000, "timers": {"sample_time_ms": 13425.914, "sample_throughput": 1787.588, "load_time_ms": 0.242, "load_throughput": 99371466.93, "learn_time_ms": 935.377, "learn_throughput": 25658.091, "update_time_ms": 7.941}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005, "total_loss": 0.5344991870224476, "policy_loss": 0.004907380207441747, "vf_loss": 0.5443873405456543, "vf_explained_var": -0.0004310905933380127, "kl": 0.0008093549371738784, "entropy": 1.4795511662960052, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1272000, "num_agent_steps_sampled": 1272000, "num_steps_trained": 1272000, "num_agent_steps_trained": 1272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 265, "training_iteration": 53, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-28-04", "timestamp": 1708763284, "time_this_iter_s": 11.369324922561646, "time_total_s": 625.3255474567413, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17030d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 625.3255474567413, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 9.418750000000001, "gpu_util_percent0": 0.023125000000000003, "vram_util_percent0": 0.025716145833333332}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -180.11671223248314, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.13628114847543, -171.42533109234873, -173.4968573313729, -168.39207935594746, -179.97707703176187, -168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32261083124915824, "mean_inference_ms": 1.1884365938863817, "mean_action_processing_ms": 0.09097869231139104, "mean_env_wait_ms": 0.5697714126834273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1296000, "timesteps_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"sample_time_ms": 13439.513, "sample_throughput": 1785.779, "load_time_ms": 0.238, "load_throughput": 100653230.677, "learn_time_ms": 938.345, "learn_throughput": 25576.957, "update_time_ms": 7.983}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005, "total_loss": 0.6598310321569443, "policy_loss": 0.05346527695655823, "vf_loss": 0.6215369179844856, "vf_explained_var": -9.653717279434204e-05, "kl": 0.0017207090338478004, "entropy": 1.5171152204275131, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1296000, "num_agent_steps_sampled": 1296000, "num_steps_trained": 1296000, "num_agent_steps_trained": 1296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 270, "training_iteration": 54, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-28-15", "timestamp": 1708763295, "time_this_iter_s": 11.336031913757324, "time_total_s": 636.6615793704987, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404dca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 636.6615793704987, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.10666666666667, "ram_util_percent": 9.40666666666667, "gpu_util_percent0": 0.018666666666666668, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -180.5540858724666, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.10163008035963, -173.44832062775575, -184.2595929673523, -191.86361029182473, -183.6732638614641, -168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3225265370292518, "mean_inference_ms": 1.1880378109212797, "mean_action_processing_ms": 0.09094117138510331, "mean_env_wait_ms": 0.5696502829793395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1320000, "timesteps_this_iter": 0, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 13445.995, "sample_throughput": 1784.918, "load_time_ms": 0.251, "load_throughput": 95496913.006, "learn_time_ms": 937.946, "learn_throughput": 25587.815, "update_time_ms": 7.988}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005, "total_loss": 0.5881454162299633, "policy_loss": -0.036117397248744965, "vf_loss": 0.639735646545887, "vf_explained_var": 0.00010789930820465088, "kl": 0.0016619779206295537, "entropy": 1.5472823530435562, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1320000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 1320000, "num_agent_steps_trained": 1320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 275, "training_iteration": 55, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-28-26", "timestamp": 1708763306, "time_this_iter_s": 11.301967859268188, "time_total_s": 647.9635472297668, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 647.9635472297668, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.506666666666668, "ram_util_percent": 9.453333333333335, "gpu_util_percent0": 0.018666666666666668, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -182.05721673549172, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.31932477742404, -178.10826960889557, -167.47837434281348, -171.12893535358177, -177.30497757742648, -172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3224526371123691, "mean_inference_ms": 1.1877013868711457, "mean_action_processing_ms": 0.09090912008314848, "mean_env_wait_ms": 0.5695520600781897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1344000, "timesteps_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"sample_time_ms": 13447.545, "sample_throughput": 1784.712, "load_time_ms": 0.251, "load_throughput": 95751256.54, "learn_time_ms": 935.291, "learn_throughput": 25660.474, "update_time_ms": 7.968}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005, "total_loss": 1.2976978346705437, "policy_loss": -0.025805922225117683, "vf_loss": 1.339529700577259, "vf_explained_var": -5.505979061126709e-06, "kl": 0.0015034407226001134, "entropy": 1.6025985032320023, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1344000, "num_agent_steps_sampled": 1344000, "num_steps_trained": 1344000, "num_agent_steps_trained": 1344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 56, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-28-38", "timestamp": 1708763318, "time_this_iter_s": 11.331813335418701, "time_total_s": 659.2953605651855, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404d700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 659.2953605651855, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.12, "ram_util_percent": 9.479999999999999, "gpu_util_percent0": 0.014000000000000002, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -183.61924459670027, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.42604179894462, -175.9606235813153, -179.97351573741082, -170.39895926634006, -187.94546624442293, -226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3223931747228233, "mean_inference_ms": 1.1874319130678508, "mean_action_processing_ms": 0.09088332898388794, "mean_env_wait_ms": 0.5694663761440176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1368000, "timesteps_this_iter": 0, "agent_timesteps_total": 1368000, "timers": {"sample_time_ms": 13445.143, "sample_throughput": 1785.031, "load_time_ms": 0.248, "load_throughput": 96847504.329, "learn_time_ms": 934.502, "learn_throughput": 25682.133, "update_time_ms": 8.111}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005, "total_loss": 0.8392212837934494, "policy_loss": -0.07137703406624496, "vf_loss": 0.9260586053133011, "vf_explained_var": -0.00011374056339263916, "kl": 0.0018722605880241439, "entropy": 1.5460291653871536, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1368000, "num_agent_steps_sampled": 1368000, "num_steps_trained": 1368000, "num_agent_steps_trained": 1368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 285, "training_iteration": 57, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-28-49", "timestamp": 1708763329, "time_this_iter_s": 11.284262895584106, "time_total_s": 670.5796234607697, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16cf3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 670.5796234607697, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 29.7, "ram_util_percent": 9.5, "gpu_util_percent0": 0.010000000000000002, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -241.52501349783407, "episode_reward_mean": -183.54517190537064, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-226.6177352343681, -189.6604257352937, -241.52501349783407, -236.60064366704634, -190.3417040415458, -210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3223491061846883, "mean_inference_ms": 1.1872115636576699, "mean_action_processing_ms": 0.09086079788638718, "mean_env_wait_ms": 0.569388586653658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1392000, "timesteps_this_iter": 0, "agent_timesteps_total": 1392000, "timers": {"sample_time_ms": 13455.162, "sample_throughput": 1783.702, "load_time_ms": 0.248, "load_throughput": 96884789.22, "learn_time_ms": 934.916, "learn_throughput": 25670.744, "update_time_ms": 8.14}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0005, "total_loss": 0.671795979142189, "policy_loss": 0.06980845408543246, "vf_loss": 0.6168956160545349, "vf_explained_var": -7.317960262298584e-05, "kl": 0.0011230066759119195, "entropy": 1.4908097386360168, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1392000, "num_agent_steps_sampled": 1392000, "num_steps_trained": 1392000, "num_agent_steps_trained": 1392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 290, "training_iteration": 58, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-29-00", "timestamp": 1708763340, "time_this_iter_s": 11.346942663192749, "time_total_s": 681.9265661239624, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5410eb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 681.9265661239624, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.15333333333333, "ram_util_percent": 9.533333333333331, "gpu_util_percent0": 0.012, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -181.40723205641777, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.4431511010125, -175.52363087353044, -182.48995402413613, -207.2890941571572, -188.13432265017244, -167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3222942230253848, "mean_inference_ms": 1.1869513133824836, "mean_action_processing_ms": 0.09083543356820453, "mean_env_wait_ms": 0.5692933531105225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1416000, "timesteps_this_iter": 0, "agent_timesteps_total": 1416000, "timers": {"sample_time_ms": 13462.543, "sample_throughput": 1782.724, "load_time_ms": 0.248, "load_throughput": 96782324.776, "learn_time_ms": 937.032, "learn_throughput": 25612.775, "update_time_ms": 8.092}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005, "total_loss": 0.6626835912466049, "policy_loss": 0.0409687920473516, "vf_loss": 0.6365935504436493, "vf_explained_var": -0.00014909356832504272, "kl": 0.0017198965759864793, "entropy": 1.487873136997223, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1416000, "num_agent_steps_sampled": 1416000, "num_steps_trained": 1416000, "num_agent_steps_trained": 1416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 295, "training_iteration": 59, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-29-12", "timestamp": 1708763352, "time_this_iter_s": 11.334102630615234, "time_total_s": 693.2606687545776, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ef670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 693.2606687545776, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 30.266666666666666, "ram_util_percent": 9.5, "gpu_util_percent0": 0.024666666666666667, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -180.23904742303287, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.41390149180336, -178.60625370869525, -166.55501505468922, -175.0866526280885, -166.64470410587163, -171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3222435247745093, "mean_inference_ms": 1.1867207680027303, "mean_action_processing_ms": 0.09081281655959694, "mean_env_wait_ms": 0.5691969479591227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 13462.475, "sample_throughput": 1782.733, "load_time_ms": 0.248, "load_throughput": 96866143.187, "learn_time_ms": 937.16, "learn_throughput": 25609.298, "update_time_ms": 8.021}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0005, "total_loss": 0.6235484145581722, "policy_loss": 0.018248399428557605, "vf_loss": 0.6204247549176216, "vf_explained_var": 8.150935173034668e-06, "kl": 0.003187338864115742, "entropy": 1.51247438788414, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1440000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 1440000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 60, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-29-23", "timestamp": 1708763363, "time_this_iter_s": 11.397266387939453, "time_total_s": 704.6579351425171, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 704.6579351425171, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.200000000000003, "ram_util_percent": 9.513333333333332, "gpu_util_percent0": 0.028666666666666667, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -180.77399480074249, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.31600278932868, -174.26043579158545, -169.44095726432906, -173.72660648055327, -169.4785501830995, -168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3221988914348502, "mean_inference_ms": 1.186502285483426, "mean_action_processing_ms": 0.09079112748887531, "mean_env_wait_ms": 0.5691073699118164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1464000, "timesteps_this_iter": 0, "agent_timesteps_total": 1464000, "timers": {"sample_time_ms": 11367.993, "sample_throughput": 2111.191, "load_time_ms": 0.249, "load_throughput": 96439256.563, "learn_time_ms": 941.111, "learn_throughput": 25501.777, "update_time_ms": 8.235}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0005, "total_loss": 0.6438678205013275, "policy_loss": -0.0742101320065558, "vf_loss": 0.7331720814108849, "vf_explained_var": -0.0002826377749443054, "kl": 0.001803514139857347, "entropy": 1.5094147026538849, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1464000, "num_agent_steps_sampled": 1464000, "num_steps_trained": 1464000, "num_agent_steps_trained": 1464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 305, "training_iteration": 61, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-29-35", "timestamp": 1708763375, "time_this_iter_s": 11.385880708694458, "time_total_s": 716.0438158512115, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16d50d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 716.0438158512115, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 30.225, "ram_util_percent": 9.55, "gpu_util_percent0": 0.036875000000000005, "vram_util_percent0": 0.025716145833333332}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -180.86641446401686, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.59830111983084, -173.72886135858806, -169.16476186506884, -170.79323009470858, -186.59338735897973, -198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3221594078218014, "mean_inference_ms": 1.186309990123532, "mean_action_processing_ms": 0.09077141782059789, "mean_env_wait_ms": 0.5690177859955949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1488000, "timesteps_this_iter": 0, "agent_timesteps_total": 1488000, "timers": {"sample_time_ms": 11363.213, "sample_throughput": 2112.079, "load_time_ms": 0.248, "load_throughput": 96605850.288, "learn_time_ms": 941.185, "learn_throughput": 25499.757, "update_time_ms": 8.245}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0005, "total_loss": 0.6501703783869743, "policy_loss": 0.0005825061816722155, "vf_loss": 0.6645622402429581, "vf_explained_var": 3.269314765930176e-05, "kl": 0.0015757587945435525, "entropy": 1.4974357187747955, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1488000, "num_agent_steps_sampled": 1488000, "num_steps_trained": 1488000, "num_agent_steps_trained": 1488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 310, "training_iteration": 62, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-29-46", "timestamp": 1708763386, "time_this_iter_s": 11.270911455154419, "time_total_s": 727.314727306366, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15078b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 727.314727306366, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 29.846666666666668, "ram_util_percent": 9.586666666666666, "gpu_util_percent0": 0.009333333333333334, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -181.2483730046403, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.96202573879145, -201.0064224494095, -196.33438560949807, -205.61844448972002, -192.86105261324806, -195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3221197018342244, "mean_inference_ms": 1.1861229176992574, "mean_action_processing_ms": 0.09075196719319155, "mean_env_wait_ms": 0.5689263870858224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1512000, "timesteps_this_iter": 0, "agent_timesteps_total": 1512000, "timers": {"sample_time_ms": 11359.126, "sample_throughput": 2112.839, "load_time_ms": 0.249, "load_throughput": 96476227.717, "learn_time_ms": 945.291, "learn_throughput": 25389.02, "update_time_ms": 8.226}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0005, "total_loss": 0.8583547882735729, "policy_loss": 0.03877933695912361, "vf_loss": 0.8347721621394157, "vf_explained_var": -0.00023278594017028809, "kl": 0.0005430717573008254, "entropy": 1.5196679085493088, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1512000, "num_agent_steps_sampled": 1512000, "num_steps_trained": 1512000, "num_agent_steps_trained": 1512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 315, "training_iteration": 63, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-29-57", "timestamp": 1708763397, "time_this_iter_s": 11.371243238449097, "time_total_s": 738.6859705448151, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17efca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 738.6859705448151, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.513333333333335, "ram_util_percent": 9.599999999999998, "gpu_util_percent0": 0.03133333333333334, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -180.993320547996, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.77145338817616, -166.76702159882484, -194.24262327549073, -188.0605277046222, -175.0772417504436, -173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32208612143578547, "mean_inference_ms": 1.1859656366532674, "mean_action_processing_ms": 0.09073277924695197, "mean_env_wait_ms": 0.5688407560703207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 11362.744, "sample_throughput": 2112.166, "load_time_ms": 0.254, "load_throughput": 94590580.718, "learn_time_ms": 944.431, "learn_throughput": 25412.137, "update_time_ms": 8.228}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0005, "total_loss": 1.018811322748661, "policy_loss": 0.05273660738021135, "vf_loss": 0.9808049276471138, "vf_explained_var": -0.00017086416482925415, "kl": 0.0015282178568032795, "entropy": 1.4730209410190582, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1536000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 1536000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 64, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-30-09", "timestamp": 1708763409, "time_this_iter_s": 11.322348356246948, "time_total_s": 750.008318901062, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 750.008318901062, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.526666666666664, "ram_util_percent": 9.606666666666664, "gpu_util_percent0": 0.016666666666666666, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -180.48961187516133, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.55509533756532, -178.34189786477964, -167.47113967894265, -176.98704384032888, -176.8036700402262, -176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3220600084142884, "mean_inference_ms": 1.1858304199626992, "mean_action_processing_ms": 0.09071521638158143, "mean_env_wait_ms": 0.5687532465339895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1560000, "timers": {"sample_time_ms": 11367.798, "sample_throughput": 2111.227, "load_time_ms": 0.225, "load_throughput": 106668746.424, "learn_time_ms": 944.107, "learn_throughput": 25420.837, "update_time_ms": 8.179}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0005, "total_loss": 0.6288020759820938, "policy_loss": 0.05367703491356224, "vf_loss": 0.5891984179615974, "vf_explained_var": 5.171447992324829e-05, "kl": 0.00046302887888877153, "entropy": 1.4073409736156464, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1560000, "num_agent_steps_sampled": 1560000, "num_steps_trained": 1560000, "num_agent_steps_trained": 1560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 325, "training_iteration": 65, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-30-20", "timestamp": 1708763420, "time_this_iter_s": 11.356091499328613, "time_total_s": 761.3644104003906, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16d59d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 761.3644104003906, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.333333333333332, "ram_util_percent": 9.639999999999997, "gpu_util_percent0": 0.017333333333333333, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -180.6563244918064, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.89813446647244, -175.56627570853465, -172.29319305088882, -176.2794586654232, -169.35555977961045, -176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32203954793568323, "mean_inference_ms": 1.1857174197100802, "mean_action_processing_ms": 0.09069945363284948, "mean_env_wait_ms": 0.5686741568032678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1584000, "timesteps_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"sample_time_ms": 11380.263, "sample_throughput": 2108.914, "load_time_ms": 0.225, "load_throughput": 106759249.125, "learn_time_ms": 943.758, "learn_throughput": 25430.26, "update_time_ms": 8.259}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0005, "total_loss": 0.5197635479271412, "policy_loss": -0.03940238105133176, "vf_loss": 0.5735752210021019, "vf_explained_var": -7.87004828453064e-05, "kl": 0.0013947986142388569, "entropy": 1.4409250915050507, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1584000, "num_agent_steps_sampled": 1584000, "num_steps_trained": 1584000, "num_agent_steps_trained": 1584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 330, "training_iteration": 66, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-30-31", "timestamp": 1708763431, "time_this_iter_s": 11.45858645439148, "time_total_s": 772.8229968547821, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ef940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 772.8229968547821, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.833333333333332, "ram_util_percent": 9.653333333333332, "gpu_util_percent0": 0.018666666666666668, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -181.68539704572635, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.09843808724744, -173.0518381484219, -180.27380786632358, -172.11939051685818, -179.64868949093716, -174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3220129481523666, "mean_inference_ms": 1.1856216462883729, "mean_action_processing_ms": 0.09068509147385591, "mean_env_wait_ms": 0.5685972100594447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1608000, "timesteps_this_iter": 0, "agent_timesteps_total": 1608000, "timers": {"sample_time_ms": 11381.772, "sample_throughput": 2108.635, "load_time_ms": 0.225, "load_throughput": 106488200.571, "learn_time_ms": 943.115, "learn_throughput": 25447.582, "update_time_ms": 8.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0005, "total_loss": 0.7796117067337036, "policy_loss": -0.009404760785400867, "vf_loss": 0.8040545508265495, "vf_explained_var": -0.00010623037815093994, "kl": 0.0019767315104245314, "entropy": 1.5038089752197266, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1608000, "num_agent_steps_sampled": 1608000, "num_steps_trained": 1608000, "num_agent_steps_trained": 1608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 335, "training_iteration": 67, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-30-43", "timestamp": 1708763443, "time_this_iter_s": 11.293677568435669, "time_total_s": 784.1166744232178, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 784.1166744232178, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.71333333333333, "ram_util_percent": 9.693333333333333, "gpu_util_percent0": 0.013333333333333334, "vram_util_percent0": 0.025716145833333325}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -183.2222288512587, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.39634467996063, -173.07637290521, -168.07576778790343, -168.87675689788315, -172.659820334201, -166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32199192563488993, "mean_inference_ms": 1.1855536680148235, "mean_action_processing_ms": 0.09067225288103631, "mean_env_wait_ms": 0.5685180791824224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1632000, "timesteps_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"sample_time_ms": 11382.711, "sample_throughput": 2108.461, "load_time_ms": 0.226, "load_throughput": 106308264.864, "learn_time_ms": 942.842, "learn_throughput": 25454.946, "update_time_ms": 8.126}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0005, "total_loss": 1.006053388118744, "policy_loss": -0.006989156187046319, "vf_loss": 1.0278518795967102, "vf_explained_var": -0.0003435760736465454, "kl": 0.0032633398842249126, "entropy": 1.480934426188469, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1632000, "num_agent_steps_sampled": 1632000, "num_steps_trained": 1632000, "num_agent_steps_trained": 1632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 68, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-30-54", "timestamp": 1708763454, "time_this_iter_s": 11.366305351257324, "time_total_s": 795.4829797744751, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae16d5430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 795.4829797744751, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.27999999999999, "ram_util_percent": 9.726666666666667, "gpu_util_percent0": 0.018666666666666668, "vram_util_percent0": 0.025390625}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -183.36438869593573, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.6793023356326, -170.73211395150344, -169.91717496090038, -170.14900162676994, -183.74752436704048, -176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3219763747399201, "mean_inference_ms": 1.1855155081477904, "mean_action_processing_ms": 0.09065893350667659, "mean_env_wait_ms": 0.5684407348858503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1656000, "timesteps_this_iter": 0, "agent_timesteps_total": 1656000, "timers": {"sample_time_ms": 11391.956, "sample_throughput": 2106.75, "load_time_ms": 0.225, "load_throughput": 106612260.114, "learn_time_ms": 942.056, "learn_throughput": 25476.181, "update_time_ms": 8.129}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005, "total_loss": 0.6412861719727516, "policy_loss": 0.027823138356325217, "vf_loss": 0.6273960173130035, "vf_explained_var": -0.0004779398441314697, "kl": 0.0021785889057271968, "entropy": 1.3932980298995972, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1656000, "num_agent_steps_sampled": 1656000, "num_steps_trained": 1656000, "num_agent_steps_trained": 1656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 345, "training_iteration": 69, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-31-06", "timestamp": 1708763466, "time_this_iter_s": 11.422229290008545, "time_total_s": 806.9052090644836, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae06a7ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 806.9052090644836, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.506666666666664, "ram_util_percent": 9.7, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -163.63894589404796, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -183.4103561313081, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.3850950646763, -184.71769684484914, -163.63894589404796, -194.96096229575662, -190.83611879431646, -170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3219546793425373, "mean_inference_ms": 1.185488279647097, "mean_action_processing_ms": 0.09064541874362861, "mean_env_wait_ms": 0.5683525233360068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1680000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 11388.375, "sample_throughput": 2107.412, "load_time_ms": 0.227, "load_throughput": 105816562.599, "learn_time_ms": 941.928, "learn_throughput": 25479.658, "update_time_ms": 8.233}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0005, "total_loss": 0.5839981473982334, "policy_loss": 0.013974374393001199, "vf_loss": 0.5832660347223282, "vf_explained_var": -0.00022560358047485352, "kl": 0.0004746147681654045, "entropy": 1.3242277055978775, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1680000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 1680000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 350, "training_iteration": 70, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-31-17", "timestamp": 1708763477, "time_this_iter_s": 11.367396354675293, "time_total_s": 818.2726054191589, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e89b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 818.2726054191589, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 30.22666666666667, "ram_util_percent": 9.726666666666668, "gpu_util_percent0": 0.03666666666666667, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.33111195622368, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -182.88573925534837, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.8189329929285, -184.47072237665506, -189.84852868337296, -214.29440499326773, -204.80781844425692, -172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3219358723572634, "mean_inference_ms": 1.1854599801537176, "mean_action_processing_ms": 0.09063389987900247, "mean_env_wait_ms": 0.5682616106253949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1704000, "timesteps_this_iter": 0, "agent_timesteps_total": 1704000, "timers": {"sample_time_ms": 11397.133, "sample_throughput": 2105.793, "load_time_ms": 0.226, "load_throughput": 105994836.264, "learn_time_ms": 942.236, "learn_throughput": 25471.326, "update_time_ms": 8.787}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0005, "total_loss": 0.5447300225496292, "policy_loss": 0.006984187755733728, "vf_loss": 0.5510772615671158, "vf_explained_var": -7.946044206619263e-05, "kl": 0.0005170796263696542, "entropy": 1.33314049243927, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1704000, "num_agent_steps_sampled": 1704000, "num_steps_trained": 1704000, "num_agent_steps_trained": 1704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 355, "training_iteration": 71, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-31-29", "timestamp": 1708763489, "time_this_iter_s": 11.48438811302185, "time_total_s": 829.7569935321808, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404daf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 829.7569935321808, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.3125, "ram_util_percent": 9.775, "gpu_util_percent0": 0.02125, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.33111195622368, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -181.81780878610715, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.1688563280511, -169.67568403705565, -171.35943097157562, -167.67176563405633, -173.6378248114466, -164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3219184325092823, "mean_inference_ms": 1.185429333660308, "mean_action_processing_ms": 0.09062355607501774, "mean_env_wait_ms": 0.5681678665733951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1728000, "timesteps_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"sample_time_ms": 11398.775, "sample_throughput": 2105.489, "load_time_ms": 0.228, "load_throughput": 105428671.973, "learn_time_ms": 943.713, "learn_throughput": 25431.466, "update_time_ms": 8.746}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0005, "total_loss": 0.5660792477428913, "policy_loss": 0.022546518594026566, "vf_loss": 0.5575306490063667, "vf_explained_var": -7.002055644989014e-05, "kl": 0.0013288622667849692, "entropy": 1.3997922241687775, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1728000, "num_agent_steps_sampled": 1728000, "num_steps_trained": 1728000, "num_agent_steps_trained": 1728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 72, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-31-40", "timestamp": 1708763500, "time_this_iter_s": 11.291592836380005, "time_total_s": 841.0485863685608, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 841.0485863685608, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 29.726666666666667, "ram_util_percent": 9.780000000000001, "gpu_util_percent0": 0.010666666666666668, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.33111195622368, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -181.738573914599, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.33111195622368, -193.95173215727698, -184.1685966338862, -173.65604252567394, -167.66411244659147, -167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3218937434863285, "mean_inference_ms": 1.1854103105018594, "mean_action_processing_ms": 0.09061447650786539, "mean_env_wait_ms": 0.5680712520042247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1752000, "timesteps_this_iter": 0, "agent_timesteps_total": 1752000, "timers": {"sample_time_ms": 11403.128, "sample_throughput": 2104.686, "load_time_ms": 0.227, "load_throughput": 105594562.048, "learn_time_ms": 940.886, "learn_throughput": 25507.874, "update_time_ms": 8.738}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0005, "total_loss": 0.5080063119530678, "policy_loss": 0.0016093042213469744, "vf_loss": 0.5210904255509377, "vf_explained_var": -0.00029753148555755615, "kl": 0.0025377596852307616, "entropy": 1.4693420082330704, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1752000, "num_agent_steps_sampled": 1752000, "num_steps_trained": 1752000, "num_agent_steps_trained": 1752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 365, "training_iteration": 73, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-31-51", "timestamp": 1708763511, "time_this_iter_s": 11.373102188110352, "time_total_s": 852.4216885566711, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 852.4216885566711, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 30.186666666666667, "ram_util_percent": 9.8, "gpu_util_percent0": 0.02333333333333333, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -182.64896779965457, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.60885378958528, -186.7855205436916, -185.1989770294728, -175.57049002690144, -189.00114856860822, -190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3218731104799093, "mean_inference_ms": 1.18539214961165, "mean_action_processing_ms": 0.09060603437665461, "mean_env_wait_ms": 0.5679710856910681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1776000, "timesteps_this_iter": 0, "agent_timesteps_total": 1776000, "timers": {"sample_time_ms": 11399.618, "sample_throughput": 2105.334, "load_time_ms": 0.254, "load_throughput": 94661741.584, "learn_time_ms": 940.856, "learn_throughput": 25508.686, "update_time_ms": 8.749}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0005, "total_loss": 0.9806205493514426, "policy_loss": 0.01984444260597229, "vf_loss": 0.975876584649086, "vf_explained_var": -0.00020913779735565186, "kl": 0.0016235237277114623, "entropy": 1.5100452601909637, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1776000, "num_agent_steps_sampled": 1776000, "num_steps_trained": 1776000, "num_agent_steps_trained": 1776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 370, "training_iteration": 74, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-32-03", "timestamp": 1708763523, "time_this_iter_s": 11.315762519836426, "time_total_s": 863.7374510765076, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e73660700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 863.7374510765076, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 30.286666666666672, "ram_util_percent": 9.793333333333333, "gpu_util_percent0": 0.021333333333333336, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -183.80195372395445, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.37324008403675, -221.13801342007923, -221.2646204332359, -198.74127680991631, -220.14235338399493, -194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32185309981902877, "mean_inference_ms": 1.185383261048951, "mean_action_processing_ms": 0.09059903453907242, "mean_env_wait_ms": 0.5678777272080161, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1800000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 11401.02, "sample_throughput": 2105.075, "load_time_ms": 0.253, "load_throughput": 94715182.537, "learn_time_ms": 942.642, "learn_throughput": 25460.36, "update_time_ms": 8.783}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0005, "total_loss": 1.0710705369710922, "policy_loss": -0.00205433601513505, "vf_loss": 1.088088795542717, "vf_explained_var": -0.00011393427848815918, "kl": 0.002738397093963937, "entropy": 1.4963905215263367, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1800000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 1800000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 375, "training_iteration": 75, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-32-14", "timestamp": 1708763534, "time_this_iter_s": 11.389483451843262, "time_total_s": 875.1269345283508, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 875.1269345283508, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 30.56666666666667, "ram_util_percent": 9.873333333333337, "gpu_util_percent0": 0.021333333333333333, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -224.37148785760616, "episode_reward_mean": -182.60200161826967, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.5162776585018, -198.69274749747518, -200.33605480284052, -200.62609996457985, -224.37148785760616, -172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3218335643925206, "mean_inference_ms": 1.185386266309077, "mean_action_processing_ms": 0.09059180539994681, "mean_env_wait_ms": 0.5677887747462573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1824000, "timesteps_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"sample_time_ms": 11398.095, "sample_throughput": 2105.615, "load_time_ms": 0.254, "load_throughput": 94422001.688, "learn_time_ms": 944.034, "learn_throughput": 25422.809, "update_time_ms": 8.715}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0005, "total_loss": 0.6322495564818382, "policy_loss": 0.00044648931361734867, "vf_loss": 0.6461576297879219, "vf_explained_var": -7.652491331100464e-05, "kl": 0.003102505620392104, "entropy": 1.435456782579422, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1824000, "num_agent_steps_sampled": 1824000, "num_steps_trained": 1824000, "num_agent_steps_trained": 1824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 76, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-32-25", "timestamp": 1708763545, "time_this_iter_s": 11.425854921340942, "time_total_s": 886.5527894496918, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ef700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 886.5527894496918, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 30.18, "ram_util_percent": 9.833333333333336, "gpu_util_percent0": 0.017333333333333333, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -181.01960596655513, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.50322603694912, -178.4906691960546, -188.5027025184049, -174.48723075410192, -165.3135089899541, -177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3218202699434862, "mean_inference_ms": 1.1854122290390547, "mean_action_processing_ms": 0.09058424900262653, "mean_env_wait_ms": 0.5677050530412905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1848000, "timesteps_this_iter": 0, "agent_timesteps_total": 1848000, "timers": {"sample_time_ms": 11418.309, "sample_throughput": 2101.887, "load_time_ms": 0.252, "load_throughput": 95415446.445, "learn_time_ms": 944.848, "learn_throughput": 25400.905, "update_time_ms": 8.676}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0005, "total_loss": 0.5539601817727089, "policy_loss": 0.013590478338301182, "vf_loss": 0.554394967854023, "vf_explained_var": -0.0003239661455154419, "kl": 0.0006133895247537602, "entropy": 1.4025312215089798, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1848000, "num_agent_steps_sampled": 1848000, "num_steps_trained": 1848000, "num_agent_steps_trained": 1848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 385, "training_iteration": 77, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-32-37", "timestamp": 1708763557, "time_this_iter_s": 11.488893747329712, "time_total_s": 898.0416831970215, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426bd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 898.0416831970215, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 29.873333333333335, "ram_util_percent": 9.900000000000002, "gpu_util_percent0": 0.020000000000000004, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -180.91536578778167, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.71835220408377, -185.08587575625575, -167.32539033330215, -171.78625634963984, -169.03566263751995, -171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.321804561422464, "mean_inference_ms": 1.1854433241535725, "mean_action_processing_ms": 0.09057819202449459, "mean_env_wait_ms": 0.5676268783049885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1872000, "timesteps_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"sample_time_ms": 11421.826, "sample_throughput": 2101.24, "load_time_ms": 0.251, "load_throughput": 95605751.733, "learn_time_ms": 945.198, "learn_throughput": 25391.506, "update_time_ms": 8.651}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0005, "total_loss": 0.5560269393026829, "policy_loss": 0.020822980673983693, "vf_loss": 0.5493930652737617, "vf_explained_var": -0.00026819854974746704, "kl": 0.0012544526562655312, "entropy": 1.4189128875732422, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1872000, "num_agent_steps_sampled": 1872000, "num_steps_trained": 1872000, "num_agent_steps_trained": 1872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 390, "training_iteration": 78, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-32-48", "timestamp": 1708763568, "time_this_iter_s": 11.396331548690796, "time_total_s": 909.4380147457123, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404daf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 909.4380147457123, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 30.233333333333334, "ram_util_percent": 9.900000000000002, "gpu_util_percent0": 0.03133333333333334, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -180.95467314560352, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.0572989666321, -166.00381086006612, -177.52010102994782, -165.5618894777491, -166.91858913312225, -182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32178897519273436, "mean_inference_ms": 1.1854866905621924, "mean_action_processing_ms": 0.09057233023791054, "mean_env_wait_ms": 0.5675475018269966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1896000, "timesteps_this_iter": 0, "agent_timesteps_total": 1896000, "timers": {"sample_time_ms": 11418.224, "sample_throughput": 2101.903, "load_time_ms": 0.251, "load_throughput": 95605751.733, "learn_time_ms": 944.79, "learn_throughput": 25402.472, "update_time_ms": 8.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0005, "total_loss": 0.5675308555364609, "policy_loss": 0.027459055185317993, "vf_loss": 0.554897665977478, "vf_explained_var": -0.0004001408815383911, "kl": 0.0028541168246217705, "entropy": 1.4825904071331024, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1896000, "num_agent_steps_sampled": 1896000, "num_steps_trained": 1896000, "num_agent_steps_trained": 1896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 395, "training_iteration": 79, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-33-00", "timestamp": 1708763580, "time_this_iter_s": 11.37968134880066, "time_total_s": 920.8176960945129, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ed280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 920.8176960945129, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 30.506666666666668, "ram_util_percent": 9.96, "gpu_util_percent0": 0.03066666666666667, "vram_util_percent0": 0.02490234375}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -182.58667335153743, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.07616846449747, -169.94511224011572, -190.35516131054362, -168.53973559183495, -196.88508715311892, -169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217746795540745, "mean_inference_ms": 1.1855232726555693, "mean_action_processing_ms": 0.09056516591785689, "mean_env_wait_ms": 0.5674689379030567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 11415.972, "sample_throughput": 2102.318, "load_time_ms": 0.25, "load_throughput": 96153688.031, "learn_time_ms": 944.775, "learn_throughput": 25402.869, "update_time_ms": 8.628}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0005, "total_loss": 0.9097301587462425, "policy_loss": -0.012749688292387873, "vf_loss": 0.9375423416495323, "vf_explained_var": -0.00027905404567718506, "kl": 0.00030379155893389687, "entropy": 1.5062443315982819, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1920000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 1920000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 80, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-33-11", "timestamp": 1708763591, "time_this_iter_s": 11.347999334335327, "time_total_s": 932.1656954288483, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e8b83a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 932.1656954288483, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.433333333333337, "ram_util_percent": 9.960000000000003, "gpu_util_percent0": 0.03133333333333334, "vram_util_percent0": 0.024782986111111106}}
{"episode_reward_max": -164.7169124119057, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -182.8837870058672, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.80087640661776, -180.24241489453144, -164.7169124119057, -179.07643313620974, -173.62788198706997, -176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217584841093825, "mean_inference_ms": 1.1855553111320554, "mean_action_processing_ms": 0.09055826194895006, "mean_env_wait_ms": 0.5674085532907513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1944000, "timesteps_this_iter": 0, "agent_timesteps_total": 1944000, "timers": {"sample_time_ms": 11414.704, "sample_throughput": 2102.551, "load_time_ms": 0.25, "load_throughput": 96181249.761, "learn_time_ms": 940.454, "learn_throughput": 25519.6, "update_time_ms": 7.808}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0005, "total_loss": 0.6315152570605278, "policy_loss": -0.010867598932236433, "vf_loss": 0.6569356098771095, "vf_explained_var": -0.00025485455989837646, "kl": 0.0018986268187082267, "entropy": 1.4552774280309677, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1944000, "num_agent_steps_sampled": 1944000, "num_steps_trained": 1944000, "num_agent_steps_trained": 1944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 405, "training_iteration": 81, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-33-23", "timestamp": 1708763603, "time_this_iter_s": 11.41754961013794, "time_total_s": 943.5832450389862, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ed310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 943.5832450389862, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 30.366666666666667, "ram_util_percent": 9.96, "gpu_util_percent0": 0.032, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.60471205608872, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -183.02626386421997, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.07255431400984, -204.80631036375604, -174.7678986613138, -174.1814199241071, -177.24621259633665, -181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217419150746489, "mean_inference_ms": 1.1855929574717445, "mean_action_processing_ms": 0.0905517015835883, "mean_env_wait_ms": 0.5673551670142798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1968000, "timesteps_this_iter": 0, "agent_timesteps_total": 1968000, "timers": {"sample_time_ms": 11414.36, "sample_throughput": 2102.615, "load_time_ms": 0.249, "load_throughput": 96346952.527, "learn_time_ms": 939.168, "learn_throughput": 25554.54, "update_time_ms": 7.765}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0005, "total_loss": 0.5917036756873131, "policy_loss": 0.016616414999589324, "vf_loss": 0.589373379945755, "vf_explained_var": 1.1004507541656494e-05, "kl": 0.0017877167386151083, "entropy": 1.4286126345396042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1968000, "num_agent_steps_sampled": 1968000, "num_steps_trained": 1968000, "num_agent_steps_trained": 1968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 410, "training_iteration": 82, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-33-34", "timestamp": 1708763614, "time_this_iter_s": 11.327529668807983, "time_total_s": 954.9107747077942, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ef3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 954.9107747077942, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 29.926666666666666, "ram_util_percent": 9.986666666666668, "gpu_util_percent0": 0.024666666666666667, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.60471205608872, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -182.62732862033266, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.37582884186554, -198.38369857953626, -208.58601860797035, -197.55510713074645, -183.37643207612072, -185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217243283472706, "mean_inference_ms": 1.1856330805386899, "mean_action_processing_ms": 0.09054513626787512, "mean_env_wait_ms": 0.5673062467868089, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1992000, "timesteps_this_iter": 0, "agent_timesteps_total": 1992000, "timers": {"sample_time_ms": 11412.142, "sample_throughput": 2103.023, "load_time_ms": 0.249, "load_throughput": 96245621.952, "learn_time_ms": 937.23, "learn_throughput": 25607.382, "update_time_ms": 7.768}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0005, "total_loss": 0.5689916387200356, "policy_loss": -0.004858547355979681, "vf_loss": 0.588418997824192, "vf_explained_var": -0.00019451230764389038, "kl": 0.005069670537458007, "entropy": 1.4568779468536377, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1992000, "num_agent_steps_sampled": 1992000, "num_steps_trained": 1992000, "num_agent_steps_trained": 1992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 415, "training_iteration": 83, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-33-45", "timestamp": 1708763625, "time_this_iter_s": 11.34642219543457, "time_total_s": 966.2571969032288, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5404daf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 966.2571969032288, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.279999999999998, "ram_util_percent": 9.986666666666668, "gpu_util_percent0": 0.03333333333333333, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.60471205608872, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -182.02138694368344, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.30370438883992, -169.75997688535375, -176.77096836715484, -172.10863873664488, -165.60471205608872, -180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217086833486672, "mean_inference_ms": 1.1856791909188833, "mean_action_processing_ms": 0.09053891118084509, "mean_env_wait_ms": 0.5672674441309208, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2016000, "timesteps_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"sample_time_ms": 11423.104, "sample_throughput": 2101.005, "load_time_ms": 0.217, "load_throughput": 110364319.702, "learn_time_ms": 936.181, "learn_throughput": 25636.07, "update_time_ms": 7.702}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0005, "total_loss": 0.7316159829497337, "policy_loss": -0.013134186214301735, "vf_loss": 0.7592638060450554, "vf_explained_var": -0.0002705305814743042, "kl": 0.004338833592108127, "entropy": 1.4513614475727081, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2016000, "num_agent_steps_sampled": 2016000, "num_steps_trained": 2016000, "num_agent_steps_trained": 2016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 84, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-33-57", "timestamp": 1708763637, "time_this_iter_s": 11.433485984802246, "time_total_s": 977.690682888031, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e89b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 977.690682888031, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 30.42, "ram_util_percent": 10.006666666666666, "gpu_util_percent0": 0.03333333333333333, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -182.20113336877176, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.03026895096443, -179.97148649799138, -166.3524370468978, -174.1174746970949, -189.35844123340726, -196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216891501216045, "mean_inference_ms": 1.185716727094338, "mean_action_processing_ms": 0.09053177452278191, "mean_env_wait_ms": 0.5672372334367348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2040000, "timesteps_this_iter": 0, "agent_timesteps_total": 2040000, "timers": {"sample_time_ms": 11418.655, "sample_throughput": 2101.824, "load_time_ms": 0.218, "load_throughput": 110074681.247, "learn_time_ms": 935.06, "learn_throughput": 25666.796, "update_time_ms": 7.697}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0005, "total_loss": 0.5885534845292568, "policy_loss": -0.00641115999314934, "vf_loss": 0.608563557267189, "vf_explained_var": -0.0002040565013885498, "kl": 0.0022539111201225343, "entropy": 1.359891265630722, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2040000, "num_agent_steps_sampled": 2040000, "num_steps_trained": 2040000, "num_agent_steps_trained": 2040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 425, "training_iteration": 85, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-34-08", "timestamp": 1708763648, "time_this_iter_s": 11.316632747650146, "time_total_s": 989.0073156356812, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17efee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 989.0073156356812, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 30.513333333333332, "ram_util_percent": 10.046666666666665, "gpu_util_percent0": 0.030000000000000006, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -182.02578059980704, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-196.64731643758276, -189.08181586977216, -195.16723349313835, -192.51438299274324, -199.88912826968453, -204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216669674267573, "mean_inference_ms": 1.185751893139515, "mean_action_processing_ms": 0.09052383293607731, "mean_env_wait_ms": 0.567210638569507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2064000, "timesteps_this_iter": 0, "agent_timesteps_total": 2064000, "timers": {"sample_time_ms": 11422.415, "sample_throughput": 2101.132, "load_time_ms": 0.217, "load_throughput": 110801646.67, "learn_time_ms": 935.831, "learn_throughput": 25645.643, "update_time_ms": 8.755}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0005, "total_loss": 0.538933377712965, "policy_loss": 0.018364928080700338, "vf_loss": 0.5340346843004227, "vf_explained_var": -5.8673322200775146e-05, "kl": 0.0014942978872269919, "entropy": 1.346623718738556, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2064000, "num_agent_steps_sampled": 2064000, "num_steps_trained": 2064000, "num_agent_steps_trained": 2064000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 430, "training_iteration": 86, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-34-20", "timestamp": 1708763660, "time_this_iter_s": 11.497455358505249, "time_total_s": 1000.5047709941864, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e6e8b83a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1000.5047709941864, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 30.4375, "ram_util_percent": 10.075, "gpu_util_percent0": 0.03375, "vram_util_percent0": 0.024739583333333332}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -215.58125983202117, "episode_reward_mean": -181.00526847681812, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.13850209713118, -197.22452611175885, -214.80656036373745, -203.1244962583749, -215.58125983202117, -185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216466483077109, "mean_inference_ms": 1.185784491282766, "mean_action_processing_ms": 0.09051578967191107, "mean_env_wait_ms": 0.5671896884645531, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2088000, "timesteps_this_iter": 0, "agent_timesteps_total": 2088000, "timers": {"sample_time_ms": 11408.788, "sample_throughput": 2103.641, "load_time_ms": 0.22, "load_throughput": 109049177.771, "learn_time_ms": 937.988, "learn_throughput": 25586.691, "update_time_ms": 9.786}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0005, "total_loss": 0.555416963994503, "policy_loss": 0.023797654546797276, "vf_loss": 0.545722633600235, "vf_explained_var": 0.000383622944355011, "kl": 0.006085984164638916, "entropy": 1.4103323966264725, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2088000, "num_agent_steps_sampled": 2088000, "num_steps_trained": 2088000, "num_agent_steps_trained": 2088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 435, "training_iteration": 87, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-34-31", "timestamp": 1708763671, "time_this_iter_s": 11.353188753128052, "time_total_s": 1011.8579597473145, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426b160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1011.8579597473145, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.733333333333338, "ram_util_percent": 10.04, "gpu_util_percent0": 0.014000000000000002, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -179.39822991485428, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.45278492478317, -173.9202416743501, -167.9370108518636, -172.3640372077325, -171.62697241413338, -175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216284315029829, "mean_inference_ms": 1.1858163455923978, "mean_action_processing_ms": 0.0905077822721834, "mean_env_wait_ms": 0.5671657234881023, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2112000, "timesteps_this_iter": 0, "agent_timesteps_total": 2112000, "timers": {"sample_time_ms": 11408.723, "sample_throughput": 2103.654, "load_time_ms": 0.22, "load_throughput": 108907601.428, "learn_time_ms": 941.158, "learn_throughput": 25500.507, "update_time_ms": 10.084}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0005, "total_loss": 0.5636739991605282, "policy_loss": 0.02010956429876387, "vf_loss": 0.5582262501120567, "vf_explained_var": -0.00010648369789123535, "kl": 0.003134427683122748, "entropy": 1.4661825597286224, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2112000, "num_agent_steps_sampled": 2112000, "num_steps_trained": 2112000, "num_agent_steps_trained": 2112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 88, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-34-43", "timestamp": 1708763683, "time_this_iter_s": 11.385960578918457, "time_total_s": 1023.2439203262329, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5426b310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1023.2439203262329, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 30.293333333333337, "ram_util_percent": 10.086666666666664, "gpu_util_percent0": 0.02666666666666667, "vram_util_percent0": 0.02473958333333333}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -179.36077456752952, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.39751810001053, -170.23140591112292, -171.4731988680464, -174.92912827144085, -173.79060962845875, -173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216186631590321, "mean_inference_ms": 1.1858632735041739, "mean_action_processing_ms": 0.09050204478052487, "mean_env_wait_ms": 0.5671641857041108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2136000, "timesteps_this_iter": 0, "agent_timesteps_total": 2136000, "timers": {"sample_time_ms": 11458.458, "sample_throughput": 2094.523, "load_time_ms": 0.221, "load_throughput": 108778145.667, "learn_time_ms": 948.096, "learn_throughput": 25313.895, "update_time_ms": 10.475}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0005, "total_loss": 0.592397429049015, "policy_loss": 0.021256206091493368, "vf_loss": 0.5862159430980682, "vf_explained_var": -0.00033196061849594116, "kl": 0.001319083891267725, "entropy": 1.5074735134840012, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2136000, "num_agent_steps_sampled": 2136000, "num_steps_trained": 2136000, "num_agent_steps_trained": 2136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 445, "training_iteration": 89, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-34-54", "timestamp": 1708763694, "time_this_iter_s": 11.91531777381897, "time_total_s": 1035.1592381000519, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e541e59d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1035.1592381000519, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 34.08, "ram_util_percent": 10.09333333333333, "gpu_util_percent0": 0.06533333333333334, "vram_util_percent0": 0.02478841145833333}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -179.86244580736172, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.304578757545, -168.77714542116007, -172.68867161119263, -171.82535710092267, -171.4813784068559, -177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216175211323156, "mean_inference_ms": 1.1859444602568672, "mean_action_processing_ms": 0.09049913161550839, "mean_env_wait_ms": 0.5671786006703503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2160000, "timesteps_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"sample_time_ms": 11521.449, "sample_throughput": 2083.071, "load_time_ms": 0.221, "load_throughput": 108801660.182, "learn_time_ms": 949.13, "learn_throughput": 25286.311, "update_time_ms": 10.469}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0005, "total_loss": 0.8971051797270775, "policy_loss": 0.08054238371551037, "vf_loss": 0.8318173065781593, "vf_explained_var": 7.729977369308472e-05, "kl": 0.0008004511307192486, "entropy": 1.5254554599523544, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2160000, "num_agent_steps_sampled": 2160000, "num_steps_trained": 2160000, "num_agent_steps_trained": 2160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 450, "training_iteration": 90, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-35-06", "timestamp": 1708763706, "time_this_iter_s": 11.908650159835815, "time_total_s": 1047.0678882598877, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5415df70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1047.0678882598877, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 33.89375, "ram_util_percent": 10.1, "gpu_util_percent0": 0.075625, "vram_util_percent0": 0.024937947591145832}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -180.2941844065446, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.0647798131053, -168.2234822298974, -173.2291609910893, -171.52348583753525, -167.40645169473012, -167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216447509950098, "mean_inference_ms": 1.1861321415139985, "mean_action_processing_ms": 0.0905043036425152, "mean_env_wait_ms": 0.5672338599012401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2184000, "timesteps_this_iter": 0, "agent_timesteps_total": 2184000, "timers": {"sample_time_ms": 11687.35, "sample_throughput": 2053.502, "load_time_ms": 0.22, "load_throughput": 108860490.97, "learn_time_ms": 950.133, "learn_throughput": 25259.619, "update_time_ms": 10.465}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0005, "total_loss": 0.4957290906459093, "policy_loss": -0.08746927976608276, "vf_loss": 0.5982974618673325, "vf_explained_var": -0.0003398209810256958, "kl": 0.0005692449783830933, "entropy": 1.5099103152751923, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2184000, "num_agent_steps_sampled": 2184000, "num_steps_trained": 2184000, "num_agent_steps_trained": 2184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 455, "training_iteration": 91, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-35-20", "timestamp": 1708763720, "time_this_iter_s": 13.076631307601929, "time_total_s": 1060.1445195674896, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae072fee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1060.1445195674896, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 42.741176470588236, "ram_util_percent": 10.194117647058823, "gpu_util_percent0": 0.11294117647058823, "vram_util_percent0": 0.02789186963848039}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -180.9199048155164, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.85687292710216, -166.0430809237987, -172.2924944225023, -169.4446276507374, -170.95299870723255, -167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216720507402156, "mean_inference_ms": 1.1863157056504716, "mean_action_processing_ms": 0.09050747465064413, "mean_env_wait_ms": 0.5672984584556701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2208000, "timesteps_this_iter": 0, "agent_timesteps_total": 2208000, "timers": {"sample_time_ms": 11685.881, "sample_throughput": 2053.76, "load_time_ms": 0.22, "load_throughput": 109108276.61, "learn_time_ms": 949.526, "learn_throughput": 25275.77, "update_time_ms": 10.481}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0005, "total_loss": 0.672444012016058, "policy_loss": -0.008900500368326902, "vf_loss": 0.6964471191167831, "vf_explained_var": -0.00010704994201660156, "kl": 0.0013259084679328181, "entropy": 1.5102588385343552, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2208000, "num_agent_steps_sampled": 2208000, "num_steps_trained": 2208000, "num_agent_steps_trained": 2208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 92, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-35-31", "timestamp": 1708763731, "time_this_iter_s": 11.296687126159668, "time_total_s": 1071.4412066936493, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17efca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1071.4412066936493, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 29.453333333333333, "ram_util_percent": 10.186666666666666, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.025881618923611113}}
{"episode_reward_max": -165.75412228629034, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -181.25821474609646, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.5215572586814, -205.8723724265916, -196.03954894086198, -212.93554352637514, -192.4419620726976, -203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32169858016117625, "mean_inference_ms": 1.1864851477152392, "mean_action_processing_ms": 0.09050987100319638, "mean_env_wait_ms": 0.5673646486667168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2232000, "timesteps_this_iter": 0, "agent_timesteps_total": 2232000, "timers": {"sample_time_ms": 11675.55, "sample_throughput": 2055.578, "load_time_ms": 0.22, "load_throughput": 108895819.991, "learn_time_ms": 953.126, "learn_throughput": 25180.308, "update_time_ms": 10.558}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005, "total_loss": 0.5132048800587654, "policy_loss": -0.015571045223623514, "vf_loss": 0.5435364320874214, "vf_explained_var": -1.8477439880371094e-06, "kl": 0.0026443332737596734, "entropy": 1.4760516285896301, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2232000, "num_agent_steps_sampled": 2232000, "num_steps_trained": 2232000, "num_agent_steps_trained": 2232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 465, "training_iteration": 93, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-35-42", "timestamp": 1708763742, "time_this_iter_s": 11.282918453216553, "time_total_s": 1082.7241251468658, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1082.7241251468658, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 29.273333333333326, "ram_util_percent": 10.199999999999998, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -180.26726707979122, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.76938455654522, -199.02301573052506, -210.29579193550734, -198.43584984609038, -207.93954031958134, -185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217219050886439, "mean_inference_ms": 1.1866519851115818, "mean_action_processing_ms": 0.09051188934587402, "mean_env_wait_ms": 0.5674356178468029, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2256000, "timesteps_this_iter": 0, "agent_timesteps_total": 2256000, "timers": {"sample_time_ms": 11663.603, "sample_throughput": 2057.683, "load_time_ms": 0.22, "load_throughput": 108931171.951, "learn_time_ms": 954.241, "learn_throughput": 25150.891, "update_time_ms": 10.956}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0005, "total_loss": 0.574869267642498, "policy_loss": 0.01844293752219528, "vf_loss": 0.5710436999797821, "vf_explained_var": 8.374452590942383e-06, "kl": 0.001277765158370553, "entropy": 1.4617388844490051, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2256000, "num_agent_steps_sampled": 2256000, "num_steps_trained": 2256000, "num_agent_steps_trained": 2256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 470, "training_iteration": 94, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-35-53", "timestamp": 1708763753, "time_this_iter_s": 11.292222499847412, "time_total_s": 1094.0163476467133, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae072f820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1094.0163476467133, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 29.253333333333334, "ram_util_percent": 10.193333333333332, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -214.91334541702258, "episode_reward_mean": -179.34788284718113, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.9641501884426, -183.43979488660753, -199.68207077787528, -172.40557087519664, -190.17270683466123, -173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342, -170.52589451523394, -205.4267687221218, -166.86138967229041, -183.2851259786233, -201.42598023896852], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32174112267048227, "mean_inference_ms": 1.1868224489143706, "mean_action_processing_ms": 0.09051331359854028, "mean_env_wait_ms": 0.5675009988207038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2280000, "timesteps_this_iter": 0, "agent_timesteps_total": 2280000, "timers": {"sample_time_ms": 11666.504, "sample_throughput": 2057.172, "load_time_ms": 0.22, "load_throughput": 108907601.428, "learn_time_ms": 956.368, "learn_throughput": 25094.931, "update_time_ms": 11.463}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0005, "total_loss": 0.608881002292037, "policy_loss": -0.05040271984762512, "vf_loss": 0.6744902804493904, "vf_explained_var": -0.00019809603691101074, "kl": 0.0034869234132344495, "entropy": 1.5206556022167206, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2280000, "num_agent_steps_sampled": 2280000, "num_steps_trained": 2280000, "num_agent_steps_trained": 2280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 475, "training_iteration": 95, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-36-05", "timestamp": 1708763765, "time_this_iter_s": 11.370400667190552, "time_total_s": 1105.3867483139038, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1105.3867483139038, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 29.186666666666667, "ram_util_percent": 10.213333333333331, "gpu_util_percent0": 0.0006666666666666666, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -228.11099543231433, "episode_reward_mean": -179.98106967355386, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.25904898977728, -170.98414887610747, -172.09311895473638, -173.87719622047302, -170.08958956845376, -170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342, -170.52589451523394, -205.4267687221218, -166.86138967229041, -183.2851259786233, -201.42598023896852, -194.95940212341608, -207.73672842948505, -228.11099543231433, -194.79721850378206, -169.3786317110566], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32175747006841166, "mean_inference_ms": 1.1869808847385679, "mean_action_processing_ms": 0.09051386074870947, "mean_env_wait_ms": 0.5675658406789365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2304000, "timesteps_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"sample_time_ms": 11654.396, "sample_throughput": 2059.309, "load_time_ms": 0.221, "load_throughput": 108801660.182, "learn_time_ms": 953.306, "learn_throughput": 25175.537, "update_time_ms": 10.451}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0005, "total_loss": 1.3418354615569115, "policy_loss": 0.12330895522609353, "vf_loss": 1.2336030900478363, "vf_explained_var": -6.886571645736694e-05, "kl": 0.0022937362029438607, "entropy": 1.5076605379581451, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2304000, "num_agent_steps_sampled": 2304000, "num_steps_trained": 2304000, "num_agent_steps_trained": 2304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 96, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-36-16", "timestamp": 1708763776, "time_this_iter_s": 11.286809921264648, "time_total_s": 1116.6735582351685, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae15075e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1116.6735582351685, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 29.178571428571427, "ram_util_percent": 10.250000000000002, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -228.11099543231433, "episode_reward_mean": -180.13510105590368, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.37640532221212, -183.94657470478177, -169.7030248085181, -173.17605951249308, -171.67125527011063, -170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342, -170.52589451523394, -205.4267687221218, -166.86138967229041, -183.2851259786233, -201.42598023896852, -194.95940212341608, -207.73672842948505, -228.11099543231433, -194.79721850378206, -169.3786317110566, -176.43828153800615, -171.40108111787225, -164.8488242719906, -172.8359741653202, -190.1820797513429], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3217655965021363, "mean_inference_ms": 1.1871205133031129, "mean_action_processing_ms": 0.09051310093095219, "mean_env_wait_ms": 0.5676229043868981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2328000, "timesteps_this_iter": 0, "agent_timesteps_total": 2328000, "timers": {"sample_time_ms": 11637.059, "sample_throughput": 2062.377, "load_time_ms": 0.221, "load_throughput": 108391618.391, "learn_time_ms": 952.0, "learn_throughput": 25210.073, "update_time_ms": 9.47}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0005, "total_loss": 0.5504275597631931, "policy_loss": -0.038064142456278205, "vf_loss": 0.6029260754585266, "vf_explained_var": -2.9064714908599854e-05, "kl": 0.0016371714978895835, "entropy": 1.4434391409158707, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2328000, "num_agent_steps_sampled": 2328000, "num_steps_trained": 2328000, "num_agent_steps_trained": 2328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 485, "training_iteration": 97, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-36-27", "timestamp": 1708763787, "time_this_iter_s": 11.214109659194946, "time_total_s": 1127.8876678943634, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1127.8876678943634, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 29.306666666666665, "ram_util_percent": 10.26666666666667, "gpu_util_percent0": 0.0006666666666666666, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -228.11099543231433, "episode_reward_mean": -180.04887353425096, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.7569474245036, -182.7644976378326, -176.71748871352457, -173.19825794228078, -171.4450813448499, -191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342, -170.52589451523394, -205.4267687221218, -166.86138967229041, -183.2851259786233, -201.42598023896852, -194.95940212341608, -207.73672842948505, -228.11099543231433, -194.79721850378206, -169.3786317110566, -176.43828153800615, -171.40108111787225, -164.8488242719906, -172.8359741653202, -190.1820797513429, -170.02814209657106, -173.73406143058435, -176.44463668122086, -167.51127535062423, -172.53245189383782], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32177169664889405, "mean_inference_ms": 1.1872485776088808, "mean_action_processing_ms": 0.09051128299570475, "mean_env_wait_ms": 0.5676827456087947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2352000, "timesteps_this_iter": 0, "agent_timesteps_total": 2352000, "timers": {"sample_time_ms": 11628.901, "sample_throughput": 2063.824, "load_time_ms": 0.221, "load_throughput": 108356615.716, "learn_time_ms": 948.078, "learn_throughput": 25314.375, "update_time_ms": 9.23}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0005, "total_loss": 0.5886044204235077, "policy_loss": 0.006636013742536306, "vf_loss": 0.596309095621109, "vf_explained_var": -0.00022973120212554932, "kl": 0.0013429415568544933, "entropy": 1.4340713173151016, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2352000, "num_agent_steps_sampled": 2352000, "num_steps_trained": 2352000, "num_agent_steps_trained": 2352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 490, "training_iteration": 98, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-36-39", "timestamp": 1708763799, "time_this_iter_s": 11.297747373580933, "time_total_s": 1139.1854152679443, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae1507430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1139.1854152679443, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 29.01333333333333, "ram_util_percent": 10.300000000000002, "gpu_util_percent0": 0.004, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -228.11099543231433, "episode_reward_mean": -179.7647384298686, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.2607972779997, -200.35225420747756, -197.85005774868168, -214.91334541702258, -205.88525540972438, -183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342, -170.52589451523394, -205.4267687221218, -166.86138967229041, -183.2851259786233, -201.42598023896852, -194.95940212341608, -207.73672842948505, -228.11099543231433, -194.79721850378206, -169.3786317110566, -176.43828153800615, -171.40108111787225, -164.8488242719906, -172.8359741653202, -190.1820797513429, -170.02814209657106, -173.73406143058435, -176.44463668122086, -167.51127535062423, -172.53245189383782, -165.44716523992537, -173.16972309146362, -170.43776817165073, -171.42350725515215, -165.99059886656173], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32177776315398776, "mean_inference_ms": 1.1873627520627048, "mean_action_processing_ms": 0.09050880543496465, "mean_env_wait_ms": 0.567743816482371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2376000, "timesteps_this_iter": 0, "agent_timesteps_total": 2376000, "timers": {"sample_time_ms": 11567.568, "sample_throughput": 2074.766, "load_time_ms": 0.222, "load_throughput": 108344953.18, "learn_time_ms": 940.526, "learn_throughput": 25517.643, "update_time_ms": 8.81}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0005, "total_loss": 0.5802779085934162, "policy_loss": 0.02674636198207736, "vf_loss": 0.568182460963726, "vf_explained_var": 0.000266343355178833, "kl": 0.0019399455412905595, "entropy": 1.4650897979736328, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2376000, "num_agent_steps_sampled": 2376000, "num_steps_trained": 2376000, "num_agent_steps_trained": 2376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 495, "training_iteration": 99, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-36-50", "timestamp": 1708763810, "time_this_iter_s": 11.262975931167603, "time_total_s": 1150.448391199112, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4e5415ddc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1150.448391199112, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 29.15333333333334, "ram_util_percent": 10.300000000000002, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.025634765625}}
{"episode_reward_max": -164.72687144954097, "episode_reward_min": -228.11099543231433, "episode_reward_mean": -179.2363197704004, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.33972536703254, -180.4579545843079, -190.14528021784955, -192.09534758296917, -191.4743224409296, -175.40975738863074, -172.07104564601602, -174.45468061674853, -184.91457087194686, -174.86215014827098, -165.75412228629034, -176.3038947309657, -172.24410952175992, -176.88878018947992, -175.98996474229872, -189.6635993296892, -167.4724235859906, -186.04092358557003, -181.3762198476566, -184.12975122240636, -177.2506332599673, -171.47126595421318, -185.43370741204296, -173.8932195605984, -179.47381675609887, -172.1352948308381, -179.6937134152786, -171.5392808297285, -176.0663542181571, -172.86018823587605, -172.77708679553373, -178.4999672204763, -175.04630910820381, -173.65279472334043, -171.27250691647748, -176.9776001468635, -172.09034958068366, -170.14013032749168, -181.5832074827581, -173.3802009288375, -171.18947486265031, -171.34439772010572, -176.37234441599406, -179.15175272517672, -169.49754261645893, -191.1376373591027, -200.6508798993006, -178.75296109248325, -177.93061452564658, -167.51689188576964, -168.23781956358596, -174.079702065269, -168.39367117864683, -185.28288979408867, -205.25690861437414, -188.05717946475974, -182.39492226407, -173.67007349633815, -184.3277509626407, -191.56947527572586, -173.433375685513, -174.7370331620618, -169.5163769195286, -179.78232851664916, -182.95195340563194, -182.55379260199203, -164.72687144954097, -175.395594426137, -179.48782371877348, -173.55213539824342, -170.52589451523394, -205.4267687221218, -166.86138967229041, -183.2851259786233, -201.42598023896852, -194.95940212341608, -207.73672842948505, -228.11099543231433, -194.79721850378206, -169.3786317110566, -176.43828153800615, -171.40108111787225, -164.8488242719906, -172.8359741653202, -190.1820797513429, -170.02814209657106, -173.73406143058435, -176.44463668122086, -167.51127535062423, -172.53245189383782, -165.44716523992537, -173.16972309146362, -170.43776817165073, -171.42350725515215, -165.99059886656173, -192.59318345208743, -210.51225722222256, -175.9469348512106, -181.53228164306975, -196.8351869455046], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32178463313709144, "mean_inference_ms": 1.1874753393234994, "mean_action_processing_ms": 0.09050650275316176, "mean_env_wait_ms": 0.5678082225094382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2400000, "timesteps_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"sample_time_ms": 11507.539, "sample_throughput": 2085.589, "load_time_ms": 0.223, "load_throughput": 107857383.478, "learn_time_ms": 940.827, "learn_throughput": 25509.461, "update_time_ms": 9.004}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0005, "total_loss": 0.8745432086288929, "policy_loss": 0.009544612374156713, "vf_loss": 0.87977634370327, "vf_explained_var": -7.227063179016113e-07, "kl": 0.0011267707657158232, "entropy": 1.4777730852365494, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2400000, "num_agent_steps_sampled": 2400000, "num_steps_trained": 2400000, "num_agent_steps_trained": 2400000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -169.2159702728234, "episode_reward_min": -196.4677582060459, "episode_reward_mean": -179.97734073625597, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.59410742409582, -169.49943873310815, -170.85349881610375, -185.11511180504223, -169.2159702728234, -181.28099437073766, -176.04338670880298, -181.61557440793447, -194.0875666178653, -196.4677582060459], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3025480983319503, "mean_inference_ms": 1.2122208945087254, "mean_action_processing_ms": 0.08784256331107684, "mean_env_wait_ms": 0.5565863041559622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 500, "training_iteration": 100, "trial_id": "2b270_00000", "experiment_id": "26dc2f3383b643b6aab801ab106a7c38", "date": "2024-02-24_14-37-22", "timestamp": 1708763842, "time_this_iter_s": 32.12262463569641, "time_total_s": 1182.5710158348083, "pid": 7917, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f4ae17ce040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1182.5710158348083, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 29.159523809523815, "ram_util_percent": 10.333333333333334, "gpu_util_percent0": 0.002142857142857143, "vram_util_percent0": 0.025634765625}}
