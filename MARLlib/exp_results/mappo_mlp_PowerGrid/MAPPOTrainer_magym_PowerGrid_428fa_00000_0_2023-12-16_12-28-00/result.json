{"episode_reward_max": -68.5662515307521, "episode_reward_min": -85.8819414862939, "episode_reward_mean": -78.31191567402941, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.60381063724623, -83.44515640146201, -68.5662515307521, -84.94862289037218, -82.70327278563144, -76.11956113616122, -69.80246578938433, -82.58988938755017, -75.77272988786083, -80.01641923667819, -76.90902424125062, -82.2405485093172, -81.86361010833163, -77.41553982610154, -78.78522878507553, -79.058378329616, -77.83568205877842, -83.74140756055047, -74.23487367784836, -81.78782395669796, -78.3098300866167, -80.45023068060536, -73.07560659231874, -85.8819414862939, -80.51838618748732, -75.97821427216758, -81.95426110223448, -69.54737512672597, -77.28420007879643, -72.21247151684652, -80.8928600285701, -73.08142408503271, -74.64438714782588, -76.69369738875771, -83.17600389353552, -77.30906434186929, -75.28226405505556, -79.51729437702969, -79.34335546231543, -78.88346231442526], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35695898696575573, "mean_inference_ms": 1.1431177308348084, "mean_action_processing_ms": 0.08624817399347616, "mean_env_wait_ms": 0.5431007951981714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 8607.582, "sample_throughput": 2323.533, "load_time_ms": 0.578, "load_throughput": 34620751.135, "learn_time_ms": 1061.513, "learn_throughput": 18841.028, "update_time_ms": 7.946}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 40.19109344482422, "policy_loss": -0.0007181679041128319, "vf_loss": 40.21371841430664, "vf_explained_var": 5.111098289489746e-05, "kl": 0.0002828712771288447, "entropy": 2.1968910694122314, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-28-10", "timestamp": 1702708090, "time_this_iter_s": 9.665752172470093, "time_total_s": 9.665752172470093, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46f25e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.665752172470093, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.142857142857142, "ram_util_percent": 20.50714285714286, "gpu_util_percent0": 0.030000000000000002, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -68.08371905456495, "episode_reward_min": -85.8819414862939, "episode_reward_mean": -76.34327313671979, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.60381063724623, -83.44515640146201, -68.5662515307521, -84.94862289037218, -82.70327278563144, -76.11956113616122, -69.80246578938433, -82.58988938755017, -75.77272988786083, -80.01641923667819, -76.90902424125062, -82.2405485093172, -81.86361010833163, -77.41553982610154, -78.78522878507553, -79.058378329616, -77.83568205877842, -83.74140756055047, -74.23487367784836, -81.78782395669796, -78.3098300866167, -80.45023068060536, -73.07560659231874, -85.8819414862939, -80.51838618748732, -75.97821427216758, -81.95426110223448, -69.54737512672597, -77.28420007879643, -72.21247151684652, -80.8928600285701, -73.08142408503271, -74.64438714782588, -76.69369738875771, -83.17600389353552, -77.30906434186929, -75.28226405505556, -79.51729437702969, -79.34335546231543, -78.88346231442526, -73.79819905271982, -78.74048039380986, -68.08371905456495, -80.94508922455202, -73.83589229365558, -74.05487526513546, -73.70177808926576, -73.30407507648471, -74.63127732659461, -76.3383022568357, -70.22882440664837, -78.58761524549789, -78.62004538832325, -76.05903551749333, -73.6586547092349, -74.22276752684891, -72.0742472578309, -74.63823598140469, -73.60586112104141, -78.1215193888156, -69.85809253282547, -74.50830553244393, -76.19834328031723, -75.54752859906176, -80.03398776566014, -69.99850795120804, -73.25522765640714, -77.95272559219426, -75.16850385347433, -73.93412179976882, -71.27790182865262, -76.43848952471299, -76.55365887799545, -68.68090927029682, -69.19457584050285, -72.76810987067955, -79.04779744537896, -70.66602853894946, -73.51196313331383, -73.13995050580542], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3565811355506483, "mean_inference_ms": 1.1436856453251265, "mean_action_processing_ms": 0.08609308658420751, "mean_env_wait_ms": 0.5422353052156479, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 9138.448, "sample_throughput": 2188.556, "load_time_ms": 0.403, "load_throughput": 49578061.466, "learn_time_ms": 1011.548, "learn_throughput": 19771.669, "update_time_ms": 7.803}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 28.684030532836914, "policy_loss": -0.0009573104782961694, "vf_loss": 28.706884384155273, "vf_explained_var": 0.00080069899559021, "kl": 0.0003473622331335302, "entropy": 2.1930078268051147, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-28-20", "timestamp": 1702708100, "time_this_iter_s": 9.538319110870361, "time_total_s": 19.204071283340454, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d47d30d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.204071283340454, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.79166666666666, "ram_util_percent": 22.45, "gpu_util_percent0": 0.010833333333333334, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -59.58814149098788, "episode_reward_min": -83.17600389353552, "episode_reward_mean": -72.29829187799143, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.97821427216758, -81.95426110223448, -69.54737512672597, -77.28420007879643, -72.21247151684652, -80.8928600285701, -73.08142408503271, -74.64438714782588, -76.69369738875771, -83.17600389353552, -77.30906434186929, -75.28226405505556, -79.51729437702969, -79.34335546231543, -78.88346231442526, -73.79819905271982, -78.74048039380986, -68.08371905456495, -80.94508922455202, -73.83589229365558, -74.05487526513546, -73.70177808926576, -73.30407507648471, -74.63127732659461, -76.3383022568357, -70.22882440664837, -78.58761524549789, -78.62004538832325, -76.05903551749333, -73.6586547092349, -74.22276752684891, -72.0742472578309, -74.63823598140469, -73.60586112104141, -78.1215193888156, -69.85809253282547, -74.50830553244393, -76.19834328031723, -75.54752859906176, -80.03398776566014, -69.99850795120804, -73.25522765640714, -77.95272559219426, -75.16850385347433, -73.93412179976882, -71.27790182865262, -76.43848952471299, -76.55365887799545, -68.68090927029682, -69.19457584050285, -72.76810987067955, -79.04779744537896, -70.66602853894946, -73.51196313331383, -73.13995050580542, -77.04454918245784, -66.31251045600487, -67.40920572237086, -64.79606540718497, -62.368118077536096, -71.7726967972073, -73.11174033196718, -66.0755101837841, -59.58814149098788, -72.26968468421892, -71.97902915935293, -62.397591102890225, -69.33366905894681, -67.85727040220826, -70.64087404246669, -66.27675361087604, -68.62569443930121, -74.90271823984533, -73.43609417271534, -63.79102484510134, -70.8861611125679, -71.8451315587005, -69.09475190783962, -67.11880663879242, -61.35567761564729, -71.664609481272, -67.91405029334663, -75.1899789340675, -63.27267552587958, -66.21229344993787, -65.31738465052509, -76.13253533239181, -73.31113955337467, -77.98125682250406, -65.51539668138365, -70.8854104009869, -71.93345875516499, -68.96384671879731, -63.339649391003334, -70.87446752551044, -68.50370500187826, -74.12049335962139, -72.49269438132775, -61.10800580134075, -64.02110633026243], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35818952836750134, "mean_inference_ms": 1.1428386022939896, "mean_action_processing_ms": 0.08584718057917598, "mean_env_wait_ms": 0.5423927096570206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 9348.728, "sample_throughput": 2139.329, "load_time_ms": 0.341, "load_throughput": 58620600.978, "learn_time_ms": 1004.752, "learn_throughput": 19905.403, "update_time_ms": 7.832}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 28.379396438598633, "policy_loss": -0.0008621604687526485, "vf_loss": 28.40205669403076, "vf_explained_var": 0.0025448501110076904, "kl": 0.0004890630894549552, "entropy": 2.1821056604385376, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 3, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-28-30", "timestamp": 1702708110, "time_this_iter_s": 9.7548189163208, "time_total_s": 28.958890199661255, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04dce47dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28.958890199661255, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.128571428571433, "ram_util_percent": 22.407142857142855, "gpu_util_percent0": 0.02285714285714286, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -56.79312787520565, "episode_reward_min": -79.04779744537896, "episode_reward_mean": -67.97764078925829, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.99850795120804, -73.25522765640714, -77.95272559219426, -75.16850385347433, -73.93412179976882, -71.27790182865262, -76.43848952471299, -76.55365887799545, -68.68090927029682, -69.19457584050285, -72.76810987067955, -79.04779744537896, -70.66602853894946, -73.51196313331383, -73.13995050580542, -77.04454918245784, -66.31251045600487, -67.40920572237086, -64.79606540718497, -62.368118077536096, -71.7726967972073, -73.11174033196718, -66.0755101837841, -59.58814149098788, -72.26968468421892, -71.97902915935293, -62.397591102890225, -69.33366905894681, -67.85727040220826, -70.64087404246669, -66.27675361087604, -68.62569443930121, -74.90271823984533, -73.43609417271534, -63.79102484510134, -70.8861611125679, -71.8451315587005, -69.09475190783962, -67.11880663879242, -61.35567761564729, -71.664609481272, -67.91405029334663, -75.1899789340675, -63.27267552587958, -66.21229344993787, -65.31738465052509, -76.13253533239181, -73.31113955337467, -77.98125682250406, -65.51539668138365, -70.8854104009869, -71.93345875516499, -68.96384671879731, -63.339649391003334, -70.87446752551044, -68.50370500187826, -74.12049335962139, -72.49269438132775, -61.10800580134075, -64.02110633026243, -66.3482386195326, -56.79312787520565, -62.389391162064456, -66.4676171775495, -68.58606328901382, -65.97090168079865, -61.1894940770223, -57.586232951126306, -60.6299411211604, -62.21998586531946, -64.09873525599137, -63.49367876930798, -63.083272261094244, -63.09957623814448, -62.93513788652202, -67.17922750991849, -63.195481116513385, -67.21684271835056, -63.45634872034386, -58.31931753212001, -68.6078653589177, -68.59410307771358, -63.39347271966176, -64.95442176906089, -63.96948315748534, -66.31762155319184, -57.93441163341052, -68.36098006603319, -73.48252226856573, -65.99784987959188, -67.75946978017762, -67.58520925349266, -70.41082370105761, -68.62234624014798, -61.44139482351109, -69.90873035720284, -67.33550100429485, -66.84614668810633, -68.57203466749958, -62.778978778716805], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36107553085730887, "mean_inference_ms": 1.1464686782300122, "mean_action_processing_ms": 0.08612330200948026, "mean_env_wait_ms": 0.544793881333394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 9447.49, "sample_throughput": 2116.964, "load_time_ms": 0.319, "load_throughput": 62636610.043, "learn_time_ms": 1000.751, "learn_throughput": 19984.983, "update_time_ms": 8.14}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 25.880085945129395, "policy_loss": -0.0012359016334642092, "vf_loss": 25.902915000915527, "vf_explained_var": 0.0020349621772766113, "kl": 0.0006429486368126902, "entropy": 2.1608842611312866, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 165, "training_iteration": 4, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-28-39", "timestamp": 1702708119, "time_this_iter_s": 9.715984582901001, "time_total_s": 38.674874782562256, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d43795e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38.674874782562256, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.238461538461543, "ram_util_percent": 22.584615384615383, "gpu_util_percent0": 0.012307692307692308, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -48.59679000710591, "episode_reward_min": -77.98125682250406, "episode_reward_mean": -63.48269918404263, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.664609481272, -67.91405029334663, -75.1899789340675, -63.27267552587958, -66.21229344993787, -65.31738465052509, -76.13253533239181, -73.31113955337467, -77.98125682250406, -65.51539668138365, -70.8854104009869, -71.93345875516499, -68.96384671879731, -63.339649391003334, -70.87446752551044, -68.50370500187826, -74.12049335962139, -72.49269438132775, -61.10800580134075, -64.02110633026243, -66.3482386195326, -56.79312787520565, -62.389391162064456, -66.4676171775495, -68.58606328901382, -65.97090168079865, -61.1894940770223, -57.586232951126306, -60.6299411211604, -62.21998586531946, -64.09873525599137, -63.49367876930798, -63.083272261094244, -63.09957623814448, -62.93513788652202, -67.17922750991849, -63.195481116513385, -67.21684271835056, -63.45634872034386, -58.31931753212001, -68.6078653589177, -68.59410307771358, -63.39347271966176, -64.95442176906089, -63.96948315748534, -66.31762155319184, -57.93441163341052, -68.36098006603319, -73.48252226856573, -65.99784987959188, -67.75946978017762, -67.58520925349266, -70.41082370105761, -68.62234624014798, -61.44139482351109, -69.90873035720284, -67.33550100429485, -66.84614668810633, -68.57203466749958, -62.778978778716805, -58.69290181569693, -57.69624949582041, -52.89123871201457, -57.072792144949176, -64.49112221669128, -67.68129705209464, -57.31626392112392, -50.91139728711353, -55.78070223195064, -61.89888302722734, -56.02663800310964, -53.93556209148805, -59.1153202719364, -60.87220509499791, -62.016266740868915, -60.78810762574783, -63.974980447851465, -59.060457006521716, -61.078779114653656, -60.38755913875549, -62.74907982894322, -56.4629103750207, -59.975992169705364, -58.29307976914161, -60.70303094861531, -58.01321443288203, -64.98930639359779, -57.56105584024929, -62.99811901401537, -48.59679000710591, -58.22425263319827, -60.80696539080904, -71.07970608115411, -55.713983868617916, -59.77216822437347, -58.72206227839896, -54.32158300918306, -56.338653649043685, -63.61067008143597, -51.76243397264275], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36211875729446746, "mean_inference_ms": 1.1515558774260477, "mean_action_processing_ms": 0.08635835651823795, "mean_env_wait_ms": 0.5457305705136589, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 9502.207, "sample_throughput": 2104.774, "load_time_ms": 0.3, "load_throughput": 66692701.542, "learn_time_ms": 993.973, "learn_throughput": 20121.264, "update_time_ms": 8.095}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 15.811566829681396, "policy_loss": -0.0012984055083222756, "vf_loss": 15.834115505218506, "vf_explained_var": 0.002038419246673584, "kl": 0.0007871940104325903, "entropy": 2.1258171796798706, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 205, "training_iteration": 5, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-28-49", "timestamp": 1702708129, "time_this_iter_s": 9.674968481063843, "time_total_s": 48.3498432636261, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4379c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 48.3498432636261, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.707692307692312, "ram_util_percent": 22.653846153846153, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -44.792714005860915, "episode_reward_min": -73.48252226856573, "episode_reward_mean": -58.067424100500695, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.31762155319184, -57.93441163341052, -68.36098006603319, -73.48252226856573, -65.99784987959188, -67.75946978017762, -67.58520925349266, -70.41082370105761, -68.62234624014798, -61.44139482351109, -69.90873035720284, -67.33550100429485, -66.84614668810633, -68.57203466749958, -62.778978778716805, -58.69290181569693, -57.69624949582041, -52.89123871201457, -57.072792144949176, -64.49112221669128, -67.68129705209464, -57.31626392112392, -50.91139728711353, -55.78070223195064, -61.89888302722734, -56.02663800310964, -53.93556209148805, -59.1153202719364, -60.87220509499791, -62.016266740868915, -60.78810762574783, -63.974980447851465, -59.060457006521716, -61.078779114653656, -60.38755913875549, -62.74907982894322, -56.4629103750207, -59.975992169705364, -58.29307976914161, -60.70303094861531, -58.01321443288203, -64.98930639359779, -57.56105584024929, -62.99811901401537, -48.59679000710591, -58.22425263319827, -60.80696539080904, -71.07970608115411, -55.713983868617916, -59.77216822437347, -58.72206227839896, -54.32158300918306, -56.338653649043685, -63.61067008143597, -51.76243397264275, -58.529488255792565, -53.233094257207654, -51.74818107423951, -44.792714005860915, -56.570231517207716, -55.08204955797747, -57.81739299200473, -51.62043692628184, -56.163687110139726, -58.87347994164834, -61.6295109892381, -55.85947342945713, -47.34054217471329, -52.249553776615556, -51.067849745464315, -46.01239255329829, -51.21669726184869, -59.673525438892156, -49.17543323684507, -53.494845416580276, -50.806325272549785, -55.97631975446283, -54.573976124294916, -52.198547780367804, -51.33152813500705, -53.918744961142124, -46.32270957726108, -58.36601722613402, -53.97850818747689, -59.6216934425901, -54.50206253104335, -54.253729816425604, -56.04446271920342, -54.8385126144824, -56.657109254921735, -52.08436678018041, -61.84807136870721, -54.01175013919797, -54.07484318803477, -54.20844932891417, -53.854554460891414, -54.24782142272126, -56.76326888237263, -63.782622669565754, -50.58803264705964], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36185779645185034, "mean_inference_ms": 1.1545384249374668, "mean_action_processing_ms": 0.0863200611150261, "mean_env_wait_ms": 0.5450687603760455, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 9519.074, "sample_throughput": 2101.045, "load_time_ms": 0.289, "load_throughput": 69098912.685, "learn_time_ms": 988.279, "learn_throughput": 20237.201, "update_time_ms": 8.004}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 15.336384296417236, "policy_loss": -0.0020491289965818282, "vf_loss": 15.359177589416504, "vf_explained_var": 0.0033981502056121826, "kl": 0.0009168295393952586, "entropy": 2.0749685764312744, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 250, "training_iteration": 6, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-28-59", "timestamp": 1702708139, "time_this_iter_s": 9.567703247070312, "time_total_s": 57.91754651069641, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4655a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 57.91754651069641, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.925, "ram_util_percent": 22.649999999999995, "gpu_util_percent0": 0.010833333333333334, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -37.41818774795186, "episode_reward_min": -71.07970608115411, "episode_reward_mean": -51.31611174192508, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.01321443288203, -64.98930639359779, -57.56105584024929, -62.99811901401537, -48.59679000710591, -58.22425263319827, -60.80696539080904, -71.07970608115411, -55.713983868617916, -59.77216822437347, -58.72206227839896, -54.32158300918306, -56.338653649043685, -63.61067008143597, -51.76243397264275, -58.529488255792565, -53.233094257207654, -51.74818107423951, -44.792714005860915, -56.570231517207716, -55.08204955797747, -57.81739299200473, -51.62043692628184, -56.163687110139726, -58.87347994164834, -61.6295109892381, -55.85947342945713, -47.34054217471329, -52.249553776615556, -51.067849745464315, -46.01239255329829, -51.21669726184869, -59.673525438892156, -49.17543323684507, -53.494845416580276, -50.806325272549785, -55.97631975446283, -54.573976124294916, -52.198547780367804, -51.33152813500705, -53.918744961142124, -46.32270957726108, -58.36601722613402, -53.97850818747689, -59.6216934425901, -54.50206253104335, -54.253729816425604, -56.04446271920342, -54.8385126144824, -56.657109254921735, -52.08436678018041, -61.84807136870721, -54.01175013919797, -54.07484318803477, -54.20844932891417, -53.854554460891414, -54.24782142272126, -56.76326888237263, -63.782622669565754, -50.58803264705964, -47.90806374396847, -48.908837119230746, -52.12898832076503, -38.76643218266405, -37.41818774795186, -42.86682455626415, -44.50633025592906, -37.71176571986152, -43.72739834173177, -47.36562879930882, -47.511074287099895, -51.97420549167665, -49.72618213873373, -45.528262533503195, -54.109655776954746, -49.220768179353215, -44.92079375238794, -41.57835363276787, -38.185869251687166, -47.518321544299354, -47.46379303787745, -37.7613648691032, -44.97125820715177, -44.064296747182254, -41.22745933562935, -45.886680049987184, -41.94884728666463, -45.45957347383212, -40.81128714769521, -47.16502227769353, -45.14267521008114, -47.02964939730649, -47.42131114293827, -41.86406282569748, -40.264562191972566, -45.9707169380972, -47.45447134042605, -45.69806408320005, -52.68128454020702, -46.227277890596305], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36151097480420336, "mean_inference_ms": 1.1562518068809404, "mean_action_processing_ms": 0.08621494007997725, "mean_env_wait_ms": 0.5444715070461932, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 9543.112, "sample_throughput": 2095.752, "load_time_ms": 0.279, "load_throughput": 71723776.719, "learn_time_ms": 987.647, "learn_throughput": 20250.159, "update_time_ms": 7.919}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 10.090702056884766, "policy_loss": -0.0019621976036585664, "vf_loss": 10.112732887268066, "vf_explained_var": 0.00208321213722229, "kl": 0.0010165686943106461, "entropy": 2.0071374773979187, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 290, "training_iteration": 7, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-29-08", "timestamp": 1702708148, "time_this_iter_s": 9.686676979064941, "time_total_s": 67.60422348976135, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04e3bd49d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 67.60422348976135, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.192307692307686, "ram_util_percent": 22.65384615384615, "gpu_util_percent0": 0.006923076923076924, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -34.264099527573904, "episode_reward_min": -63.782622669565754, "episode_reward_mean": -45.16353525303102, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.918744961142124, -46.32270957726108, -58.36601722613402, -53.97850818747689, -59.6216934425901, -54.50206253104335, -54.253729816425604, -56.04446271920342, -54.8385126144824, -56.657109254921735, -52.08436678018041, -61.84807136870721, -54.01175013919797, -54.07484318803477, -54.20844932891417, -53.854554460891414, -54.24782142272126, -56.76326888237263, -63.782622669565754, -50.58803264705964, -47.90806374396847, -48.908837119230746, -52.12898832076503, -38.76643218266405, -37.41818774795186, -42.86682455626415, -44.50633025592906, -37.71176571986152, -43.72739834173177, -47.36562879930882, -47.511074287099895, -51.97420549167665, -49.72618213873373, -45.528262533503195, -54.109655776954746, -49.220768179353215, -44.92079375238794, -41.57835363276787, -38.185869251687166, -47.518321544299354, -47.46379303787745, -37.7613648691032, -44.97125820715177, -44.064296747182254, -41.22745933562935, -45.886680049987184, -41.94884728666463, -45.45957347383212, -40.81128714769521, -47.16502227769353, -45.14267521008114, -47.02964939730649, -47.42131114293827, -41.86406282569748, -40.264562191972566, -45.9707169380972, -47.45447134042605, -45.69806408320005, -52.68128454020702, -46.227277890596305, -40.12614581136381, -39.726056035468076, -44.720755868127554, -41.14725492633431, -44.45875110018261, -36.91946368493163, -43.812002161205285, -42.29259211931695, -40.68058480341951, -42.312845584725565, -42.64596261988047, -37.35260614197388, -45.41852787195849, -48.14520545148797, -35.05887071028844, -34.264099527573904, -38.500734058138065, -36.48223982299161, -38.67102822262564, -37.69958788636612, -34.86595230640465, -42.21197878759876, -38.88855364607251, -45.58512434435052, -39.62416363705254, -39.28980956085273, -39.28870403858884, -39.98982300227535, -42.46699012976687, -36.33198776071104, -40.85512859275119, -37.52345344472932, -40.009309695621596, -37.93076023543004, -42.71352117669339, -36.81140743007967, -39.10461362362548, -42.8116971998906, -40.54328703896881, -37.00901265547428], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3612867651877045, "mean_inference_ms": 1.156458697063667, "mean_action_processing_ms": 0.08613474618170301, "mean_env_wait_ms": 0.5443822451862209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 9566.493, "sample_throughput": 2090.63, "load_time_ms": 0.276, "load_throughput": 72401406.84, "learn_time_ms": 985.872, "learn_throughput": 20286.602, "update_time_ms": 7.869}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 5.478072643280029, "policy_loss": -0.001868019125796816, "vf_loss": 5.499181032180786, "vf_explained_var": 0.0018316209316253662, "kl": 0.0010181506027637788, "entropy": 1.9241602420806885, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 330, "training_iteration": 8, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-29-18", "timestamp": 1702708158, "time_this_iter_s": 9.694712162017822, "time_total_s": 77.29893565177917, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4655d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.29893565177917, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.384615384615383, "ram_util_percent": 22.77692307692308, "gpu_util_percent0": 0.013076923076923078, "vram_util_percent0": 0.016357421875}}
{"episode_reward_max": -24.5218326091306, "episode_reward_min": -52.68128454020702, "episode_reward_mean": -37.81717728390985, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.886680049987184, -41.94884728666463, -45.45957347383212, -40.81128714769521, -47.16502227769353, -45.14267521008114, -47.02964939730649, -47.42131114293827, -41.86406282569748, -40.264562191972566, -45.9707169380972, -47.45447134042605, -45.69806408320005, -52.68128454020702, -46.227277890596305, -40.12614581136381, -39.726056035468076, -44.720755868127554, -41.14725492633431, -44.45875110018261, -36.91946368493163, -43.812002161205285, -42.29259211931695, -40.68058480341951, -42.312845584725565, -42.64596261988047, -37.35260614197388, -45.41852787195849, -48.14520545148797, -35.05887071028844, -34.264099527573904, -38.500734058138065, -36.48223982299161, -38.67102822262564, -37.69958788636612, -34.86595230640465, -42.21197878759876, -38.88855364607251, -45.58512434435052, -39.62416363705254, -39.28980956085273, -39.28870403858884, -39.98982300227535, -42.46699012976687, -36.33198776071104, -40.85512859275119, -37.52345344472932, -40.009309695621596, -37.93076023543004, -42.71352117669339, -36.81140743007967, -39.10461362362548, -42.8116971998906, -40.54328703896881, -37.00901265547428, -38.78363357100051, -33.299774335323775, -34.93564829237878, -24.5218326091306, -34.8085443474438, -31.13432538200869, -32.55736895980866, -29.812251337472837, -33.23405226378588, -31.00310391129865, -29.787977461306127, -38.2898339409396, -37.8691238630921, -33.10593109971614, -37.609161406326784, -26.505451545759886, -32.065752021664835, -30.96783991178316, -41.004436665517076, -34.04316271982367, -34.06262267536615, -37.647718801837954, -30.889537424153986, -37.94265139564276, -32.733067895430885, -30.269864014479925, -36.68320945638688, -33.45430061859426, -30.38629890149162, -31.238851547536214, -33.80961719595299, -33.15927695892644, -35.96665048152801, -35.305061909546694, -31.499010184715253, -30.486828782128573, -37.679518841578286, -30.412747942178058, -29.532382846554555, -32.15763105608055, -32.70517319943329, -30.179237034092317, -37.99737347059562, -32.60467524871159, -32.259136350768], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3630815337260501, "mean_inference_ms": 1.161663723763291, "mean_action_processing_ms": 0.0864786318658911, "mean_env_wait_ms": 0.5462356089629058, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 9653.157, "sample_throughput": 2071.861, "load_time_ms": 0.271, "load_throughput": 73865054.3, "learn_time_ms": 987.692, "learn_throughput": 20249.223, "update_time_ms": 7.842}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 3.9162540435791016, "policy_loss": -0.0017650703938691947, "vf_loss": 3.9363385438919067, "vf_explained_var": 0.0027593672275543213, "kl": 0.0009329289826445208, "entropy": 1.8320516347885132, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 375, "training_iteration": 9, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-29-29", "timestamp": 1702708169, "time_this_iter_s": 10.353914022445679, "time_total_s": 87.65284967422485, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d470f670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 87.65284967422485, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.714285714285715, "ram_util_percent": 22.821428571428566, "gpu_util_percent0": 0.08785714285714286, "vram_util_percent0": 0.01668875558035714}}
{"episode_reward_max": -22.14629771115859, "episode_reward_min": -42.8116971998906, "episode_reward_mean": -32.07388589480046, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.28980956085273, -39.28870403858884, -39.98982300227535, -42.46699012976687, -36.33198776071104, -40.85512859275119, -37.52345344472932, -40.009309695621596, -37.93076023543004, -42.71352117669339, -36.81140743007967, -39.10461362362548, -42.8116971998906, -40.54328703896881, -37.00901265547428, -38.78363357100051, -33.299774335323775, -34.93564829237878, -24.5218326091306, -34.8085443474438, -31.13432538200869, -32.55736895980866, -29.812251337472837, -33.23405226378588, -31.00310391129865, -29.787977461306127, -38.2898339409396, -37.8691238630921, -33.10593109971614, -37.609161406326784, -26.505451545759886, -32.065752021664835, -30.96783991178316, -41.004436665517076, -34.04316271982367, -34.06262267536615, -37.647718801837954, -30.889537424153986, -37.94265139564276, -32.733067895430885, -30.269864014479925, -36.68320945638688, -33.45430061859426, -30.38629890149162, -31.238851547536214, -33.80961719595299, -33.15927695892644, -35.96665048152801, -35.305061909546694, -31.499010184715253, -30.486828782128573, -37.679518841578286, -30.412747942178058, -29.532382846554555, -32.15763105608055, -32.70517319943329, -30.179237034092317, -37.99737347059562, -32.60467524871159, -32.259136350768, -29.890359238575215, -32.66763378155843, -26.96174700929309, -29.086625699000766, -30.959409799818026, -28.88068484843162, -31.30749939725468, -27.80501869244889, -27.07325430927665, -28.42749493696358, -30.10578562481875, -28.56998899449291, -23.54450898291151, -25.710911352309665, -25.323984067793244, -28.012000936919527, -22.14629771115859, -35.23510234203766, -29.08158918934278, -26.9399969752782, -26.599044990566313, -28.652298118749783, -26.17478138176823, -27.125936796958165, -26.065840951284628, -29.978301821828495, -29.463694149281444, -27.5250247975149, -28.392759056328785, -26.786891107851087, -25.418970868865742, -26.82343429810227, -30.780601293612172, -30.073002316351726, -23.094398844678565, -30.66504943798423, -24.672860309578525, -23.34224264483031, -30.462047669465264, -28.48035927000982], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36718458638391127, "mean_inference_ms": 1.1736174801479735, "mean_action_processing_ms": 0.08728611197854325, "mean_env_wait_ms": 0.5513941483119705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 9815.041, "sample_throughput": 2037.689, "load_time_ms": 0.27, "load_throughput": 73954050.957, "learn_time_ms": 990.025, "learn_throughput": 20201.515, "update_time_ms": 8.065}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 2.078251600265503, "policy_loss": -0.0015666961468738805, "vf_loss": 2.0972073078155518, "vf_explained_var": 0.001958131790161133, "kl": 0.0007839272250629303, "entropy": 1.7389259934425354, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 415, "training_iteration": 10, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-29-40", "timestamp": 1702708180, "time_this_iter_s": 11.259244441986084, "time_total_s": 98.91209411621094, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d444ea60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 98.91209411621094, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.77333333333334, "ram_util_percent": 23.033333333333335, "gpu_util_percent0": 0.09133333333333332, "vram_util_percent0": 0.01773003472222222}}
{"episode_reward_max": -18.751113910486193, "episode_reward_min": -37.99737347059562, "episode_reward_mean": -27.58584822021453, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.269864014479925, -36.68320945638688, -33.45430061859426, -30.38629890149162, -31.238851547536214, -33.80961719595299, -33.15927695892644, -35.96665048152801, -35.305061909546694, -31.499010184715253, -30.486828782128573, -37.679518841578286, -30.412747942178058, -29.532382846554555, -32.15763105608055, -32.70517319943329, -30.179237034092317, -37.99737347059562, -32.60467524871159, -32.259136350768, -29.890359238575215, -32.66763378155843, -26.96174700929309, -29.086625699000766, -30.959409799818026, -28.88068484843162, -31.30749939725468, -27.80501869244889, -27.07325430927665, -28.42749493696358, -30.10578562481875, -28.56998899449291, -23.54450898291151, -25.710911352309665, -25.323984067793244, -28.012000936919527, -22.14629771115859, -35.23510234203766, -29.08158918934278, -26.9399969752782, -26.599044990566313, -28.652298118749783, -26.17478138176823, -27.125936796958165, -26.065840951284628, -29.978301821828495, -29.463694149281444, -27.5250247975149, -28.392759056328785, -26.786891107851087, -25.418970868865742, -26.82343429810227, -30.780601293612172, -30.073002316351726, -23.094398844678565, -30.66504943798423, -24.672860309578525, -23.34224264483031, -30.462047669465264, -28.48035927000982, -26.634602840493365, -24.900913954828905, -24.735486890533945, -23.68656697901357, -23.080187857484837, -21.997863534236217, -25.914456209599795, -25.37464442243653, -24.444361603436494, -22.672911547731744, -23.308424259199825, -20.850678388135343, -24.385925337861757, -22.178475188466056, -20.863881286404407, -30.82616506002317, -32.122764979613756, -20.018411635934555, -28.38573262548144, -23.070561388583908, -23.743996928101517, -24.60599148327325, -31.26359616998029, -23.11819414755997, -27.10766138128199, -19.287487318097135, -18.751113910486193, -26.1797118775721, -27.59825600063077, -25.99414153844833, -25.46540785319653, -25.200542064979256, -25.62865102439889, -25.474559304232294, -23.882119000881637, -22.144977963438308, -18.754177322090747, -25.40783524548596, -26.606239016736815, -26.82286642450832], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37214724931921517, "mean_inference_ms": 1.1891811705208126, "mean_action_processing_ms": 0.0882932721656141, "mean_env_wait_ms": 0.5578624450577457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 10040.192, "sample_throughput": 1991.994, "load_time_ms": 0.235, "load_throughput": 85059906.713, "learn_time_ms": 981.497, "learn_throughput": 20377.037, "update_time_ms": 8.046}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 0.9318523705005646, "policy_loss": -0.0014239075161515125, "vf_loss": 0.9497750401496887, "vf_explained_var": 0.002609938383102417, "kl": 0.0006400136719010296, "entropy": 1.6498867273330688, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 455, "training_iteration": 11, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-29-51", "timestamp": 1702708191, "time_this_iter_s": 10.794840574264526, "time_total_s": 109.70693469047546, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d452b700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 109.70693469047546, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.05714285714286, "ram_util_percent": 23.35, "gpu_util_percent0": 0.07857142857142858, "vram_util_percent0": 0.01785132998511905}}
{"episode_reward_max": -17.695225608396374, "episode_reward_min": -32.122764979613756, "episode_reward_mean": -23.34637001493351, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.978301821828495, -29.463694149281444, -27.5250247975149, -28.392759056328785, -26.786891107851087, -25.418970868865742, -26.82343429810227, -30.780601293612172, -30.073002316351726, -23.094398844678565, -30.66504943798423, -24.672860309578525, -23.34224264483031, -30.462047669465264, -28.48035927000982, -26.634602840493365, -24.900913954828905, -24.735486890533945, -23.68656697901357, -23.080187857484837, -21.997863534236217, -25.914456209599795, -25.37464442243653, -24.444361603436494, -22.672911547731744, -23.308424259199825, -20.850678388135343, -24.385925337861757, -22.178475188466056, -20.863881286404407, -30.82616506002317, -32.122764979613756, -20.018411635934555, -28.38573262548144, -23.070561388583908, -23.743996928101517, -24.60599148327325, -31.26359616998029, -23.11819414755997, -27.10766138128199, -19.287487318097135, -18.751113910486193, -26.1797118775721, -27.59825600063077, -25.99414153844833, -25.46540785319653, -25.200542064979256, -25.62865102439889, -25.474559304232294, -23.882119000881637, -22.144977963438308, -18.754177322090747, -25.40783524548596, -26.606239016736815, -26.82286642450832, -25.569436151949567, -20.309875327798153, -22.20019634322616, -20.44914896928346, -17.810463145872802, -21.604643895069156, -18.91301424011364, -18.94373202503757, -21.746342444302122, -20.170782043430208, -18.21212487111741, -23.284949053575325, -18.169001969120323, -21.621848014675315, -17.695225608396374, -19.64355342114059, -17.82275023301831, -20.02328456925526, -23.935911823906984, -21.98413150098409, -19.24441231099989, -21.86913403606134, -19.326746783810822, -21.721804981073902, -20.63186955716465, -19.98926294704504, -17.84093699768814, -24.883483071429048, -19.49365173843007, -19.998419376657157, -20.143051558894502, -23.28504188904374, -21.724579602115814, -24.76907649374172, -19.422784861333565, -22.249900210496413, -20.927466512555167, -21.979980523356968, -20.387497381187444, -20.797899807422525, -23.446683265031577, -18.00136715428752, -20.838392424713113, -22.14159387840083, -20.961368627974103], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37516433936033694, "mean_inference_ms": 1.1992038049388372, "mean_action_processing_ms": 0.0888176063433449, "mean_env_wait_ms": 0.560720431966945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 10060.775, "sample_throughput": 1987.918, "load_time_ms": 0.235, "load_throughput": 85250081.301, "learn_time_ms": 984.385, "learn_throughput": 20317.253, "update_time_ms": 8.061}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 0.6854860186576843, "policy_loss": -0.0006289153908380918, "vf_loss": 0.7018012404441833, "vf_explained_var": 0.002956092357635498, "kl": 0.000474147360006949, "entropy": 1.5686389207839966, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 500, "training_iteration": 12, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-30-01", "timestamp": 1702708201, "time_this_iter_s": 9.865506649017334, "time_total_s": 119.5724413394928, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d45230d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 119.5724413394928, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.357142857142854, "ram_util_percent": 23.2, "gpu_util_percent0": 0.02142857142857143, "vram_util_percent0": 0.0160551525297619}}
{"episode_reward_max": -17.159330813149158, "episode_reward_min": -27.59825600063077, "episode_reward_mean": -20.728511364935834, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.287487318097135, -18.751113910486193, -26.1797118775721, -27.59825600063077, -25.99414153844833, -25.46540785319653, -25.200542064979256, -25.62865102439889, -25.474559304232294, -23.882119000881637, -22.144977963438308, -18.754177322090747, -25.40783524548596, -26.606239016736815, -26.82286642450832, -25.569436151949567, -20.309875327798153, -22.20019634322616, -20.44914896928346, -17.810463145872802, -21.604643895069156, -18.91301424011364, -18.94373202503757, -21.746342444302122, -20.170782043430208, -18.21212487111741, -23.284949053575325, -18.169001969120323, -21.621848014675315, -17.695225608396374, -19.64355342114059, -17.82275023301831, -20.02328456925526, -23.935911823906984, -21.98413150098409, -19.24441231099989, -21.86913403606134, -19.326746783810822, -21.721804981073902, -20.63186955716465, -19.98926294704504, -17.84093699768814, -24.883483071429048, -19.49365173843007, -19.998419376657157, -20.143051558894502, -23.28504188904374, -21.724579602115814, -24.76907649374172, -19.422784861333565, -22.249900210496413, -20.927466512555167, -21.979980523356968, -20.387497381187444, -20.797899807422525, -23.446683265031577, -18.00136715428752, -20.838392424713113, -22.14159387840083, -20.961368627974103, -20.15330145025578, -17.728381647095766, -19.697127360656623, -19.565186694614454, -19.270908440576115, -21.153966747295453, -20.289547823487183, -17.75366393843962, -18.191754935894977, -18.999722746649255, -18.787835184003598, -19.359685994611553, -18.632520748462525, -18.17082143026547, -19.977924960401346, -19.384286323441042, -18.673869257188006, -20.06304203728441, -19.618974240266333, -19.320463502543227, -23.670940747500318, -18.465800540708152, -18.922226960654008, -18.446814784120768, -20.90745879973751, -18.852691831206315, -17.61124983169697, -18.860430944550345, -20.72543308681003, -19.198028301564456, -20.48274898380113, -18.143037704514626, -17.159330813149158, -21.80577955434719, -18.304334077260904, -20.832454140772796, -17.371707103972703, -20.884070468531355, -19.50532470676115, -18.52338014111958], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3755104048947818, "mean_inference_ms": 1.1996170532179464, "mean_action_processing_ms": 0.08878427160151309, "mean_env_wait_ms": 0.5605758180126145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 10082.92, "sample_throughput": 1983.552, "load_time_ms": 0.272, "load_throughput": 73461844.295, "learn_time_ms": 992.012, "learn_throughput": 20161.056, "update_time_ms": 8.071}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 0.40368759632110596, "policy_loss": -0.0006121444873511406, "vf_loss": 0.4193127453327179, "vf_explained_var": 0.0031189322471618652, "kl": 0.0003527927202209291, "entropy": 1.5013008117675781, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 13, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-30-11", "timestamp": 1702708211, "time_this_iter_s": 10.047722101211548, "time_total_s": 129.62016344070435, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4612c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 129.62016344070435, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.53846153846154, "ram_util_percent": 23.16923076923077, "gpu_util_percent0": 0.04230769230769231, "vram_util_percent0": 0.016175881410256412}}
{"episode_reward_max": -17.02809615568399, "episode_reward_min": -24.883483071429048, "episode_reward_mean": -19.448035806743576, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.98926294704504, -17.84093699768814, -24.883483071429048, -19.49365173843007, -19.998419376657157, -20.143051558894502, -23.28504188904374, -21.724579602115814, -24.76907649374172, -19.422784861333565, -22.249900210496413, -20.927466512555167, -21.979980523356968, -20.387497381187444, -20.797899807422525, -23.446683265031577, -18.00136715428752, -20.838392424713113, -22.14159387840083, -20.961368627974103, -20.15330145025578, -17.728381647095766, -19.697127360656623, -19.565186694614454, -19.270908440576115, -21.153966747295453, -20.289547823487183, -17.75366393843962, -18.191754935894977, -18.999722746649255, -18.787835184003598, -19.359685994611553, -18.632520748462525, -18.17082143026547, -19.977924960401346, -19.384286323441042, -18.673869257188006, -20.06304203728441, -19.618974240266333, -19.320463502543227, -23.670940747500318, -18.465800540708152, -18.922226960654008, -18.446814784120768, -20.90745879973751, -18.852691831206315, -17.61124983169697, -18.860430944550345, -20.72543308681003, -19.198028301564456, -20.48274898380113, -18.143037704514626, -17.159330813149158, -21.80577955434719, -18.304334077260904, -20.832454140772796, -17.371707103972703, -20.884070468531355, -19.50532470676115, -18.52338014111958, -19.038556199342665, -17.826862373113393, -17.02809615568399, -19.321170949563534, -20.208990384137863, -18.832178712047146, -20.608152096893477, -18.05562783171945, -17.882062798141202, -18.002171717197875, -19.159151754005528, -17.94786579696466, -18.867158898273914, -19.46095560718708, -18.001980188243472, -18.148957681028826, -20.52087827889732, -18.339879182264916, -18.347967987135192, -17.660351327578404, -18.991128601564213, -18.241615145262205, -20.51039919115961, -19.3623706196694, -17.987155682604975, -20.88513315750187, -17.968950780227765, -18.089701026276387, -17.228130544989753, -18.26011860592412, -19.39212660432353, -18.752095410475945, -19.472066370244825, -19.709069824691056, -19.953294350974737, -18.37878497580656, -18.091412933501587, -18.352618932546083, -17.40736480727304, -17.76235988190313], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37630149920417283, "mean_inference_ms": 1.2009931484172747, "mean_action_processing_ms": 0.08886622414845849, "mean_env_wait_ms": 0.5612644958622469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 10165.35, "sample_throughput": 1967.468, "load_time_ms": 0.269, "load_throughput": 74340730.238, "learn_time_ms": 990.78, "learn_throughput": 20186.111, "update_time_ms": 8.0}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 0.4118265360593796, "policy_loss": -7.521057081177895e-05, "vf_loss": 0.42635321617126465, "vf_explained_var": 0.0034141838550567627, "kl": 0.00023412543614542702, "entropy": 1.4451512098312378, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 580, "training_iteration": 14, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-30-21", "timestamp": 1702708221, "time_this_iter_s": 10.448566913604736, "time_total_s": 140.06873035430908, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04dce47dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 140.06873035430908, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.207142857142856, "ram_util_percent": 23.157142857142855, "gpu_util_percent0": 0.08214285714285716, "vram_util_percent0": 0.01673525855654762}}
{"episode_reward_max": -16.809631447687828, "episode_reward_min": -21.80577955434719, "episode_reward_mean": -18.57447340383537, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.852691831206315, -17.61124983169697, -18.860430944550345, -20.72543308681003, -19.198028301564456, -20.48274898380113, -18.143037704514626, -17.159330813149158, -21.80577955434719, -18.304334077260904, -20.832454140772796, -17.371707103972703, -20.884070468531355, -19.50532470676115, -18.52338014111958, -19.038556199342665, -17.826862373113393, -17.02809615568399, -19.321170949563534, -20.208990384137863, -18.832178712047146, -20.608152096893477, -18.05562783171945, -17.882062798141202, -18.002171717197875, -19.159151754005528, -17.94786579696466, -18.867158898273914, -19.46095560718708, -18.001980188243472, -18.148957681028826, -20.52087827889732, -18.339879182264916, -18.347967987135192, -17.660351327578404, -18.991128601564213, -18.241615145262205, -20.51039919115961, -19.3623706196694, -17.987155682604975, -20.88513315750187, -17.968950780227765, -18.089701026276387, -17.228130544989753, -18.26011860592412, -19.39212660432353, -18.752095410475945, -19.472066370244825, -19.709069824691056, -19.953294350974737, -18.37878497580656, -18.091412933501587, -18.352618932546083, -17.40736480727304, -17.76235988190313, -18.715126970940048, -18.131896255735665, -18.071105806571328, -17.81795384831988, -17.07085721945553, -18.630778445164616, -18.408668102705633, -18.538618528332066, -18.41021260643031, -18.690692203261232, -19.25424086805478, -17.554714031546922, -18.43701497096871, -17.535839870196604, -19.912079679423393, -17.365260096012168, -19.799621031167256, -17.476614702714095, -18.47710329361741, -19.069882137818198, -17.804411631888424, -17.534937960043056, -17.808944589713388, -17.334636348074504, -18.307538972659646, -18.351153721499852, -19.175155752518652, -17.965595232523626, -18.338509942296938, -18.315743496080085, -18.746128080445846, -19.394971170977698, -17.65840261074378, -17.952485489608243, -17.732321884255718, -17.946302485888115, -17.125510883893547, -18.060469007921743, -17.746526086263433, -18.282040565035118, -18.63818857670365, -19.262561285512362, -19.082356102689864, -16.809631447687828, -18.38962133377668], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37837628256539146, "mean_inference_ms": 1.2056777010930377, "mean_action_processing_ms": 0.0891827664168402, "mean_env_wait_ms": 0.5634830955866302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 10259.776, "sample_throughput": 1949.36, "load_time_ms": 0.27, "load_throughput": 74104310.954, "learn_time_ms": 992.112, "learn_throughput": 20159.005, "update_time_ms": 7.989}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 0.5571469366550446, "policy_loss": -4.700012244868157e-05, "vf_loss": 0.5712201595306396, "vf_explained_var": 0.0028036832809448242, "kl": 0.0001134743957005302, "entropy": 1.4026222825050354, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 625, "training_iteration": 15, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-30-32", "timestamp": 1702708232, "time_this_iter_s": 10.642446517944336, "time_total_s": 150.71117687225342, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d452bb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 150.71117687225342, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.85, "ram_util_percent": 23.371428571428574, "gpu_util_percent0": 0.09714285714285716, "vram_util_percent0": 0.01712472098214286}}
{"episode_reward_max": -16.809631447687828, "episode_reward_min": -20.88513315750187, "episode_reward_mean": -18.29757494312747, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.88513315750187, -17.968950780227765, -18.089701026276387, -17.228130544989753, -18.26011860592412, -19.39212660432353, -18.752095410475945, -19.472066370244825, -19.709069824691056, -19.953294350974737, -18.37878497580656, -18.091412933501587, -18.352618932546083, -17.40736480727304, -17.76235988190313, -18.715126970940048, -18.131896255735665, -18.071105806571328, -17.81795384831988, -17.07085721945553, -18.630778445164616, -18.408668102705633, -18.538618528332066, -18.41021260643031, -18.690692203261232, -19.25424086805478, -17.554714031546922, -18.43701497096871, -17.535839870196604, -19.912079679423393, -17.365260096012168, -19.799621031167256, -17.476614702714095, -18.47710329361741, -19.069882137818198, -17.804411631888424, -17.534937960043056, -17.808944589713388, -17.334636348074504, -18.307538972659646, -18.351153721499852, -19.175155752518652, -17.965595232523626, -18.338509942296938, -18.315743496080085, -18.746128080445846, -19.394971170977698, -17.65840261074378, -17.952485489608243, -17.732321884255718, -17.946302485888115, -17.125510883893547, -18.060469007921743, -17.746526086263433, -18.282040565035118, -18.63818857670365, -19.262561285512362, -19.082356102689864, -16.809631447687828, -18.38962133377668, -17.05864253382988, -19.31386171235953, -19.648742789687137, -20.061697384196634, -19.149455637993736, -16.969140988516255, -18.368471277859445, -17.86390938706662, -17.71165464844671, -19.62266042649381, -18.0143188952603, -17.130689675058314, -18.594696087443385, -18.36394637723324, -17.913195296174123, -17.387050833254335, -16.891914053741605, -17.47109416446231, -18.029737508990166, -17.286107616522514, -17.958333007833424, -19.104860328277333, -18.29841953931306, -17.489543375302965, -17.475629619592937, -20.12473392942242, -16.9306285825773, -17.56990903524334, -18.90098212742897, -17.591352996311123, -19.347717405775605, -18.52469990130011, -18.26112242800947, -17.64288603898286, -19.318300374192546, -17.997110493530265, -18.916125793175986, -17.83848992052053, -18.513152121949098, -18.26685646561947], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37971784199618364, "mean_inference_ms": 1.209550451385729, "mean_action_processing_ms": 0.08943723545932718, "mean_env_wait_ms": 0.5653449685561608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 10321.895, "sample_throughput": 1937.629, "load_time_ms": 0.28, "load_throughput": 71331700.68, "learn_time_ms": 994.771, "learn_throughput": 20105.138, "update_time_ms": 8.249}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 0.41906608641147614, "policy_loss": -5.612258980924878e-05, "vf_loss": 0.432842418551445, "vf_explained_var": 0.004354923963546753, "kl": 6.362088753686379e-05, "entropy": 1.3720210194587708, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 665, "training_iteration": 16, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-30-42", "timestamp": 1702708242, "time_this_iter_s": 10.210007190704346, "time_total_s": 160.92118406295776, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d44c9550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 160.92118406295776, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.07857142857142, "ram_util_percent": 23.19285714285714, "gpu_util_percent0": 0.05071428571428571, "vram_util_percent0": 0.018112909226190476}}
{"episode_reward_max": -16.809631447687828, "episode_reward_min": -20.12473392942242, "episode_reward_mean": -18.26865559504569, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.351153721499852, -19.175155752518652, -17.965595232523626, -18.338509942296938, -18.315743496080085, -18.746128080445846, -19.394971170977698, -17.65840261074378, -17.952485489608243, -17.732321884255718, -17.946302485888115, -17.125510883893547, -18.060469007921743, -17.746526086263433, -18.282040565035118, -18.63818857670365, -19.262561285512362, -19.082356102689864, -16.809631447687828, -18.38962133377668, -17.05864253382988, -19.31386171235953, -19.648742789687137, -20.061697384196634, -19.149455637993736, -16.969140988516255, -18.368471277859445, -17.86390938706662, -17.71165464844671, -19.62266042649381, -18.0143188952603, -17.130689675058314, -18.594696087443385, -18.36394637723324, -17.913195296174123, -17.387050833254335, -16.891914053741605, -17.47109416446231, -18.029737508990166, -17.286107616522514, -17.958333007833424, -19.104860328277333, -18.29841953931306, -17.489543375302965, -17.475629619592937, -20.12473392942242, -16.9306285825773, -17.56990903524334, -18.90098212742897, -17.591352996311123, -19.347717405775605, -18.52469990130011, -18.26112242800947, -17.64288603898286, -19.318300374192546, -17.997110493530265, -18.916125793175986, -17.83848992052053, -18.513152121949098, -18.26685646561947, -17.234789235929576, -17.72118822062786, -17.442805952112344, -18.371474496544632, -16.864729042689078, -19.414680778899, -18.247561196542726, -18.690264456828594, -18.60655981922451, -17.78754916802456, -19.19590405198695, -17.68126823225171, -19.919575690957174, -19.41228323992147, -17.954966812423493, -18.906076192305008, -18.17016509773275, -18.596615819598142, -17.052919189676388, -18.41902318292519, -17.76105400484711, -17.073997224094718, -18.94469138196005, -18.051003917376313, -19.157428934161057, -18.581664123337845, -18.530696637891502, -19.752079750239197, -17.414576741180852, -19.749070831325007, -17.783035625370452, -19.60192918540505, -17.45533976464202, -17.965817699384097, -18.834684510182605, -19.464683976707768, -18.244423189946062, -18.217870742059436, -17.427549429768664, -17.26804602221627], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3797928596988727, "mean_inference_ms": 1.21016957379832, "mean_action_processing_ms": 0.0894987325726629, "mean_env_wait_ms": 0.5660074829821603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 10349.323, "sample_throughput": 1932.494, "load_time_ms": 0.295, "load_throughput": 67704665.052, "learn_time_ms": 997.335, "learn_throughput": 20053.443, "update_time_ms": 8.399}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 0.4851020276546478, "policy_loss": -0.00013482589360780395, "vf_loss": 0.49872177839279175, "vf_explained_var": 0.004441767930984497, "kl": 4.768650332498403e-05, "entropy": 1.3484904766082764, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 705, "training_iteration": 17, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-30-52", "timestamp": 1702708252, "time_this_iter_s": 9.958886623382568, "time_total_s": 170.88007068634033, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d44c9820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 170.88007068634033, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.31538461538462, "ram_util_percent": 23.184615384615384, "gpu_util_percent0": 0.05846153846153846, "vram_util_percent0": 0.017822265625000003}}
{"episode_reward_max": -16.70936915755784, "episode_reward_min": -20.12473392942242, "episode_reward_mean": -18.214699311006235, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.12473392942242, -16.9306285825773, -17.56990903524334, -18.90098212742897, -17.591352996311123, -19.347717405775605, -18.52469990130011, -18.26112242800947, -17.64288603898286, -19.318300374192546, -17.997110493530265, -18.916125793175986, -17.83848992052053, -18.513152121949098, -18.26685646561947, -17.234789235929576, -17.72118822062786, -17.442805952112344, -18.371474496544632, -16.864729042689078, -19.414680778899, -18.247561196542726, -18.690264456828594, -18.60655981922451, -17.78754916802456, -19.19590405198695, -17.68126823225171, -19.919575690957174, -19.41228323992147, -17.954966812423493, -18.906076192305008, -18.17016509773275, -18.596615819598142, -17.052919189676388, -18.41902318292519, -17.76105400484711, -17.073997224094718, -18.94469138196005, -18.051003917376313, -19.157428934161057, -18.581664123337845, -18.530696637891502, -19.752079750239197, -17.414576741180852, -19.749070831325007, -17.783035625370452, -19.60192918540505, -17.45533976464202, -17.965817699384097, -18.834684510182605, -19.464683976707768, -18.244423189946062, -18.217870742059436, -17.427549429768664, -17.26804602221627, -17.902818874656084, -18.87538938406326, -18.119408488409203, -18.289228582442785, -17.601944231801916, -17.583201617188998, -18.1104887775651, -18.2222913633991, -18.32408875256672, -18.941104314001855, -19.12208021253031, -17.720413225138934, -17.541373163254413, -18.549589313118894, -17.325087885393216, -18.499870929210715, -17.937768013501376, -19.06885019594228, -17.74033360974878, -17.43896965739285, -17.123356355800823, -18.13136692008826, -18.81966114383328, -18.46324103212727, -17.411873951823402, -18.305432261843073, -17.964297702637545, -17.956173550615695, -18.316923123739883, -17.515450922988606, -17.68075221861605, -17.651791841498707, -18.170190196603023, -16.70936915755784, -17.81946941312789, -17.92154570078585, -18.137842922310966, -17.915956970105082, -18.684962536529213, -18.205044821717287, -18.12952374423871, -17.69455715422508, -18.34980497910519, -18.134532054977065, -18.62839864906443], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3798232745399065, "mean_inference_ms": 1.210231628278115, "mean_action_processing_ms": 0.08954096804333772, "mean_env_wait_ms": 0.566104716704783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 10405.233, "sample_throughput": 1922.11, "load_time_ms": 0.292, "load_throughput": 68523182.487, "learn_time_ms": 1000.249, "learn_throughput": 19995.031, "update_time_ms": 8.424}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 0.5859933197498322, "policy_loss": 4.8520279407604505e-05, "vf_loss": 0.5992312729358673, "vf_explained_var": 0.003999054431915283, "kl": 2.7678423687227394e-05, "entropy": 1.328650414943695, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 750, "training_iteration": 18, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-31-02", "timestamp": 1702708262, "time_this_iter_s": 10.259453535079956, "time_total_s": 181.1395242214203, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d452be50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 181.1395242214203, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 34.46923076923077, "ram_util_percent": 23.399999999999995, "gpu_util_percent0": 0.06461538461538462, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -16.70936915755784, "episode_reward_min": -19.752079750239197, "episode_reward_mean": -18.139983091778177, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.581664123337845, -18.530696637891502, -19.752079750239197, -17.414576741180852, -19.749070831325007, -17.783035625370452, -19.60192918540505, -17.45533976464202, -17.965817699384097, -18.834684510182605, -19.464683976707768, -18.244423189946062, -18.217870742059436, -17.427549429768664, -17.26804602221627, -17.902818874656084, -18.87538938406326, -18.119408488409203, -18.289228582442785, -17.601944231801916, -17.583201617188998, -18.1104887775651, -18.2222913633991, -18.32408875256672, -18.941104314001855, -19.12208021253031, -17.720413225138934, -17.541373163254413, -18.549589313118894, -17.325087885393216, -18.499870929210715, -17.937768013501376, -19.06885019594228, -17.74033360974878, -17.43896965739285, -17.123356355800823, -18.13136692008826, -18.81966114383328, -18.46324103212727, -17.411873951823402, -18.305432261843073, -17.964297702637545, -17.956173550615695, -18.316923123739883, -17.515450922988606, -17.68075221861605, -17.651791841498707, -18.170190196603023, -16.70936915755784, -17.81946941312789, -17.92154570078585, -18.137842922310966, -17.915956970105082, -18.684962536529213, -18.205044821717287, -18.12952374423871, -17.69455715422508, -18.34980497910519, -18.134532054977065, -18.62839864906443, -17.814704031124162, -18.402448524773597, -17.887804665322513, -17.862836530550496, -17.327947313652274, -18.304598868712155, -17.998394300054997, -18.290649326292687, -17.755037520573467, -18.413137327283856, -17.594234277086407, -18.6531726832519, -18.795648093573817, -17.88313950073989, -18.291870328303617, -19.28668835339587, -18.261783190776242, -18.474363158681907, -18.678172675040827, -18.172671844902926, -17.699553552518474, -17.386623331031345, -19.018882697252074, -17.441298706507233, -18.05054444147017, -18.264442589620664, -18.834076589324194, -18.111582046775712, -18.391483330737543, -17.901382549265527, -18.010543060126707, -17.407284084701764, -17.876044934831565, -17.367930787180327, -19.54792193582427, -17.519753644134532, -17.674372613180218, -17.81356687574599, -18.12243814376501, -18.361992602787012], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38013324272888965, "mean_inference_ms": 1.2116698296323765, "mean_action_processing_ms": 0.08961460325008051, "mean_env_wait_ms": 0.5664026066496775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 10392.212, "sample_throughput": 1924.518, "load_time_ms": 0.292, "load_throughput": 68534379.085, "learn_time_ms": 996.332, "learn_throughput": 20073.623, "update_time_ms": 8.443}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 0.46180200576782227, "policy_loss": -6.300888127874771e-05, "vf_loss": 0.4750271290540695, "vf_explained_var": 0.006350666284561157, "kl": 1.7099658532859774e-05, "entropy": 1.3162106275558472, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 790, "training_iteration": 19, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-31-12", "timestamp": 1702708272, "time_this_iter_s": 10.147672414779663, "time_total_s": 191.28719663619995, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d470f670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 191.28719663619995, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.392857142857146, "ram_util_percent": 23.250000000000004, "gpu_util_percent0": 0.05357142857142858, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -16.70936915755784, "episode_reward_min": -19.98322834232161, "episode_reward_mean": -18.110388456107742, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.305432261843073, -17.964297702637545, -17.956173550615695, -18.316923123739883, -17.515450922988606, -17.68075221861605, -17.651791841498707, -18.170190196603023, -16.70936915755784, -17.81946941312789, -17.92154570078585, -18.137842922310966, -17.915956970105082, -18.684962536529213, -18.205044821717287, -18.12952374423871, -17.69455715422508, -18.34980497910519, -18.134532054977065, -18.62839864906443, -17.814704031124162, -18.402448524773597, -17.887804665322513, -17.862836530550496, -17.327947313652274, -18.304598868712155, -17.998394300054997, -18.290649326292687, -17.755037520573467, -18.413137327283856, -17.594234277086407, -18.6531726832519, -18.795648093573817, -17.88313950073989, -18.291870328303617, -19.28668835339587, -18.261783190776242, -18.474363158681907, -18.678172675040827, -18.172671844902926, -17.699553552518474, -17.386623331031345, -19.018882697252074, -17.441298706507233, -18.05054444147017, -18.264442589620664, -18.834076589324194, -18.111582046775712, -18.391483330737543, -17.901382549265527, -18.010543060126707, -17.407284084701764, -17.876044934831565, -17.367930787180327, -19.54792193582427, -17.519753644134532, -17.674372613180218, -17.81356687574599, -18.12243814376501, -18.361992602787012, -17.947140491713498, -18.179213149878994, -18.458483979015494, -17.692679623768207, -18.237294150896904, -18.526730788775154, -17.97212427583785, -16.757464964379114, -18.169174407239403, -17.87454734395967, -17.097362272953536, -17.041131794329374, -19.98322834232161, -17.81983387662465, -17.911767660204198, -17.740054031679342, -18.922051226962147, -18.84545040018899, -17.77344626363547, -19.11898049173078, -17.653071773176087, -18.433459363619242, -16.962820870040428, -18.336932347578554, -17.62217725123898, -17.848637458713263, -18.60193209371304, -18.38130057493754, -18.690361662036096, -17.86720451346563, -19.601729317842782, -18.942164513633728, -17.6878410623286, -17.815867189141976, -17.53759281550073, -18.415495167748837, -18.779389971953016, -18.985869312167594, -18.294136237169127, -17.669661625513754], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38021610172510395, "mean_inference_ms": 1.2124637909774345, "mean_action_processing_ms": 0.08963130158790072, "mean_env_wait_ms": 0.5663583710645677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 10264.516, "sample_throughput": 1948.46, "load_time_ms": 0.303, "load_throughput": 65963733.585, "learn_time_ms": 1002.995, "learn_throughput": 19940.281, "update_time_ms": 8.216}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 0.5132018029689789, "policy_loss": -1.192398103633252e-05, "vf_loss": 0.5262753963470459, "vf_explained_var": 0.0064782798290252686, "kl": 8.645125089579153e-06, "entropy": 1.3061707019805908, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 830, "training_iteration": 20, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-31-23", "timestamp": 1702708283, "time_this_iter_s": 10.087417125701904, "time_total_s": 201.37461376190186, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4612670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 201.37461376190186, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.46153846153846, "ram_util_percent": 23.184615384615384, "gpu_util_percent0": 0.026923076923076925, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -16.757464964379114, "episode_reward_min": -19.98322834232161, "episode_reward_mean": -18.109396769078764, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.264442589620664, -18.834076589324194, -18.111582046775712, -18.391483330737543, -17.901382549265527, -18.010543060126707, -17.407284084701764, -17.876044934831565, -17.367930787180327, -19.54792193582427, -17.519753644134532, -17.674372613180218, -17.81356687574599, -18.12243814376501, -18.361992602787012, -17.947140491713498, -18.179213149878994, -18.458483979015494, -17.692679623768207, -18.237294150896904, -18.526730788775154, -17.97212427583785, -16.757464964379114, -18.169174407239403, -17.87454734395967, -17.097362272953536, -17.041131794329374, -19.98322834232161, -17.81983387662465, -17.911767660204198, -17.740054031679342, -18.922051226962147, -18.84545040018899, -17.77344626363547, -19.11898049173078, -17.653071773176087, -18.433459363619242, -16.962820870040428, -18.336932347578554, -17.62217725123898, -17.848637458713263, -18.60193209371304, -18.38130057493754, -18.690361662036096, -17.86720451346563, -19.601729317842782, -18.942164513633728, -17.6878410623286, -17.815867189141976, -17.53759281550073, -18.415495167748837, -18.779389971953016, -18.985869312167594, -18.294136237169127, -17.669661625513754, -19.904758187177187, -17.6561442035974, -18.54568967529194, -17.581459731634318, -17.281101704704305, -17.683360731634963, -18.47842365532688, -19.937866041132224, -17.99516383882077, -17.859472846047858, -18.50136797944633, -18.152707635570767, -17.72960900360679, -18.81569665284787, -17.810371332968298, -17.377302915299452, -18.3543662734712, -17.877555710171194, -18.41440522123716, -18.36650748993359, -18.241052153336287, -17.628078141813184, -18.5455223983791, -17.55854318304522, -18.06979202042764, -17.936024101860156, -18.10500792129621, -17.53684883473985, -17.662828612380252, -17.51847572684946, -17.783585022420077, -17.43504491569169, -17.7655320180779, -18.221217147152835, -17.129866029058928, -18.649910201773277, -17.49222200819279, -18.289069490306467, -17.71031822254446, -18.550767976517548, -18.848262663819625, -18.451938269564643, -18.936461361194816, -17.652138903694738, -17.49721830820426], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806120078896866, "mean_inference_ms": 1.2141821820568657, "mean_action_processing_ms": 0.08970870143005377, "mean_env_wait_ms": 0.5667987762588801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 10245.121, "sample_throughput": 1952.149, "load_time_ms": 0.304, "load_throughput": 65870498.626, "learn_time_ms": 1004.639, "learn_throughput": 19907.65, "update_time_ms": 8.397}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 0.6126021146774292, "policy_loss": -4.1499710036418946e-05, "vf_loss": 0.6256282925605774, "vf_explained_var": 0.005666494369506836, "kl": 7.824075012319298e-06, "entropy": 1.2984689474105835, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 875, "training_iteration": 21, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-31-33", "timestamp": 1702708293, "time_this_iter_s": 10.549571990966797, "time_total_s": 211.92418575286865, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4655670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 211.92418575286865, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 23.292857142857148, "gpu_util_percent0": 0.03928571428571429, "vram_util_percent0": 0.016892206101190473}}
{"episode_reward_max": -16.981334723060566, "episode_reward_min": -19.937866041132224, "episode_reward_mean": -18.131511526131998, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.848637458713263, -18.60193209371304, -18.38130057493754, -18.690361662036096, -17.86720451346563, -19.601729317842782, -18.942164513633728, -17.6878410623286, -17.815867189141976, -17.53759281550073, -18.415495167748837, -18.779389971953016, -18.985869312167594, -18.294136237169127, -17.669661625513754, -19.904758187177187, -17.6561442035974, -18.54568967529194, -17.581459731634318, -17.281101704704305, -17.683360731634963, -18.47842365532688, -19.937866041132224, -17.99516383882077, -17.859472846047858, -18.50136797944633, -18.152707635570767, -17.72960900360679, -18.81569665284787, -17.810371332968298, -17.377302915299452, -18.3543662734712, -17.877555710171194, -18.41440522123716, -18.36650748993359, -18.241052153336287, -17.628078141813184, -18.5455223983791, -17.55854318304522, -18.06979202042764, -17.936024101860156, -18.10500792129621, -17.53684883473985, -17.662828612380252, -17.51847572684946, -17.783585022420077, -17.43504491569169, -17.7655320180779, -18.221217147152835, -17.129866029058928, -18.649910201773277, -17.49222200819279, -18.289069490306467, -17.71031822254446, -18.550767976517548, -18.848262663819625, -18.451938269564643, -18.936461361194816, -17.652138903694738, -17.49721830820426, -19.124020495922064, -17.672367770610453, -18.435006913414306, -18.100167304568856, -18.346951675420023, -18.358075767803598, -17.96929179351749, -17.490184572113748, -18.435841107716563, -18.456568850318003, -18.207185092494036, -18.23470015988501, -18.51621265350098, -18.380391994337863, -18.281492423591136, -17.764406796960742, -17.85990701546087, -17.702082119844086, -18.46224524500358, -17.733437820599647, -18.711974327584844, -17.776882750030172, -16.981334723060566, -17.90038880569508, -17.476496066255265, -18.15534545567057, -18.245637177924568, -17.46811327374823, -17.98341650563445, -18.540368396794943, -18.07919548044363, -18.359234750176192, -18.37623713702463, -17.717349489466812, -18.55122382069112, -18.210512618533244, -17.911990575640242, -19.19221331382731, -17.82321377551854, -17.50124661826867], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38146748226593885, "mean_inference_ms": 1.2170465512277264, "mean_action_processing_ms": 0.08986945132038635, "mean_env_wait_ms": 0.5680224649611876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 10323.577, "sample_throughput": 1937.313, "load_time_ms": 0.304, "load_throughput": 65725989.187, "learn_time_ms": 1004.454, "learn_throughput": 19911.323, "update_time_ms": 8.405}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 0.476614773273468, "policy_loss": -5.048980588995278e-05, "vf_loss": 0.48960748314857483, "vf_explained_var": 0.009517759084701538, "kl": 2.0633366869859948e-05, "entropy": 1.2942235469818115, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 915, "training_iteration": 22, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-31-44", "timestamp": 1702708304, "time_this_iter_s": 10.622601985931396, "time_total_s": 222.54678773880005, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46f2e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 222.54678773880005, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 37.142857142857146, "ram_util_percent": 23.37857142857143, "gpu_util_percent0": 0.04357142857142858, "vram_util_percent0": 0.017084030877976195}}
{"episode_reward_max": -16.981334723060566, "episode_reward_min": -19.71167750112624, "episode_reward_mean": -18.09714681694545, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.936024101860156, -18.10500792129621, -17.53684883473985, -17.662828612380252, -17.51847572684946, -17.783585022420077, -17.43504491569169, -17.7655320180779, -18.221217147152835, -17.129866029058928, -18.649910201773277, -17.49222200819279, -18.289069490306467, -17.71031822254446, -18.550767976517548, -18.848262663819625, -18.451938269564643, -18.936461361194816, -17.652138903694738, -17.49721830820426, -19.124020495922064, -17.672367770610453, -18.435006913414306, -18.100167304568856, -18.346951675420023, -18.358075767803598, -17.96929179351749, -17.490184572113748, -18.435841107716563, -18.456568850318003, -18.207185092494036, -18.23470015988501, -18.51621265350098, -18.380391994337863, -18.281492423591136, -17.764406796960742, -17.85990701546087, -17.702082119844086, -18.46224524500358, -17.733437820599647, -18.711974327584844, -17.776882750030172, -16.981334723060566, -17.90038880569508, -17.476496066255265, -18.15534545567057, -18.245637177924568, -17.46811327374823, -17.98341650563445, -18.540368396794943, -18.07919548044363, -18.359234750176192, -18.37623713702463, -17.717349489466812, -18.55122382069112, -18.210512618533244, -17.911990575640242, -19.19221331382731, -17.82321377551854, -17.50124661826867, -17.574469608460966, -17.83396565765959, -18.184866333352346, -18.893802647259957, -17.943943673614022, -17.667900723180352, -17.954131223494546, -18.263709155671286, -18.55405405646042, -17.340744459613255, -18.753799942749424, -18.49968760970284, -17.934457165369952, -17.84498005944203, -18.210206369164013, -18.417532202856002, -18.17369495989073, -17.55423871833941, -18.4166783739402, -18.772747973794754, -18.33360747697254, -18.341142438521665, -17.558839613245034, -17.875145362918765, -18.063062174066154, -18.605795706638084, -19.440953519339864, -19.71167750112624, -18.3168361079699, -17.293064084253388, -18.031862547703646, -18.633579073176513, -17.889388273160215, -17.6203186897555, -18.79405828667842, -17.507705436239284, -18.78366764799056, -17.473482357408212, -17.680169858235196, -17.30506425471764], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3818985086233566, "mean_inference_ms": 1.2180432592101735, "mean_action_processing_ms": 0.0899535706070667, "mean_env_wait_ms": 0.5685969171112406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 10328.394, "sample_throughput": 1936.41, "load_time_ms": 0.267, "load_throughput": 74958520.239, "learn_time_ms": 995.892, "learn_throughput": 20082.492, "update_time_ms": 8.434}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005, "total_loss": 0.5201234221458435, "policy_loss": 8.14971913243312e-06, "vf_loss": 0.533035159111023, "vf_explained_var": 0.009790122509002686, "kl": 9.197301292784843e-06, "entropy": 1.2919870018959045, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 955, "training_iteration": 23, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-31-54", "timestamp": 1702708314, "time_this_iter_s": 10.008830308914185, "time_total_s": 232.55561804771423, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4612ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 232.55561804771423, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.428571428571427, "ram_util_percent": 23.52142857142857, "gpu_util_percent0": 0.010714285714285714, "vram_util_percent0": 0.01648530505952381}}
{"episode_reward_max": -17.062548435009425, "episode_reward_min": -19.71167750112624, "episode_reward_mean": -18.137643219900276, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.15534545567057, -18.245637177924568, -17.46811327374823, -17.98341650563445, -18.540368396794943, -18.07919548044363, -18.359234750176192, -18.37623713702463, -17.717349489466812, -18.55122382069112, -18.210512618533244, -17.911990575640242, -19.19221331382731, -17.82321377551854, -17.50124661826867, -17.574469608460966, -17.83396565765959, -18.184866333352346, -18.893802647259957, -17.943943673614022, -17.667900723180352, -17.954131223494546, -18.263709155671286, -18.55405405646042, -17.340744459613255, -18.753799942749424, -18.49968760970284, -17.934457165369952, -17.84498005944203, -18.210206369164013, -18.417532202856002, -18.17369495989073, -17.55423871833941, -18.4166783739402, -18.772747973794754, -18.33360747697254, -18.341142438521665, -17.558839613245034, -17.875145362918765, -18.063062174066154, -18.605795706638084, -19.440953519339864, -19.71167750112624, -18.3168361079699, -17.293064084253388, -18.031862547703646, -18.633579073176513, -17.889388273160215, -17.6203186897555, -18.79405828667842, -17.507705436239284, -18.78366764799056, -17.473482357408212, -17.680169858235196, -17.30506425471764, -18.144912615487097, -18.284708461055455, -18.63790361448823, -18.695193121639832, -17.182253881361994, -18.008335847311265, -18.47393040870996, -18.54169978369154, -18.70172933937412, -18.200256156213594, -18.711734354958292, -19.037069495946774, -18.312467922922366, -17.646437831668173, -18.57327774638189, -17.838512032070952, -17.408978169830693, -18.42280379290654, -17.83996407460138, -17.713134155071373, -18.119411993815053, -17.389244526201267, -17.51828651158284, -17.760715823180025, -17.696682301240273, -18.430222693600182, -17.921329465467032, -18.29010279055712, -18.651962256453128, -17.79873448526118, -18.20510010405247, -17.857482439096998, -17.831236410684184, -17.545656796775013, -18.019453056033598, -18.210041047831844, -18.582118664739482, -18.220445699020253, -18.240167802775087, -18.225635453788854, -17.062548435009425, -17.36371870526594, -19.03361613485498, -18.42838898928227, -18.82238688427178], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38218099674001216, "mean_inference_ms": 1.2183772214690505, "mean_action_processing_ms": 0.08998120450327757, "mean_env_wait_ms": 0.5685923071754645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 10283.807, "sample_throughput": 1944.805, "load_time_ms": 0.267, "load_throughput": 74778106.614, "learn_time_ms": 998.462, "learn_throughput": 20030.805, "update_time_ms": 8.362}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 0.610382616519928, "policy_loss": -1.5137100640494339e-05, "vf_loss": 0.6232912242412567, "vf_explained_var": 0.008562356233596802, "kl": 7.443812193974608e-06, "entropy": 1.2893508076667786, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1000, "training_iteration": 24, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-32-04", "timestamp": 1702708324, "time_this_iter_s": 10.1178879737854, "time_total_s": 242.67350602149963, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46f2820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 242.67350602149963, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.62307692307692, "ram_util_percent": 23.576923076923077, "gpu_util_percent0": 0.03230769230769231, "vram_util_percent0": 0.016551482371794872}}
{"episode_reward_max": -17.062548435009425, "episode_reward_min": -19.71167750112624, "episode_reward_mean": -18.132565434465757, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.605795706638084, -19.440953519339864, -19.71167750112624, -18.3168361079699, -17.293064084253388, -18.031862547703646, -18.633579073176513, -17.889388273160215, -17.6203186897555, -18.79405828667842, -17.507705436239284, -18.78366764799056, -17.473482357408212, -17.680169858235196, -17.30506425471764, -18.144912615487097, -18.284708461055455, -18.63790361448823, -18.695193121639832, -17.182253881361994, -18.008335847311265, -18.47393040870996, -18.54169978369154, -18.70172933937412, -18.200256156213594, -18.711734354958292, -19.037069495946774, -18.312467922922366, -17.646437831668173, -18.57327774638189, -17.838512032070952, -17.408978169830693, -18.42280379290654, -17.83996407460138, -17.713134155071373, -18.119411993815053, -17.389244526201267, -17.51828651158284, -17.760715823180025, -17.696682301240273, -18.430222693600182, -17.921329465467032, -18.29010279055712, -18.651962256453128, -17.79873448526118, -18.20510010405247, -17.857482439096998, -17.831236410684184, -17.545656796775013, -18.019453056033598, -18.210041047831844, -18.582118664739482, -18.220445699020253, -18.240167802775087, -18.225635453788854, -17.062548435009425, -17.36371870526594, -19.03361613485498, -18.42838898928227, -18.82238688427178, -18.2156885589013, -18.71948859504193, -17.94931707920859, -18.517967072746146, -17.09244821057874, -18.618079763878892, -19.66739524806714, -17.99616866875717, -17.86834046367571, -18.054448438862266, -17.162643944769993, -17.781643726275888, -17.730024828660948, -17.82784409750474, -17.909575258380183, -18.33735311118442, -17.819648969185053, -17.75352799561552, -18.24520270555792, -19.17779358315924, -17.683048147537306, -18.467069225299838, -18.10074253286083, -18.38586167468278, -17.51452346419682, -17.665638362494263, -17.902759104143442, -18.215333869965093, -17.42539652116843, -18.397642161243077, -18.887120570428046, -18.1748993119621, -18.19583056288785, -17.686658115595755, -18.89663901187958, -17.894641140318008, -17.59211581769289, -18.39915509313982, -18.074709717741296, -18.564543100401927], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38290763150770557, "mean_inference_ms": 1.2197857733117352, "mean_action_processing_ms": 0.09007544776304792, "mean_env_wait_ms": 0.569026606794949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 10300.713, "sample_throughput": 1941.613, "load_time_ms": 0.27, "load_throughput": 74143609.687, "learn_time_ms": 1001.893, "learn_throughput": 19962.203, "update_time_ms": 8.353}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005, "total_loss": 0.4713471531867981, "policy_loss": -4.7284700139371694e-05, "vf_loss": 0.4842681884765625, "vf_explained_var": 0.014997899532318115, "kl": 1.9535397533410048e-05, "entropy": 1.2873778939247131, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1040, "training_iteration": 25, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-32-15", "timestamp": 1702708335, "time_this_iter_s": 10.81611704826355, "time_total_s": 253.48962306976318, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4654820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 253.48962306976318, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 39.207142857142856, "ram_util_percent": 23.48571428571429, "gpu_util_percent0": 0.06500000000000002, "vram_util_percent0": 0.017217726934523808}}
{"episode_reward_max": -17.062548435009425, "episode_reward_min": -19.66739524806714, "episode_reward_mean": -18.104392098565654, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.430222693600182, -17.921329465467032, -18.29010279055712, -18.651962256453128, -17.79873448526118, -18.20510010405247, -17.857482439096998, -17.831236410684184, -17.545656796775013, -18.019453056033598, -18.210041047831844, -18.582118664739482, -18.220445699020253, -18.240167802775087, -18.225635453788854, -17.062548435009425, -17.36371870526594, -19.03361613485498, -18.42838898928227, -18.82238688427178, -18.2156885589013, -18.71948859504193, -17.94931707920859, -18.517967072746146, -17.09244821057874, -18.618079763878892, -19.66739524806714, -17.99616866875717, -17.86834046367571, -18.054448438862266, -17.162643944769993, -17.781643726275888, -17.730024828660948, -17.82784409750474, -17.909575258380183, -18.33735311118442, -17.819648969185053, -17.75352799561552, -18.24520270555792, -19.17779358315924, -17.683048147537306, -18.467069225299838, -18.10074253286083, -18.38586167468278, -17.51452346419682, -17.665638362494263, -17.902759104143442, -18.215333869965093, -17.42539652116843, -18.397642161243077, -18.887120570428046, -18.1748993119621, -18.19583056288785, -17.686658115595755, -18.89663901187958, -17.894641140318008, -17.59211581769289, -18.39915509313982, -18.074709717741296, -18.564543100401927, -17.74404943065854, -18.006306517552105, -18.241259514347785, -17.747613216917294, -17.489010022685264, -18.19363634615093, -17.77229542383627, -17.783109462533965, -18.226779465503828, -17.780954325446288, -18.996594529836685, -18.812210324916375, -18.14749675499548, -18.506181339081213, -17.642448697587774, -18.704438482591833, -18.028379221825897, -18.867154272659093, -17.54411199270291, -18.45910347246246, -18.455926245961294, -17.413120131678046, -18.89637512317956, -18.418640174564587, -18.086420363125427, -17.31958428368244, -18.162180992828716, -18.33149862329278, -17.910386834288232, -17.956637334104826, -17.2659320792783, -17.766040121531383, -18.544396544447878, -17.483727050631117, -18.673571880893626, -18.089316639847603, -17.27168244751431, -17.25709531306796, -18.45181364820953, -18.682455069673942], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38344786623276067, "mean_inference_ms": 1.2211351228929763, "mean_action_processing_ms": 0.09015796067416694, "mean_env_wait_ms": 0.5695946856001958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 10282.561, "sample_throughput": 1945.041, "load_time_ms": 0.258, "load_throughput": 77507234.593, "learn_time_ms": 1004.322, "learn_throughput": 19913.937, "update_time_ms": 8.256}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 0.5048737227916718, "policy_loss": -1.5939330745950997e-05, "vf_loss": 0.5177386403083801, "vf_explained_var": 0.016504108905792236, "kl": 2.7315711178976798e-05, "entropy": 1.2848953604698181, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 26, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-32-25", "timestamp": 1702708345, "time_this_iter_s": 10.016738653182983, "time_total_s": 263.50636172294617, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4659f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 263.50636172294617, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 31.2, "ram_util_percent": 23.935714285714283, "gpu_util_percent0": 0.015, "vram_util_percent0": 0.017810639880952377}}
{"episode_reward_max": -16.936937443569324, "episode_reward_min": -19.45201577011136, "episode_reward_mean": -18.166446133083056, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.665638362494263, -17.902759104143442, -18.215333869965093, -17.42539652116843, -18.397642161243077, -18.887120570428046, -18.1748993119621, -18.19583056288785, -17.686658115595755, -18.89663901187958, -17.894641140318008, -17.59211581769289, -18.39915509313982, -18.074709717741296, -18.564543100401927, -17.74404943065854, -18.006306517552105, -18.241259514347785, -17.747613216917294, -17.489010022685264, -18.19363634615093, -17.77229542383627, -17.783109462533965, -18.226779465503828, -17.780954325446288, -18.996594529836685, -18.812210324916375, -18.14749675499548, -18.506181339081213, -17.642448697587774, -18.704438482591833, -18.028379221825897, -18.867154272659093, -17.54411199270291, -18.45910347246246, -18.455926245961294, -17.413120131678046, -18.89637512317956, -18.418640174564587, -18.086420363125427, -17.31958428368244, -18.162180992828716, -18.33149862329278, -17.910386834288232, -17.956637334104826, -17.2659320792783, -17.766040121531383, -18.544396544447878, -17.483727050631117, -18.673571880893626, -18.089316639847603, -17.27168244751431, -17.25709531306796, -18.45181364820953, -18.682455069673942, -19.01344604925143, -17.476676297698944, -19.45201577011136, -18.566587146525585, -17.11571861802627, -18.70998019591892, -18.50367797243713, -18.5159744500368, -18.461971528070556, -18.14713160787938, -17.060790427469602, -18.029253294609536, -18.473029921795288, -18.227901799828253, -17.88149750393113, -18.645663683588538, -17.775801815672857, -17.937999085994022, -18.74242247556363, -17.992841721684748, -18.552136416780854, -16.936937443569324, -19.381185036651516, -18.596460191859464, -18.252461257777277, -17.53362456777822, -18.482287438688736, -18.02554900701526, -17.855196578262788, -18.9638244094358, -18.861461266901024, -17.864390925410383, -18.34117388344774, -17.90576799933934, -17.493660260430172, -18.1472865184444, -17.6242890094834, -18.63556640582172, -18.426564720022796, -18.699204235470695, -18.84072635345038, -18.16663999300335, -18.308306055487897, -17.981273594907453, -18.935242195616382], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832058937180157, "mean_inference_ms": 1.2204409641769163, "mean_action_processing_ms": 0.09008582650377676, "mean_env_wait_ms": 0.5693028691615036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 10260.975, "sample_throughput": 1949.133, "load_time_ms": 0.243, "load_throughput": 82257383.801, "learn_time_ms": 1002.06, "learn_throughput": 19958.881, "update_time_ms": 8.598}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 0.6016403138637543, "policy_loss": -2.8413009998562444e-05, "vf_loss": 0.6144936978816986, "vf_explained_var": 0.015418201684951782, "kl": 2.8543123982593954e-05, "entropy": 1.2824967503547668, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1125, "training_iteration": 27, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-32-35", "timestamp": 1702708355, "time_this_iter_s": 9.703899145126343, "time_total_s": 273.2102608680725, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46598b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 273.2102608680725, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 29.369230769230764, "ram_util_percent": 23.823076923076925, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.936937443569324, "episode_reward_min": -19.45201577011136, "episode_reward_mean": -18.207227125780367, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.31958428368244, -18.162180992828716, -18.33149862329278, -17.910386834288232, -17.956637334104826, -17.2659320792783, -17.766040121531383, -18.544396544447878, -17.483727050631117, -18.673571880893626, -18.089316639847603, -17.27168244751431, -17.25709531306796, -18.45181364820953, -18.682455069673942, -19.01344604925143, -17.476676297698944, -19.45201577011136, -18.566587146525585, -17.11571861802627, -18.70998019591892, -18.50367797243713, -18.5159744500368, -18.461971528070556, -18.14713160787938, -17.060790427469602, -18.029253294609536, -18.473029921795288, -18.227901799828253, -17.88149750393113, -18.645663683588538, -17.775801815672857, -17.937999085994022, -18.74242247556363, -17.992841721684748, -18.552136416780854, -16.936937443569324, -19.381185036651516, -18.596460191859464, -18.252461257777277, -17.53362456777822, -18.482287438688736, -18.02554900701526, -17.855196578262788, -18.9638244094358, -18.861461266901024, -17.864390925410383, -18.34117388344774, -17.90576799933934, -17.493660260430172, -18.1472865184444, -17.6242890094834, -18.63556640582172, -18.426564720022796, -18.699204235470695, -18.84072635345038, -18.16663999300335, -18.308306055487897, -17.981273594907453, -18.935242195616382, -18.22425843748651, -18.1312522012337, -18.113955374551367, -17.830569601506966, -17.071348515414837, -18.38953333042393, -18.466303726740414, -18.282310653890157, -17.830405655461817, -17.737763709516713, -18.16470651593565, -18.04607674604094, -18.23523908672215, -17.748809338160825, -18.73438951682003, -18.875531620546212, -18.290754627679508, -19.164876433923826, -18.54160631938783, -17.95550188271101, -17.271498794309373, -18.332491101128525, -17.795043244819528, -18.534397984098227, -18.114705222464618, -19.345559284574797, -17.965143064850537, -18.256235120868453, -17.267185108509306, -18.931662456717717, -19.065262042462614, -18.52371226788973, -17.99210033984043, -17.696012378373915, -18.055384564587705, -19.28545694513901, -19.0761901676689, -18.815527674586207, -17.258011638984215, -18.59802388756548], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38253234876221504, "mean_inference_ms": 1.2185171029356365, "mean_action_processing_ms": 0.08994170619093261, "mean_env_wait_ms": 0.5685141032156121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 10209.455, "sample_throughput": 1958.968, "load_time_ms": 0.242, "load_throughput": 82516309.266, "learn_time_ms": 1000.179, "learn_throughput": 19996.422, "update_time_ms": 8.61}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 0.43966227769851685, "policy_loss": -5.23559559546527e-05, "vf_loss": 0.4525216072797775, "vf_explained_var": 0.02645668387413025, "kl": 2.6069784889060088e-05, "entropy": 1.2806982398033142, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1165, "training_iteration": 28, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-32-44", "timestamp": 1702708364, "time_this_iter_s": 9.730769157409668, "time_total_s": 282.9410300254822, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46590d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 282.9410300254822, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.125, "ram_util_percent": 23.883333333333336, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -17.071348515414837, "episode_reward_min": -19.444977240714408, "episode_reward_mean": -18.212529404186185, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.53362456777822, -18.482287438688736, -18.02554900701526, -17.855196578262788, -18.9638244094358, -18.861461266901024, -17.864390925410383, -18.34117388344774, -17.90576799933934, -17.493660260430172, -18.1472865184444, -17.6242890094834, -18.63556640582172, -18.426564720022796, -18.699204235470695, -18.84072635345038, -18.16663999300335, -18.308306055487897, -17.981273594907453, -18.935242195616382, -18.22425843748651, -18.1312522012337, -18.113955374551367, -17.830569601506966, -17.071348515414837, -18.38953333042393, -18.466303726740414, -18.282310653890157, -17.830405655461817, -17.737763709516713, -18.16470651593565, -18.04607674604094, -18.23523908672215, -17.748809338160825, -18.73438951682003, -18.875531620546212, -18.290754627679508, -19.164876433923826, -18.54160631938783, -17.95550188271101, -17.271498794309373, -18.332491101128525, -17.795043244819528, -18.534397984098227, -18.114705222464618, -19.345559284574797, -17.965143064850537, -18.256235120868453, -17.267185108509306, -18.931662456717717, -19.065262042462614, -18.52371226788973, -17.99210033984043, -17.696012378373915, -18.055384564587705, -19.28545694513901, -19.0761901676689, -18.815527674586207, -17.258011638984215, -18.59802388756548, -18.27861392346137, -17.58420278759403, -17.767728191724604, -18.048011076055772, -17.708339280872398, -19.229461655971676, -19.197255924339174, -19.246407287307804, -17.419149673944357, -17.663085741263906, -18.74558533927072, -17.49509268405459, -17.74933544261281, -17.787107695397744, -18.166777441194142, -18.33960959793012, -19.095076733004873, -18.03446686168102, -17.678089213250743, -17.939727965865035, -18.026749069446513, -17.570718249924028, -17.716238123359556, -18.554851921882744, -17.670061463027317, -18.008680133306132, -18.055721793404036, -18.19399997952845, -18.469587969074396, -19.444977240714408, -17.8143894774497, -18.1868948015952, -17.55360733150352, -19.188586654744135, -18.476395573010095, -17.097027663935847, -18.706351589870458, -18.217291469955654, -17.75532684603681, -18.265526548041194], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3819148145412879, "mean_inference_ms": 1.2164993792903576, "mean_action_processing_ms": 0.08979381856432501, "mean_env_wait_ms": 0.56771965036444, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 10162.017, "sample_throughput": 1968.113, "load_time_ms": 0.242, "load_throughput": 82483854.474, "learn_time_ms": 1001.266, "learn_throughput": 19974.706, "update_time_ms": 8.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005, "total_loss": 0.47094330191612244, "policy_loss": -3.659362689945045e-05, "vf_loss": 0.48380473256111145, "vf_explained_var": 0.02831512689590454, "kl": 6.183518914093522e-05, "entropy": 1.2824782133102417, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1205, "training_iteration": 29, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-32-54", "timestamp": 1702708374, "time_this_iter_s": 9.707802057266235, "time_total_s": 292.6488320827484, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4379310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 292.6488320827484, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.638461538461538, "ram_util_percent": 23.869230769230764, "gpu_util_percent0": 0.0023076923076923075, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -17.052025821101797, "episode_reward_min": -19.444977240714408, "episode_reward_mean": -18.221024791491608, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.345559284574797, -17.965143064850537, -18.256235120868453, -17.267185108509306, -18.931662456717717, -19.065262042462614, -18.52371226788973, -17.99210033984043, -17.696012378373915, -18.055384564587705, -19.28545694513901, -19.0761901676689, -18.815527674586207, -17.258011638984215, -18.59802388756548, -18.27861392346137, -17.58420278759403, -17.767728191724604, -18.048011076055772, -17.708339280872398, -19.229461655971676, -19.197255924339174, -19.246407287307804, -17.419149673944357, -17.663085741263906, -18.74558533927072, -17.49509268405459, -17.74933544261281, -17.787107695397744, -18.166777441194142, -18.33960959793012, -19.095076733004873, -18.03446686168102, -17.678089213250743, -17.939727965865035, -18.026749069446513, -17.570718249924028, -17.716238123359556, -18.554851921882744, -17.670061463027317, -18.008680133306132, -18.055721793404036, -18.19399997952845, -18.469587969074396, -19.444977240714408, -17.8143894774497, -18.1868948015952, -17.55360733150352, -19.188586654744135, -18.476395573010095, -17.097027663935847, -18.706351589870458, -18.217291469955654, -17.75532684603681, -18.265526548041194, -18.03339189205582, -19.24576244059204, -18.285891602074734, -18.869458884334602, -18.08981716672372, -18.02229046340831, -18.049449145155975, -17.6326621058638, -17.95314002717054, -17.76964457102081, -18.172974536024483, -18.368844500867134, -19.440434642850214, -18.74088128624566, -18.353919627784514, -17.862820291758144, -18.184949488874288, -17.860691616081315, -17.573895527833734, -18.217143488122353, -17.426598233163922, -17.98233449292919, -18.207388959366874, -18.073284967315416, -17.74868781201281, -19.081321826641457, -17.052025821101797, -17.724057861418295, -19.029424476673746, -17.99121318625162, -17.94606670840328, -18.739809035451515, -18.945915676131207, -18.09878809386008, -18.328533705277117, -18.629943653942824, -18.546723588263788, -17.898112935358768, -18.202467132674826, -18.61013770774428, -18.34682513967325, -18.005805066058223, -17.565728853793903, -18.427492795068012, -18.48815275651623], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38134997524734277, "mean_inference_ms": 1.2148461283484564, "mean_action_processing_ms": 0.08965216827405992, "mean_env_wait_ms": 0.5670396882450853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 10134.651, "sample_throughput": 1973.428, "load_time_ms": 0.227, "load_throughput": 88143406.536, "learn_time_ms": 991.421, "learn_throughput": 20173.074, "update_time_ms": 8.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005, "total_loss": 0.5686424672603607, "policy_loss": -5.8573914429871365e-05, "vf_loss": 0.5815424919128418, "vf_explained_var": 0.026010900735855103, "kl": 7.498612735368226e-05, "entropy": 1.28414785861969, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1250, "training_iteration": 30, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-33-04", "timestamp": 1702708384, "time_this_iter_s": 9.70284652709961, "time_total_s": 302.351678609848, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d44c9e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 302.351678609848, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.55384615384616, "ram_util_percent": 23.97692307692307, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -17.052025821101797, "episode_reward_min": -19.80020515058921, "episode_reward_mean": -18.204403427775812, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.008680133306132, -18.055721793404036, -18.19399997952845, -18.469587969074396, -19.444977240714408, -17.8143894774497, -18.1868948015952, -17.55360733150352, -19.188586654744135, -18.476395573010095, -17.097027663935847, -18.706351589870458, -18.217291469955654, -17.75532684603681, -18.265526548041194, -18.03339189205582, -19.24576244059204, -18.285891602074734, -18.869458884334602, -18.08981716672372, -18.02229046340831, -18.049449145155975, -17.6326621058638, -17.95314002717054, -17.76964457102081, -18.172974536024483, -18.368844500867134, -19.440434642850214, -18.74088128624566, -18.353919627784514, -17.862820291758144, -18.184949488874288, -17.860691616081315, -17.573895527833734, -18.217143488122353, -17.426598233163922, -17.98233449292919, -18.207388959366874, -18.073284967315416, -17.74868781201281, -19.081321826641457, -17.052025821101797, -17.724057861418295, -19.029424476673746, -17.99121318625162, -17.94606670840328, -18.739809035451515, -18.945915676131207, -18.09878809386008, -18.328533705277117, -18.629943653942824, -18.546723588263788, -17.898112935358768, -18.202467132674826, -18.61013770774428, -18.34682513967325, -18.005805066058223, -17.565728853793903, -18.427492795068012, -18.48815275651623, -18.080126719694974, -18.63548254037942, -17.61064403333946, -18.294802666280283, -19.242317494776024, -18.21468721216063, -18.932947631192604, -18.137925621318246, -19.80020515058921, -18.596678283740196, -18.21747367937793, -18.236549250043115, -18.4413267908365, -18.401528322467378, -19.349280653491213, -17.945012456128495, -17.7843551857964, -18.639217159523398, -17.836996598299674, -17.376533614898584, -17.83190227010354, -17.94304082595169, -18.94468144750259, -18.60967817744286, -17.50757822612795, -18.377986355509734, -17.630612661142266, -17.88304215213604, -17.654244460197198, -17.93893149055257, -17.97145118457458, -17.855567644317965, -18.20913404495838, -17.899526535621863, -17.90438616881609, -18.045933931951154, -17.79997186002651, -17.41811185378252, -18.039991613169818, -17.941209947257544], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808625044903184, "mean_inference_ms": 1.2130720991964057, "mean_action_processing_ms": 0.0895205321021497, "mean_env_wait_ms": 0.5665103723726717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 10040.246, "sample_throughput": 1991.983, "load_time_ms": 0.226, "load_throughput": 88412816.189, "learn_time_ms": 991.648, "learn_throughput": 20168.441, "update_time_ms": 8.458}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005, "total_loss": 0.4079927057027817, "policy_loss": 2.3038483326853765e-05, "vf_loss": 0.4208240211009979, "vf_explained_var": 0.04207700490951538, "kl": 5.748853722942204e-05, "entropy": 1.2854332327842712, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1290, "training_iteration": 31, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-33-14", "timestamp": 1702708394, "time_this_iter_s": 9.710782051086426, "time_total_s": 312.06246066093445, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04dce47430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 312.06246066093445, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.33846153846154, "ram_util_percent": 23.95384615384615, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -17.052025821101797, "episode_reward_min": -19.80020515058921, "episode_reward_mean": -18.126629630224645, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.081321826641457, -17.052025821101797, -17.724057861418295, -19.029424476673746, -17.99121318625162, -17.94606670840328, -18.739809035451515, -18.945915676131207, -18.09878809386008, -18.328533705277117, -18.629943653942824, -18.546723588263788, -17.898112935358768, -18.202467132674826, -18.61013770774428, -18.34682513967325, -18.005805066058223, -17.565728853793903, -18.427492795068012, -18.48815275651623, -18.080126719694974, -18.63548254037942, -17.61064403333946, -18.294802666280283, -19.242317494776024, -18.21468721216063, -18.932947631192604, -18.137925621318246, -19.80020515058921, -18.596678283740196, -18.21747367937793, -18.236549250043115, -18.4413267908365, -18.401528322467378, -19.349280653491213, -17.945012456128495, -17.7843551857964, -18.639217159523398, -17.836996598299674, -17.376533614898584, -17.83190227010354, -17.94304082595169, -18.94468144750259, -18.60967817744286, -17.50757822612795, -18.377986355509734, -17.630612661142266, -17.88304215213604, -17.654244460197198, -17.93893149055257, -17.97145118457458, -17.855567644317965, -18.20913404495838, -17.899526535621863, -17.90438616881609, -18.045933931951154, -17.79997186002651, -17.41811185378252, -18.039991613169818, -17.941209947257544, -18.193197355047232, -18.190774513003475, -17.969162248927105, -18.21917182628652, -17.636191066760333, -18.470257912006613, -17.881179767343152, -17.06244286086787, -17.493724382382837, -17.359970032953818, -18.502994989189183, -18.424294614688613, -17.97974331383186, -17.941398236142803, -17.913722919532873, -17.36890690349893, -17.940876363950547, -17.353946389872803, -17.79968582604038, -17.77934731292117, -18.135397088180895, -18.090264150847773, -17.775279627003044, -17.88631917860077, -17.58080171097302, -17.69859109520429, -18.7871287317206, -18.686090857406995, -18.238156352646875, -18.595605263303057, -18.305926704584103, -18.337165456779314, -18.5589064853, -18.219736941909584, -18.262719711736622, -18.243394967498222, -17.438621773819904, -17.95506445895333, -17.837332928764006, -17.709850766203186], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38029933013332623, "mean_inference_ms": 1.2111341119650278, "mean_action_processing_ms": 0.08939320015644897, "mean_env_wait_ms": 0.5659482356876657, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 9944.482, "sample_throughput": 2011.166, "load_time_ms": 0.23, "load_throughput": 86991683.086, "learn_time_ms": 990.433, "learn_throughput": 20193.193, "update_time_ms": 8.489}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005, "total_loss": 0.4236871302127838, "policy_loss": -8.797607427712961e-05, "vf_loss": 0.4366334527730942, "vf_explained_var": 0.04430556297302246, "kl": 6.396502600347631e-05, "entropy": 1.2858315706253052, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1330, "training_iteration": 32, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-33-23", "timestamp": 1702708403, "time_this_iter_s": 9.66266131401062, "time_total_s": 321.72512197494507, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04e3bd49d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 321.72512197494507, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.753846153846155, "ram_util_percent": 24.169230769230765, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -17.062224672885993, "episode_reward_min": -19.674214126414334, "episode_reward_mean": -17.94283974836242, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.377986355509734, -17.630612661142266, -17.88304215213604, -17.654244460197198, -17.93893149055257, -17.97145118457458, -17.855567644317965, -18.20913404495838, -17.899526535621863, -17.90438616881609, -18.045933931951154, -17.79997186002651, -17.41811185378252, -18.039991613169818, -17.941209947257544, -18.193197355047232, -18.190774513003475, -17.969162248927105, -18.21917182628652, -17.636191066760333, -18.470257912006613, -17.881179767343152, -17.06244286086787, -17.493724382382837, -17.359970032953818, -18.502994989189183, -18.424294614688613, -17.97974331383186, -17.941398236142803, -17.913722919532873, -17.36890690349893, -17.940876363950547, -17.353946389872803, -17.79968582604038, -17.77934731292117, -18.135397088180895, -18.090264150847773, -17.775279627003044, -17.88631917860077, -17.58080171097302, -17.69859109520429, -18.7871287317206, -18.686090857406995, -18.238156352646875, -18.595605263303057, -18.305926704584103, -18.337165456779314, -18.5589064853, -18.219736941909584, -18.262719711736622, -18.243394967498222, -17.438621773819904, -17.95506445895333, -17.837332928764006, -17.709850766203186, -17.746055871225835, -17.730561049753916, -17.242194424785183, -17.062224672885993, -17.337360524776265, -18.266334511806036, -18.456595095018976, -17.7830983773032, -17.51717213488614, -17.38882093861851, -17.859047599873822, -18.081634716013582, -18.4404044998237, -17.81060859773863, -18.773034563395388, -17.169614150781364, -18.087761791618096, -18.06720049646365, -18.466495550328638, -17.379963562321123, -17.484563845866823, -18.10768079135368, -18.114192273045152, -18.56511169335583, -17.912444018469024, -18.525208741693653, -17.637059155401612, -18.072968649861785, -17.666465832699945, -17.795021716794565, -17.76269482188939, -17.412712404907616, -17.21817023544164, -17.905880049939835, -18.127548927582385, -17.549323198532964, -17.114643511106003, -18.10995257329807, -18.243845536245207, -18.250822950092157, -17.25485619727603, -18.149763857795516, -18.674759053911206, -17.894442553151528, -19.674214126414334], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3799845577646803, "mean_inference_ms": 1.2106230209634943, "mean_action_processing_ms": 0.08932122404988131, "mean_env_wait_ms": 0.5655948498369433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 9955.505, "sample_throughput": 2008.939, "load_time_ms": 0.231, "load_throughput": 86694997.933, "learn_time_ms": 992.18, "learn_throughput": 20157.637, "update_time_ms": 8.48}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005, "total_loss": 0.5320580899715424, "policy_loss": 7.494278025133028e-05, "vf_loss": 0.544842004776001, "vf_explained_var": 0.037423908710479736, "kl": 2.917657405809848e-05, "entropy": 1.2858824133872986, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1375, "training_iteration": 33, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-33-33", "timestamp": 1702708413, "time_this_iter_s": 10.14481806755066, "time_total_s": 331.8699400424957, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04dce47dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 331.8699400424957, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.73076923076923, "ram_util_percent": 24.16923076923077, "gpu_util_percent0": 0.05153846153846154, "vram_util_percent0": 0.017653245192307696}}
{"episode_reward_max": -17.030345165349132, "episode_reward_min": -19.73838266626999, "episode_reward_mean": -18.01518005856655, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.69859109520429, -18.7871287317206, -18.686090857406995, -18.238156352646875, -18.595605263303057, -18.305926704584103, -18.337165456779314, -18.5589064853, -18.219736941909584, -18.262719711736622, -18.243394967498222, -17.438621773819904, -17.95506445895333, -17.837332928764006, -17.709850766203186, -17.746055871225835, -17.730561049753916, -17.242194424785183, -17.062224672885993, -17.337360524776265, -18.266334511806036, -18.456595095018976, -17.7830983773032, -17.51717213488614, -17.38882093861851, -17.859047599873822, -18.081634716013582, -18.4404044998237, -17.81060859773863, -18.773034563395388, -17.169614150781364, -18.087761791618096, -18.06720049646365, -18.466495550328638, -17.379963562321123, -17.484563845866823, -18.10768079135368, -18.114192273045152, -18.56511169335583, -17.912444018469024, -18.525208741693653, -17.637059155401612, -18.072968649861785, -17.666465832699945, -17.795021716794565, -17.76269482188939, -17.412712404907616, -17.21817023544164, -17.905880049939835, -18.127548927582385, -17.549323198532964, -17.114643511106003, -18.10995257329807, -18.243845536245207, -18.250822950092157, -17.25485619727603, -18.149763857795516, -18.674759053911206, -17.894442553151528, -19.674214126414334, -18.17146510438576, -17.849769598299424, -18.40499789382244, -18.5228944885627, -17.453390190047607, -17.2058134558578, -18.51897760996242, -17.905308233873598, -18.185905096299898, -17.87270564750436, -17.889912195747993, -18.444259565924202, -18.03399984187757, -18.44027041504675, -18.980327310235275, -18.21691123158601, -18.23862430285023, -17.030345165349132, -19.73838266626999, -17.60298692765383, -18.542179468197084, -17.586596031133936, -18.062027306573345, -18.33016047474979, -17.59718397428949, -17.035855015199985, -19.09566263395455, -17.635236485321023, -18.061146673856854, -18.7272105067859, -17.13862086524525, -18.139076517923954, -18.463769495782536, -18.426385288184026, -17.523763524667025, -17.400194687757075, -18.220123963754553, -18.032353857919457, -18.209947443378667, -17.818442359449303], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38007594693585395, "mean_inference_ms": 1.2108230725577942, "mean_action_processing_ms": 0.08933256905466579, "mean_env_wait_ms": 0.5657438113872493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 9968.964, "sample_throughput": 2006.227, "load_time_ms": 0.243, "load_throughput": 82362376.043, "learn_time_ms": 994.111, "learn_throughput": 20118.473, "update_time_ms": 8.563}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005, "total_loss": 0.3718118518590927, "policy_loss": -1.3009643755612643e-05, "vf_loss": 0.3847092241048813, "vf_explained_var": 0.0559561550617218, "kl": 5.331029125921205e-06, "entropy": 1.288435161113739, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1415, "training_iteration": 34, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-33-44", "timestamp": 1702708424, "time_this_iter_s": 10.253987073898315, "time_total_s": 342.12392711639404, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d468aca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 342.12392711639404, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.34285714285714, "ram_util_percent": 24.21428571428571, "gpu_util_percent0": 0.06357142857142858, "vram_util_percent0": 0.017659505208333332}}
{"episode_reward_max": -17.030345165349132, "episode_reward_min": -19.73838266626999, "episode_reward_mean": -18.029859384109436, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.525208741693653, -17.637059155401612, -18.072968649861785, -17.666465832699945, -17.795021716794565, -17.76269482188939, -17.412712404907616, -17.21817023544164, -17.905880049939835, -18.127548927582385, -17.549323198532964, -17.114643511106003, -18.10995257329807, -18.243845536245207, -18.250822950092157, -17.25485619727603, -18.149763857795516, -18.674759053911206, -17.894442553151528, -19.674214126414334, -18.17146510438576, -17.849769598299424, -18.40499789382244, -18.5228944885627, -17.453390190047607, -17.2058134558578, -18.51897760996242, -17.905308233873598, -18.185905096299898, -17.87270564750436, -17.889912195747993, -18.444259565924202, -18.03399984187757, -18.44027041504675, -18.980327310235275, -18.21691123158601, -18.23862430285023, -17.030345165349132, -19.73838266626999, -17.60298692765383, -18.542179468197084, -17.586596031133936, -18.062027306573345, -18.33016047474979, -17.59718397428949, -17.035855015199985, -19.09566263395455, -17.635236485321023, -18.061146673856854, -18.7272105067859, -17.13862086524525, -18.139076517923954, -18.463769495782536, -18.426385288184026, -17.523763524667025, -17.400194687757075, -18.220123963754553, -18.032353857919457, -18.209947443378667, -17.818442359449303, -18.542537145289437, -17.665888516958518, -17.575866407155466, -17.578020852691612, -17.93075453649204, -18.889689413244557, -17.318873227931675, -18.842238941908825, -17.530284159515354, -18.21753582310742, -18.1032829236128, -17.469812217974077, -18.12288845674489, -17.94425619565003, -18.609271436527408, -18.68898954927284, -18.006765455441837, -17.81829070537963, -17.63386253550389, -18.017923527160125, -17.905317140968638, -17.518586300496565, -17.37037855401681, -17.999213542781927, -18.222198132249478, -18.99535612489307, -18.38902723835469, -18.458020552230373, -17.420223382721595, -17.859299454169, -17.90692153212572, -17.395742334884503, -17.707522054439288, -18.18842980300075, -17.912305984499554, -18.951774405800276, -18.92768415293348, -18.524004984579946, -17.62193682329454, -17.411426275624578], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3799913851020949, "mean_inference_ms": 1.2104541148879486, "mean_action_processing_ms": 0.0893279834377757, "mean_env_wait_ms": 0.565894150312504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 9878.006, "sample_throughput": 2024.7, "load_time_ms": 0.242, "load_throughput": 82678967.081, "learn_time_ms": 991.29, "learn_throughput": 20175.723, "update_time_ms": 8.619}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005, "total_loss": 0.3988055884838104, "policy_loss": -3.7170409236786384e-05, "vf_loss": 0.4117567390203476, "vf_explained_var": 0.05659976601600647, "kl": 2.0537770982931303e-05, "entropy": 1.2913957834243774, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1455, "training_iteration": 35, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-33-54", "timestamp": 1702708434, "time_this_iter_s": 9.86592698097229, "time_total_s": 351.98985409736633, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d44c95e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 351.98985409736633, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.76153846153846, "ram_util_percent": 24.161538461538463, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.017415364583333336}}
{"episode_reward_max": -17.035855015199985, "episode_reward_min": -19.417511528459883, "episode_reward_mean": -18.04249425209875, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.035855015199985, -19.09566263395455, -17.635236485321023, -18.061146673856854, -18.7272105067859, -17.13862086524525, -18.139076517923954, -18.463769495782536, -18.426385288184026, -17.523763524667025, -17.400194687757075, -18.220123963754553, -18.032353857919457, -18.209947443378667, -17.818442359449303, -18.542537145289437, -17.665888516958518, -17.575866407155466, -17.578020852691612, -17.93075453649204, -18.889689413244557, -17.318873227931675, -18.842238941908825, -17.530284159515354, -18.21753582310742, -18.1032829236128, -17.469812217974077, -18.12288845674489, -17.94425619565003, -18.609271436527408, -18.68898954927284, -18.006765455441837, -17.81829070537963, -17.63386253550389, -18.017923527160125, -17.905317140968638, -17.518586300496565, -17.37037855401681, -17.999213542781927, -18.222198132249478, -18.99535612489307, -18.38902723835469, -18.458020552230373, -17.420223382721595, -17.859299454169, -17.90692153212572, -17.395742334884503, -17.707522054439288, -18.18842980300075, -17.912305984499554, -18.951774405800276, -18.92768415293348, -18.524004984579946, -17.62193682329454, -17.411426275624578, -18.209695147467322, -19.203675057770518, -18.131047064808115, -17.866129061642397, -17.894075512656137, -18.50355937118439, -17.83893822394797, -18.026832990977063, -18.359098064020323, -19.417511528459883, -18.20553827018633, -18.36540517113285, -18.463775240783413, -17.97868410933995, -17.86424334252103, -18.092853857469926, -17.95811936569941, -18.210242482722414, -17.547167808742522, -17.785857512079602, -18.28120405609144, -18.34441116725948, -18.636203631855444, -17.991349576341275, -17.87267498160097, -18.382897934743617, -17.418643692586024, -18.26668055351162, -17.43609576689895, -17.62294688191874, -18.180565415097053, -18.192078028400694, -17.662712734931276, -17.78555605973453, -18.409531382692926, -17.478902225808255, -18.40321430983382, -17.77413259373015, -17.68623703193143, -17.77701760090343, -17.47184646432792, -17.85098638636425, -18.616926370799487, -18.51780530289665, -17.146165755196566], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37973823392640166, "mean_inference_ms": 1.2097943091233605, "mean_action_processing_ms": 0.08927904525963097, "mean_env_wait_ms": 0.5657736537427137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 9858.369, "sample_throughput": 2028.733, "load_time_ms": 0.242, "load_throughput": 82719731.782, "learn_time_ms": 989.73, "learn_throughput": 20207.538, "update_time_ms": 8.553}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005, "total_loss": 0.5186976194381714, "policy_loss": -1.8513489371763114e-05, "vf_loss": 0.5316539108753204, "vf_explained_var": 0.049968838691711426, "kl": 2.53030015011646e-05, "entropy": 1.29378080368042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1500, "training_iteration": 36, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-34-03", "timestamp": 1702708443, "time_this_iter_s": 9.833860397338867, "time_total_s": 361.8237144947052, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46590d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 361.8237144947052, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.52307692307692, "ram_util_percent": 24.199999999999996, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.017415364583333336}}
{"episode_reward_max": -16.98080200268739, "episode_reward_min": -19.417511528459883, "episode_reward_mean": -18.013530972072964, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.99535612489307, -18.38902723835469, -18.458020552230373, -17.420223382721595, -17.859299454169, -17.90692153212572, -17.395742334884503, -17.707522054439288, -18.18842980300075, -17.912305984499554, -18.951774405800276, -18.92768415293348, -18.524004984579946, -17.62193682329454, -17.411426275624578, -18.209695147467322, -19.203675057770518, -18.131047064808115, -17.866129061642397, -17.894075512656137, -18.50355937118439, -17.83893822394797, -18.026832990977063, -18.359098064020323, -19.417511528459883, -18.20553827018633, -18.36540517113285, -18.463775240783413, -17.97868410933995, -17.86424334252103, -18.092853857469926, -17.95811936569941, -18.210242482722414, -17.547167808742522, -17.785857512079602, -18.28120405609144, -18.34441116725948, -18.636203631855444, -17.991349576341275, -17.87267498160097, -18.382897934743617, -17.418643692586024, -18.26668055351162, -17.43609576689895, -17.62294688191874, -18.180565415097053, -18.192078028400694, -17.662712734931276, -17.78555605973453, -18.409531382692926, -17.478902225808255, -18.40321430983382, -17.77413259373015, -17.68623703193143, -17.77701760090343, -17.47184646432792, -17.85098638636425, -18.616926370799487, -18.51780530289665, -17.146165755196566, -17.565725516230415, -18.05915002515341, -18.349327459075468, -18.17295764946671, -17.128157905778714, -17.567028899584233, -17.66493415782655, -17.829232442804646, -17.764824445773, -18.18876324670265, -16.98080200268739, -17.610422529607842, -17.751441418145507, -17.616693740574135, -17.790737835693932, -18.468657999889256, -17.440083799573024, -18.867470925820392, -18.79231766939564, -18.8252958273698, -19.232846210396204, -18.133351207311925, -17.113310721479273, -17.500556554533127, -17.617426522146417, -17.93253776746419, -18.684692841712486, -17.511179742891034, -17.612305838905556, -18.259860561648836, -18.385870508920434, -17.754578113890666, -17.48575749807762, -18.383960752494097, -17.26406868206235, -17.681284019483705, -17.328718025100912, -17.654275829619635, -17.868086651819667, -18.715493467566674], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37947199407498955, "mean_inference_ms": 1.2090255287669303, "mean_action_processing_ms": 0.08920712262474328, "mean_env_wait_ms": 0.5654453585453859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 9864.802, "sample_throughput": 2027.41, "load_time_ms": 0.246, "load_throughput": 81206272.991, "learn_time_ms": 991.467, "learn_throughput": 20172.133, "update_time_ms": 8.217}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005, "total_loss": 0.3504171818494797, "policy_loss": 2.4536133123476134e-05, "vf_loss": 0.36338354647159576, "vf_explained_var": 0.07604888081550598, "kl": 8.86414996914553e-06, "entropy": 1.2990905046463013, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1540, "training_iteration": 37, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-34-13", "timestamp": 1702708453, "time_this_iter_s": 9.79240608215332, "time_total_s": 371.6161205768585, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04e3b720d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 371.6161205768585, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.438461538461542, "ram_util_percent": 24.26923076923077, "gpu_util_percent0": 0.008461538461538463, "vram_util_percent0": 0.017415364583333336}}
{"episode_reward_max": -16.98080200268739, "episode_reward_min": -19.33439866042609, "episode_reward_mean": -17.93644415804272, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.382897934743617, -17.418643692586024, -18.26668055351162, -17.43609576689895, -17.62294688191874, -18.180565415097053, -18.192078028400694, -17.662712734931276, -17.78555605973453, -18.409531382692926, -17.478902225808255, -18.40321430983382, -17.77413259373015, -17.68623703193143, -17.77701760090343, -17.47184646432792, -17.85098638636425, -18.616926370799487, -18.51780530289665, -17.146165755196566, -17.565725516230415, -18.05915002515341, -18.349327459075468, -18.17295764946671, -17.128157905778714, -17.567028899584233, -17.66493415782655, -17.829232442804646, -17.764824445773, -18.18876324670265, -16.98080200268739, -17.610422529607842, -17.751441418145507, -17.616693740574135, -17.790737835693932, -18.468657999889256, -17.440083799573024, -18.867470925820392, -18.79231766939564, -18.8252958273698, -19.232846210396204, -18.133351207311925, -17.113310721479273, -17.500556554533127, -17.617426522146417, -17.93253776746419, -18.684692841712486, -17.511179742891034, -17.612305838905556, -18.259860561648836, -18.385870508920434, -17.754578113890666, -17.48575749807762, -18.383960752494097, -17.26406868206235, -17.681284019483705, -17.328718025100912, -17.654275829619635, -17.868086651819667, -18.715493467566674, -17.279704801206044, -17.468601347637247, -18.663996207560935, -17.868029169197214, -18.326202043592204, -19.33439866042609, -17.781550207817368, -17.712901916906617, -17.987505452584635, -18.427688041522742, -19.209689741083018, -17.974350626890363, -17.32896803064631, -17.546762354613126, -17.669273473616695, -18.628116756193638, -17.39975721275758, -19.067221260291866, -17.272234517107176, -17.354661091201784, -17.297869476024147, -17.958008533930034, -18.288461651296636, -17.61086707518734, -17.611798874340042, -17.300073009375694, -18.323083162351146, -17.30480731082495, -18.281380452518043, -17.592502593532743, -17.241587194329178, -17.727414542920474, -17.614484677319204, -17.724344836366726, -18.486197875846162, -19.236685656411694, -17.38777719197814, -19.003964283692014, -18.753772021893834, -17.96259296429588], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791300399963697, "mean_inference_ms": 1.2078978740305664, "mean_action_processing_ms": 0.08913282597603046, "mean_env_wait_ms": 0.565013059221789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 9868.272, "sample_throughput": 2026.697, "load_time_ms": 0.247, "load_throughput": 81072852.034, "learn_time_ms": 993.089, "learn_throughput": 20139.187, "update_time_ms": 8.564}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005, "total_loss": 0.37162888050079346, "policy_loss": -1.650619459381275e-05, "vf_loss": 0.38467641174793243, "vf_explained_var": 0.08186608552932739, "kl": 6.840405157915175e-06, "entropy": 1.303101897239685, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1580, "training_iteration": 38, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-34-23", "timestamp": 1702708463, "time_this_iter_s": 9.786844730377197, "time_total_s": 381.4029653072357, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d44c9430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 381.4029653072357, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.56153846153846, "ram_util_percent": 24.33076923076923, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.01735276442307692}}
{"episode_reward_max": -16.750861094874615, "episode_reward_min": -19.33439866042609, "episode_reward_mean": -18.001303371672737, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.93253776746419, -18.684692841712486, -17.511179742891034, -17.612305838905556, -18.259860561648836, -18.385870508920434, -17.754578113890666, -17.48575749807762, -18.383960752494097, -17.26406868206235, -17.681284019483705, -17.328718025100912, -17.654275829619635, -17.868086651819667, -18.715493467566674, -17.279704801206044, -17.468601347637247, -18.663996207560935, -17.868029169197214, -18.326202043592204, -19.33439866042609, -17.781550207817368, -17.712901916906617, -17.987505452584635, -18.427688041522742, -19.209689741083018, -17.974350626890363, -17.32896803064631, -17.546762354613126, -17.669273473616695, -18.628116756193638, -17.39975721275758, -19.067221260291866, -17.272234517107176, -17.354661091201784, -17.297869476024147, -17.958008533930034, -18.288461651296636, -17.61086707518734, -17.611798874340042, -17.300073009375694, -18.323083162351146, -17.30480731082495, -18.281380452518043, -17.592502593532743, -17.241587194329178, -17.727414542920474, -17.614484677319204, -17.724344836366726, -18.486197875846162, -19.236685656411694, -17.38777719197814, -19.003964283692014, -18.753772021893834, -17.96259296429588, -18.079603713213928, -18.00105205077442, -18.328983192448383, -18.342498474782897, -17.654670555645772, -18.631767218944262, -17.782917512962747, -17.488655691570788, -17.574520972096103, -18.42597947856356, -18.766095771897103, -18.746739286052957, -19.201775619556507, -17.908680692425467, -17.13610064893022, -16.750861094874615, -17.19888098619035, -18.306772330549748, -18.284467054406477, -18.882748829888314, -17.658830737470176, -17.832567454266623, -17.46493983025864, -17.899214396263233, -19.217238416741843, -17.06847400227407, -17.766864178562287, -18.447516330830545, -17.54100952235644, -17.907638627578763, -18.04519365846232, -17.543514398288323, -18.412450056581456, -17.7943578600265, -18.182879216518547, -17.713011258657357, -18.352354690331886, -17.722513463608465, -17.78704507272001, -18.4044929127942, -18.50759982546623, -17.67229263678146, -18.386276242102493, -19.070198279988787, -18.70613632362391], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37883764201172726, "mean_inference_ms": 1.207270191493449, "mean_action_processing_ms": 0.08907690070109416, "mean_env_wait_ms": 0.5647544929017689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 9886.337, "sample_throughput": 2022.994, "load_time_ms": 0.255, "load_throughput": 78456864.946, "learn_time_ms": 994.413, "learn_throughput": 20112.367, "update_time_ms": 8.592}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005, "total_loss": 0.494841605424881, "policy_loss": 2.8463745239404314e-05, "vf_loss": 0.5079022943973541, "vf_explained_var": 0.07550576329231262, "kl": 1.0213117941137995e-05, "entropy": 1.3089177012443542, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1625, "training_iteration": 39, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-34-33", "timestamp": 1702708473, "time_this_iter_s": 9.864248752593994, "time_total_s": 391.2672140598297, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46590d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 391.2672140598297, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 24.315384615384616, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.750861094874615, "episode_reward_min": -19.236685656411694, "episode_reward_mean": -18.011373931822288, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.300073009375694, -18.323083162351146, -17.30480731082495, -18.281380452518043, -17.592502593532743, -17.241587194329178, -17.727414542920474, -17.614484677319204, -17.724344836366726, -18.486197875846162, -19.236685656411694, -17.38777719197814, -19.003964283692014, -18.753772021893834, -17.96259296429588, -18.079603713213928, -18.00105205077442, -18.328983192448383, -18.342498474782897, -17.654670555645772, -18.631767218944262, -17.782917512962747, -17.488655691570788, -17.574520972096103, -18.42597947856356, -18.766095771897103, -18.746739286052957, -19.201775619556507, -17.908680692425467, -17.13610064893022, -16.750861094874615, -17.19888098619035, -18.306772330549748, -18.284467054406477, -18.882748829888314, -17.658830737470176, -17.832567454266623, -17.46493983025864, -17.899214396263233, -19.217238416741843, -17.06847400227407, -17.766864178562287, -18.447516330830545, -17.54100952235644, -17.907638627578763, -18.04519365846232, -17.543514398288323, -18.412450056581456, -17.7943578600265, -18.182879216518547, -17.713011258657357, -18.352354690331886, -17.722513463608465, -17.78704507272001, -18.4044929127942, -18.50759982546623, -17.67229263678146, -18.386276242102493, -19.070198279988787, -18.70613632362391, -16.972655721158432, -18.727190224532848, -17.79233917061744, -18.550482993738235, -18.343677693628862, -17.96470287965201, -18.298602209461077, -17.941936335069315, -17.750203208028566, -17.74958689912158, -17.31588645791643, -18.24279740428962, -17.739106085418175, -18.395969468826912, -17.694145161933058, -17.962190653632568, -18.32363617253344, -18.529474782616198, -17.57820958598088, -18.089796506173187, -18.8001858754836, -17.27347041420056, -18.087545426086944, -18.35311560720556, -17.108024050078154, -18.833862082965098, -17.19382628192119, -16.97886633060584, -17.941140388045604, -17.242425249964246, -17.568038880017045, -18.131973989869635, -18.006062240782086, -17.939400798062596, -18.076933590757037, -18.437535149471856, -18.308463650980443, -17.698671128004218, -18.82400495461502, -17.83220913679786], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37863676071999064, "mean_inference_ms": 1.2067311280968736, "mean_action_processing_ms": 0.08903237805186556, "mean_env_wait_ms": 0.564555963532943, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 9903.893, "sample_throughput": 2019.408, "load_time_ms": 0.267, "load_throughput": 74971918.849, "learn_time_ms": 998.091, "learn_throughput": 20038.244, "update_time_ms": 8.758}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005, "total_loss": 0.3264153450727463, "policy_loss": -4.739151018462451e-05, "vf_loss": 0.3396098017692566, "vf_explained_var": 0.11162275075912476, "kl": 1.2034533158455929e-05, "entropy": 1.314707636833191, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1665, "training_iteration": 40, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-34-43", "timestamp": 1702708483, "time_this_iter_s": 9.90141487121582, "time_total_s": 401.16862893104553, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04e3b720d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 401.16862893104553, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.61538461538462, "ram_util_percent": 24.41538461538461, "gpu_util_percent0": 0.0015384615384615385, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.657108952530063, "episode_reward_min": -19.199464842409974, "episode_reward_mean": -18.022956127220173, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.06847400227407, -17.766864178562287, -18.447516330830545, -17.54100952235644, -17.907638627578763, -18.04519365846232, -17.543514398288323, -18.412450056581456, -17.7943578600265, -18.182879216518547, -17.713011258657357, -18.352354690331886, -17.722513463608465, -17.78704507272001, -18.4044929127942, -18.50759982546623, -17.67229263678146, -18.386276242102493, -19.070198279988787, -18.70613632362391, -16.972655721158432, -18.727190224532848, -17.79233917061744, -18.550482993738235, -18.343677693628862, -17.96470287965201, -18.298602209461077, -17.941936335069315, -17.750203208028566, -17.74958689912158, -17.31588645791643, -18.24279740428962, -17.739106085418175, -18.395969468826912, -17.694145161933058, -17.962190653632568, -18.32363617253344, -18.529474782616198, -17.57820958598088, -18.089796506173187, -18.8001858754836, -17.27347041420056, -18.087545426086944, -18.35311560720556, -17.108024050078154, -18.833862082965098, -17.19382628192119, -16.97886633060584, -17.941140388045604, -17.242425249964246, -17.568038880017045, -18.131973989869635, -18.006062240782086, -17.939400798062596, -18.076933590757037, -18.437535149471856, -18.308463650980443, -17.698671128004218, -18.82400495461502, -17.83220913679786, -17.745569212829416, -17.644815475796097, -18.361684619291786, -17.835935232001003, -18.924448534947928, -18.605267187071423, -17.9173547310718, -18.46611165926833, -17.849151961185143, -17.116951130662844, -17.138642934394035, -17.638675488636473, -18.299911518186924, -18.20621575097254, -18.527187173167633, -18.121884016023998, -17.509142340779253, -18.124779455317285, -19.170609205419563, -18.256512099065418, -18.867955719154267, -16.989059687875727, -18.176182866102664, -17.829890698437318, -18.42529723948736, -16.657108952530063, -18.277920070039006, -18.076057790067324, -18.183175512133076, -18.984284118306753, -18.678052524942196, -18.09671401230326, -18.407017159341265, -19.199464842409974, -16.73341009871712, -17.557638106000596, -17.97191278142084, -18.333558965552914, -17.77122165563456, -17.98867679767502], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37838587276559393, "mean_inference_ms": 1.2059500170062483, "mean_action_processing_ms": 0.08897549763766242, "mean_env_wait_ms": 0.5641700330831949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 9914.266, "sample_throughput": 2017.295, "load_time_ms": 0.266, "load_throughput": 75086000.716, "learn_time_ms": 997.644, "learn_throughput": 20047.239, "update_time_ms": 8.841}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005, "total_loss": 0.3456031084060669, "policy_loss": -2.1887969627432113e-05, "vf_loss": 0.35887035727500916, "vf_explained_var": 0.11891776323318481, "kl": 3.1041980892432264e-05, "entropy": 1.3245324492454529, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1705, "training_iteration": 41, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-34-53", "timestamp": 1702708493, "time_this_iter_s": 9.775411605834961, "time_total_s": 410.9440405368805, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d46115e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 410.9440405368805, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.446153846153848, "ram_util_percent": 24.415384615384614, "gpu_util_percent0": 0.02230769230769231, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.657108952530063, "episode_reward_min": -19.526907953164745, "episode_reward_mean": -18.054532598512402, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.833862082965098, -17.19382628192119, -16.97886633060584, -17.941140388045604, -17.242425249964246, -17.568038880017045, -18.131973989869635, -18.006062240782086, -17.939400798062596, -18.076933590757037, -18.437535149471856, -18.308463650980443, -17.698671128004218, -18.82400495461502, -17.83220913679786, -17.745569212829416, -17.644815475796097, -18.361684619291786, -17.835935232001003, -18.924448534947928, -18.605267187071423, -17.9173547310718, -18.46611165926833, -17.849151961185143, -17.116951130662844, -17.138642934394035, -17.638675488636473, -18.299911518186924, -18.20621575097254, -18.527187173167633, -18.121884016023998, -17.509142340779253, -18.124779455317285, -19.170609205419563, -18.256512099065418, -18.867955719154267, -16.989059687875727, -18.176182866102664, -17.829890698437318, -18.42529723948736, -16.657108952530063, -18.277920070039006, -18.076057790067324, -18.183175512133076, -18.984284118306753, -18.678052524942196, -18.09671401230326, -18.407017159341265, -19.199464842409974, -16.73341009871712, -17.557638106000596, -17.97191278142084, -18.333558965552914, -17.77122165563456, -17.98867679767502, -18.405251852745188, -17.90232499314903, -17.89917708714498, -17.6305374577245, -17.593878887508993, -18.676242827392247, -17.26772227422282, -17.937219085956006, -17.59612259404994, -17.394970973023327, -17.904809067040382, -16.964394698358873, -18.216886724485008, -18.469338884093645, -18.086880954587546, -19.068356613669238, -18.318240769441466, -18.37003786850536, -17.79428873086389, -17.25947725177263, -19.526907953164745, -18.884627038934962, -18.079897988253144, -18.19635483416515, -17.26524614659676, -17.691955058585734, -19.50878350864125, -17.79189691443869, -17.562687144831415, -18.292258682469154, -18.598142257356866, -17.676707034364547, -18.618684770563124, -19.177411111737293, -17.58508037453611, -18.4681430777805, -18.30030959247849, -17.871962694459366, -18.299048250464466, -18.703090073861176, -17.021485009692892, -17.39350400171192, -17.68858828694966, -18.993983035270247, -17.821482237117124], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37822794919202096, "mean_inference_ms": 1.2057319195042113, "mean_action_processing_ms": 0.08893745656780093, "mean_env_wait_ms": 0.5638244256878324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 9934.943, "sample_throughput": 2013.097, "load_time_ms": 0.262, "load_throughput": 76454684.652, "learn_time_ms": 1001.693, "learn_throughput": 19966.204, "update_time_ms": 8.887}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005, "total_loss": 0.4698008596897125, "policy_loss": -4.8933408857365635e-05, "vf_loss": 0.483214408159256, "vf_explained_var": 0.10791537165641785, "kl": 3.9553726499885755e-05, "entropy": 1.336459755897522, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1750, "training_iteration": 42, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-35-03", "timestamp": 1702708503, "time_this_iter_s": 9.91012191772461, "time_total_s": 420.8541624546051, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4612f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 420.8541624546051, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.423076923076923, "ram_util_percent": 24.4, "gpu_util_percent0": 0.01769230769230769, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.657108952530063, "episode_reward_min": -19.89406134335002, "episode_reward_mean": -18.042999820262608, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.657108952530063, -18.277920070039006, -18.076057790067324, -18.183175512133076, -18.984284118306753, -18.678052524942196, -18.09671401230326, -18.407017159341265, -19.199464842409974, -16.73341009871712, -17.557638106000596, -17.97191278142084, -18.333558965552914, -17.77122165563456, -17.98867679767502, -18.405251852745188, -17.90232499314903, -17.89917708714498, -17.6305374577245, -17.593878887508993, -18.676242827392247, -17.26772227422282, -17.937219085956006, -17.59612259404994, -17.394970973023327, -17.904809067040382, -16.964394698358873, -18.216886724485008, -18.469338884093645, -18.086880954587546, -19.068356613669238, -18.318240769441466, -18.37003786850536, -17.79428873086389, -17.25947725177263, -19.526907953164745, -18.884627038934962, -18.079897988253144, -18.19635483416515, -17.26524614659676, -17.691955058585734, -19.50878350864125, -17.79189691443869, -17.562687144831415, -18.292258682469154, -18.598142257356866, -17.676707034364547, -18.618684770563124, -19.177411111737293, -17.58508037453611, -18.4681430777805, -18.30030959247849, -17.871962694459366, -18.299048250464466, -18.703090073861176, -17.021485009692892, -17.39350400171192, -17.68858828694966, -18.993983035270247, -17.821482237117124, -17.599165128637615, -17.31415771666993, -18.008650918112274, -18.570411408777026, -17.418881061807078, -17.57329890940874, -18.046459536692936, -17.836508672975185, -18.61174998822993, -18.38923177641041, -18.046552788573123, -18.528511619002042, -19.89406134335002, -17.73344352208106, -18.443736182538196, -17.31498689830008, -17.746665689458865, -18.34510061459671, -17.460714069853665, -17.087195612052923, -18.42938146978121, -19.328569011205143, -18.84192128671489, -17.95257962037984, -17.067967680367843, -17.376067232525177, -18.16210639892624, -18.107407018230866, -17.19310205425285, -17.528563232858787, -18.204761325197843, -18.714044084412617, -16.840684907571863, -17.582246936439788, -18.18033874848127, -18.30147886769146, -17.714292218953673, -17.929233694610254, -18.42433838299481, -17.760804335902797], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37808086132122304, "mean_inference_ms": 1.205296771956788, "mean_action_processing_ms": 0.08890041277234322, "mean_env_wait_ms": 0.5634870521212746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"sample_time_ms": 9907.189, "sample_throughput": 2018.736, "load_time_ms": 0.261, "load_throughput": 76720395.098, "learn_time_ms": 1000.612, "learn_throughput": 19987.759, "update_time_ms": 9.425}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005, "total_loss": 0.30530884861946106, "policy_loss": -3.7742613844260475e-06, "vf_loss": 0.31879881024360657, "vf_explained_var": 0.1545735001564026, "kl": 6.28404255789139e-05, "entropy": 1.3486196994781494, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 860000, "num_steps_trained": 860000, "num_agent_steps_trained": 860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1790, "training_iteration": 43, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-35-12", "timestamp": 1702708512, "time_this_iter_s": 9.825071811676025, "time_total_s": 430.6792342662811, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04dce47dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 430.6792342662811, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.707692307692305, "ram_util_percent": 24.46153846153846, "gpu_util_percent0": 0.021538461538461538, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.7789290599797, "episode_reward_min": -20.35765983740069, "episode_reward_mean": -18.109753289899594, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.691955058585734, -19.50878350864125, -17.79189691443869, -17.562687144831415, -18.292258682469154, -18.598142257356866, -17.676707034364547, -18.618684770563124, -19.177411111737293, -17.58508037453611, -18.4681430777805, -18.30030959247849, -17.871962694459366, -18.299048250464466, -18.703090073861176, -17.021485009692892, -17.39350400171192, -17.68858828694966, -18.993983035270247, -17.821482237117124, -17.599165128637615, -17.31415771666993, -18.008650918112274, -18.570411408777026, -17.418881061807078, -17.57329890940874, -18.046459536692936, -17.836508672975185, -18.61174998822993, -18.38923177641041, -18.046552788573123, -18.528511619002042, -19.89406134335002, -17.73344352208106, -18.443736182538196, -17.31498689830008, -17.746665689458865, -18.34510061459671, -17.460714069853665, -17.087195612052923, -18.42938146978121, -19.328569011205143, -18.84192128671489, -17.95257962037984, -17.067967680367843, -17.376067232525177, -18.16210639892624, -18.107407018230866, -17.19310205425285, -17.528563232858787, -18.204761325197843, -18.714044084412617, -16.840684907571863, -17.582246936439788, -18.18033874848127, -18.30147886769146, -17.714292218953673, -17.929233694610254, -18.42433838299481, -17.760804335902797, -18.10535319303596, -18.478709344092877, -17.18578840331969, -18.39630122040269, -19.685284028479643, -16.7789290599797, -18.340937338102506, -17.954706625500556, -17.259308924443246, -17.123859791747925, -17.675275463958126, -17.685371490596125, -18.395877372534187, -18.529227630989183, -18.371586636163606, -18.493835528823755, -17.318832451157085, -18.90749272307595, -17.544542711776675, -17.886863519074645, -18.05963256819421, -17.79000993468909, -17.936102329937157, -18.813511839467218, -17.884984940450213, -17.957547133763974, -18.329202286534205, -18.008653616720864, -19.26406502228058, -18.917047920574383, -18.54646545304394, -18.09220330171189, -20.35765983740069, -18.07231109588361, -17.523875863511925, -18.432448403689058, -19.617573410263013, -19.23097739911148, -17.54029855604463, -17.80809953709627], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778456372006772, "mean_inference_ms": 1.204572112660189, "mean_action_processing_ms": 0.08885621075868037, "mean_env_wait_ms": 0.5631112759109268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 9866.788, "sample_throughput": 2027.002, "load_time_ms": 0.248, "load_throughput": 80636431.799, "learn_time_ms": 997.166, "learn_throughput": 20056.839, "update_time_ms": 9.395}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005, "total_loss": 0.32541486620903015, "policy_loss": 5.281829619452338e-06, "vf_loss": 0.3389923721551895, "vf_explained_var": 0.15960201621055603, "kl": 5.010521103576693e-05, "entropy": 1.3582779169082642, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 880000, "num_steps_trained": 880000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1830, "training_iteration": 44, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-35-22", "timestamp": 1702708522, "time_this_iter_s": 9.815218925476074, "time_total_s": 440.4944531917572, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4379310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 440.4944531917572, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 24.525000000000002, "gpu_util_percent0": 0.020833333333333332, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.519464141522505, "episode_reward_min": -20.35765983740069, "episode_reward_mean": -18.056644206792225, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.376067232525177, -18.16210639892624, -18.107407018230866, -17.19310205425285, -17.528563232858787, -18.204761325197843, -18.714044084412617, -16.840684907571863, -17.582246936439788, -18.18033874848127, -18.30147886769146, -17.714292218953673, -17.929233694610254, -18.42433838299481, -17.760804335902797, -18.10535319303596, -18.478709344092877, -17.18578840331969, -18.39630122040269, -19.685284028479643, -16.7789290599797, -18.340937338102506, -17.954706625500556, -17.259308924443246, -17.123859791747925, -17.675275463958126, -17.685371490596125, -18.395877372534187, -18.529227630989183, -18.371586636163606, -18.493835528823755, -17.318832451157085, -18.90749272307595, -17.544542711776675, -17.886863519074645, -18.05963256819421, -17.79000993468909, -17.936102329937157, -18.813511839467218, -17.884984940450213, -17.957547133763974, -18.329202286534205, -18.008653616720864, -19.26406502228058, -18.917047920574383, -18.54646545304394, -18.09220330171189, -20.35765983740069, -18.07231109588361, -17.523875863511925, -18.432448403689058, -19.617573410263013, -19.23097739911148, -17.54029855604463, -17.80809953709627, -17.637289356757044, -18.51051660851773, -19.065415778114584, -16.519464141522505, -17.65976559075167, -17.736871374190137, -18.112166276733582, -17.16574525405118, -17.467340265931412, -16.92916012506725, -17.74675909939691, -18.876151239289378, -18.04732499996588, -18.096580094349978, -17.64397308225716, -17.827114226726707, -18.182997596677353, -17.348845167201006, -18.1238706336704, -17.322297360610406, -17.856707535991095, -18.807177338654206, -17.559315800272532, -18.054005144459424, -17.0832037545671, -19.03720735383004, -18.125164698455052, -17.86134157990378, -17.714345280481425, -18.18502617904995, -18.602892862057303, -17.79673336960488, -18.136619551597818, -18.786043659005358, -19.537819444328406, -16.80799520202268, -17.982641048995276, -17.09769702406298, -19.048410610137587, -19.583502412679586, -17.510762915611235, -17.74695318731718, -17.69220558304313, -18.643155540845925, -18.067621983793334], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37769709696535286, "mean_inference_ms": 1.2043653390377669, "mean_action_processing_ms": 0.08883741993444744, "mean_env_wait_ms": 0.5629020627589832, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 9869.798, "sample_throughput": 2026.384, "load_time_ms": 0.246, "load_throughput": 81379588.669, "learn_time_ms": 996.183, "learn_throughput": 20076.641, "update_time_ms": 11.906}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005, "total_loss": 0.4483072906732559, "policy_loss": -1.4541626368047567e-05, "vf_loss": 0.46195948123931885, "vf_explained_var": 0.1458663046360016, "kl": 3.987060823684718e-05, "entropy": 1.363764762878418, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1875, "training_iteration": 45, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-35-32", "timestamp": 1702708532, "time_this_iter_s": 9.919507265090942, "time_total_s": 450.41396045684814, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d44c9e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 450.41396045684814, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.007142857142856, "ram_util_percent": 24.59285714285715, "gpu_util_percent0": 0.009285714285714286, "vram_util_percent0": 0.017252604166666664}}
{"episode_reward_max": -16.519464141522505, "episode_reward_min": -20.35765983740069, "episode_reward_mean": -18.091172871810066, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.957547133763974, -18.329202286534205, -18.008653616720864, -19.26406502228058, -18.917047920574383, -18.54646545304394, -18.09220330171189, -20.35765983740069, -18.07231109588361, -17.523875863511925, -18.432448403689058, -19.617573410263013, -19.23097739911148, -17.54029855604463, -17.80809953709627, -17.637289356757044, -18.51051660851773, -19.065415778114584, -16.519464141522505, -17.65976559075167, -17.736871374190137, -18.112166276733582, -17.16574525405118, -17.467340265931412, -16.92916012506725, -17.74675909939691, -18.876151239289378, -18.04732499996588, -18.096580094349978, -17.64397308225716, -17.827114226726707, -18.182997596677353, -17.348845167201006, -18.1238706336704, -17.322297360610406, -17.856707535991095, -18.807177338654206, -17.559315800272532, -18.054005144459424, -17.0832037545671, -19.03720735383004, -18.125164698455052, -17.86134157990378, -17.714345280481425, -18.18502617904995, -18.602892862057303, -17.79673336960488, -18.136619551597818, -18.786043659005358, -19.537819444328406, -16.80799520202268, -17.982641048995276, -17.09769702406298, -19.048410610137587, -19.583502412679586, -17.510762915611235, -17.74695318731718, -17.69220558304313, -18.643155540845925, -18.067621983793334, -17.83804540600749, -17.307543408664284, -17.852002260515714, -17.016786726480387, -17.1018571516029, -19.04370614942561, -18.50173247563466, -17.76275000572521, -18.49985725713065, -17.91421326274981, -16.616490690268492, -18.790581374052167, -18.0167685813315, -18.012584340074064, -17.907068181969887, -17.825745741479505, -17.229438535221355, -18.45753169746684, -18.674936293637845, -18.998059101990414, -18.62362527335904, -16.833094951598586, -17.243631467840167, -16.960852276932467, -17.802067405680507, -19.323196979568174, -18.98224011362425, -17.59011682127804, -18.240647614205006, -17.974592725988835, -19.130842341462973, -18.18637866110442, -18.572592490775808, -18.53383825963635, -18.228991807064542, -18.490092051041888, -18.471186196388235, -17.520454471041933, -18.61078283933358, -17.387737621473295], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37762922258405607, "mean_inference_ms": 1.2043310234245548, "mean_action_processing_ms": 0.0888327078560735, "mean_env_wait_ms": 0.5628114731208149, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"sample_time_ms": 9904.663, "sample_throughput": 2019.251, "load_time_ms": 0.258, "load_throughput": 77521559.93, "learn_time_ms": 1003.455, "learn_throughput": 19931.128, "update_time_ms": 11.914}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005, "total_loss": 0.2890033423900604, "policy_loss": -6.577530229678885e-05, "vf_loss": 0.3027604967355728, "vf_explained_var": 0.1960301697254181, "kl": 2.509909707271163e-05, "entropy": 1.3691408038139343, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 920000, "num_steps_trained": 920000, "num_agent_steps_trained": 920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1915, "training_iteration": 46, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-35-43", "timestamp": 1702708543, "time_this_iter_s": 10.21096420288086, "time_total_s": 460.624924659729, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4612550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 460.624924659729, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 34.05384615384616, "ram_util_percent": 24.47692307692308, "gpu_util_percent0": 0.09076923076923078, "vram_util_percent0": 0.01745292467948718}}
{"episode_reward_max": -16.616490690268492, "episode_reward_min": -20.08185119200821, "episode_reward_mean": -18.07743950019881, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.03720735383004, -18.125164698455052, -17.86134157990378, -17.714345280481425, -18.18502617904995, -18.602892862057303, -17.79673336960488, -18.136619551597818, -18.786043659005358, -19.537819444328406, -16.80799520202268, -17.982641048995276, -17.09769702406298, -19.048410610137587, -19.583502412679586, -17.510762915611235, -17.74695318731718, -17.69220558304313, -18.643155540845925, -18.067621983793334, -17.83804540600749, -17.307543408664284, -17.852002260515714, -17.016786726480387, -17.1018571516029, -19.04370614942561, -18.50173247563466, -17.76275000572521, -18.49985725713065, -17.91421326274981, -16.616490690268492, -18.790581374052167, -18.0167685813315, -18.012584340074064, -17.907068181969887, -17.825745741479505, -17.229438535221355, -18.45753169746684, -18.674936293637845, -18.998059101990414, -18.62362527335904, -16.833094951598586, -17.243631467840167, -16.960852276932467, -17.802067405680507, -19.323196979568174, -18.98224011362425, -17.59011682127804, -18.240647614205006, -17.974592725988835, -19.130842341462973, -18.18637866110442, -18.572592490775808, -18.53383825963635, -18.228991807064542, -18.490092051041888, -18.471186196388235, -17.520454471041933, -18.61078283933358, -17.387737621473295, -17.672684656695534, -17.26086641511305, -17.324992806890734, -18.831951457622623, -20.08185119200821, -18.440932487986366, -18.095116675085144, -18.269306955497797, -17.81734470735492, -16.713401377892314, -17.585238793488138, -18.192132633281254, -17.78439014197493, -17.655957163057707, -17.520737209894417, -17.61958169458327, -17.87097774672361, -18.714378090870078, -17.109779090680995, -18.08797100484576, -17.74528855246266, -17.72677214400448, -18.87530421060119, -18.028256286999902, -18.16506924693067, -18.276225666985752, -17.098047550119915, -17.78981132608894, -17.459513957199047, -17.63655790106739, -19.787820042517957, -17.759477531481565, -17.672186387655444, -18.548873498917384, -18.713084974073613, -18.078386934816248, -18.969663584152634, -17.83253643913762, -18.65713843013564, -18.235542555336682], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37784384793563186, "mean_inference_ms": 1.2052469713944913, "mean_action_processing_ms": 0.0888881071974342, "mean_env_wait_ms": 0.5631500140340084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"sample_time_ms": 10015.812, "sample_throughput": 1996.843, "load_time_ms": 0.255, "load_throughput": 78515612.13, "learn_time_ms": 1003.292, "learn_throughput": 19934.384, "update_time_ms": 11.897}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005, "total_loss": 0.3048548698425293, "policy_loss": -3.072433383222162e-05, "vf_loss": 0.3186657577753067, "vf_explained_var": 0.20329365134239197, "kl": 2.6146329371368182e-05, "entropy": 1.3780164122581482, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 940000, "num_steps_trained": 940000, "num_agent_steps_trained": 940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1955, "training_iteration": 47, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-35-53", "timestamp": 1702708553, "time_this_iter_s": 10.82670783996582, "time_total_s": 471.4516324996948, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4612b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 471.4516324996948, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 37.04285714285714, "ram_util_percent": 24.692857142857143, "gpu_util_percent0": 0.07428571428571427, "vram_util_percent0": 0.018037341889880952}}
{"episode_reward_max": -16.713401377892314, "episode_reward_min": -20.613074987432654, "episode_reward_mean": -18.088532056727775, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.323196979568174, -18.98224011362425, -17.59011682127804, -18.240647614205006, -17.974592725988835, -19.130842341462973, -18.18637866110442, -18.572592490775808, -18.53383825963635, -18.228991807064542, -18.490092051041888, -18.471186196388235, -17.520454471041933, -18.61078283933358, -17.387737621473295, -17.672684656695534, -17.26086641511305, -17.324992806890734, -18.831951457622623, -20.08185119200821, -18.440932487986366, -18.095116675085144, -18.269306955497797, -17.81734470735492, -16.713401377892314, -17.585238793488138, -18.192132633281254, -17.78439014197493, -17.655957163057707, -17.520737209894417, -17.61958169458327, -17.87097774672361, -18.714378090870078, -17.109779090680995, -18.08797100484576, -17.74528855246266, -17.72677214400448, -18.87530421060119, -18.028256286999902, -18.16506924693067, -18.276225666985752, -17.098047550119915, -17.78981132608894, -17.459513957199047, -17.63655790106739, -19.787820042517957, -17.759477531481565, -17.672186387655444, -18.548873498917384, -18.713084974073613, -18.078386934816248, -18.969663584152634, -17.83253643913762, -18.65713843013564, -18.235542555336682, -18.778253307285585, -17.101754353613664, -16.93931586674566, -16.861150640224807, -16.850114595674775, -18.292692673606705, -17.934082514519126, -19.42717170556671, -17.1762190093787, -18.728011477984204, -17.741698781085148, -17.596683315673054, -17.40411566733417, -18.45063462205985, -17.762833354534692, -20.613074987432654, -17.903473309592652, -17.92638143341167, -19.304100585245397, -18.307336139623956, -18.2528572270095, -18.514064676051706, -18.0607357146548, -18.577262250085838, -19.433276172729393, -17.601651068925737, -17.27715574184574, -17.843515354929806, -18.246979492836722, -19.260953411812075, -17.38270724516769, -18.596588134389663, -18.008960481802376, -17.02519114904863, -17.878567620371825, -17.98030306680787, -17.904003502699865, -17.927142780643273, -17.419329663369574, -17.441409538473216, -18.140350097729275, -18.31894478015461, -17.600801863679344, -17.010058850080103, -19.102456930666364], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783106167636214, "mean_inference_ms": 1.2070934955662687, "mean_action_processing_ms": 0.08897715287637023, "mean_env_wait_ms": 0.5638063489123308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 10069.055, "sample_throughput": 1986.284, "load_time_ms": 0.255, "load_throughput": 78412862.217, "learn_time_ms": 1008.95, "learn_throughput": 19822.586, "update_time_ms": 11.804}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005, "total_loss": 0.42243337631225586, "policy_loss": 3.235854925609516e-05, "vf_loss": 0.4362916201353073, "vf_explained_var": 0.18079644441604614, "kl": 2.343628248580032e-05, "entropy": 1.3890615701675415, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2000, "training_iteration": 48, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-36-04", "timestamp": 1702708564, "time_this_iter_s": 10.37012243270874, "time_total_s": 481.82175493240356, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d47d3160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 481.82175493240356, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 33.528571428571425, "ram_util_percent": 24.65714285714285, "gpu_util_percent0": 0.04214285714285714, "vram_util_percent0": 0.01722353980654762}}
{"episode_reward_max": -16.515897921433403, "episode_reward_min": -20.958088475115453, "episode_reward_mean": -18.097011573793854, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.276225666985752, -17.098047550119915, -17.78981132608894, -17.459513957199047, -17.63655790106739, -19.787820042517957, -17.759477531481565, -17.672186387655444, -18.548873498917384, -18.713084974073613, -18.078386934816248, -18.969663584152634, -17.83253643913762, -18.65713843013564, -18.235542555336682, -18.778253307285585, -17.101754353613664, -16.93931586674566, -16.861150640224807, -16.850114595674775, -18.292692673606705, -17.934082514519126, -19.42717170556671, -17.1762190093787, -18.728011477984204, -17.741698781085148, -17.596683315673054, -17.40411566733417, -18.45063462205985, -17.762833354534692, -20.613074987432654, -17.903473309592652, -17.92638143341167, -19.304100585245397, -18.307336139623956, -18.2528572270095, -18.514064676051706, -18.0607357146548, -18.577262250085838, -19.433276172729393, -17.601651068925737, -17.27715574184574, -17.843515354929806, -18.246979492836722, -19.260953411812075, -17.38270724516769, -18.596588134389663, -18.008960481802376, -17.02519114904863, -17.878567620371825, -17.98030306680787, -17.904003502699865, -17.927142780643273, -17.419329663369574, -17.441409538473216, -18.140350097729275, -18.31894478015461, -17.600801863679344, -17.010058850080103, -19.102456930666364, -18.582018819315497, -17.927173012500717, -18.73176725106909, -18.549428290119373, -18.11494912849684, -16.515897921433403, -17.786209621101108, -17.81521996085552, -18.74701140222951, -17.932316064689974, -17.468669546646055, -17.91538793687682, -18.21695409175326, -17.377097831726807, -17.47503119126507, -17.73337115777028, -18.788035435791805, -17.69327913417178, -18.888759687373096, -17.2368926393786, -18.587671788387553, -17.98349323276727, -17.82278769813368, -18.70538816379637, -17.239942104472334, -17.260876594257496, -20.958088475115453, -18.015186541843082, -17.685584185033612, -18.849947509432482, -18.63289022540073, -18.699871660477513, -17.724338037935183, -18.127751813859245, -18.294251409637884, -19.242332203991623, -18.781021568608125, -17.928260530523083, -17.196211601623908, -18.05055997328017], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37893667558752114, "mean_inference_ms": 1.209231460042478, "mean_action_processing_ms": 0.08911392244180145, "mean_env_wait_ms": 0.5646631076072749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"sample_time_ms": 10216.413, "sample_throughput": 1957.634, "load_time_ms": 0.247, "load_throughput": 81041522.558, "learn_time_ms": 1009.773, "learn_throughput": 19806.429, "update_time_ms": 14.318}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005, "total_loss": 0.2775271236896515, "policy_loss": -3.0445861889383252e-05, "vf_loss": 0.2915460616350174, "vf_explained_var": 0.2349739372730255, "kl": 3.2555566709890904e-05, "entropy": 1.3988468647003174, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 980000, "num_steps_trained": 980000, "num_agent_steps_trained": 980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2040, "training_iteration": 49, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-36-15", "timestamp": 1702708575, "time_this_iter_s": 11.331175565719604, "time_total_s": 493.15293049812317, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d47d30d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 493.15293049812317, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 41.53333333333333, "ram_util_percent": 24.706666666666667, "gpu_util_percent0": 0.07666666666666667, "vram_util_percent0": 0.018391927083333332}}
{"episode_reward_max": -16.515897921433403, "episode_reward_min": -20.958088475115453, "episode_reward_mean": -18.178623927487674, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.601651068925737, -17.27715574184574, -17.843515354929806, -18.246979492836722, -19.260953411812075, -17.38270724516769, -18.596588134389663, -18.008960481802376, -17.02519114904863, -17.878567620371825, -17.98030306680787, -17.904003502699865, -17.927142780643273, -17.419329663369574, -17.441409538473216, -18.140350097729275, -18.31894478015461, -17.600801863679344, -17.010058850080103, -19.102456930666364, -18.582018819315497, -17.927173012500717, -18.73176725106909, -18.549428290119373, -18.11494912849684, -16.515897921433403, -17.786209621101108, -17.81521996085552, -18.74701140222951, -17.932316064689974, -17.468669546646055, -17.91538793687682, -18.21695409175326, -17.377097831726807, -17.47503119126507, -17.73337115777028, -18.788035435791805, -17.69327913417178, -18.888759687373096, -17.2368926393786, -18.587671788387553, -17.98349323276727, -17.82278769813368, -18.70538816379637, -17.239942104472334, -17.260876594257496, -20.958088475115453, -18.015186541843082, -17.685584185033612, -18.849947509432482, -18.63289022540073, -18.699871660477513, -17.724338037935183, -18.127751813859245, -18.294251409637884, -19.242332203991623, -18.781021568608125, -17.928260530523083, -17.196211601623908, -18.05055997328017, -17.837063647355933, -18.412364445686322, -18.683499915023656, -18.441290422044112, -18.335638886631987, -17.637921354075715, -17.658270184994798, -18.276834518889707, -17.15171251577231, -17.5307780823663, -17.38290445931242, -17.00724490878344, -18.021511158402717, -17.533940283711193, -17.233201445730582, -20.42915249816589, -18.809587734011302, -17.39269127689476, -18.35931278373336, -19.169031109280517, -18.952401490809606, -18.23672958461728, -18.12282633766394, -20.885474092232784, -18.881817432846454, -19.222894832304405, -18.262368392102367, -18.514490730544203, -18.804989486327255, -18.71873789748939, -18.984236407826046, -17.79326976374638, -17.91147026143763, -18.869677381465287, -18.26133423483192, -18.59191134524177, -20.03582202423437, -17.644751373107137, -19.03463819066073, -17.579603639836353], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37967218476363257, "mean_inference_ms": 1.2114054111327486, "mean_action_processing_ms": 0.08926857919808892, "mean_env_wait_ms": 0.5655951021428198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"sample_time_ms": 10315.745, "sample_throughput": 1938.784, "load_time_ms": 0.239, "load_throughput": 83785537.355, "learn_time_ms": 1009.459, "learn_throughput": 19812.588, "update_time_ms": 14.248}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005, "total_loss": 0.2804504632949829, "policy_loss": 2.8439330740148705e-05, "vf_loss": 0.29443947970867157, "vf_explained_var": 0.2431071400642395, "kl": 3.252012213739164e-05, "entropy": 1.401742160320282, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 1000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 1000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -17.487568664350743, "episode_reward_min": -20.01200046073349, "episode_reward_mean": -18.365688887803284, "episode_len_mean": 96.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.01200046073349, -19.938382392895797, -17.919326738033753, -17.548624367989504, -17.641521640165166, -17.761317260971275, -17.487568664350743, -19.748862591476627, -17.680188346085245, -17.919096415331275], "episode_lengths": [96, 96, 96, 96, 96, 96, 96, 96, 96, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3309889961107712, "mean_inference_ms": 1.2513422693099734, "mean_action_processing_ms": 0.08830815770747634, "mean_env_wait_ms": 0.577006950338723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 2080, "training_iteration": 50, "trial_id": "428fa_00000", "experiment_id": "be0eb14d8abd4b108107d14b2354bb6e", "date": "2023-12-16_12-36-28", "timestamp": 1702708588, "time_this_iter_s": 13.005528450012207, "time_total_s": 506.1584589481354, "pid": 36538, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 96, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f04d4379c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 506.1584589481354, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 37.94117647058823, "ram_util_percent": 25.041176470588233, "gpu_util_percent0": 0.044705882352941186, "vram_util_percent0": 0.018296185661764705}}
