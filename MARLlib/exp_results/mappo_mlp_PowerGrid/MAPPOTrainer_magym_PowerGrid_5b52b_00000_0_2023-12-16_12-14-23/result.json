{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 8486.298, "sample_throughput": 2356.74, "load_time_ms": 0.695, "load_throughput": 28797143.838, "learn_time_ms": 992.419, "learn_throughput": 20152.788, "update_time_ms": 7.5}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 108.96073913574219, "policy_loss": -0.00047669753502077583, "vf_loss": 108.9831314086914, "vf_explained_var": -1.6629695892333984e-05, "kl": 0.00030049553262516404, "entropy": 2.1968905925750732, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-14-33", "timestamp": 1702707273, "time_this_iter_s": 9.472126483917236, "time_total_s": 9.472126483917236, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc0b55e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.472126483917236, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.623076923076926, "ram_util_percent": 20.323076923076925, "gpu_util_percent0": 0.03692307692307692, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -776.2104047811908, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -789.0920844987597, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3320520628548502, "mean_inference_ms": 1.1983787469905587, "mean_action_processing_ms": 0.09005050373256096, "mean_env_wait_ms": 0.5623800169297265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 9323.027, "sample_throughput": 2145.226, "load_time_ms": 0.47, "load_throughput": 42581766.497, "learn_time_ms": 986.186, "learn_throughput": 20280.152, "update_time_ms": 7.543}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 85.1524543762207, "policy_loss": -0.0006369461206716664, "vf_loss": 85.17500305175781, "vf_explained_var": -0.0002967715263366699, "kl": 0.0003000902084178414, "entropy": 2.1933573484420776, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5, "training_iteration": 2, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-14-43", "timestamp": 1702707283, "time_this_iter_s": 10.119593143463135, "time_total_s": 19.59171962738037, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc196280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.59171962738037, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.82142857142858, "ram_util_percent": 21.614285714285717, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -694.4880173591667, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -760.5781770824165, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3314096217824875, "mean_inference_ms": 1.1945170304425698, "mean_action_processing_ms": 0.08953761331571317, "mean_env_wait_ms": 0.5604742271223319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 9428.18, "sample_throughput": 2121.3, "load_time_ms": 0.385, "load_throughput": 51888296.907, "learn_time_ms": 989.064, "learn_throughput": 20221.136, "update_time_ms": 7.8}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 67.5599365234375, "policy_loss": -0.0008328865234741301, "vf_loss": 67.58259201049805, "vf_explained_var": 0.0004012882709503174, "kl": 0.0004288292248136871, "entropy": 2.184171438217163, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 3, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-14-53", "timestamp": 1702707293, "time_this_iter_s": 9.630140781402588, "time_total_s": 29.22186040878296, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26feac7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29.22186040878296, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.430769230769222, "ram_util_percent": 21.992307692307694, "gpu_util_percent0": 0.01846153846153846, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -639.6486102155069, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -731.9324590976395, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33046695399782194, "mean_inference_ms": 1.1888422919769481, "mean_action_processing_ms": 0.08899566723023193, "mean_env_wait_ms": 0.5588974633408156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 9436.398, "sample_throughput": 2119.453, "load_time_ms": 0.35, "load_throughput": 57211307.758, "learn_time_ms": 993.94, "learn_throughput": 20121.947, "update_time_ms": 7.977}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 62.68548774719238, "policy_loss": -0.000529703909717405, "vf_loss": 62.70766639709473, "vf_explained_var": 0.00017219781875610352, "kl": 0.0005369363935519011, "entropy": 2.1660971641540527, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 4, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-15-02", "timestamp": 1702707302, "time_this_iter_s": 9.450840950012207, "time_total_s": 38.672701358795166, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25c17d21f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38.672701358795166, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.253846153846155, "ram_util_percent": 22.23076923076923, "gpu_util_percent0": 0.01153846153846154, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -602.0219918276034, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -703.5857973470477, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32993355802123336, "mean_inference_ms": 1.1846743245155626, "mean_action_processing_ms": 0.08862148522446239, "mean_env_wait_ms": 0.5576074190504618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 9457.557, "sample_throughput": 2114.711, "load_time_ms": 0.324, "load_throughput": 61762685.908, "learn_time_ms": 990.474, "learn_throughput": 20192.362, "update_time_ms": 8.072}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 50.254804611206055, "policy_loss": -0.0007134979531180363, "vf_loss": 50.27689170837402, "vf_explained_var": -0.0004673004150390625, "kl": 0.0006053087440248683, "entropy": 2.1378508806228638, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 5, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-15-12", "timestamp": 1702707312, "time_this_iter_s": 9.485510110855103, "time_total_s": 48.15821146965027, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc24f430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 48.15821146965027, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.200000000000003, "ram_util_percent": 22.661538461538463, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -554.8953131794527, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -676.1064573214992, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32928538005326935, "mean_inference_ms": 1.1814653015899517, "mean_action_processing_ms": 0.08837293929083949, "mean_env_wait_ms": 0.5563365878340827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 9456.631, "sample_throughput": 2114.918, "load_time_ms": 0.306, "load_throughput": 65348802.908, "learn_time_ms": 987.723, "learn_throughput": 20248.586, "update_time_ms": 7.984}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 47.938472747802734, "policy_loss": -0.0010168528012926004, "vf_loss": 47.96046447753906, "vf_explained_var": 0.0003490149974822998, "kl": 0.0007010530718382091, "entropy": 2.0980653762817383, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 6, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-15-21", "timestamp": 1702707321, "time_this_iter_s": 9.424871444702148, "time_total_s": 57.58308291435242, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25c17d2040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 57.58308291435242, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.84166666666667, "ram_util_percent": 22.741666666666664, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -554.8953131794527, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -676.1064573214992, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32928538005326935, "mean_inference_ms": 1.1814653015899517, "mean_action_processing_ms": 0.08837293929083949, "mean_env_wait_ms": 0.5563365878340827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 9478.098, "sample_throughput": 2110.128, "load_time_ms": 0.295, "load_throughput": 67837634.011, "learn_time_ms": 997.794, "learn_throughput": 20044.227, "update_time_ms": 8.006}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 36.53263473510742, "policy_loss": -0.0013610531160601624, "vf_loss": 36.55443572998047, "vf_explained_var": -0.00020557641983032227, "kl": 0.0008306968477280186, "entropy": 2.044062376022339, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 7, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-15-31", "timestamp": 1702707331, "time_this_iter_s": 9.66830039024353, "time_total_s": 67.25138330459595, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc22baf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 67.25138330459595, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.999999999999996, "ram_util_percent": 22.784615384615385, "gpu_util_percent0": 0.026153846153846156, "vram_util_percent0": 0.01659530248397436}}
{"episode_reward_max": -441.6308957981312, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -642.6941720171219, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3293134430122384, "mean_inference_ms": 1.1808377607302156, "mean_action_processing_ms": 0.08826307722736772, "mean_env_wait_ms": 0.5562094076113304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 9578.263, "sample_throughput": 2088.061, "load_time_ms": 0.286, "load_throughput": 69992557.363, "learn_time_ms": 997.886, "learn_throughput": 20042.379, "update_time_ms": 8.196}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 21.84433937072754, "policy_loss": -0.0014784389913096163, "vf_loss": 21.865554809570312, "vf_explained_var": -0.0005948543548583984, "kl": 0.0009177199932692837, "entropy": 1.973879337310791, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 8, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-15-41", "timestamp": 1702707341, "time_this_iter_s": 10.203175067901611, "time_total_s": 77.45455837249756, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc279820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.45455837249756, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.41428571428571, "ram_util_percent": 22.8, "gpu_util_percent0": 0.05642857142857143, "vram_util_percent0": 0.01746186755952381}}
{"episode_reward_max": -387.75721200526544, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -608.5056887081126, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32986176450960003, "mean_inference_ms": 1.1820432188042889, "mean_action_processing_ms": 0.08827655034456253, "mean_env_wait_ms": 0.5567653670721163, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 9674.084, "sample_throughput": 2067.379, "load_time_ms": 0.278, "load_throughput": 71847613.247, "learn_time_ms": 1001.081, "learn_throughput": 19978.411, "update_time_ms": 8.192}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 15.712410926818848, "policy_loss": -0.000986918240599266, "vf_loss": 15.732314586639404, "vf_explained_var": 0.0002925097942352295, "kl": 0.0008670293576757103, "entropy": 1.8917335271835327, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 9, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-15-51", "timestamp": 1702707351, "time_this_iter_s": 10.44191861152649, "time_total_s": 87.89647698402405, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25d0056e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 87.89647698402405, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.114285714285714, "ram_util_percent": 22.857142857142858, "gpu_util_percent0": 0.05714285714285715, "vram_util_percent0": 0.018037341889880952}}
{"episode_reward_max": -339.26851353468413, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -577.2137377844281, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33041535657076615, "mean_inference_ms": 1.1830225152398308, "mean_action_processing_ms": 0.08829608196786665, "mean_env_wait_ms": 0.5573667314797166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 9700.97, "sample_throughput": 2061.649, "load_time_ms": 0.291, "load_throughput": 68624083.77, "learn_time_ms": 1002.721, "learn_throughput": 19945.731, "update_time_ms": 8.221}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 12.144335746765137, "policy_loss": -0.0011413112951448312, "vf_loss": 12.163540840148926, "vf_explained_var": -5.072355270385742e-05, "kl": 0.0007275525120772897, "entropy": 1.8064410090446472, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 10, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-16-01", "timestamp": 1702707361, "time_this_iter_s": 9.911728858947754, "time_total_s": 97.8082058429718, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25d0056820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 97.8082058429718, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.97692307692308, "ram_util_percent": 22.9, "gpu_util_percent0": 0.03538461538461538, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -248.04339717177652, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -544.3993023825026, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3310715061554242, "mean_inference_ms": 1.1842694503612154, "mean_action_processing_ms": 0.08836862971526169, "mean_env_wait_ms": 0.5582236048097248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 9879.925, "sample_throughput": 2024.307, "load_time_ms": 0.243, "load_throughput": 82249318.561, "learn_time_ms": 1001.705, "learn_throughput": 19965.965, "update_time_ms": 8.376}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 6.592088222503662, "policy_loss": -0.0009596706307490876, "vf_loss": 6.610286474227905, "vf_explained_var": -0.00015783309936523438, "kl": 0.0006056388067773311, "entropy": 1.723896086215973, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 11, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-16-12", "timestamp": 1702707372, "time_this_iter_s": 10.214113473892212, "time_total_s": 108.02231931686401, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26feac7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 108.02231931686401, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.67857142857143, "ram_util_percent": 22.835714285714282, "gpu_util_percent0": 0.12642857142857142, "vram_util_percent0": 0.01672944568452381}}
{"episode_reward_max": -201.53940267159442, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -513.4109130028489, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3318585908645726, "mean_inference_ms": 1.1864357316622387, "mean_action_processing_ms": 0.0885051040338117, "mean_env_wait_ms": 0.5594048524149258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 9943.023, "sample_throughput": 2011.461, "load_time_ms": 0.241, "load_throughput": 83088431.062, "learn_time_ms": 1005.906, "learn_throughput": 19882.579, "update_time_ms": 8.459}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 4.2060253620147705, "policy_loss": -0.0006965486305752222, "vf_loss": 4.223185062408447, "vf_explained_var": 3.6388635635375977e-05, "kl": 0.0004888288262001605, "entropy": 1.6463128328323364, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 12, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-16-22", "timestamp": 1702707382, "time_this_iter_s": 10.804351329803467, "time_total_s": 118.82667064666748, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25d0056c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 118.82667064666748, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.478571428571435, "ram_util_percent": 23.021428571428572, "gpu_util_percent0": 0.1492857142857143, "vram_util_percent0": 0.018327985491071428}}
{"episode_reward_max": -201.53940267159442, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -513.4109130028489, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3318585908645726, "mean_inference_ms": 1.1864357316622387, "mean_action_processing_ms": 0.0885051040338117, "mean_env_wait_ms": 0.5594048524149258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 9955.885, "sample_throughput": 2008.862, "load_time_ms": 0.241, "load_throughput": 82842267.43, "learn_time_ms": 1006.416, "learn_throughput": 19872.503, "update_time_ms": 8.407}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 3.355343818664551, "policy_loss": -0.00043391400403436364, "vf_loss": 3.3715587854385376, "vf_explained_var": -8.672475814819336e-05, "kl": 0.00037265801106256546, "entropy": 1.5781229138374329, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 13, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-16-32", "timestamp": 1702707392, "time_this_iter_s": 9.716905117034912, "time_total_s": 128.5435757637024, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc2e5f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 128.5435757637024, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 32.5, "ram_util_percent": 23.246153846153845, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.01819786658653846}}
{"episode_reward_max": -183.20193557990342, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -485.15199907847017, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3325384777996121, "mean_inference_ms": 1.1884128587480183, "mean_action_processing_ms": 0.08861621669674348, "mean_env_wait_ms": 0.5603609067816123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 10032.735, "sample_throughput": 1993.474, "load_time_ms": 0.239, "load_throughput": 83726998.702, "learn_time_ms": 1003.837, "learn_throughput": 19923.551, "update_time_ms": 8.406}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 2.021968901157379, "policy_loss": -0.00022989081659119392, "vf_loss": 2.037395656108856, "vf_explained_var": 0.00027424097061157227, "kl": 0.0002695837758264208, "entropy": 1.5196849703788757, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 55, "training_iteration": 14, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-16-42", "timestamp": 1702707402, "time_this_iter_s": 10.191943407058716, "time_total_s": 138.7355191707611, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc0d2f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 138.7355191707611, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 35.55714285714286, "ram_util_percent": 23.342857142857145, "gpu_util_percent0": 0.07214285714285715, "vram_util_percent0": 0.017333984375}}
{"episode_reward_max": -175.32491453418515, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -460.54521569594783, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33311166482635607, "mean_inference_ms": 1.1900814715162435, "mean_action_processing_ms": 0.08870888739323177, "mean_env_wait_ms": 0.5611653748979556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 10072.219, "sample_throughput": 1985.66, "load_time_ms": 0.239, "load_throughput": 83793906.703, "learn_time_ms": 1008.103, "learn_throughput": 19839.244, "update_time_ms": 8.412}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 1.329949975013733, "policy_loss": -0.00015997009398560635, "vf_loss": 1.3448233008384705, "vf_explained_var": -0.00035494565963745117, "kl": 0.00020165128989368952, "entropy": 1.4713389873504639, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 15, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-16-52", "timestamp": 1702707412, "time_this_iter_s": 9.94752836227417, "time_total_s": 148.68304753303528, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc0d2700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 148.68304753303528, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.95384615384615, "ram_util_percent": 23.28461538461539, "gpu_util_percent0": 0.06076923076923077, "vram_util_percent0": 0.016845703125}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -438.58423582986984, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3337512731336585, "mean_inference_ms": 1.19176279312363, "mean_action_processing_ms": 0.08880419235982619, "mean_env_wait_ms": 0.5619415181001524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 10167.357, "sample_throughput": 1967.079, "load_time_ms": 0.257, "load_throughput": 77953796.116, "learn_time_ms": 1011.883, "learn_throughput": 19765.13, "update_time_ms": 8.449}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 1.2603349089622498, "policy_loss": -2.909011778839954e-05, "vf_loss": 1.2746883630752563, "vf_explained_var": -0.0004947781562805176, "kl": 0.00011866882656219602, "entropy": 1.432431936264038, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 65, "training_iteration": 16, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-17-03", "timestamp": 1702707423, "time_this_iter_s": 10.373871803283691, "time_total_s": 159.05691933631897, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25c17e1550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 159.05691933631897, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 36.699999999999996, "ram_util_percent": 23.12857142857143, "gpu_util_percent0": 0.11357142857142859, "vram_util_percent0": 0.0169677734375}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -419.9485300916049, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33433824264541984, "mean_inference_ms": 1.1932016987958027, "mean_action_processing_ms": 0.08888752070207559, "mean_env_wait_ms": 0.5625879065724436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 10205.503, "sample_throughput": 1959.727, "load_time_ms": 0.256, "load_throughput": 78186298.816, "learn_time_ms": 1004.847, "learn_throughput": 19903.536, "update_time_ms": 8.516}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 1.2280254364013672, "policy_loss": 2.7550887939042923e-05, "vf_loss": 1.2420406937599182, "vf_explained_var": 0.00013208389282226562, "kl": 4.275919831140968e-05, "entropy": 1.404283344745636, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 17, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-17-13", "timestamp": 1702707433, "time_this_iter_s": 9.941365003585815, "time_total_s": 168.99828433990479, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc2e5670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 168.99828433990479, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 31.853846153846156, "ram_util_percent": 23.176923076923078, "gpu_util_percent0": 0.024615384615384615, "vram_util_percent0": 0.0167079827724359}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -403.70828519885634, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3347959988050375, "mean_inference_ms": 1.1942404420987054, "mean_action_processing_ms": 0.08894163431299096, "mean_env_wait_ms": 0.5630778571179365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 10134.653, "sample_throughput": 1973.427, "load_time_ms": 0.259, "load_throughput": 77228944.946, "learn_time_ms": 1001.698, "learn_throughput": 19966.092, "update_time_ms": 8.342}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 1.0976706147193909, "policy_loss": -2.2983552394606477e-07, "vf_loss": 1.1115559935569763, "vf_explained_var": -0.00031763315200805664, "kl": 2.5386841131513904e-05, "entropy": 1.3885177373886108, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 18, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-17-22", "timestamp": 1702707442, "time_this_iter_s": 9.52480435371399, "time_total_s": 178.52308869361877, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc24faf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 178.52308869361877, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.98461538461538, "ram_util_percent": 23.515384615384615, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -403.70828519885634, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3347959988050375, "mean_inference_ms": 1.1942404420987054, "mean_action_processing_ms": 0.08894163431299096, "mean_env_wait_ms": 0.5630778571179365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 10044.957, "sample_throughput": 1991.049, "load_time_ms": 0.259, "load_throughput": 77243167.587, "learn_time_ms": 995.67, "learn_throughput": 20086.982, "update_time_ms": 9.024}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 1.0970461964607239, "policy_loss": -5.902099441712494e-05, "vf_loss": 1.1109516620635986, "vf_explained_var": -0.0004334449768066406, "kl": 6.954266924452668e-05, "entropy": 1.3846458196640015, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 19, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-17-32", "timestamp": 1702707452, "time_this_iter_s": 9.529151916503906, "time_total_s": 188.05224061012268, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f27057760d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 188.05224061012268, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.83846153846154, "ram_util_percent": 23.215384615384615, "gpu_util_percent0": 0.012307692307692308, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -389.3411102308804, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.335092697596136, "mean_inference_ms": 1.194839479004386, "mean_action_processing_ms": 0.0889635716521006, "mean_env_wait_ms": 0.5633945782171412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 10008.241, "sample_throughput": 1998.353, "load_time_ms": 0.24, "load_throughput": 83253354.506, "learn_time_ms": 991.364, "learn_throughput": 20174.223, "update_time_ms": 8.977}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 0.9235414266586304, "policy_loss": 3.410034280967866e-05, "vf_loss": 0.9373854994773865, "vf_explained_var": 0.00013622641563415527, "kl": 7.868257342891205e-05, "entropy": 1.3878186345100403, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 20, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-17-41", "timestamp": 1702707461, "time_this_iter_s": 9.539859771728516, "time_total_s": 197.5921003818512, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25c17e1c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 197.5921003818512, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.883333333333336, "ram_util_percent": 23.308333333333337, "gpu_util_percent0": 0.009166666666666667, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -376.8323510219789, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33533006617375105, "mean_inference_ms": 1.1952206435272037, "mean_action_processing_ms": 0.08897082647229539, "mean_env_wait_ms": 0.5636184687513227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 9934.086, "sample_throughput": 2013.27, "load_time_ms": 0.241, "load_throughput": 82858632.951, "learn_time_ms": 990.228, "learn_throughput": 20197.368, "update_time_ms": 8.867}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 0.8317780196666718, "policy_loss": -7.026634243079144e-05, "vf_loss": 0.8457687497138977, "vf_explained_var": -0.0004742145538330078, "kl": 7.171898615521144e-05, "entropy": 1.3920543193817139, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 85, "training_iteration": 21, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-17-51", "timestamp": 1702707471, "time_this_iter_s": 9.506141662597656, "time_total_s": 207.09824204444885, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f27057d49d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 207.09824204444885, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.88461538461539, "ram_util_percent": 23.338461538461537, "gpu_util_percent0": 0.012307692307692308, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -365.5238933851788, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33550095647989375, "mean_inference_ms": 1.1954185414557168, "mean_action_processing_ms": 0.08896658998643668, "mean_env_wait_ms": 0.5637696617382736, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 9802.19, "sample_throughput": 2040.36, "load_time_ms": 0.242, "load_throughput": 82687116.806, "learn_time_ms": 985.756, "learn_throughput": 20288.988, "update_time_ms": 9.266}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 0.8681671321392059, "policy_loss": -1.722030706297062e-05, "vf_loss": 0.8821684420108795, "vf_explained_var": -0.00020515918731689453, "kl": 5.993945583127047e-05, "entropy": 1.3984065651893616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 90, "training_iteration": 22, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-00", "timestamp": 1702707480, "time_this_iter_s": 9.4607412815094, "time_total_s": 216.55898332595825, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc283550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 216.55898332595825, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.592307692307692, "ram_util_percent": 23.623076923076926, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -169.9924826328381, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -355.49562438320777, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33563620511984216, "mean_inference_ms": 1.195511249519937, "mean_action_processing_ms": 0.08895302039732081, "mean_env_wait_ms": 0.563844929713034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 9780.627, "sample_throughput": 2044.859, "load_time_ms": 0.242, "load_throughput": 82752372.497, "learn_time_ms": 984.819, "learn_throughput": 20308.299, "update_time_ms": 9.281}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005, "total_loss": 0.8237884342670441, "policy_loss": 3.6201476913966246e-06, "vf_loss": 0.8378511369228363, "vf_explained_var": -3.057718276977539e-05, "kl": 3.135186695113479e-05, "entropy": 1.4066296815872192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 95, "training_iteration": 23, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-10", "timestamp": 1702707490, "time_this_iter_s": 9.532350063323975, "time_total_s": 226.09133338928223, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f27057760d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 226.09133338928223, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.958333333333332, "ram_util_percent": 23.70833333333333, "gpu_util_percent0": 0.012500000000000002, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -168.04048255579818, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -346.341410514964, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357269718764628, "mean_inference_ms": 1.1955008402580125, "mean_action_processing_ms": 0.08893604272845755, "mean_env_wait_ms": 0.5638903010236287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 9712.536, "sample_throughput": 2059.195, "load_time_ms": 0.244, "load_throughput": 81944007.033, "learn_time_ms": 983.916, "learn_throughput": 20326.931, "update_time_ms": 9.328}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 0.7199171185493469, "policy_loss": -7.582683564422155e-05, "vf_loss": 0.7341639995574951, "vf_explained_var": -9.882450103759766e-05, "kl": 2.7970402267207817e-05, "entropy": 1.4171016812324524, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 24, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-19", "timestamp": 1702707499, "time_this_iter_s": 9.513190507888794, "time_total_s": 235.60452389717102, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f27057d49d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 235.60452389717102, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.930769230769222, "ram_util_percent": 23.823076923076925, "gpu_util_percent0": 0.01769230769230769, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -168.04048255579818, "episode_reward_min": -799.9309662198092, "episode_reward_mean": -346.341410514964, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.4276380634492, -799.9309662198092, -797.4023668595621, -776.2104047811908, -779.4890465697874, -749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357269718764628, "mean_inference_ms": 1.1955008402580125, "mean_action_processing_ms": 0.08893604272845755, "mean_env_wait_ms": 0.5638903010236287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 9674.889, "sample_throughput": 2067.207, "load_time_ms": 0.257, "load_throughput": 77859736.402, "learn_time_ms": 979.148, "learn_throughput": 20425.916, "update_time_ms": 9.337}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005, "total_loss": 0.7334988415241241, "policy_loss": -0.0001198078183222151, "vf_loss": 0.7479349672794342, "vf_explained_var": -0.00027549266815185547, "kl": 3.460696482249226e-05, "entropy": 1.4316330552101135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 25, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-29", "timestamp": 1702707509, "time_this_iter_s": 9.531578302383423, "time_total_s": 245.13610219955444, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26feac7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 245.13610219955444, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.892307692307693, "ram_util_percent": 23.73076923076923, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -168.04048255579818, "episode_reward_min": -749.2335179334315, "episode_reward_mean": -315.54183464881544, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749.2335179334315, -737.0920123868765, -694.4880173591667, -738.8772614825548, -740.6305391683363, -669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359380295295381, "mean_inference_ms": 1.1951735212565326, "mean_action_processing_ms": 0.0888481108424387, "mean_env_wait_ms": 0.5639569307198363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 9579.188, "sample_throughput": 2087.86, "load_time_ms": 0.24, "load_throughput": 83427230.234, "learn_time_ms": 975.107, "learn_throughput": 20510.577, "update_time_ms": 9.373}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 0.6663773357868195, "policy_loss": -4.3143843171833396e-05, "vf_loss": 0.6809081137180328, "vf_explained_var": 0.00012597441673278809, "kl": 4.683259053894773e-05, "entropy": 1.4487636089324951, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 105, "training_iteration": 26, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-38", "timestamp": 1702707518, "time_this_iter_s": 9.4200439453125, "time_total_s": 254.55614614486694, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc196310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 254.55614614486694, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.758333333333336, "ram_util_percent": 23.65833333333333, "gpu_util_percent0": 0.0016666666666666668, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -168.04048255579818, "episode_reward_min": -698.8230288438879, "episode_reward_mean": -287.6573061382336, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.8479771645787, -698.8230288438879, -666.6709548749758, -698.2145445414785, -639.6486102155069, -619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3361893014234824, "mean_inference_ms": 1.1951929288239924, "mean_action_processing_ms": 0.0888031756421849, "mean_env_wait_ms": 0.5641713861658968, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 9536.433, "sample_throughput": 2097.22, "load_time_ms": 0.291, "load_throughput": 68669024.231, "learn_time_ms": 974.937, "learn_throughput": 20514.15, "update_time_ms": 9.259}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 0.6735618412494659, "policy_loss": -3.205394794392191e-05, "vf_loss": 0.6882757842540741, "vf_explained_var": -0.00042617321014404297, "kl": 5.095383954323296e-05, "entropy": 1.4681950211524963, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 110, "training_iteration": 27, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-48", "timestamp": 1702707528, "time_this_iter_s": 9.551285743713379, "time_total_s": 264.1074318885803, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc279790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 264.1074318885803, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 29.90769230769231, "ram_util_percent": 23.76923076923077, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -168.04048255579818, "episode_reward_min": -633.2161407490582, "episode_reward_mean": -262.59921563721434, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-619.3355831919444, -608.5132121536969, -629.6421325540581, -602.0219918276034, -633.2161407490582, -570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3365323539607142, "mean_inference_ms": 1.1957886970459304, "mean_action_processing_ms": 0.08880696918726981, "mean_env_wait_ms": 0.5645165034472426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 9532.54, "sample_throughput": 2098.077, "load_time_ms": 0.288, "load_throughput": 69557280.265, "learn_time_ms": 977.144, "learn_throughput": 20467.822, "update_time_ms": 9.403}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 0.7110953330993652, "policy_loss": -6.814842460478587e-05, "vf_loss": 0.7260373830795288, "vf_explained_var": -0.00012046098709106445, "kl": 8.313659666248086e-05, "entropy": 1.4873923063278198, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 115, "training_iteration": 28, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-18-58", "timestamp": 1702707538, "time_this_iter_s": 9.51188349723816, "time_total_s": 273.6193153858185, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc24fc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 273.6193153858185, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.516666666666666, "ram_util_percent": 23.933333333333334, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -168.04048255579818, "episode_reward_min": -580.4829024285128, "episode_reward_mean": -240.6171620050162, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.6297926181021, -554.8953131794527, -567.9012567978497, -557.0362210726076, -580.4829024285128, -441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33687996561003075, "mean_inference_ms": 1.1965988289435503, "mean_action_processing_ms": 0.0888258486104332, "mean_env_wait_ms": 0.5649416915656184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 9537.622, "sample_throughput": 2096.959, "load_time_ms": 0.287, "load_throughput": 69568817.383, "learn_time_ms": 979.022, "learn_throughput": 20428.549, "update_time_ms": 8.701}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005, "total_loss": 0.8056750893592834, "policy_loss": -2.0014952923474993e-05, "vf_loss": 0.8207566142082214, "vf_explained_var": -2.4616718292236328e-05, "kl": 0.00012027424172433854, "entropy": 1.506152868270874, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 29, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-19-07", "timestamp": 1702707547, "time_this_iter_s": 9.562809467315674, "time_total_s": 283.18212485313416, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f25c1766d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 283.18212485313416, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.93076923076923, "ram_util_percent": 24.130769230769236, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -165.94674164104902, "episode_reward_min": -495.6366080292875, "episode_reward_mean": -221.40678871112922, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33729834248170804, "mean_inference_ms": 1.1975504317593615, "mean_action_processing_ms": 0.08884631717090453, "mean_env_wait_ms": 0.5654822933486651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 9543.437, "sample_throughput": 2095.681, "load_time_ms": 0.288, "load_throughput": 69453618.149, "learn_time_ms": 978.053, "learn_throughput": 20448.783, "update_time_ms": 8.712}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005, "total_loss": 0.7453509271144867, "policy_loss": 7.657509042191535e-05, "vf_loss": 0.7604609131813049, "vf_explained_var": -0.0004405379295349121, "kl": 0.00010040071140871021, "entropy": 1.5186532735824585, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 30, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-19-17", "timestamp": 1702707557, "time_this_iter_s": 9.590720415115356, "time_total_s": 292.7728452682495, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc24f5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 292.7728452682495, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.115384615384617, "ram_util_percent": 24.06153846153846, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -165.94674164104902, "episode_reward_min": -495.6366080292875, "episode_reward_mean": -221.40678871112922, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-441.6308957981312, -480.45659099383073, -495.6366080292875, -487.61533067660565, -472.82430197832144, -394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33729834248170804, "mean_inference_ms": 1.1975504317593615, "mean_action_processing_ms": 0.08884631717090453, "mean_env_wait_ms": 0.5654822933486651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 9544.946, "sample_throughput": 2095.35, "load_time_ms": 0.288, "load_throughput": 69401902.871, "learn_time_ms": 978.503, "learn_throughput": 20439.393, "update_time_ms": 8.712}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005, "total_loss": 0.7387139201164246, "policy_loss": -3.384037085396585e-05, "vf_loss": 0.7539837062358856, "vf_explained_var": -0.0005470514297485352, "kl": 4.3655107504037005e-05, "entropy": 1.5235940217971802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 31, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-19-26", "timestamp": 1702707566, "time_this_iter_s": 9.534487962722778, "time_total_s": 302.3073332309723, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc047280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 302.3073332309723, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.158333333333335, "ram_util_percent": 24.13333333333333, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -165.94674164104902, "episode_reward_min": -435.23711010013193, "episode_reward_mean": -206.65583019460303, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-394.9075164234257, -387.75721200526544, -435.23711010013193, -399.983573056761, -398.9885326847018, -368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.337572720483001, "mean_inference_ms": 1.1980304246256226, "mean_action_processing_ms": 0.08884940023791182, "mean_env_wait_ms": 0.5658036903345984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 9590.039, "sample_throughput": 2085.497, "load_time_ms": 0.288, "load_throughput": 69516930.472, "learn_time_ms": 979.91, "learn_throughput": 20410.029, "update_time_ms": 8.466}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005, "total_loss": 0.7446109056472778, "policy_loss": -8.25370802779446e-05, "vf_loss": 0.7599159479141235, "vf_explained_var": 0.000277787446975708, "kl": 4.351452571427217e-05, "entropy": 1.5222492218017578, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 130, "training_iteration": 32, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-19-36", "timestamp": 1702707576, "time_this_iter_s": 9.893370866775513, "time_total_s": 312.2007040977478, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc2e5c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 312.2007040977478, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 32.53571428571429, "ram_util_percent": 24.29285714285714, "gpu_util_percent0": 0.027857142857142858, "vram_util_percent0": 0.01674107142857143}}
{"episode_reward_max": -165.94674164104902, "episode_reward_min": -376.6276752187334, "episode_reward_mean": -195.59821157255683, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-368.90821670426334, -339.26851353468413, -342.3598499036431, -376.6276752187334, -363.68615123185805, -248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3376722207856816, "mean_inference_ms": 1.1979678830400458, "mean_action_processing_ms": 0.08882006204382825, "mean_env_wait_ms": 0.5659012349804942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 9627.17, "sample_throughput": 2077.454, "load_time_ms": 0.287, "load_throughput": 69667037.621, "learn_time_ms": 979.064, "learn_throughput": 20427.676, "update_time_ms": 8.582}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005, "total_loss": 0.8526932597160339, "policy_loss": -0.0001286661130146527, "vf_loss": 0.8680403828620911, "vf_explained_var": -0.00018340349197387695, "kl": 4.5289291012107213e-05, "entropy": 1.5218454003334045, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 135, "training_iteration": 33, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-19-46", "timestamp": 1702707586, "time_this_iter_s": 9.882236242294312, "time_total_s": 322.0829403400421, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc0d2f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 322.0829403400421, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.86923076923077, "ram_util_percent": 24.338461538461537, "gpu_util_percent0": 0.02230769230769231, "vram_util_percent0": 0.016751802884615388}}
{"episode_reward_max": -165.94674164104902, "episode_reward_min": -317.30653811320246, "episode_reward_mean": -186.85335079977835, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-248.04339717177652, -275.5346919849968, -294.8748724188957, -317.30653811320246, -273.65959614661944, -251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3377052980781067, "mean_inference_ms": 1.1978332864743229, "mean_action_processing_ms": 0.08878407234417557, "mean_env_wait_ms": 0.5658977498900352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 9627.357, "sample_throughput": 2077.413, "load_time_ms": 0.321, "load_throughput": 62299353.88, "learn_time_ms": 980.16, "learn_throughput": 20404.824, "update_time_ms": 8.475}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005, "total_loss": 0.7025238275527954, "policy_loss": -6.0048101813592325e-05, "vf_loss": 0.7177649736404419, "vf_explained_var": -0.00015181303024291992, "kl": 4.776688067575918e-05, "entropy": 1.5181089639663696, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 34, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-19-56", "timestamp": 1702707596, "time_this_iter_s": 9.529551029205322, "time_total_s": 331.61249136924744, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc0b6040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 331.61249136924744, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.125, "ram_util_percent": 24.308333333333334, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -251.850852801495, "episode_reward_mean": -181.4397396908683, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-251.850852801495, -201.53940267159442, -235.65543913281073, -238.70723043112068, -244.82411789281124, -183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3376313649168749, "mean_inference_ms": 1.1974481261534224, "mean_action_processing_ms": 0.08871751993862151, "mean_env_wait_ms": 0.5656929787996066, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 9629.08, "sample_throughput": 2077.042, "load_time_ms": 0.309, "load_throughput": 64821945.754, "learn_time_ms": 980.97, "learn_throughput": 20387.991, "update_time_ms": 8.411}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005, "total_loss": 0.5123974680900574, "policy_loss": -2.0687483891279612e-05, "vf_loss": 0.5275766551494598, "vf_explained_var": 8.571147918701172e-05, "kl": 3.9184073835407673e-05, "entropy": 1.515846610069275, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 145, "training_iteration": 35, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-20-05", "timestamp": 1702707605, "time_this_iter_s": 9.546769618988037, "time_total_s": 341.1592609882355, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc20f310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 341.1592609882355, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.07692307692308, "ram_util_percent": 24.384615384615383, "gpu_util_percent0": 0.010769230769230769, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -223.010142009944, "episode_reward_mean": -178.59741890392417, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3374149591642286, "mean_inference_ms": 1.196463156715579, "mean_action_processing_ms": 0.08860788627384635, "mean_env_wait_ms": 0.5652287153051584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 9647.971, "sample_throughput": 2072.975, "load_time_ms": 0.307, "load_throughput": 65053183.404, "learn_time_ms": 982.857, "learn_throughput": 20348.836, "update_time_ms": 8.882}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005, "total_loss": 0.6214863657951355, "policy_loss": -6.211585928639352e-05, "vf_loss": 0.6367442309856415, "vf_explained_var": -0.00038242340087890625, "kl": 4.804992916662698e-05, "entropy": 1.5195754170417786, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 36, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-20-15", "timestamp": 1702707615, "time_this_iter_s": 9.62593150138855, "time_total_s": 350.785192489624, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc1f0c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 350.785192489624, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.88461538461539, "ram_util_percent": 24.707692307692305, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -223.010142009944, "episode_reward_mean": -178.59741890392417, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.20193557990342, -208.04049863134068, -213.58333452616822, -223.010142009944, -184.97838842605753, -202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3374149591642286, "mean_inference_ms": 1.196463156715579, "mean_action_processing_ms": 0.08860788627384635, "mean_env_wait_ms": 0.5652287153051584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 9647.231, "sample_throughput": 2073.134, "load_time_ms": 0.256, "load_throughput": 78069874.36, "learn_time_ms": 983.772, "learn_throughput": 20329.922, "update_time_ms": 8.932}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005, "total_loss": 0.6774516999721527, "policy_loss": -9.756202363631061e-05, "vf_loss": 0.6927419602870941, "vf_explained_var": -0.0010752081871032715, "kl": 0.00010113094876817996, "entropy": 1.519264817237854, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 37, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-20-24", "timestamp": 1702707624, "time_this_iter_s": 9.528231620788574, "time_total_s": 360.3134241104126, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc279790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 360.3134241104126, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.066666666666663, "ram_util_percent": 24.59166666666667, "gpu_util_percent0": 0.0016666666666666668, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -210.66238496055857, "episode_reward_mean": -177.63912593915236, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.51869446675715, -195.4611289482937, -182.01758691617385, -175.32491453418515, -194.03066757560438, -169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33716322697043777, "mean_inference_ms": 1.1953286932911784, "mean_action_processing_ms": 0.08849417333348632, "mean_env_wait_ms": 0.5647212791756417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 9660.234, "sample_throughput": 2070.343, "load_time_ms": 0.257, "load_throughput": 77852510.441, "learn_time_ms": 982.264, "learn_throughput": 20361.115, "update_time_ms": 8.828}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005, "total_loss": 0.5134485065937042, "policy_loss": 8.37287935340214e-06, "vf_loss": 0.52855184674263, "vf_explained_var": -0.00014781951904296875, "kl": 4.665359412214798e-05, "entropy": 1.5111733078956604, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 155, "training_iteration": 38, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-20-34", "timestamp": 1702707634, "time_this_iter_s": 9.62024474143982, "time_total_s": 369.9336688518524, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc196160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 369.9336688518524, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 29.823076923076925, "ram_util_percent": 24.6, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -210.66238496055857, "episode_reward_mean": -176.73903562434936, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.9924826328381, -189.35050228576947, -170.20111402586215, -173.09261495177736, -172.6256732884221, -181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3368989483798959, "mean_inference_ms": 1.1941456266636277, "mean_action_processing_ms": 0.088377024417314, "mean_env_wait_ms": 0.5641959635918898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 9655.812, "sample_throughput": 2071.291, "load_time_ms": 0.259, "load_throughput": 77350004.61, "learn_time_ms": 981.687, "learn_throughput": 20373.101, "update_time_ms": 8.835}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005, "total_loss": 0.6475359499454498, "policy_loss": -1.7819023935494727e-05, "vf_loss": 0.6626555323600769, "vf_explained_var": -0.0002874135971069336, "kl": 3.504221208094904e-05, "entropy": 1.5101773738861084, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 39, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-20-44", "timestamp": 1702707644, "time_this_iter_s": 9.529992818832397, "time_total_s": 379.4636616706848, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f27057760d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 379.4636616706848, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.791666666666668, "ram_util_percent": 24.59166666666667, "gpu_util_percent0": 0.0008333333333333334, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -210.66238496055857, "episode_reward_mean": -177.41637227288092, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.31688582584377, -177.69115584997652, -175.98744865124576, -177.3272301842591, -176.09905695947498, -175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3365304428061569, "mean_inference_ms": 1.192787644830736, "mean_action_processing_ms": 0.08824635470590404, "mean_env_wait_ms": 0.5635867533582922, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 9657.42, "sample_throughput": 2070.947, "load_time_ms": 0.258, "load_throughput": 77399963.093, "learn_time_ms": 984.798, "learn_throughput": 20308.735, "update_time_ms": 8.872}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005, "total_loss": 0.761212557554245, "policy_loss": -3.6464690991167004e-06, "vf_loss": 0.7763051986694336, "vf_explained_var": -0.00028330087661743164, "kl": 2.8201077397871366e-05, "entropy": 1.5089013576507568, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 165, "training_iteration": 40, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-20-53", "timestamp": 1702707653, "time_this_iter_s": 9.643017292022705, "time_total_s": 389.1066789627075, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc2e5940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 389.1066789627075, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.838461538461537, "ram_util_percent": 24.699999999999996, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -210.66238496055857, "episode_reward_mean": -177.6951934247232, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.10572507475337, -176.78235668881294, -173.3508090160951, -177.87271393059973, -178.61267879162273, -176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336129606755065, "mean_inference_ms": 1.191411360188283, "mean_action_processing_ms": 0.08811239708053309, "mean_env_wait_ms": 0.5629729083610102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 9662.949, "sample_throughput": 2069.761, "load_time_ms": 0.257, "load_throughput": 77701074.472, "learn_time_ms": 987.583, "learn_throughput": 20251.469, "update_time_ms": 8.933}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005, "total_loss": 0.6061716079711914, "policy_loss": -4.822521071190522e-05, "vf_loss": 0.6212793290615082, "vf_explained_var": 0.00017264485359191895, "kl": 6.812884645296391e-06, "entropy": 1.5059595704078674, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 41, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-21-03", "timestamp": 1702707663, "time_this_iter_s": 9.588635206222534, "time_total_s": 398.69531416893005, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc196310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 398.69531416893005, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.076923076923077, "ram_util_percent": 24.861538461538462, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -178.0016463669034, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33576190418748825, "mean_inference_ms": 1.1901897533951773, "mean_action_processing_ms": 0.08799014829329949, "mean_env_wait_ms": 0.5623943472620405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 9637.594, "sample_throughput": 2075.207, "load_time_ms": 0.258, "load_throughput": 77478599.797, "learn_time_ms": 987.612, "learn_throughput": 20250.862, "update_time_ms": 8.735}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005, "total_loss": 0.6425912976264954, "policy_loss": -0.00011859760080712434, "vf_loss": 0.6578489243984222, "vf_explained_var": -0.00013977289199829102, "kl": 7.719061908506575e-05, "entropy": 1.5138992667198181, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 42, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-21-13", "timestamp": 1702707673, "time_this_iter_s": 9.634303331375122, "time_total_s": 408.3296175003052, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc20fc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 408.3296175003052, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.008333333333336, "ram_util_percent": 24.833333333333332, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.988861921379, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -178.0016463669034, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.80342468968576, -172.31734884670877, -172.90752212056387, -176.8988295523808, -170.24030334687154, -180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33576190418748825, "mean_inference_ms": 1.1901897533951773, "mean_action_processing_ms": 0.08799014829329949, "mean_env_wait_ms": 0.5623943472620405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"sample_time_ms": 9608.219, "sample_throughput": 2081.551, "load_time_ms": 0.258, "load_throughput": 77399963.093, "learn_time_ms": 988.366, "learn_throughput": 20235.421, "update_time_ms": 8.634}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005, "total_loss": 0.36660152673721313, "policy_loss": 3.9420317364147195e-05, "vf_loss": 0.3818523585796356, "vf_explained_var": -0.0013964176177978516, "kl": 5.515832825508937e-05, "entropy": 1.5290273427963257, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 860000, "num_steps_trained": 860000, "num_agent_steps_trained": 860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 43, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-21-22", "timestamp": 1702707682, "time_this_iter_s": 9.600427150726318, "time_total_s": 417.9300446510315, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f27057760d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 417.9300446510315, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 29.946153846153848, "ram_util_percent": 24.946153846153848, "gpu_util_percent0": 0.02076923076923077, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.21173459013804, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -178.15812800028436, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.23875109223292, -178.18440281340472, -174.43425950678323, -172.8559215883443, -177.74768339700924, -175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33546713715981125, "mean_inference_ms": 1.1891665471999882, "mean_action_processing_ms": 0.08788240143176063, "mean_env_wait_ms": 0.5618892370947735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 9610.559, "sample_throughput": 2081.044, "load_time_ms": 0.224, "load_throughput": 89326035.566, "learn_time_ms": 988.426, "learn_throughput": 20234.181, "update_time_ms": 8.716}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005, "total_loss": 0.5735213756561279, "policy_loss": -0.00011534195069717867, "vf_loss": 0.5889874696731567, "vf_explained_var": 0.0005607008934020996, "kl": 8.012586590533388e-05, "entropy": 1.5350738763809204, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 880000, "num_steps_trained": 880000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 44, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-21-32", "timestamp": 1702707692, "time_this_iter_s": 9.543493747711182, "time_total_s": 427.4735383987427, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc137ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 427.4735383987427, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.76923076923077, "ram_util_percent": 25.0, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.21173459013804, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -178.19212730651464, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.25949658424324, -174.23670305405403, -174.42477255422972, -172.00581046772814, -170.47378513762789, -179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596, -181.85118238792148, -171.21160259859994, -198.68908770113862, -168.4089266116674, -166.70014972147342], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3351992250844073, "mean_inference_ms": 1.1882594162327222, "mean_action_processing_ms": 0.08778381143965111, "mean_env_wait_ms": 0.5614185760123965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 9620.611, "sample_throughput": 2078.87, "load_time_ms": 0.224, "load_throughput": 89373620.286, "learn_time_ms": 987.978, "learn_throughput": 20243.356, "update_time_ms": 9.171}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005, "total_loss": 0.6725945770740509, "policy_loss": 4.8181914095835054e-05, "vf_loss": 0.6880073845386505, "vf_explained_var": -0.00018084049224853516, "kl": 7.84309220822621e-05, "entropy": 1.5461019277572632, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 185, "training_iteration": 45, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-21-41", "timestamp": 1702707701, "time_this_iter_s": 9.645127534866333, "time_total_s": 437.118665933609, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc1960d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 437.118665933609, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.066666666666666, "ram_util_percent": 24.983333333333334, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.21173459013804, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -178.87015796620352, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.4932098382983, -177.3242736584153, -170.52558306500768, -171.49832801603205, -176.09251716089844, -168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596, -181.85118238792148, -171.21160259859994, -198.68908770113862, -168.4089266116674, -166.70014972147342, -209.50009539116633, -174.73694243730898, -203.42869102566584, -174.1829952058965, -172.3549097067297], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33496728572330736, "mean_inference_ms": 1.1875012108239076, "mean_action_processing_ms": 0.08769362114356422, "mean_env_wait_ms": 0.5609805639356092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"sample_time_ms": 9633.387, "sample_throughput": 2076.113, "load_time_ms": 0.225, "load_throughput": 88881203.645, "learn_time_ms": 986.598, "learn_throughput": 20271.674, "update_time_ms": 8.693}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005, "total_loss": 0.6588521897792816, "policy_loss": -9.193420691389065e-08, "vf_loss": 0.6744241714477539, "vf_explained_var": -6.16312026977539e-05, "kl": 3.557223676753374e-05, "entropy": 1.557183563709259, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 920000, "num_steps_trained": 920000, "num_agent_steps_trained": 920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 46, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-21-51", "timestamp": 1702707711, "time_this_iter_s": 9.736470699310303, "time_total_s": 446.8551366329193, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc0824c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 446.8551366329193, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.199999999999996, "ram_util_percent": 24.923076923076923, "gpu_util_percent0": 0.016153846153846154, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.21173459013804, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -179.48823286824165, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.04048255579818, -173.14220123963347, -175.4770266237352, -173.31213927807, -172.0848853944164, -173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596, -181.85118238792148, -171.21160259859994, -198.68908770113862, -168.4089266116674, -166.70014972147342, -209.50009539116633, -174.73694243730898, -203.42869102566584, -174.1829952058965, -172.3549097067297, -194.54355283353425, -185.59101590110063, -197.48708308899984, -180.61662964092147, -178.50312047791343], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.334755736902453, "mean_inference_ms": 1.1868125250730974, "mean_action_processing_ms": 0.08761099926818827, "mean_env_wait_ms": 0.5605926563021458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"sample_time_ms": 9644.784, "sample_throughput": 2073.66, "load_time_ms": 0.237, "load_throughput": 84417912.851, "learn_time_ms": 984.242, "learn_throughput": 20320.209, "update_time_ms": 8.822}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005, "total_loss": 0.652666449546814, "policy_loss": -6.281299340749058e-05, "vf_loss": 0.6683938503265381, "vf_explained_var": -0.0001710057258605957, "kl": 2.3373701548479175e-05, "entropy": 1.5664554834365845, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 940000, "num_steps_trained": 940000, "num_agent_steps_trained": 940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 195, "training_iteration": 47, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-22-01", "timestamp": 1702707721, "time_this_iter_s": 9.639523029327393, "time_total_s": 456.4946596622467, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc1f0820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 456.4946596622467, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.130769230769225, "ram_util_percent": 25.092307692307692, "gpu_util_percent0": 0.01076923076923077, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.21173459013804, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -180.58535097727898, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596, -181.85118238792148, -171.21160259859994, -198.68908770113862, -168.4089266116674, -166.70014972147342, -209.50009539116633, -174.73694243730898, -203.42869102566584, -174.1829952058965, -172.3549097067297, -194.54355283353425, -185.59101590110063, -197.48708308899984, -180.61662964092147, -178.50312047791343, -189.55583922387007, -216.98756334810926, -189.603107959819, -182.62845854593857, -192.99357691764678], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33457177182497033, "mean_inference_ms": 1.1861938467302124, "mean_action_processing_ms": 0.08753186351938436, "mean_env_wait_ms": 0.560214876237688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 9634.772, "sample_throughput": 2075.814, "load_time_ms": 0.237, "load_throughput": 84494439.968, "learn_time_ms": 985.593, "learn_throughput": 20292.346, "update_time_ms": 8.809}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005, "total_loss": 0.7516827285289764, "policy_loss": 1.932144169103367e-07, "vf_loss": 0.767374724149704, "vf_explained_var": -0.00018286705017089844, "kl": 4.8102982889486334e-05, "entropy": 1.5692132115364075, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 48, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-22-10", "timestamp": 1702707730, "time_this_iter_s": 9.553162813186646, "time_total_s": 466.04782247543335, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26dc0823a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 466.04782247543335, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.024999999999995, "ram_util_percent": 25.216666666666665, "gpu_util_percent0": 0.004166666666666667, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -164.21173459013804, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -180.58535097727898, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.6484758352017, -173.71410065113108, -171.0183671274951, -172.39939590818273, -174.72249635693365, -179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596, -181.85118238792148, -171.21160259859994, -198.68908770113862, -168.4089266116674, -166.70014972147342, -209.50009539116633, -174.73694243730898, -203.42869102566584, -174.1829952058965, -172.3549097067297, -194.54355283353425, -185.59101590110063, -197.48708308899984, -180.61662964092147, -178.50312047791343, -189.55583922387007, -216.98756334810926, -189.603107959819, -182.62845854593857, -192.99357691764678], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33457177182497033, "mean_inference_ms": 1.1861938467302124, "mean_action_processing_ms": 0.08753186351938436, "mean_env_wait_ms": 0.560214876237688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"sample_time_ms": 9645.401, "sample_throughput": 2073.527, "load_time_ms": 0.236, "load_throughput": 84887755.515, "learn_time_ms": 987.712, "learn_throughput": 20248.825, "update_time_ms": 8.81}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005, "total_loss": 0.577585369348526, "policy_loss": -4.038495882419113e-05, "vf_loss": 0.5932912230491638, "vf_explained_var": -0.00031834840774536133, "kl": 3.185808068706386e-05, "entropy": 1.5665470957756042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 980000, "num_steps_trained": 980000, "num_agent_steps_trained": 980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 49, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-22-20", "timestamp": 1702707740, "time_this_iter_s": 9.643042802810669, "time_total_s": 475.690865278244, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26feac7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 475.690865278244, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.05384615384616, "ram_util_percent": 25.223076923076924, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.016682942708333336}}
{"episode_reward_max": -163.53626428561037, "episode_reward_min": -217.82531822504893, "episode_reward_mean": -181.2786201090012, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.49093412817396, -174.17128097157027, -175.41674215892746, -168.54352476554453, -174.24601524796157, -171.38252750304957, -172.26508141514898, -172.44895089484663, -175.89078207172852, -175.40872365373832, -176.58466211904403, -178.52449579595304, -170.51960175490987, -182.32691267784898, -186.56802490878655, -180.62976036057515, -179.38216817567405, -180.0368047623962, -203.91268176813284, -165.94674164104902, -183.07132998795979, -177.88767095643706, -174.0910004287065, -189.81142657411013, -178.20644787634572, -170.05803929964804, -181.9501668179789, -189.15690480466898, -180.4431035445215, -189.5038675988417, -200.9739423307021, -179.042014862893, -172.25929585714698, -181.53394662702593, -182.555129637565, -167.7370711418157, -176.27231168974527, -164.988861921379, -170.56709898900297, -188.49264120254693, -185.00562912482098, -174.03259722486297, -174.40960377873316, -180.8702229998473, -174.0269111071458, -210.66238496055857, -174.4204095947923, -196.0200999338009, -168.59181521326042, -167.29029299382466, -172.02915398871144, -170.7875620792115, -171.04196891179964, -171.4676949598324, -174.01758102116275, -174.54737185209044, -190.01037452692012, -193.96386870653595, -185.03707350181676, -199.4373634504646, -173.29034863892528, -174.8345565752961, -189.4158620583091, -195.15364827225457, -183.6094771102375, -170.156593352076, -173.3481703756023, -217.82531822504893, -183.650656831578, -167.38883893560305, -164.21173459013804, -171.64045893745893, -193.14548840448916, -175.7710768645141, -180.04683309770596, -181.85118238792148, -171.21160259859994, -198.68908770113862, -168.4089266116674, -166.70014972147342, -209.50009539116633, -174.73694243730898, -203.42869102566584, -174.1829952058965, -172.3549097067297, -194.54355283353425, -185.59101590110063, -197.48708308899984, -180.61662964092147, -178.50312047791343, -189.55583922387007, -216.98756334810926, -189.603107959819, -182.62845854593857, -192.99357691764678, -208.9899218164635, -200.38062385882378, -163.53626428561037, -182.29509335346043, -179.62784573681316], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3344369897758538, "mean_inference_ms": 1.1857098531195052, "mean_action_processing_ms": 0.08746388183174793, "mean_env_wait_ms": 0.5598781329197926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"sample_time_ms": 9635.746, "sample_throughput": 2075.605, "load_time_ms": 0.236, "load_throughput": 84571105.958, "learn_time_ms": 985.132, "learn_throughput": 20301.853, "update_time_ms": 10.835}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005, "total_loss": 0.8360432684421539, "policy_loss": -8.234977478860372e-05, "vf_loss": 0.8516423106193542, "vf_explained_var": 9.971857070922852e-05, "kl": 3.120748885154789e-05, "entropy": 1.5516672134399414, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 1000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 1000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -168.76906600573045, "episode_reward_min": -189.32730886691635, "episode_reward_mean": -179.62311332079554, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.18862126239077, -189.32730886691635, -171.3399807387549, -187.53325902957283, -181.1385259089603, -182.91091874225708, -178.08555159233126, -185.0626368614851, -168.76906600573045, -173.87526419955614], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923518366496297, "mean_inference_ms": 1.1736836089229674, "mean_action_processing_ms": 0.08272379714366655, "mean_env_wait_ms": 0.5463289352844513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 205, "training_iteration": 50, "trial_id": "5b52b_00000", "experiment_id": "a866316dfdb947d2ab867a1240bc300a", "date": "2023-12-16_12-22-50", "timestamp": 1702707770, "time_this_iter_s": 29.698214054107666, "time_total_s": 505.3890793323517, "pid": 35569, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f26fc047310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 505.3890793323517, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.453846153846154, "ram_util_percent": 25.33589743589743, "gpu_util_percent0": 0.0007692307692307692, "vram_util_percent0": 0.01668294270833334}}
