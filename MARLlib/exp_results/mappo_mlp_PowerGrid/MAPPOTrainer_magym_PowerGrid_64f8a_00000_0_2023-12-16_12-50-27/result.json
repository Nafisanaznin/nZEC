{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 8581.659, "sample_throughput": 2330.552, "load_time_ms": 0.734, "load_throughput": 27262294.443, "learn_time_ms": 1076.003, "learn_throughput": 18587.316, "update_time_ms": 9.186}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 109.39774322509766, "policy_loss": -0.0004958959382932449, "vf_loss": 109.4201545715332, "vf_explained_var": -1.609325408935547e-05, "kl": 0.00029544159166412787, "entropy": 2.1968952417373657, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-50-37", "timestamp": 1702709437, "time_this_iter_s": 9.655056238174438, "time_total_s": 9.655056238174438, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.655056238174438, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.54285714285714, "ram_util_percent": 33.93571428571429, "gpu_util_percent0": 0.028571428571428574, "vram_util_percent0": 0.015811011904761908}}
{"episode_reward_max": -770.6406867605886, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -792.0289248514143, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.330217297117387, "mean_inference_ms": 1.17402952362194, "mean_action_processing_ms": 0.08806220298257192, "mean_env_wait_ms": 0.5587992706870674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 9241.039, "sample_throughput": 2164.259, "load_time_ms": 0.479, "load_throughput": 41796751.37, "learn_time_ms": 1035.256, "learn_throughput": 19318.901, "update_time_ms": 8.441}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 85.0724983215332, "policy_loss": -0.0006249835936387171, "vf_loss": 85.09503173828125, "vf_explained_var": -0.0003008246421813965, "kl": 0.00029452317716119336, "entropy": 2.193493962287903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5, "training_iteration": 2, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-50-46", "timestamp": 1702709446, "time_this_iter_s": 9.785489320755005, "time_total_s": 19.440545558929443, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.440545558929443, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.87692307692308, "ram_util_percent": 35.9076923076923, "gpu_util_percent0": 0.03538461538461539, "vram_util_percent0": 0.01659530248397436}}
{"episode_reward_max": -688.8739267343778, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -760.1058194489069, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33447014516589124, "mean_inference_ms": 1.1852021607413525, "mean_action_processing_ms": 0.08878053104390361, "mean_env_wait_ms": 0.5621707033779303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 9550.614, "sample_throughput": 2094.106, "load_time_ms": 0.395, "load_throughput": 50645651.036, "learn_time_ms": 1024.479, "learn_throughput": 19522.115, "update_time_ms": 8.144}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 67.47994232177734, "policy_loss": -0.0008303600284271795, "vf_loss": 67.50259780883789, "vf_explained_var": 0.0004151463508605957, "kl": 0.00041990268926794805, "entropy": 2.184537887573242, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 3, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-50-57", "timestamp": 1702709457, "time_this_iter_s": 10.1573007106781, "time_total_s": 29.597846269607544, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29.597846269607544, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.392307692307696, "ram_util_percent": 36.14615384615385, "gpu_util_percent0": 0.05846153846153846, "vram_util_percent0": 0.016438802083333336}}
{"episode_reward_max": -638.3054922116851, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -730.6779102359145, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3381157182704882, "mean_inference_ms": 1.1974369337122583, "mean_action_processing_ms": 0.08957944830822771, "mean_env_wait_ms": 0.5664522032574681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 9804.032, "sample_throughput": 2039.977, "load_time_ms": 0.352, "load_throughput": 56814141.551, "learn_time_ms": 1012.178, "learn_throughput": 19759.367, "update_time_ms": 11.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 62.616825103759766, "policy_loss": -0.0005721576568671338, "vf_loss": 62.63905334472656, "vf_explained_var": 0.0001614391803741455, "kl": 0.0005398641293260509, "entropy": 2.1668251752853394, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15, "training_iteration": 4, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-51-07", "timestamp": 1702709467, "time_this_iter_s": 10.525486469268799, "time_total_s": 40.12333273887634, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d401d8b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 40.12333273887634, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.22666666666667, "ram_util_percent": 36.166666666666664, "gpu_util_percent0": 0.07800000000000001, "vram_util_percent0": 0.01712782118055555}}
{"episode_reward_max": -601.1809723292331, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -702.9538399773656, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34100847576157023, "mean_inference_ms": 1.206776588289167, "mean_action_processing_ms": 0.09017633382630783, "mean_env_wait_ms": 0.5691838532828523, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 9935.185, "sample_throughput": 2013.048, "load_time_ms": 0.366, "load_throughput": 54570699.974, "learn_time_ms": 1016.953, "learn_throughput": 19666.585, "update_time_ms": 10.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 50.224613189697266, "policy_loss": -0.0007482547484336521, "vf_loss": 50.24674034118652, "vf_explained_var": -0.0004673004150390625, "kl": 0.0006183168018494278, "entropy": 2.1385557651519775, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 5, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-51-18", "timestamp": 1702709478, "time_this_iter_s": 10.45906686782837, "time_total_s": 50.58239960670471, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 50.58239960670471, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.385714285714286, "ram_util_percent": 36.19285714285714, "gpu_util_percent0": 0.07928571428571428, "vram_util_percent0": 0.017072405133928572}}
{"episode_reward_max": -548.029136499489, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -676.1010408823211, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3422685582262088, "mean_inference_ms": 1.211212451414212, "mean_action_processing_ms": 0.09048714679622513, "mean_env_wait_ms": 0.5703291914021178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 9927.334, "sample_throughput": 2014.64, "load_time_ms": 0.342, "load_throughput": 58409711.036, "learn_time_ms": 1010.405, "learn_throughput": 19794.041, "update_time_ms": 10.217}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 47.9547233581543, "policy_loss": -0.000967801663094292, "vf_loss": 47.976675033569336, "vf_explained_var": 0.0003504157066345215, "kl": 0.0007044697259012689, "entropy": 2.0986424684524536, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 6, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-51-27", "timestamp": 1702709487, "time_this_iter_s": 9.803809881210327, "time_total_s": 60.38620948791504, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 60.38620948791504, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.61538461538462, "ram_util_percent": 36.253846153846155, "gpu_util_percent0": 0.025384615384615387, "vram_util_percent0": 0.016564002403846152}}
{"episode_reward_max": -548.029136499489, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -676.1010408823211, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3422685582262088, "mean_inference_ms": 1.211212451414212, "mean_action_processing_ms": 0.09048714679622513, "mean_env_wait_ms": 0.5703291914021178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 9872.818, "sample_throughput": 2025.764, "load_time_ms": 0.326, "load_throughput": 61390753.79, "learn_time_ms": 1003.316, "learn_throughput": 19933.901, "update_time_ms": 9.912}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 36.83456039428711, "policy_loss": -0.0013683201011269741, "vf_loss": 36.856374740600586, "vf_explained_var": -0.00017547607421875, "kl": 0.0008246122120185717, "entropy": 2.0448973178863525, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25, "training_iteration": 7, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-51-37", "timestamp": 1702709497, "time_this_iter_s": 9.506250143051147, "time_total_s": 69.89245963096619, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 69.89245963096619, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.466666666666665, "ram_util_percent": 36.33333333333333, "gpu_util_percent0": 0.021666666666666667, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -442.59906942908725, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -642.7646170374156, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34209948236438126, "mean_inference_ms": 1.2111126325584938, "mean_action_processing_ms": 0.09046302818106414, "mean_env_wait_ms": 0.5697837873896084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 9829.534, "sample_throughput": 2034.685, "load_time_ms": 0.313, "load_throughput": 63822029.482, "learn_time_ms": 1001.772, "learn_throughput": 19964.623, "update_time_ms": 9.743}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 21.685450553894043, "policy_loss": -0.001513867611809161, "vf_loss": 21.706713676452637, "vf_explained_var": -0.0006144046783447266, "kl": 0.0009080479405835229, "entropy": 1.9750685691833496, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 8, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-51-47", "timestamp": 1702709507, "time_this_iter_s": 9.518831968307495, "time_total_s": 79.41129159927368, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48112b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 79.41129159927368, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.1, "ram_util_percent": 36.17692307692308, "gpu_util_percent0": 0.01846153846153846, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -389.01013832723726, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -608.3366759055747, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3417844034375503, "mean_inference_ms": 1.2100124013111984, "mean_action_processing_ms": 0.09036750275143618, "mean_env_wait_ms": 0.5691959512391177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 9798.05, "sample_throughput": 2041.222, "load_time_ms": 0.325, "load_throughput": 61595392.021, "learn_time_ms": 998.214, "learn_throughput": 20035.779, "update_time_ms": 9.535}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 15.150866985321045, "policy_loss": -0.0008854099098591917, "vf_loss": 15.170688152313232, "vf_explained_var": 0.00027805566787719727, "kl": 0.0008428069837179697, "entropy": 1.8936420679092407, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 35, "training_iteration": 9, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-51-56", "timestamp": 1702709516, "time_this_iter_s": 9.500234365463257, "time_total_s": 88.91152596473694, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402af1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 88.91152596473694, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.284615384615385, "ram_util_percent": 36.407692307692294, "gpu_util_percent0": 0.025384615384615387, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -329.2268029291836, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -576.2135569922075, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34156297202764313, "mean_inference_ms": 1.2092865149286525, "mean_action_processing_ms": 0.09029311779792142, "mean_env_wait_ms": 0.5687381553051081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 9807.452, "sample_throughput": 2039.266, "load_time_ms": 0.331, "load_throughput": 60502041.111, "learn_time_ms": 995.781, "learn_throughput": 20084.731, "update_time_ms": 9.364}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 11.445663452148438, "policy_loss": -0.0011485681107270551, "vf_loss": 11.46491289138794, "vf_explained_var": -3.1828880310058594e-05, "kl": 0.0007016442783656096, "entropy": 1.8101168870925903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 10, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-52-06", "timestamp": 1702709526, "time_this_iter_s": 9.872777700424194, "time_total_s": 98.78430366516113, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 98.78430366516113, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 33.84615384615385, "ram_util_percent": 36.18461538461539, "gpu_util_percent0": 0.04692307692307693, "vram_util_percent0": 0.016651642628205128}}
{"episode_reward_max": -254.20975068407736, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -543.6269029204815, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3413060459330427, "mean_inference_ms": 1.2082951233994672, "mean_action_processing_ms": 0.09020580683637965, "mean_env_wait_ms": 0.568219701992609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 9908.443, "sample_throughput": 2018.481, "load_time_ms": 0.28, "load_throughput": 71392408.511, "learn_time_ms": 985.421, "learn_throughput": 20295.897, "update_time_ms": 9.227}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 6.790284633636475, "policy_loss": -0.0010350603677329318, "vf_loss": 6.808605194091797, "vf_explained_var": -0.00016868114471435547, "kl": 0.0005954110176054073, "entropy": 1.7285776138305664, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 45, "training_iteration": 11, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-52-16", "timestamp": 1702709536, "time_this_iter_s": 9.568089723587036, "time_total_s": 108.35239338874817, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48112c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 108.35239338874817, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 30.43846153846154, "ram_util_percent": 36.238461538461536, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.015869140625}}
{"episode_reward_max": -205.6151262613657, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -512.7479717805476, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3409459612364174, "mean_inference_ms": 1.2070602323155561, "mean_action_processing_ms": 0.09010403832312894, "mean_env_wait_ms": 0.5676825415118145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 9866.727, "sample_throughput": 2027.015, "load_time_ms": 0.292, "load_throughput": 68495206.989, "learn_time_ms": 985.324, "learn_throughput": 20297.885, "update_time_ms": 9.267}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 4.222031831741333, "policy_loss": -0.0006528896077533375, "vf_loss": 4.239194631576538, "vf_explained_var": 6.887316703796387e-05, "kl": 0.00048628972479425325, "entropy": 1.6509484648704529, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 12, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-52-25", "timestamp": 1702709545, "time_this_iter_s": 9.477470874786377, "time_total_s": 117.82986426353455, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402afa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 117.82986426353455, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.861538461538466, "ram_util_percent": 36.39999999999999, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015869140625}}
{"episode_reward_max": -205.6151262613657, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -512.7479717805476, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3409459612364174, "mean_inference_ms": 1.2070602323155561, "mean_action_processing_ms": 0.09010403832312894, "mean_env_wait_ms": 0.5676825415118145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 9806.388, "sample_throughput": 2039.487, "load_time_ms": 0.292, "load_throughput": 68579202.093, "learn_time_ms": 983.378, "learn_throughput": 20338.069, "update_time_ms": 9.603}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 3.5380234718322754, "policy_loss": -0.0004917019016108526, "vf_loss": 3.5543426275253296, "vf_explained_var": -0.00011980533599853516, "kl": 0.00037119785389849724, "entropy": 1.5827287435531616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 13, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-52-35", "timestamp": 1702709555, "time_this_iter_s": 9.536774635314941, "time_total_s": 127.36663889884949, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 127.36663889884949, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.584615384615386, "ram_util_percent": 36.56923076923078, "gpu_util_percent0": 0.013076923076923078, "vram_util_percent0": 0.015869140625}}
{"episode_reward_max": -183.98999855964635, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -484.8741483910564, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405848842856763, "mean_inference_ms": 1.2057566916715283, "mean_action_processing_ms": 0.09000263456113042, "mean_env_wait_ms": 0.5671847842855825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 9732.804, "sample_throughput": 2054.906, "load_time_ms": 0.292, "load_throughput": 68478432.653, "learn_time_ms": 986.141, "learn_throughput": 20281.069, "update_time_ms": 8.309}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 2.131516456604004, "policy_loss": -0.00029291478008985905, "vf_loss": 2.1470372676849365, "vf_explained_var": 0.00026851892471313477, "kl": 0.0002868703580332088, "entropy": 1.522767186164856, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 55, "training_iteration": 14, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-52-44", "timestamp": 1702709564, "time_this_iter_s": 9.81802225112915, "time_total_s": 137.18466114997864, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402af8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 137.18466114997864, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 32.738461538461536, "ram_util_percent": 36.60769230769232, "gpu_util_percent0": 0.015384615384615385, "vram_util_percent0": 0.01598808092948718}}
{"episode_reward_max": -183.34230581822158, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -460.6075043667015, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34049142035761204, "mean_inference_ms": 1.2053031323447634, "mean_action_processing_ms": 0.08995921053328562, "mean_env_wait_ms": 0.5670506756409939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 9754.416, "sample_throughput": 2050.353, "load_time_ms": 0.286, "load_throughput": 69875951.687, "learn_time_ms": 989.61, "learn_throughput": 20209.98, "update_time_ms": 8.301}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 1.4848932027816772, "policy_loss": -0.00016800727958354855, "vf_loss": 1.49978506565094, "vf_explained_var": -0.00019025802612304688, "kl": 0.00023827082622673856, "entropy": 1.472381353378296, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 15, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-52-55", "timestamp": 1702709575, "time_this_iter_s": 10.7187180519104, "time_total_s": 147.90337920188904, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 147.90337920188904, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.82857142857143, "ram_util_percent": 36.82857142857142, "gpu_util_percent0": 0.05071428571428572, "vram_util_percent0": 0.017339797247023805}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -438.7587123176689, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404381146693128, "mean_inference_ms": 1.2048883155684607, "mean_action_processing_ms": 0.08992032633103951, "mean_env_wait_ms": 0.5669574324316324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 9761.848, "sample_throughput": 2048.792, "load_time_ms": 0.287, "load_throughput": 69759733.888, "learn_time_ms": 1000.066, "learn_throughput": 19998.683, "update_time_ms": 8.439}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 1.251121997833252, "policy_loss": -2.555770885415143e-05, "vf_loss": 1.2654563784599304, "vf_explained_var": -0.000500023365020752, "kl": 0.00015874521029934918, "entropy": 1.4308792352676392, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 65, "training_iteration": 16, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-53-05", "timestamp": 1702709585, "time_this_iter_s": 9.952802896499634, "time_total_s": 157.85618209838867, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 157.85618209838867, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.853846153846156, "ram_util_percent": 36.853846153846156, "gpu_util_percent0": 0.04538461538461539, "vram_util_percent0": 0.0170585436698718}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -420.01199511155176, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3403809785922277, "mean_inference_ms": 1.20451856047775, "mean_action_processing_ms": 0.08987810422652472, "mean_env_wait_ms": 0.5668167124124021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 9794.999, "sample_throughput": 2041.858, "load_time_ms": 0.295, "load_throughput": 67726529.953, "learn_time_ms": 1004.076, "learn_throughput": 19918.804, "update_time_ms": 8.411}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 1.2091132998466492, "policy_loss": -2.8589249026822472e-05, "vf_loss": 1.2231318950653076, "vf_explained_var": 0.00011044740676879883, "kl": 7.93737478471529e-05, "entropy": 1.3990126252174377, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 17, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-53-15", "timestamp": 1702709595, "time_this_iter_s": 9.763844013214111, "time_total_s": 167.62002611160278, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4815b280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 167.62002611160278, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.784615384615385, "ram_util_percent": 37.01538461538461, "gpu_util_percent0": 0.04692307692307693, "vram_util_percent0": 0.016507662259615384}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -403.69306927532716, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3402796290558508, "mean_inference_ms": 1.2040374469263713, "mean_action_processing_ms": 0.08983011047560983, "mean_env_wait_ms": 0.5666592791097046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 9802.01, "sample_throughput": 2040.398, "load_time_ms": 0.295, "load_throughput": 67715595.738, "learn_time_ms": 1002.869, "learn_throughput": 19942.79, "update_time_ms": 8.341}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 1.0665701627731323, "policy_loss": 2.7788161367059416e-05, "vf_loss": 1.080310583114624, "vf_explained_var": -0.0003656148910522461, "kl": 2.060085845068116e-05, "entropy": 1.3768247365951538, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 18, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-53-25", "timestamp": 1702709605, "time_this_iter_s": 9.547707796096802, "time_total_s": 177.16773390769958, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 177.16773390769958, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.83846153846154, "ram_util_percent": 37.04615384615385, "gpu_util_percent0": 0.0023076923076923075, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -403.69306927532716, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3402796290558508, "mean_inference_ms": 1.2040374469263713, "mean_action_processing_ms": 0.08983011047560983, "mean_env_wait_ms": 0.5666592791097046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 9797.564, "sample_throughput": 2041.324, "load_time_ms": 0.276, "load_throughput": 72490563.429, "learn_time_ms": 1004.294, "learn_throughput": 19914.496, "update_time_ms": 9.292}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 1.1095778346061707, "policy_loss": -1.4725494231981884e-05, "vf_loss": 1.1232808828353882, "vf_explained_var": -0.0007352828979492188, "kl": 2.3035293949591473e-05, "entropy": 1.3688393235206604, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 75, "training_iteration": 19, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-53-34", "timestamp": 1702709614, "time_this_iter_s": 9.496213436126709, "time_total_s": 186.6639473438263, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 186.6639473438263, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.784615384615385, "ram_util_percent": 37.12307692307692, "gpu_util_percent0": 0.004615384615384615, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -389.3887914449067, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401060954049509, "mean_inference_ms": 1.203347516201179, "mean_action_processing_ms": 0.08976688727106516, "mean_env_wait_ms": 0.566413605946334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 9766.082, "sample_throughput": 2047.904, "load_time_ms": 0.26, "load_throughput": 76790626.144, "learn_time_ms": 1004.965, "learn_throughput": 19901.192, "update_time_ms": 9.3}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 0.9839124977588654, "policy_loss": -1.110439290741283e-05, "vf_loss": 0.9975950419902802, "vf_explained_var": 0.00012379884719848633, "kl": 3.1365241177638836e-05, "entropy": 1.3671481013298035, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 20, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-53-44", "timestamp": 1702709624, "time_this_iter_s": 9.52485203742981, "time_total_s": 196.1887993812561, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 196.1887993812561, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.95, "ram_util_percent": 37.07500000000001, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -376.9548650261312, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3399317071896869, "mean_inference_ms": 1.2025949977116772, "mean_action_processing_ms": 0.08969902981040127, "mean_env_wait_ms": 0.5661523898286307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 9755.998, "sample_throughput": 2050.021, "load_time_ms": 0.261, "load_throughput": 76650292.398, "learn_time_ms": 1004.164, "learn_throughput": 19917.073, "update_time_ms": 9.311}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 0.8721481263637543, "policy_loss": -7.014122192039451e-05, "vf_loss": 0.8859104514122009, "vf_explained_var": -0.0002904534339904785, "kl": 5.703379656340525e-05, "entropy": 1.3692119717597961, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 85, "training_iteration": 21, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-53-53", "timestamp": 1702709633, "time_this_iter_s": 9.450744390487671, "time_total_s": 205.63954377174377, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 205.63954377174377, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.23846153846154, "ram_util_percent": 37.0923076923077, "gpu_util_percent0": 0.016153846153846154, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -365.7083051915774, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3397489384599885, "mean_inference_ms": 1.201829832383054, "mean_action_processing_ms": 0.08962840907955169, "mean_env_wait_ms": 0.5658563830983819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 9753.74, "sample_throughput": 2050.496, "load_time_ms": 0.264, "load_throughput": 75743638.826, "learn_time_ms": 1001.312, "learn_throughput": 19973.788, "update_time_ms": 9.306}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 0.8426882028579712, "policy_loss": -5.142516969325328e-05, "vf_loss": 0.8565182089805603, "vf_explained_var": -0.0003019571304321289, "kl": 8.627920595305483e-05, "entropy": 1.3778632879257202, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 90, "training_iteration": 22, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-54-03", "timestamp": 1702709643, "time_this_iter_s": 9.435601234436035, "time_total_s": 215.0751450061798, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482f2d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 215.0751450061798, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.525000000000002, "ram_util_percent": 37.15833333333334, "gpu_util_percent0": 0.0016666666666666668, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -355.5827060827465, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3395727148945539, "mean_inference_ms": 1.2010821701012577, "mean_action_processing_ms": 0.08955925443366206, "mean_env_wait_ms": 0.5655470165547022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 9751.005, "sample_throughput": 2051.071, "load_time_ms": 0.265, "load_throughput": 75491432.685, "learn_time_ms": 1000.912, "learn_throughput": 19981.768, "update_time_ms": 9.154}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005, "total_loss": 0.8184693455696106, "policy_loss": 3.158168804873185e-05, "vf_loss": 0.8323217034339905, "vf_explained_var": -0.00031185150146484375, "kl": 7.264432952336364e-05, "entropy": 1.3883883953094482, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 95, "training_iteration": 23, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-54-12", "timestamp": 1702709652, "time_this_iter_s": 9.532670736312866, "time_total_s": 224.60781574249268, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 224.60781574249268, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.87692307692308, "ram_util_percent": 37.13076923076923, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -346.5219905044799, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33938448202847377, "mean_inference_ms": 1.2003244834615763, "mean_action_processing_ms": 0.08948925513766211, "mean_env_wait_ms": 0.565226152493451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 9713.096, "sample_throughput": 2059.076, "load_time_ms": 0.273, "load_throughput": 73307768.942, "learn_time_ms": 1000.226, "learn_throughput": 19995.486, "update_time_ms": 9.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 0.7452195286750793, "policy_loss": -2.094097093774394e-05, "vf_loss": 0.7592167556285858, "vf_explained_var": -0.0003097653388977051, "kl": 4.593068523461863e-05, "entropy": 1.3976271748542786, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 24, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-54-22", "timestamp": 1702709662, "time_this_iter_s": 9.441814422607422, "time_total_s": 234.0496301651001, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48112f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 234.0496301651001, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.861538461538462, "ram_util_percent": 37.2, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -799.8001349534923, "episode_reward_mean": -346.5219905044799, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.6757326799652, -799.8001349534923, -797.3831303749031, -797.6449394881226, -770.6406867605886, -728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33938448202847377, "mean_inference_ms": 1.2003244834615763, "mean_action_processing_ms": 0.08948925513766211, "mean_env_wait_ms": 0.565226152493451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 9594.174, "sample_throughput": 2084.598, "load_time_ms": 0.259, "load_throughput": 77292988.114, "learn_time_ms": 991.539, "learn_throughput": 20170.662, "update_time_ms": 9.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005, "total_loss": 0.7659623622894287, "policy_loss": 5.569076545253182e-06, "vf_loss": 0.7800382971763611, "vf_explained_var": -0.0005654692649841309, "kl": 1.8570005831275438e-05, "entropy": 1.408143699169159, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 25, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-54-31", "timestamp": 1702709671, "time_this_iter_s": 9.451658248901367, "time_total_s": 243.50128841400146, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4815b430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 243.50128841400146, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.849999999999998, "ram_util_percent": 37.25, "gpu_util_percent0": 0.015, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -170.19275423890133, "episode_reward_min": -753.250948541338, "episode_reward_mean": -315.66039270305265, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-728.3819228056439, -736.7285333386284, -688.8739267343778, -733.6782388120088, -753.250948541338, -662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396186268051175, "mean_inference_ms": 1.20078832550671, "mean_action_processing_ms": 0.08948192636293069, "mean_env_wait_ms": 0.5651998760680188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 9553.738, "sample_throughput": 2093.421, "load_time_ms": 0.259, "load_throughput": 77292988.114, "learn_time_ms": 979.95, "learn_throughput": 20409.205, "update_time_ms": 9.082}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 0.6261506974697113, "policy_loss": -0.00010418987112359446, "vf_loss": 0.6404477655887604, "vf_explained_var": 0.00034552812576293945, "kl": 3.728577274397793e-05, "entropy": 1.419281780719757, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 105, "training_iteration": 26, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-54-41", "timestamp": 1702709681, "time_this_iter_s": 9.514324426651001, "time_total_s": 253.01561284065247, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48096310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 253.01561284065247, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.061538461538458, "ram_util_percent": 37.26923076923077, "gpu_util_percent0": 0.02230769230769231, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -169.67423286318675, "episode_reward_min": -696.2777869622394, "episode_reward_mean": -287.859187776567, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-662.8923014912629, -693.2722321565037, -668.3626462279587, -696.2777869622394, -638.3054922116851, -615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33942314655982886, "mean_inference_ms": 1.200104708258557, "mean_action_processing_ms": 0.08939703345680078, "mean_env_wait_ms": 0.5648056330200817, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 9523.096, "sample_throughput": 2100.157, "load_time_ms": 0.252, "load_throughput": 79460149.664, "learn_time_ms": 977.875, "learn_throughput": 20452.505, "update_time_ms": 9.162}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 0.6307558119297028, "policy_loss": -7.51644137197971e-05, "vf_loss": 0.6451689302921295, "vf_explained_var": -0.0003590583801269531, "kl": 9.341405490559396e-05, "entropy": 1.4337943196296692, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 110, "training_iteration": 27, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-54-50", "timestamp": 1702709690, "time_this_iter_s": 9.562355756759644, "time_total_s": 262.5779685974121, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482381f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 262.5779685974121, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 29.823076923076925, "ram_util_percent": 37.26923076923077, "gpu_util_percent0": 0.006923076923076924, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -169.67423286318675, "episode_reward_min": -638.5007704253295, "episode_reward_mean": -262.8720092528217, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-615.075766520897, -609.6711746111678, -638.5007704253295, -601.1809723292331, -634.4794621219661, -577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3388796204481976, "mean_inference_ms": 1.1980827941201582, "mean_action_processing_ms": 0.08922229158933033, "mean_env_wait_ms": 0.5639037593900305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 9510.485, "sample_throughput": 2102.942, "load_time_ms": 0.252, "load_throughput": 79437575.758, "learn_time_ms": 977.274, "learn_throughput": 20465.088, "update_time_ms": 9.201}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 0.6923834681510925, "policy_loss": -0.0001371568672361434, "vf_loss": 0.7069976031780243, "vf_explained_var": -0.00015658140182495117, "kl": 0.0001491106636581918, "entropy": 1.447700560092926, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 115, "training_iteration": 28, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-00", "timestamp": 1702709700, "time_this_iter_s": 9.438257694244385, "time_total_s": 272.0162262916565, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 272.0162262916565, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.624999999999996, "ram_util_percent": 37.35, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -169.67423286318675, "episode_reward_min": -593.0904353446616, "episode_reward_mean": -240.66339980082324, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-577.3704243923443, -548.029136499489, -563.4319093529276, -561.5273169212946, -593.0904353446616, -442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3381124403506115, "mean_inference_ms": 1.195359523836724, "mean_action_processing_ms": 0.08900434360007896, "mean_env_wait_ms": 0.5628667358305705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 9510.954, "sample_throughput": 2102.839, "load_time_ms": 0.252, "load_throughput": 79242471.188, "learn_time_ms": 977.097, "learn_throughput": 20468.803, "update_time_ms": 8.287}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005, "total_loss": 0.6674478054046631, "policy_loss": -0.0003158525324433725, "vf_loss": 0.6823534071445465, "vf_explained_var": -0.00016820430755615234, "kl": 0.00027626396730040526, "entropy": 1.4589762687683105, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 29, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-09", "timestamp": 1702709709, "time_this_iter_s": 9.494166851043701, "time_total_s": 281.5103931427002, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 281.5103931427002, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.900000000000002, "ram_util_percent": 37.323076923076925, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -504.7342900533669, "episode_reward_mean": -221.09912254399242, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33744985597519017, "mean_inference_ms": 1.1928889461326786, "mean_action_processing_ms": 0.08879553357709234, "mean_env_wait_ms": 0.5619390270956133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 9509.44, "sample_throughput": 2103.173, "load_time_ms": 0.253, "load_throughput": 79070675.841, "learn_time_ms": 976.494, "learn_throughput": 20481.444, "update_time_ms": 8.293}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005, "total_loss": 0.6844559609889984, "policy_loss": 0.00015926704353187715, "vf_loss": 0.6989176273345947, "vf_explained_var": -0.0004245638847351074, "kl": 0.00022026298385391385, "entropy": 1.4621005654335022, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 30, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-19", "timestamp": 1702709719, "time_this_iter_s": 9.529557228088379, "time_total_s": 291.0399503707886, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 291.0399503707886, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.141666666666666, "ram_util_percent": 37.625, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -504.7342900533669, "episode_reward_mean": -221.09912254399242, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-442.59906942908725, -467.99179259604153, -490.39938781910246, -504.7342900533669, -474.6879491668435, -398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33744985597519017, "mean_inference_ms": 1.1928889461326786, "mean_action_processing_ms": 0.08879553357709234, "mean_env_wait_ms": 0.5619390270956133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 9520.337, "sample_throughput": 2100.766, "load_time_ms": 0.255, "load_throughput": 78471543.499, "learn_time_ms": 979.22, "learn_throughput": 20424.427, "update_time_ms": 8.331}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005, "total_loss": 0.6061280071735382, "policy_loss": -5.110054133083963e-05, "vf_loss": 0.6208107173442841, "vf_explained_var": -0.0004304051399230957, "kl": 9.420968904993998e-05, "entropy": 1.463166892528534, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 125, "training_iteration": 31, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-28", "timestamp": 1702709728, "time_this_iter_s": 9.593831062316895, "time_total_s": 300.63378143310547, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4825ce50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 300.63378143310547, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.83076923076923, "ram_util_percent": 37.5, "gpu_util_percent0": 0.01076923076923077, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -422.8672607355851, "episode_reward_mean": -206.07728512718015, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-398.4954868546745, -389.01013832723726, -422.8672607355851, -392.8475339454352, -405.62472570971426, -365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3370775594038538, "mean_inference_ms": 1.1912934242680544, "mean_action_processing_ms": 0.08865093135892636, "mean_env_wait_ms": 0.5613595920115703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 9529.935, "sample_throughput": 2098.65, "load_time_ms": 0.24, "load_throughput": 83278149.509, "learn_time_ms": 980.806, "learn_throughput": 20391.397, "update_time_ms": 8.342}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0005, "total_loss": 0.6336669325828552, "policy_loss": -8.752002500700407e-05, "vf_loss": 0.6483564078807831, "vf_explained_var": 9.828805923461914e-05, "kl": 8.609648716539908e-05, "entropy": 1.4601935148239136, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 130, "training_iteration": 32, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-38", "timestamp": 1702709738, "time_this_iter_s": 9.519440412521362, "time_total_s": 310.15322184562683, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 310.15322184562683, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.88461538461539, "ram_util_percent": 37.44615384615385, "gpu_util_percent0": 0.016153846153846154, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -365.6656381285341, "episode_reward_mean": -194.85740414363192, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-365.6656381285341, -338.02912303890446, -329.2268029291836, -365.52738178968536, -358.3096771068748, -254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33677000927237416, "mean_inference_ms": 1.190025901085846, "mean_action_processing_ms": 0.08853383389008056, "mean_env_wait_ms": 0.5608493986031567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 9536.728, "sample_throughput": 2097.155, "load_time_ms": 0.24, "load_throughput": 83360906.29, "learn_time_ms": 981.069, "learn_throughput": 20385.92, "update_time_ms": 8.202}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0005, "total_loss": 0.7023330330848694, "policy_loss": -5.588283553947804e-05, "vf_loss": 0.7169588804244995, "vf_explained_var": -0.00031447410583496094, "kl": 7.664205247515099e-05, "entropy": 1.4569925665855408, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 135, "training_iteration": 33, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-47", "timestamp": 1702709747, "time_this_iter_s": 9.583913326263428, "time_total_s": 319.73713517189026, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 319.73713517189026, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 29.91666666666667, "ram_util_percent": 37.50833333333333, "gpu_util_percent0": 0.013333333333333334, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -308.6622682217128, "episode_reward_mean": -186.21220271882316, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.20975068407736, -279.3723546374464, -300.30269298621226, -308.6622682217128, -272.1212852039182, -250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3364459073641688, "mean_inference_ms": 1.1886817311837035, "mean_action_processing_ms": 0.08841413095144782, "mean_env_wait_ms": 0.5603229795520269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 9544.167, "sample_throughput": 2095.521, "load_time_ms": 0.232, "load_throughput": 86143027.316, "learn_time_ms": 978.611, "learn_throughput": 20437.138, "update_time_ms": 8.227}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0005, "total_loss": 0.6576638221740723, "policy_loss": -0.00011057147995963135, "vf_loss": 0.6722871363162994, "vf_explained_var": -0.00032341480255126953, "kl": 6.873667169582376e-05, "entropy": 1.45127272605896, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 34, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-55-57", "timestamp": 1702709757, "time_this_iter_s": 9.462095737457275, "time_total_s": 329.19923090934753, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 329.19923090934753, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 29.44615384615385, "ram_util_percent": 37.63076923076924, "gpu_util_percent0": 0.01076923076923077, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -250.6384951418651, "episode_reward_mean": -180.85832503597965, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-250.6384951418651, -205.6151262613657, -237.84950963664477, -237.97008164791188, -242.1147449179255, -185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33615624609802053, "mean_inference_ms": 1.1875100079587915, "mean_action_processing_ms": 0.0883045807567099, "mean_env_wait_ms": 0.5598547205409861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 9552.12, "sample_throughput": 2093.776, "load_time_ms": 0.233, "load_throughput": 85957659.596, "learn_time_ms": 981.051, "learn_throughput": 20386.309, "update_time_ms": 8.206}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0005, "total_loss": 0.5816273391246796, "policy_loss": -1.9760323080930675e-05, "vf_loss": 0.5961080491542816, "vf_explained_var": 0.0002963542938232422, "kl": 4.3898191654623275e-05, "entropy": 1.446096956729889, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 145, "training_iteration": 35, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-56-07", "timestamp": 1702709767, "time_this_iter_s": 9.578665971755981, "time_total_s": 338.7778968811035, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 338.7778968811035, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 29.953846153846158, "ram_util_percent": 37.69230769230769, "gpu_util_percent0": 0.008461538461538463, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -229.33333369310697, "episode_reward_mean": -177.85212920957775, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359329741378114, "mean_inference_ms": 1.1865406412462296, "mean_action_processing_ms": 0.08820850163894316, "mean_env_wait_ms": 0.5594263611009529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 9559.067, "sample_throughput": 2092.254, "load_time_ms": 0.23, "load_throughput": 87081988.996, "learn_time_ms": 982.34, "learn_throughput": 20359.541, "update_time_ms": 8.269}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0005, "total_loss": 0.5558009743690491, "policy_loss": -6.0672567744002315e-05, "vf_loss": 0.5703595578670502, "vf_explained_var": -0.0003376603126525879, "kl": 3.899344829605411e-05, "entropy": 1.4497942328453064, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 36, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-56-16", "timestamp": 1702709776, "time_this_iter_s": 9.571792364120483, "time_total_s": 348.349689245224, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 348.349689245224, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.149999999999995, "ram_util_percent": 37.57500000000001, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -168.19758172835492, "episode_reward_min": -229.33333369310697, "episode_reward_mean": -177.85212920957775, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.16109898396962, -216.54818345604426, -215.64695778795968, -229.33333369310697, -183.98999855964635, -204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359329741378114, "mean_inference_ms": 1.1865406412462296, "mean_action_processing_ms": 0.08820850163894316, "mean_env_wait_ms": 0.5594263611009529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 9561.281, "sample_throughput": 2091.77, "load_time_ms": 0.229, "load_throughput": 87435980.821, "learn_time_ms": 982.609, "learn_throughput": 20353.981, "update_time_ms": 8.348}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0005, "total_loss": 0.4559851139783859, "policy_loss": -1.0869407924829488e-05, "vf_loss": 0.4705452620983124, "vf_explained_var": -0.0015848278999328613, "kl": 2.087822719754051e-05, "entropy": 1.4549323320388794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 37, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-56-26", "timestamp": 1702709786, "time_this_iter_s": 9.573710203170776, "time_total_s": 357.9233994483948, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 357.9233994483948, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 29.961538461538456, "ram_util_percent": 37.792307692307695, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -167.27361212318837, "episode_reward_min": -204.24568142868569, "episode_reward_mean": -176.334318289682, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.24568142868569, -196.7459179010602, -188.03163172168112, -183.34230581822158, -196.0065636243327, -170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357348807552942, "mean_inference_ms": 1.1857078611619294, "mean_action_processing_ms": 0.08811850480926411, "mean_env_wait_ms": 0.5590099496153677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 9573.559, "sample_throughput": 2089.087, "load_time_ms": 0.229, "load_throughput": 87354035.197, "learn_time_ms": 983.875, "learn_throughput": 20327.792, "update_time_ms": 8.395}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0005, "total_loss": 0.5083474218845367, "policy_loss": -0.00019892959299028234, "vf_loss": 0.5231900811195374, "vf_explained_var": -0.0002818107604980469, "kl": 8.094516613499358e-05, "entropy": 1.4643707275390625, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 155, "training_iteration": 38, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-56-35", "timestamp": 1702709795, "time_this_iter_s": 9.570842027664185, "time_total_s": 367.49424147605896, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 367.49424147605896, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.146153846153844, "ram_util_percent": 37.823076923076925, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -166.70626272210578, "episode_reward_min": -195.69861865266762, "episode_reward_mean": -175.25361355145253, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.29132114495525, -195.69861865266762, -170.19275423890133, -174.91109384662786, -171.77225076323356, -180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3354097692729392, "mean_inference_ms": 1.1844718346517844, "mean_action_processing_ms": 0.08800165964707965, "mean_env_wait_ms": 0.5584179083157894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 9579.963, "sample_throughput": 2087.691, "load_time_ms": 0.229, "load_throughput": 87417757.399, "learn_time_ms": 985.024, "learn_throughput": 20304.077, "update_time_ms": 8.368}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0005, "total_loss": 0.6135221421718597, "policy_loss": 8.545779883917248e-05, "vf_loss": 0.6282896399497986, "vf_explained_var": -0.00014144182205200195, "kl": 0.00010489055510998213, "entropy": 1.4852959513664246, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 39, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-56-45", "timestamp": 1702709805, "time_this_iter_s": 9.555148839950562, "time_total_s": 377.0493903160095, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 377.0493903160095, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.875, "ram_util_percent": 37.833333333333336, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -166.70626272210578, "episode_reward_min": -196.42822944611393, "episode_reward_mean": -175.769866676434, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.56454554352217, -175.54344236287594, -175.14813233264164, -178.4541071614889, -171.81312975961868, -176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33506668333838524, "mean_inference_ms": 1.1832409965893136, "mean_action_processing_ms": 0.08788626802529194, "mean_env_wait_ms": 0.5578072627432374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 9585.855, "sample_throughput": 2086.408, "load_time_ms": 0.238, "load_throughput": 84206063.04, "learn_time_ms": 984.914, "learn_throughput": 20306.332, "update_time_ms": 8.44}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0005, "total_loss": 0.7933682799339294, "policy_loss": 8.65686451785308e-05, "vf_loss": 0.8083087801933289, "vf_explained_var": -0.0005664825439453125, "kl": 3.800659628572234e-05, "entropy": 1.502707064151764, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 165, "training_iteration": 40, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-56-55", "timestamp": 1702709815, "time_this_iter_s": 9.576367139816284, "time_total_s": 386.6257574558258, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 386.6257574558258, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.61538461538461, "ram_util_percent": 37.87692307692308, "gpu_util_percent0": 0.011538461538461537, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -166.70626272210578, "episode_reward_min": -196.42822944611393, "episode_reward_mean": -176.13035698631734, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.2476262068382, -174.1948090090405, -172.34515537056268, -178.22003840718313, -175.13290884729255, -173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33473173169262294, "mean_inference_ms": 1.1819917846523766, "mean_action_processing_ms": 0.08777428786122828, "mean_env_wait_ms": 0.5572295961162596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 9579.233, "sample_throughput": 2087.85, "load_time_ms": 0.234, "load_throughput": 85354171.754, "learn_time_ms": 985.077, "learn_throughput": 20302.99, "update_time_ms": 8.492}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0005, "total_loss": 0.6359358429908752, "policy_loss": -9.604950291119962e-05, "vf_loss": 0.6511240601539612, "vf_explained_var": -0.0005013942718505859, "kl": 4.315261552290117e-05, "entropy": 1.5092169046401978, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 41, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-57-04", "timestamp": 1702709824, "time_this_iter_s": 9.530345439910889, "time_total_s": 396.1561028957367, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 396.1561028957367, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.969230769230766, "ram_util_percent": 37.96923076923077, "gpu_util_percent0": 0.006923076923076922, "vram_util_percent0": 0.016276041666666664}}
{"episode_reward_max": -166.70626272210578, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -176.66927427504055, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33443078579227425, "mean_inference_ms": 1.180848714833384, "mean_action_processing_ms": 0.08766992165275271, "mean_env_wait_ms": 0.5566769388067296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 9585.025, "sample_throughput": 2086.588, "load_time_ms": 0.234, "load_throughput": 85415008.655, "learn_time_ms": 985.388, "learn_throughput": 20296.568, "update_time_ms": 8.491}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0005, "total_loss": 0.6753809750080109, "policy_loss": -0.0001408432014518013, "vf_loss": 0.690669059753418, "vf_explained_var": -0.00039696693420410156, "kl": 0.00013576161102890616, "entropy": 1.5147194862365723, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 42, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-57-14", "timestamp": 1702709834, "time_this_iter_s": 9.57676911354065, "time_total_s": 405.73287200927734, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cddc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 405.73287200927734, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.141666666666666, "ram_util_percent": 38.05833333333334, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.016140407986111112}}
{"episode_reward_max": -166.70626272210578, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -176.66927427504055, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.72914715031536, -173.0031965143394, -175.08174121571, -178.32981940279853, -173.97921565983742, -183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33443078579227425, "mean_inference_ms": 1.180848714833384, "mean_action_processing_ms": 0.08766992165275271, "mean_env_wait_ms": 0.5566769388067296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"sample_time_ms": 9586.128, "sample_throughput": 2086.348, "load_time_ms": 0.246, "load_throughput": 81182696.216, "learn_time_ms": 984.676, "learn_throughput": 20311.246, "update_time_ms": 8.514}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0005, "total_loss": 0.4378714859485626, "policy_loss": 2.311878270155887e-05, "vf_loss": 0.4530573636293411, "vf_explained_var": -0.00164031982421875, "kl": 9.778413268084207e-05, "entropy": 1.5209060311317444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 860000, "num_steps_trained": 860000, "num_agent_steps_trained": 860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 175, "training_iteration": 43, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-57-23", "timestamp": 1702709843, "time_this_iter_s": 9.587769746780396, "time_total_s": 415.32064175605774, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 415.32064175605774, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.307692307692307, "ram_util_percent": 37.95384615384615, "gpu_util_percent0": 0.01846153846153846, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -176.91671362582395, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.8980602559542, -177.84044639999337, -176.90421829320925, -176.9814804447102, -174.43600623474916, -174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33419783828617183, "mean_inference_ms": 1.1798816055505754, "mean_action_processing_ms": 0.08758129425776964, "mean_env_wait_ms": 0.5562110386767884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 9591.611, "sample_throughput": 2085.155, "load_time_ms": 0.246, "load_throughput": 81151281.803, "learn_time_ms": 987.338, "learn_throughput": 20256.484, "update_time_ms": 8.746}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0005, "total_loss": 0.5623454451560974, "policy_loss": -0.00019847011882800913, "vf_loss": 0.577691376209259, "vf_explained_var": 3.713369369506836e-05, "kl": 0.00011897226984025622, "entropy": 1.5147401094436646, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 880000, "num_steps_trained": 880000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 44, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-57-33", "timestamp": 1702709853, "time_this_iter_s": 9.579947233200073, "time_total_s": 424.9005889892578, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 424.9005889892578, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.915384615384617, "ram_util_percent": 38.03846153846154, "gpu_util_percent0": 0.006923076923076922, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -176.9080413017239, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.6798603877068, -175.24185858837774, -175.68086640379798, -172.30214746949318, -174.67920717143704, -174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33398264601706834, "mean_inference_ms": 1.1790315802734663, "mean_action_processing_ms": 0.08750131210641948, "mean_env_wait_ms": 0.555778070684848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 9599.712, "sample_throughput": 2083.396, "load_time_ms": 0.246, "load_throughput": 81277085.554, "learn_time_ms": 984.789, "learn_throughput": 20308.913, "update_time_ms": 8.787}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0005, "total_loss": 0.6580500304698944, "policy_loss": 7.817058574888236e-05, "vf_loss": 0.6730609834194183, "vf_explained_var": -0.00045037269592285156, "kl": 0.00010552690504767037, "entropy": 1.5089035630226135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 185, "training_iteration": 45, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-57-43", "timestamp": 1702709863, "time_this_iter_s": 9.601043939590454, "time_total_s": 434.50163292884827, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 434.50163292884827, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 29.999999999999996, "ram_util_percent": 38.00833333333333, "gpu_util_percent0": 0.010833333333333334, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -177.27212211346654, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.1807108957562, -172.59545850507112, -171.7280480272718, -173.90706416460927, -174.19832902623625, -172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3337891677402131, "mean_inference_ms": 1.1782702770344455, "mean_action_processing_ms": 0.08742810462365705, "mean_env_wait_ms": 0.5554014200280617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"sample_time_ms": 9602.106, "sample_throughput": 2082.876, "load_time_ms": 0.249, "load_throughput": 80273760.766, "learn_time_ms": 984.604, "learn_throughput": 20312.736, "update_time_ms": 8.725}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0005, "total_loss": 0.6129080355167389, "policy_loss": -1.6485595127235797e-05, "vf_loss": 0.6279790997505188, "vf_explained_var": -0.0005671977996826172, "kl": 3.7511881935792246e-05, "entropy": 1.5054545998573303, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 920000, "num_steps_trained": 920000, "num_agent_steps_trained": 920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 46, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-57-52", "timestamp": 1702709872, "time_this_iter_s": 9.619159936904907, "time_total_s": 444.1207928657532, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 444.1207928657532, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.73076923076923, "ram_util_percent": 38.199999999999996, "gpu_util_percent0": 0.013076923076923078, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -177.69506381821208, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.19180510139165, -174.93453352485355, -178.39999226626836, -173.1069066716085, -173.2087350229544, -177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3336101479713565, "mean_inference_ms": 1.1775586057701637, "mean_action_processing_ms": 0.0873592584063026, "mean_env_wait_ms": 0.5550738973294823, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"sample_time_ms": 9607.871, "sample_throughput": 2081.627, "load_time_ms": 0.248, "load_throughput": 80597694.081, "learn_time_ms": 987.907, "learn_throughput": 20244.825, "update_time_ms": 8.671}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0005, "total_loss": 0.5115945041179657, "policy_loss": -4.9151802814506595e-05, "vf_loss": 0.526665598154068, "vf_explained_var": -1.6868114471435547e-05, "kl": 1.7057329280589784e-05, "entropy": 1.502194344997406, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 940000, "num_steps_trained": 940000, "num_agent_steps_trained": 940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 195, "training_iteration": 47, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-58-02", "timestamp": 1702709882, "time_this_iter_s": 9.668049812316895, "time_total_s": 453.78884267807007, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcdc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 453.78884267807007, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 29.88461538461538, "ram_util_percent": 38.15384615384615, "gpu_util_percent0": 0.007692307692307693, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -178.0986892445874, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33346160262357094, "mean_inference_ms": 1.1769213859233758, "mean_action_processing_ms": 0.08729813331357175, "mean_env_wait_ms": 0.5547885437860206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 9615.22, "sample_throughput": 2080.036, "load_time_ms": 0.248, "load_throughput": 80729554.422, "learn_time_ms": 988.955, "learn_throughput": 20223.369, "update_time_ms": 8.597}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0005, "total_loss": 0.581812858581543, "policy_loss": -1.4997482075784774e-05, "vf_loss": 0.5968576669692993, "vf_explained_var": 9.182095527648926e-05, "kl": 3.417298112040612e-05, "entropy": 1.5029810070991516, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 48, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-58-12", "timestamp": 1702709892, "time_this_iter_s": 9.619421243667603, "time_total_s": 463.40826392173767, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 463.40826392173767, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.133333333333336, "ram_util_percent": 38.10000000000001, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -178.0986892445874, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.31022592019985, -175.68611632022996, -173.8529298947573, -173.01120613043892, -174.12436584872472, -172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33346160262357094, "mean_inference_ms": 1.1769213859233758, "mean_action_processing_ms": 0.08729813331357175, "mean_env_wait_ms": 0.5547885437860206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"sample_time_ms": 9617.772, "sample_throughput": 2079.484, "load_time_ms": 0.262, "load_throughput": 76232351.872, "learn_time_ms": 989.052, "learn_throughput": 20221.376, "update_time_ms": 8.61}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0005, "total_loss": 0.3071353882551193, "policy_loss": -2.65426634982191e-06, "vf_loss": 0.322232261300087, "vf_explained_var": -0.0009335875511169434, "kl": 3.5708867256234456e-05, "entropy": 1.509421944618225, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 980000, "num_steps_trained": 980000, "num_agent_steps_trained": 980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 49, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-58-21", "timestamp": 1702709901, "time_this_iter_s": 9.568926334381104, "time_total_s": 472.9771902561188, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d484190d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 472.9771902561188, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.26923076923077, "ram_util_percent": 38.33846153846153, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -178.2942545908502, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.29519755093997, -171.83368083126942, -174.06910534713566, -169.67423286318675, -172.92086099089806, -170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3333605553752937, "mean_inference_ms": 1.1764019184835535, "mean_action_processing_ms": 0.08724790535773888, "mean_env_wait_ms": 0.5545331893381598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"sample_time_ms": 9622.156, "sample_throughput": 2078.536, "load_time_ms": 0.253, "load_throughput": 79115420.164, "learn_time_ms": 990.896, "learn_throughput": 20183.745, "update_time_ms": 8.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0005, "total_loss": 0.7098560631275177, "policy_loss": 4.3293763144269803e-05, "vf_loss": 0.7249661684036255, "vf_explained_var": -0.0003166794776916504, "kl": 8.152636798985924e-06, "entropy": 1.5153349041938782, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 1000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 1000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -167.49035107635493, "episode_reward_min": -197.87964079741428, "episode_reward_mean": -180.2162226817147, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.69174916599195, -197.87964079741428, -167.49035107635493, -193.4422522169628, -177.16396945160466, -185.18719781727748, -180.11555950258443, -174.90446155869705, -169.22372321855946, -173.06332201170022], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3012857664601155, "mean_inference_ms": 1.2068945148961887, "mean_action_processing_ms": 0.0853447128914133, "mean_env_wait_ms": 0.5465524294217196, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 205, "training_iteration": 50, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-58-51", "timestamp": 1702709931, "time_this_iter_s": 30.23846459388733, "time_total_s": 503.2156548500061, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481beee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 503.2156548500061, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.445000000000004, "ram_util_percent": 38.3725, "gpu_util_percent0": 0.0052499999999999995, "vram_util_percent0": 0.01612955729166667}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.08007926904554, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.822148868645, -172.1971799593126, -171.51386365633456, -174.80113962003813, -171.05827457078834, -172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3332930158025695, "mean_inference_ms": 1.1760151975187534, "mean_action_processing_ms": 0.08720870220474039, "mean_env_wait_ms": 0.5543302373178759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1020000, "timesteps_this_iter": 0, "agent_timesteps_total": 1020000, "timers": {"sample_time_ms": 11763.614, "sample_throughput": 1700.158, "load_time_ms": 0.266, "load_throughput": 75160003.584, "learn_time_ms": 991.833, "learn_throughput": 20164.694, "update_time_ms": 8.519}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0005, "total_loss": 0.6022303104400635, "policy_loss": -6.13124866388759e-05, "vf_loss": 0.6174291372299194, "vf_explained_var": -0.0004048347473144531, "kl": 1.808867673391834e-05, "entropy": 1.5137509107589722, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1020000, "num_agent_steps_sampled": 1020000, "num_steps_trained": 1020000, "num_agent_steps_trained": 1020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 210, "training_iteration": 51, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-59-02", "timestamp": 1702709942, "time_this_iter_s": 10.315192699432373, "time_total_s": 513.5308475494385, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481bed30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 513.5308475494385, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.300000000000004, "ram_util_percent": 38.35384615384615, "gpu_util_percent0": 0.036153846153846154, "vram_util_percent0": 0.016163361378205128}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.7700543395057, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.2291933324095, -175.6339744995668, -170.05372628625216, -179.1089853857489, -181.0213213047711, -178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3332637075065915, "mean_inference_ms": 1.1757748125912368, "mean_action_processing_ms": 0.08718022574683833, "mean_env_wait_ms": 0.5541971127662164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1040000, "timesteps_this_iter": 0, "agent_timesteps_total": 1040000, "timers": {"sample_time_ms": 11838.666, "sample_throughput": 1689.38, "load_time_ms": 0.267, "load_throughput": 74992025.746, "learn_time_ms": 1000.637, "learn_throughput": 19987.268, "update_time_ms": 8.719}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0005, "total_loss": 0.6778510212898254, "policy_loss": -8.362750924462148e-05, "vf_loss": 0.6930325329303741, "vf_explained_var": -0.0003139972686767578, "kl": 4.3548501547086005e-05, "entropy": 1.5097913146018982, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1040000, "num_agent_steps_sampled": 1040000, "num_steps_trained": 1040000, "num_agent_steps_trained": 1040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 215, "training_iteration": 52, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-59-12", "timestamp": 1702709952, "time_this_iter_s": 10.37097692489624, "time_total_s": 523.9018244743347, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 523.9018244743347, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 35.72857142857142, "ram_util_percent": 38.385714285714286, "gpu_util_percent0": 0.08714285714285716, "vram_util_percent0": 0.016206287202380952}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -180.30015466594057, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.4520567104117, -178.11877258786012, -172.6105769321861, -189.64250886881956, -168.19758172835492, -176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33326526121686667, "mean_inference_ms": 1.1756652266045255, "mean_action_processing_ms": 0.0871605024466971, "mean_env_wait_ms": 0.5541117448021656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1060000, "timesteps_this_iter": 0, "agent_timesteps_total": 1060000, "timers": {"sample_time_ms": 11911.681, "sample_throughput": 1679.024, "load_time_ms": 0.254, "load_throughput": 78766272.3, "learn_time_ms": 1003.196, "learn_throughput": 19936.288, "update_time_ms": 8.707}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0005, "total_loss": 0.5102273225784302, "policy_loss": -9.648771007775281e-05, "vf_loss": 0.5253531336784363, "vf_explained_var": -0.0007305741310119629, "kl": 6.789529328976585e-05, "entropy": 1.502928912639618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1060000, "num_agent_steps_sampled": 1060000, "num_steps_trained": 1060000, "num_agent_steps_trained": 1060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 53, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-59-22", "timestamp": 1702709962, "time_this_iter_s": 10.238208055496216, "time_total_s": 534.1400325298309, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482bf550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 534.1400325298309, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 34.10000000000001, "ram_util_percent": 38.48461538461538, "gpu_util_percent0": 0.06538461538461539, "vram_util_percent0": 0.016163361378205128}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -180.00250854530788, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3333036147341419, "mean_inference_ms": 1.1756958727198696, "mean_action_processing_ms": 0.0871482321938055, "mean_env_wait_ms": 0.5540705443493269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1080000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 11996.517, "sample_throughput": 1667.151, "load_time_ms": 0.309, "load_throughput": 64741900.131, "learn_time_ms": 1010.176, "learn_throughput": 19798.531, "update_time_ms": 8.53}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0005, "total_loss": 0.5124944746494293, "policy_loss": -3.9750290184770165e-05, "vf_loss": 0.5274319350719452, "vf_explained_var": -0.0004792213439941406, "kl": 8.943254885362961e-05, "entropy": 1.4897659420967102, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1080000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 1080000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 225, "training_iteration": 54, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-59-33", "timestamp": 1702709973, "time_this_iter_s": 10.471911191940308, "time_total_s": 544.6119437217712, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482bfee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 544.6119437217712, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 35.792857142857144, "ram_util_percent": 38.55714285714286, "gpu_util_percent0": 0.08785714285714286, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -180.00250854530788, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.70051304997588, -169.79599248089318, -172.20567268680193, -183.1565671462389, -176.37000201930655, -170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3333036147341419, "mean_inference_ms": 1.1756958727198696, "mean_action_processing_ms": 0.0871482321938055, "mean_env_wait_ms": 0.5540705443493269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1100000, "timesteps_this_iter": 0, "agent_timesteps_total": 1100000, "timers": {"sample_time_ms": 12077.143, "sample_throughput": 1656.021, "load_time_ms": 0.31, "load_throughput": 64572457.855, "learn_time_ms": 1013.08, "learn_throughput": 19741.785, "update_time_ms": 11.757}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0005, "total_loss": 0.1675773486495018, "policy_loss": -0.00013069819956967876, "vf_loss": 0.18251686543226242, "vf_explained_var": -0.002006053924560547, "kl": 0.00010718958103028697, "entropy": 1.4808824062347412, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1100000, "num_agent_steps_sampled": 1100000, "num_steps_trained": 1100000, "num_agent_steps_trained": 1100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 225, "training_iteration": 55, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-59-43", "timestamp": 1702709983, "time_this_iter_s": 10.405340433120728, "time_total_s": 555.017284154892, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 555.017284154892, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 35.6, "ram_util_percent": 38.42857142857142, "gpu_util_percent0": 0.13, "vram_util_percent0": 0.016159784226190476}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -180.0369756799535, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.56128341171006, -182.70749343314657, -183.00437385372842, -173.62644800143258, -176.9574485178089, -189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3334106577019618, "mean_inference_ms": 1.1759871591938218, "mean_action_processing_ms": 0.08715331676766029, "mean_env_wait_ms": 0.5541458985183916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1120000, "timesteps_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"sample_time_ms": 12190.308, "sample_throughput": 1640.648, "load_time_ms": 0.313, "load_throughput": 63801399.452, "learn_time_ms": 1014.907, "learn_throughput": 19706.234, "update_time_ms": 11.811}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0005, "total_loss": 0.48151154816150665, "policy_loss": 4.6677781961435016e-05, "vf_loss": 0.4961990714073181, "vf_explained_var": -2.6226043701171875e-06, "kl": 5.721238009703811e-05, "entropy": 1.4734206199645996, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1120000, "num_agent_steps_sampled": 1120000, "num_steps_trained": 1120000, "num_agent_steps_trained": 1120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 230, "training_iteration": 56, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_12-59-54", "timestamp": 1702709994, "time_this_iter_s": 10.667625665664673, "time_total_s": 565.6849098205566, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 565.6849098205566, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 38.107142857142854, "ram_util_percent": 38.642857142857146, "gpu_util_percent0": 0.09785714285714286, "vram_util_percent0": 0.016171409970238096}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.72635799123938, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.26245561165885, -169.4208864940513, -172.4847225890128, -181.16160276865529, -179.90881304892807, -172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33352300731168844, "mean_inference_ms": 1.176299221697581, "mean_action_processing_ms": 0.08715663831374564, "mean_env_wait_ms": 0.5542162817735935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1140000, "timesteps_this_iter": 0, "agent_timesteps_total": 1140000, "timers": {"sample_time_ms": 12199.804, "sample_throughput": 1639.371, "load_time_ms": 0.316, "load_throughput": 63358066.465, "learn_time_ms": 1013.178, "learn_throughput": 19739.864, "update_time_ms": 11.781}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0005, "total_loss": 0.5404830574989319, "policy_loss": -4.2494486464317305e-05, "vf_loss": 0.5553171038627625, "vf_explained_var": -0.00011247396469116211, "kl": 2.4447647736985934e-05, "entropy": 1.4791563153266907, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1140000, "num_agent_steps_sampled": 1140000, "num_steps_trained": 1140000, "num_agent_steps_trained": 1140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 235, "training_iteration": 57, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-00-04", "timestamp": 1702710004, "time_this_iter_s": 9.659368991851807, "time_total_s": 575.3442788124084, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 575.3442788124084, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 30.000000000000004, "ram_util_percent": 38.45833333333333, "gpu_util_percent0": 0.0008333333333333334, "vram_util_percent0": 0.01611328125}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.55116477242183, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.79831425406596, -175.35695614168546, -168.52394803885886, -174.6056509559944, -187.99571405841218, -176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3336465118206825, "mean_inference_ms": 1.1766426595197044, "mean_action_processing_ms": 0.08716216392451548, "mean_env_wait_ms": 0.554305819070614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1160000, "timesteps_this_iter": 0, "agent_timesteps_total": 1160000, "timers": {"sample_time_ms": 12203.923, "sample_throughput": 1638.817, "load_time_ms": 0.316, "load_throughput": 63291142.297, "learn_time_ms": 1011.837, "learn_throughput": 19766.022, "update_time_ms": 11.913}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0005, "total_loss": 0.5129127502441406, "policy_loss": 4.112672909395432e-05, "vf_loss": 0.5278521478176117, "vf_explained_var": -0.0006294846534729004, "kl": 3.266135869972597e-05, "entropy": 1.4980520606040955, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1160000, "num_agent_steps_sampled": 1160000, "num_steps_trained": 1160000, "num_agent_steps_trained": 1160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 58, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-00-14", "timestamp": 1702710014, "time_this_iter_s": 9.66830563545227, "time_total_s": 585.0125844478607, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 585.0125844478607, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.16923076923077, "ram_util_percent": 38.738461538461536, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.016163361378205128}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.2922187750285, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.18985759658446, -173.67577192796958, -177.77773299490397, -176.52977854687583, -169.3952338991864, -187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3337839110718332, "mean_inference_ms": 1.1770453764751907, "mean_action_processing_ms": 0.0871720644831736, "mean_env_wait_ms": 0.5544156112496793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1180000, "timesteps_this_iter": 0, "agent_timesteps_total": 1180000, "timers": {"sample_time_ms": 12245.603, "sample_throughput": 1633.239, "load_time_ms": 0.302, "load_throughput": 66328836.878, "learn_time_ms": 1020.137, "learn_throughput": 19605.216, "update_time_ms": 12.086}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0005, "total_loss": 0.4076513200998306, "policy_loss": -2.838411276462338e-05, "vf_loss": 0.4228164851665497, "vf_explained_var": -0.0005740523338317871, "kl": 3.170817730668851e-05, "entropy": 1.5136764645576477, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1180000, "num_agent_steps_sampled": 1180000, "num_steps_trained": 1180000, "num_agent_steps_trained": 1180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 245, "training_iteration": 59, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-00-24", "timestamp": 1702710024, "time_this_iter_s": 10.080425262451172, "time_total_s": 595.0930097103119, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 595.0930097103119, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 33.7, "ram_util_percent": 38.61538461538462, "gpu_util_percent0": 0.023846153846153847, "vram_util_percent0": 0.016219701522435896}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.4946364509211, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3339537467317918, "mean_inference_ms": 1.1775530613987437, "mean_action_processing_ms": 0.08718829161269755, "mean_env_wait_ms": 0.5545681142754278, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1200000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 12330.462, "sample_throughput": 1621.999, "load_time_ms": 0.302, "load_throughput": 66260726.698, "learn_time_ms": 1019.367, "learn_throughput": 19620.019, "update_time_ms": 12.075}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0005, "total_loss": 0.6202854812145233, "policy_loss": -4.994087379883716e-05, "vf_loss": 0.6356223821640015, "vf_explained_var": -0.0001735687255859375, "kl": 4.631615006656098e-05, "entropy": 1.528695523738861, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1200000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 1200000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 250, "training_iteration": 60, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-00-34", "timestamp": 1702710034, "time_this_iter_s": 10.390140295028687, "time_total_s": 605.4831500053406, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482bf5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 605.4831500053406, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 34.95, "ram_util_percent": 38.58571428571429, "gpu_util_percent0": 0.03214285714285715, "vram_util_percent0": 0.016217912946428575}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -217.7296465537801, "episode_reward_mean": -179.4946364509211, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.26987720141227, -173.39495371083316, -179.31860431678763, -167.27361212318837, -171.641433138924, -170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3339537467317918, "mean_inference_ms": 1.1775530613987437, "mean_action_processing_ms": 0.08718829161269755, "mean_env_wait_ms": 0.5545681142754278, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1220000, "timesteps_this_iter": 0, "agent_timesteps_total": 1220000, "timers": {"sample_time_ms": 10190.227, "sample_throughput": 1962.665, "load_time_ms": 0.29, "load_throughput": 69064778.528, "learn_time_ms": 1020.418, "learn_throughput": 19599.814, "update_time_ms": 12.119}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0005, "total_loss": 0.39755159616470337, "policy_loss": -2.771825742353684e-05, "vf_loss": 0.4130082428455353, "vf_explained_var": -0.0005510449409484863, "kl": 5.528642939997552e-05, "entropy": 1.5428900122642517, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1220000, "num_agent_steps_sampled": 1220000, "num_steps_trained": 1220000, "num_agent_steps_trained": 1220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 250, "training_iteration": 61, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-00-44", "timestamp": 1702710044, "time_this_iter_s": 9.547401666641235, "time_total_s": 615.0305516719818, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 615.0305516719818, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 29.54166666666666, "ram_util_percent": 38.791666666666664, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -180.04112505440884, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.47459222953648, -171.0011322986897, -166.70626272210578, -174.75947725516866, -177.36016216554228, -174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33413021644265456, "mean_inference_ms": 1.1780716814803425, "mean_action_processing_ms": 0.08720533859649404, "mean_env_wait_ms": 0.5547192246361893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1240000, "timesteps_this_iter": 0, "agent_timesteps_total": 1240000, "timers": {"sample_time_ms": 10131.942, "sample_throughput": 1973.955, "load_time_ms": 0.29, "load_throughput": 69036359.147, "learn_time_ms": 1011.96, "learn_throughput": 19763.628, "update_time_ms": 11.99}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0005, "total_loss": 0.6273417770862579, "policy_loss": -5.470123303208396e-05, "vf_loss": 0.642673134803772, "vf_explained_var": -0.00024968385696411133, "kl": 6.66951428310858e-05, "entropy": 1.5276723504066467, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1240000, "num_agent_steps_sampled": 1240000, "num_steps_trained": 1240000, "num_agent_steps_trained": 1240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 255, "training_iteration": 62, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-00-53", "timestamp": 1702710053, "time_this_iter_s": 9.734183549880981, "time_total_s": 624.7647352218628, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 624.7647352218628, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 30.261538461538464, "ram_util_percent": 38.83076923076922, "gpu_util_percent0": 0.01076923076923077, "vram_util_percent0": 0.016000600961538464}}
{"episode_reward_max": -164.48303944630433, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -180.40209452558275, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.88993132973522, -196.42822944611393, -189.52144979413094, -182.00754697976546, -191.64419359478163, -176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33432313558215443, "mean_inference_ms": 1.178662057815271, "mean_action_processing_ms": 0.0872270273992135, "mean_env_wait_ms": 0.5548925721407201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1260000, "timesteps_this_iter": 0, "agent_timesteps_total": 1260000, "timers": {"sample_time_ms": 10113.176, "sample_throughput": 1977.618, "load_time_ms": 0.29, "load_throughput": 68979590.494, "learn_time_ms": 1011.722, "learn_throughput": 19768.279, "update_time_ms": 12.008}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0005, "total_loss": 0.5473509430885315, "policy_loss": -0.0001109918611938987, "vf_loss": 0.5625618100166321, "vf_explained_var": -0.0005206465721130371, "kl": 5.976615304428834e-05, "entropy": 1.5099859833717346, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1260000, "num_agent_steps_sampled": 1260000, "num_steps_trained": 1260000, "num_agent_steps_trained": 1260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 63, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-01-04", "timestamp": 1702710064, "time_this_iter_s": 10.143880128860474, "time_total_s": 634.9086153507233, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9740d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 634.9086153507233, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 33.853846153846156, "ram_util_percent": 38.93076923076923, "gpu_util_percent0": 0.05307692307692307, "vram_util_percent0": 0.016013120993589744}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.67985055061138, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.55009160812935, -184.35327812828098, -184.94320455724758, -191.06463882663473, -180.6611750281915, -179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33451977573075914, "mean_inference_ms": 1.1792596926127985, "mean_action_processing_ms": 0.08724706914170904, "mean_env_wait_ms": 0.5550649513867548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1280000, "timesteps_this_iter": 0, "agent_timesteps_total": 1280000, "timers": {"sample_time_ms": 10041.41, "sample_throughput": 1991.752, "load_time_ms": 0.236, "load_throughput": 84733414.141, "learn_time_ms": 1002.823, "learn_throughput": 19943.706, "update_time_ms": 11.966}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0005, "total_loss": 0.5604606866836548, "policy_loss": -3.068523225380204e-05, "vf_loss": 0.5754834115505219, "vf_explained_var": -0.0004423856735229492, "kl": 5.348316152731236e-05, "entropy": 1.4992094039916992, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1280000, "num_agent_steps_sampled": 1280000, "num_steps_trained": 1280000, "num_agent_steps_trained": 1280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 265, "training_iteration": 64, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-01-13", "timestamp": 1702710073, "time_this_iter_s": 9.663466930389404, "time_total_s": 644.5720822811127, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 644.5720822811127, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.300000000000008, "ram_util_percent": 38.88461538461537, "gpu_util_percent0": 0.0023076923076923075, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.3556124744016, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.45576305979364, -177.69665598569946, -217.7296465537801, -187.05175251666188, -168.09844859730455, -164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33471727845363125, "mean_inference_ms": 1.1798866058122013, "mean_action_processing_ms": 0.08726905745900951, "mean_env_wait_ms": 0.5552434982453665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1300000, "timesteps_this_iter": 0, "agent_timesteps_total": 1300000, "timers": {"sample_time_ms": 9969.93, "sample_throughput": 2006.032, "load_time_ms": 0.246, "load_throughput": 81269211.393, "learn_time_ms": 1002.128, "learn_throughput": 19957.536, "update_time_ms": 8.808}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0005, "total_loss": 0.4509003907442093, "policy_loss": -0.00013200808197755265, "vf_loss": 0.4659497141838074, "vf_explained_var": -0.0009171366691589355, "kl": 7.942811379541004e-05, "entropy": 1.4917290806770325, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1300000, "num_agent_steps_sampled": 1300000, "num_steps_trained": 1300000, "num_agent_steps_trained": 1300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 270, "training_iteration": 65, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-01-23", "timestamp": 1702710083, "time_this_iter_s": 9.742507457733154, "time_total_s": 654.3145897388458, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9b21f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 654.3145897388458, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.515384615384615, "ram_util_percent": 39.04615384615385, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.04176789312768, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33491873316274495, "mean_inference_ms": 1.180531432862417, "mean_action_processing_ms": 0.08729216097536203, "mean_env_wait_ms": 0.5554176031776636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1320000, "timesteps_this_iter": 0, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 9868.462, "sample_throughput": 2026.658, "load_time_ms": 0.243, "load_throughput": 82281589.014, "learn_time_ms": 1000.474, "learn_throughput": 19990.518, "update_time_ms": 8.794}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0005, "total_loss": 0.5998756587505341, "policy_loss": -0.00011916885395768517, "vf_loss": 0.6148248016834259, "vf_explained_var": -0.0007176995277404785, "kl": 0.00011396743979474877, "entropy": 1.4829971194267273, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1320000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 1320000, "num_agent_steps_trained": 1320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 275, "training_iteration": 66, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-01-33", "timestamp": 1702710093, "time_this_iter_s": 9.710376739501953, "time_total_s": 664.0249664783478, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 664.0249664783478, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.191666666666666, "ram_util_percent": 39.19166666666666, "gpu_util_percent0": 0.0033333333333333335, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.04176789312768, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.48303944630433, -178.06123371158088, -191.67323937913366, -178.92841140819462, -185.72113107612262, -182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33491873316274495, "mean_inference_ms": 1.180531432862417, "mean_action_processing_ms": 0.08729216097536203, "mean_env_wait_ms": 0.5554176031776636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1340000, "timesteps_this_iter": 0, "agent_timesteps_total": 1340000, "timers": {"sample_time_ms": 9860.946, "sample_throughput": 2028.203, "load_time_ms": 0.242, "load_throughput": 82670818.961, "learn_time_ms": 998.686, "learn_throughput": 20026.305, "update_time_ms": 8.819}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0005, "total_loss": 0.10441695526242256, "policy_loss": -0.00012549790660898452, "vf_loss": 0.11925642564892769, "vf_explained_var": -0.0023070573806762695, "kl": 0.00011557118499738728, "entropy": 1.4713966846466064, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1340000, "num_agent_steps_sampled": 1340000, "num_steps_trained": 1340000, "num_agent_steps_trained": 1340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 275, "training_iteration": 67, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-01-42", "timestamp": 1702710102, "time_this_iter_s": 9.649063348770142, "time_total_s": 673.6740298271179, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 673.6740298271179, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 30.046153846153842, "ram_util_percent": 39.33846153846154, "gpu_util_percent0": 0.0007692307692307692, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -178.63482958857182, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182.47658117720954, -170.99096703581276, -193.01846793379363, -169.11955853626523, -173.58740453552784, -201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3351193403040444, "mean_inference_ms": 1.1812019869385035, "mean_action_processing_ms": 0.08731297547466849, "mean_env_wait_ms": 0.5555778965687309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1360000, "timesteps_this_iter": 0, "agent_timesteps_total": 1360000, "timers": {"sample_time_ms": 9857.124, "sample_throughput": 2028.989, "load_time_ms": 0.244, "load_throughput": 81872028.109, "learn_time_ms": 1000.676, "learn_throughput": 19986.483, "update_time_ms": 8.818}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0005, "total_loss": 0.5816922783851624, "policy_loss": -4.033279292059433e-05, "vf_loss": 0.5962704122066498, "vf_explained_var": -0.0003409385681152344, "kl": 8.892358437950776e-05, "entropy": 1.4537856578826904, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1360000, "num_agent_steps_sampled": 1360000, "num_steps_trained": 1360000, "num_agent_steps_trained": 1360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 68, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-01-52", "timestamp": 1702710112, "time_this_iter_s": 9.665924549102783, "time_total_s": 683.3399543762207, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48117040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 683.3399543762207, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.192307692307686, "ram_util_percent": 39.30769230769231, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -178.47950424646726, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.5389693412805, -175.0357978929903, -192.30638529406735, -173.06990582111905, -167.04096284562365, -189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3353199750312201, "mean_inference_ms": 1.1818660441312017, "mean_action_processing_ms": 0.08733417027626617, "mean_env_wait_ms": 0.5557484933500347, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1380000, "timesteps_this_iter": 0, "agent_timesteps_total": 1380000, "timers": {"sample_time_ms": 9828.92, "sample_throughput": 2034.811, "load_time_ms": 0.245, "load_throughput": 81712526.787, "learn_time_ms": 990.695, "learn_throughput": 20187.839, "update_time_ms": 8.787}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0005, "total_loss": 0.5544301867485046, "policy_loss": -4.42785253458311e-05, "vf_loss": 0.5689155757427216, "vf_explained_var": -0.0002580881118774414, "kl": 6.904133720619932e-05, "entropy": 1.4441099166870117, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1380000, "num_agent_steps_sampled": 1380000, "num_steps_trained": 1380000, "num_agent_steps_trained": 1380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 285, "training_iteration": 69, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-02-02", "timestamp": 1702710122, "time_this_iter_s": 9.684274196624756, "time_total_s": 693.0242285728455, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 693.0242285728455, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 29.90833333333333, "ram_util_percent": 39.324999999999996, "gpu_util_percent0": 0.004166666666666667, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.94123488612263, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.45710114326326, -177.9002980125183, -192.68966889699993, -177.84640179209862, -171.01031124861734, -180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33552235630804644, "mean_inference_ms": 1.1825407835333825, "mean_action_processing_ms": 0.08735668052565014, "mean_env_wait_ms": 0.5559101530024168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1400000, "timesteps_this_iter": 0, "agent_timesteps_total": 1400000, "timers": {"sample_time_ms": 9752.614, "sample_throughput": 2050.732, "load_time_ms": 0.245, "load_throughput": 81768281.509, "learn_time_ms": 989.044, "learn_throughput": 20221.555, "update_time_ms": 8.905}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0005, "total_loss": 0.5125699937343597, "policy_loss": -5.89270595461322e-05, "vf_loss": 0.5271171033382416, "vf_explained_var": 0.00023806095123291016, "kl": 4.586070988366053e-05, "entropy": 1.4488168358802795, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1400000, "num_agent_steps_sampled": 1400000, "num_steps_trained": 1400000, "num_agent_steps_trained": 1400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 290, "training_iteration": 70, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-02-12", "timestamp": 1702710132, "time_this_iter_s": 9.714458227157593, "time_total_s": 702.738686800003, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d401aa3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 702.738686800003, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 29.73846153846154, "ram_util_percent": 39.46923076923076, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.4372306227481, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.1016402350697, -198.73748989425155, -176.33731551806733, -169.63393884359007, -187.39413073363295, -189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357269741239525, "mean_inference_ms": 1.1832524421829325, "mean_action_processing_ms": 0.08738083585265752, "mean_env_wait_ms": 0.556065214100576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1420000, "timesteps_this_iter": 0, "agent_timesteps_total": 1420000, "timers": {"sample_time_ms": 9790.21, "sample_throughput": 2042.857, "load_time_ms": 0.244, "load_throughput": 81848063.226, "learn_time_ms": 985.035, "learn_throughput": 20303.844, "update_time_ms": 8.921}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0005, "total_loss": 0.44187889993190765, "policy_loss": -2.1113968113883885e-05, "vf_loss": 0.4565698802471161, "vf_explained_var": -0.001055002212524414, "kl": 5.0999029185705425e-05, "entropy": 1.4669823050498962, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1420000, "num_agent_steps_sampled": 1420000, "num_steps_trained": 1420000, "num_agent_steps_trained": 1420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 295, "training_iteration": 71, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-02-22", "timestamp": 1702710142, "time_this_iter_s": 9.9022216796875, "time_total_s": 712.6409084796906, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 712.6409084796906, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 31.59230769230769, "ram_util_percent": 39.3, "gpu_util_percent0": 0.03461538461538462, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.58999229402633, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33595671526805254, "mean_inference_ms": 1.1840461728082579, "mean_action_processing_ms": 0.08740981413850064, "mean_env_wait_ms": 0.5562648377684801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 9872.728, "sample_throughput": 2025.783, "load_time_ms": 0.257, "load_throughput": 77845285.82, "learn_time_ms": 996.258, "learn_throughput": 20075.12, "update_time_ms": 9.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0005, "total_loss": 0.6362605392932892, "policy_loss": 1.677436741864824e-05, "vf_loss": 0.6510995626449585, "vf_explained_var": -0.0004025101661682129, "kl": 4.500548502228696e-05, "entropy": 1.4855762720108032, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1440000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 1440000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 72, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-02-32", "timestamp": 1702710152, "time_this_iter_s": 10.706582307815552, "time_total_s": 723.3474907875061, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 723.3474907875061, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 38.971428571428575, "ram_util_percent": 39.57142857142857, "gpu_util_percent0": 0.08785714285714286, "vram_util_percent0": 0.016432989211309527}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.58999229402633, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.43389506930978, -185.03131267009206, -166.87380121359075, -170.7208440976132, -181.48152569001826, -200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33595671526805254, "mean_inference_ms": 1.1840461728082579, "mean_action_processing_ms": 0.08740981413850064, "mean_env_wait_ms": 0.5562648377684801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1460000, "timesteps_this_iter": 0, "agent_timesteps_total": 1460000, "timers": {"sample_time_ms": 9933.65, "sample_throughput": 2013.359, "load_time_ms": 0.257, "load_throughput": 77888653.668, "learn_time_ms": 1007.734, "learn_throughput": 19846.509, "update_time_ms": 9.282}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0005, "total_loss": 0.33306075632572174, "policy_loss": 6.108760805645375e-06, "vf_loss": 0.34811872243881226, "vf_explained_var": -0.0015028119087219238, "kl": 2.643949579428373e-05, "entropy": 1.5064062476158142, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1460000, "num_agent_steps_sampled": 1460000, "num_steps_trained": 1460000, "num_agent_steps_trained": 1460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 73, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-02-43", "timestamp": 1702710163, "time_this_iter_s": 10.75758981704712, "time_total_s": 734.1050806045532, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 734.1050806045532, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 38.33571428571429, "ram_util_percent": 39.64285714285715, "gpu_util_percent0": 0.10285714285714286, "vram_util_percent0": 0.01609584263392857}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.87871951273235, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.39052537748583, -185.8646469206305, -180.01184794559498, -185.16496508532282, -187.9435600739328, -190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3362182081484324, "mean_inference_ms": 1.1849965724705607, "mean_action_processing_ms": 0.08744790503522713, "mean_env_wait_ms": 0.5565193129956882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1480000, "timesteps_this_iter": 0, "agent_timesteps_total": 1480000, "timers": {"sample_time_ms": 10001.006, "sample_throughput": 1999.799, "load_time_ms": 0.256, "load_throughput": 78222752.704, "learn_time_ms": 1020.373, "learn_throughput": 19600.682, "update_time_ms": 9.609}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0005, "total_loss": 0.6972965002059937, "policy_loss": -0.00010402660135966357, "vf_loss": 0.7125162780284882, "vf_explained_var": -0.00040841102600097656, "kl": 3.7714601805127757e-05, "entropy": 1.5115755200386047, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1480000, "num_agent_steps_sampled": 1480000, "num_steps_trained": 1480000, "num_agent_steps_trained": 1480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 305, "training_iteration": 74, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-02-53", "timestamp": 1702710173, "time_this_iter_s": 10.34364938735962, "time_total_s": 744.4487299919128, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 744.4487299919128, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.46153846153846, "ram_util_percent": 39.54615384615385, "gpu_util_percent0": 0.03461538461538462, "vram_util_percent0": 0.015800280448717948}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.90329269996246, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.71432579181973, -181.11108833719697, -190.83775652122605, -193.92063067220582, -172.8063123986877, -174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3364569802817621, "mean_inference_ms": 1.185864494980826, "mean_action_processing_ms": 0.0874814175412092, "mean_env_wait_ms": 0.5567591581341254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1500000, "timesteps_this_iter": 0, "agent_timesteps_total": 1500000, "timers": {"sample_time_ms": 10039.674, "sample_throughput": 1992.097, "load_time_ms": 0.245, "load_throughput": 81736412.355, "learn_time_ms": 1019.992, "learn_throughput": 19607.992, "update_time_ms": 9.563}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0005, "total_loss": 0.6635339558124542, "policy_loss": -1.993169825009744e-05, "vf_loss": 0.6786695718765259, "vf_explained_var": -0.000619053840637207, "kl": 3.742933045214336e-05, "entropy": 1.5115614533424377, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1500000, "num_agent_steps_sampled": 1500000, "num_steps_trained": 1500000, "num_agent_steps_trained": 1500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 310, "training_iteration": 75, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-03-03", "timestamp": 1702710183, "time_this_iter_s": 9.985515356063843, "time_total_s": 754.4342453479767, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 754.4342453479767, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 32.50769230769231, "ram_util_percent": 39.62307692307694, "gpu_util_percent0": 0.015384615384615384, "vram_util_percent0": 0.015869140625}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.70782128551923, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.31425251833957, -190.1504233947221, -174.83969892619794, -206.40671970002947, -185.34613891294512, -168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33670211792723065, "mean_inference_ms": 1.1867353306679331, "mean_action_processing_ms": 0.0875152461841606, "mean_env_wait_ms": 0.5569829545588639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1520000, "timesteps_this_iter": 0, "agent_timesteps_total": 1520000, "timers": {"sample_time_ms": 10131.701, "sample_throughput": 1974.002, "load_time_ms": 0.248, "load_throughput": 80613184.701, "learn_time_ms": 1033.694, "learn_throughput": 19348.089, "update_time_ms": 10.024}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0005, "total_loss": 0.6946998536586761, "policy_loss": -2.6656818101766788e-05, "vf_loss": 0.7099110186100006, "vf_explained_var": -0.0006040334701538086, "kl": 3.3719265429610346e-05, "entropy": 1.5184454917907715, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1520000, "num_agent_steps_sampled": 1520000, "num_steps_trained": 1520000, "num_agent_steps_trained": 1520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 315, "training_iteration": 76, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-03-14", "timestamp": 1702710194, "time_this_iter_s": 10.784791231155396, "time_total_s": 765.2190365791321, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dce50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 765.2190365791321, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 38.00714285714286, "ram_util_percent": 39.73571428571429, "gpu_util_percent0": 0.062142857142857146, "vram_util_percent0": 0.01689220610119048}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -177.90927642475776, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.60451485917199, -166.82352982518927, -169.12263395966096, -171.63769348151357, -181.06851263882638, -175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3369580343451771, "mean_inference_ms": 1.1876459919260618, "mean_action_processing_ms": 0.08755088955191435, "mean_env_wait_ms": 0.5572235239740487, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1540000, "timesteps_this_iter": 0, "agent_timesteps_total": 1540000, "timers": {"sample_time_ms": 10284.089, "sample_throughput": 1944.752, "load_time_ms": 0.248, "load_throughput": 80582209.414, "learn_time_ms": 1034.972, "learn_throughput": 19324.187, "update_time_ms": 10.002}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0005, "total_loss": 0.5351369678974152, "policy_loss": -3.76865398834525e-05, "vf_loss": 0.5503256320953369, "vf_explained_var": -0.0008181929588317871, "kl": 2.5315172687889742e-05, "entropy": 1.5150960683822632, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1540000, "num_agent_steps_sampled": 1540000, "num_steps_trained": 1540000, "num_agent_steps_trained": 1540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 77, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-03-25", "timestamp": 1702710205, "time_this_iter_s": 11.029536008834839, "time_total_s": 776.2485725879669, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 776.2485725879669, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 38.99285714285715, "ram_util_percent": 39.82142857142856, "gpu_util_percent0": 0.04571428571428572, "vram_util_percent0": 0.01674107142857143}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -178.30813592232778, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3371918576033302, "mean_inference_ms": 1.1884666487935582, "mean_action_processing_ms": 0.08758134445613319, "mean_env_wait_ms": 0.55743161754772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1560000, "timers": {"sample_time_ms": 10305.436, "sample_throughput": 1940.723, "load_time_ms": 0.246, "load_throughput": 81214134.96, "learn_time_ms": 1031.797, "learn_throughput": 19383.653, "update_time_ms": 9.94}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0005, "total_loss": 0.5941611230373383, "policy_loss": -5.655174334506796e-05, "vf_loss": 0.6092792749404907, "vf_explained_var": -2.574920654296875e-05, "kl": 2.3230618201752762e-05, "entropy": 1.5061673521995544, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1560000, "num_agent_steps_sampled": 1560000, "num_steps_trained": 1560000, "num_agent_steps_trained": 1560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 325, "training_iteration": 78, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-03-35", "timestamp": 1702710215, "time_this_iter_s": 9.834108114242554, "time_total_s": 786.0826807022095, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d40275ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 786.0826807022095, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 31.153846153846153, "ram_util_percent": 39.88461538461537, "gpu_util_percent0": 0.008461538461538461, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -178.30813592232778, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.12845407534994, -172.03794347608866, -172.84021171563882, -191.72284722190685, -169.94600435879966, -171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3371918576033302, "mean_inference_ms": 1.1884666487935582, "mean_action_processing_ms": 0.08758134445613319, "mean_env_wait_ms": 0.55743161754772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1580000, "timesteps_this_iter": 0, "agent_timesteps_total": 1580000, "timers": {"sample_time_ms": 10296.455, "sample_throughput": 1942.416, "load_time_ms": 0.249, "load_throughput": 80381448.831, "learn_time_ms": 1033.531, "learn_throughput": 19351.133, "update_time_ms": 10.079}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0005, "total_loss": 0.4069295823574066, "policy_loss": -9.020175730078961e-05, "vf_loss": 0.42210060358047485, "vf_explained_var": -0.00012946128845214844, "kl": 2.5257715616400223e-05, "entropy": 1.5080819725990295, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1580000, "num_agent_steps_sampled": 1580000, "num_steps_trained": 1580000, "num_agent_steps_trained": 1580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 325, "training_iteration": 79, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-03-45", "timestamp": 1702710225, "time_this_iter_s": 9.644572257995605, "time_total_s": 795.7272529602051, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dca60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 795.7272529602051, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.446153846153848, "ram_util_percent": 39.869230769230754, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.06749495361808, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.52460634852778, -166.10253566162828, -174.42715338365852, -174.32280110274317, -169.41818184985425, -174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3373657756518347, "mean_inference_ms": 1.1890540285586202, "mean_action_processing_ms": 0.08759640148396862, "mean_env_wait_ms": 0.5575584111429043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1600000, "timers": {"sample_time_ms": 10301.879, "sample_throughput": 1941.393, "load_time_ms": 0.25, "load_throughput": 80097469.684, "learn_time_ms": 1035.108, "learn_throughput": 19321.655, "update_time_ms": 9.93}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0005, "total_loss": 0.5975141525268555, "policy_loss": -8.155937240239552e-05, "vf_loss": 0.6125420331954956, "vf_explained_var": 0.00019681453704833984, "kl": 2.6728469467940386e-05, "entropy": 1.4946313500404358, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1600000, "num_agent_steps_sampled": 1600000, "num_steps_trained": 1600000, "num_agent_steps_trained": 1600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 330, "training_iteration": 80, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-03-55", "timestamp": 1702710235, "time_this_iter_s": 9.759001016616821, "time_total_s": 805.4862539768219, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4828ac10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 805.4862539768219, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.425, "ram_util_percent": 39.94166666666666, "gpu_util_percent0": 0.011666666666666667, "vram_util_percent0": 0.015624999999999995}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.3181021700491, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.96772426068745, -175.8265582604146, -172.85795706632885, -169.29102416421716, -181.7758948789052, -166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.337539154430834, "mean_inference_ms": 1.1896680290578145, "mean_action_processing_ms": 0.08761325729776186, "mean_env_wait_ms": 0.5576829104348875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1620000, "timesteps_this_iter": 0, "agent_timesteps_total": 1620000, "timers": {"sample_time_ms": 10297.554, "sample_throughput": 1942.209, "load_time_ms": 0.262, "load_throughput": 76232351.872, "learn_time_ms": 1043.996, "learn_throughput": 19157.169, "update_time_ms": 10.08}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0005, "total_loss": 0.6593979001045227, "policy_loss": -5.353708392363821e-05, "vf_loss": 0.6743421256542206, "vf_explained_var": 0.00011336803436279297, "kl": 2.9867622824530926e-05, "entropy": 1.4890723824501038, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1620000, "num_agent_steps_sampled": 1620000, "num_steps_trained": 1620000, "num_agent_steps_trained": 1620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 335, "training_iteration": 81, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-04-05", "timestamp": 1702710245, "time_this_iter_s": 9.93445634841919, "time_total_s": 815.4207103252411, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 815.4207103252411, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 31.484615384615378, "ram_util_percent": 39.92307692307692, "gpu_util_percent0": 0.012307692307692308, "vram_util_percent0": 0.015362079326923074}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -179.84921708797512, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.0119729732977, -167.7220466700364, -173.2398024447286, -168.617529014123, -177.7946326074949, -172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.337717496399594, "mean_inference_ms": 1.1903080868972715, "mean_action_processing_ms": 0.08763248565517051, "mean_env_wait_ms": 0.5578176699184836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1640000, "timesteps_this_iter": 0, "agent_timesteps_total": 1640000, "timers": {"sample_time_ms": 10249.75, "sample_throughput": 1951.267, "load_time_ms": 0.25, "load_throughput": 79876290.23, "learn_time_ms": 1033.395, "learn_throughput": 19353.685, "update_time_ms": 9.981}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0005, "total_loss": 0.6128138601779938, "policy_loss": -2.1349238793488823e-05, "vf_loss": 0.627869725227356, "vf_explained_var": -0.0006112456321716309, "kl": 4.446944136193842e-05, "entropy": 1.5034462213516235, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1640000, "num_agent_steps_sampled": 1640000, "num_steps_trained": 1640000, "num_agent_steps_trained": 1640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 82, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-04-15", "timestamp": 1702710255, "time_this_iter_s": 10.02220892906189, "time_total_s": 825.442919254303, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402c7dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 825.442919254303, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 33.63846153846154, "ram_util_percent": 40.18461538461539, "gpu_util_percent0": 0.04230769230769231, "vram_util_percent0": 0.015362079326923073}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -180.14592070525595, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.56641586341817, -171.37841006458646, -174.25472063522636, -191.8880845352809, -183.72251145627263, -169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3378843890627741, "mean_inference_ms": 1.190898183614826, "mean_action_processing_ms": 0.08764931972173334, "mean_env_wait_ms": 0.5579501264647937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1660000, "timesteps_this_iter": 0, "agent_timesteps_total": 1660000, "timers": {"sample_time_ms": 10149.763, "sample_throughput": 1970.489, "load_time_ms": 0.264, "load_throughput": 75853223.619, "learn_time_ms": 1022.896, "learn_throughput": 19552.327, "update_time_ms": 9.827}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0005, "total_loss": 0.42473042011260986, "policy_loss": -0.00017233124268245525, "vf_loss": 0.4398724138736725, "vf_explained_var": -0.0011195540428161621, "kl": 0.00011196455657347393, "entropy": 1.4969658851623535, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1660000, "num_agent_steps_sampled": 1660000, "num_steps_trained": 1660000, "num_agent_steps_trained": 1660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 345, "training_iteration": 83, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-04-24", "timestamp": 1702710264, "time_this_iter_s": 9.756925106048584, "time_total_s": 835.1998443603516, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 835.1998443603516, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.200000000000003, "ram_util_percent": 40.43076923076923, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -180.30938502866604, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3380296022766413, "mean_inference_ms": 1.1913962484550593, "mean_action_processing_ms": 0.08766111278527462, "mean_env_wait_ms": 0.5580568209460002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1680000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 10088.319, "sample_throughput": 1982.491, "load_time_ms": 0.264, "load_throughput": 75736800.289, "learn_time_ms": 1011.832, "learn_throughput": 19766.128, "update_time_ms": 9.655}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0005, "total_loss": 0.6300831735134125, "policy_loss": -3.3658028522065564e-05, "vf_loss": 0.6449744701385498, "vf_explained_var": -0.0010254979133605957, "kl": 0.0001305678890981543, "entropy": 1.4857673645019531, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1680000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 1680000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 350, "training_iteration": 84, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-04-34", "timestamp": 1702710274, "time_this_iter_s": 9.73130750656128, "time_total_s": 844.9311518669128, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cda60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 844.9311518669128, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 30.558333333333334, "ram_util_percent": 40.3, "gpu_util_percent0": 0.010833333333333334, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -218.31437078941616, "episode_reward_mean": -180.30938502866604, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.24910612323148, -199.8342868143817, -172.86484375543438, -173.28473335745218, -218.31437078941616, -180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3380296022766413, "mean_inference_ms": 1.1913962484550593, "mean_action_processing_ms": 0.08766111278527462, "mean_env_wait_ms": 0.5580568209460002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1700000, "timesteps_this_iter": 0, "agent_timesteps_total": 1700000, "timers": {"sample_time_ms": 10059.203, "sample_throughput": 1988.229, "load_time_ms": 0.265, "load_throughput": 75423556.914, "learn_time_ms": 1009.336, "learn_throughput": 19815.015, "update_time_ms": 9.713}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0005, "total_loss": 0.24546249210834503, "policy_loss": -4.5629786333378775e-05, "vf_loss": 0.26034751534461975, "vf_explained_var": -0.0004214644432067871, "kl": 6.0372446432754856e-05, "entropy": 1.4839401841163635, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1700000, "num_agent_steps_sampled": 1700000, "num_steps_trained": 1700000, "num_agent_steps_trained": 1700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 350, "training_iteration": 85, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-04-44", "timestamp": 1702710284, "time_this_iter_s": 9.786200523376465, "time_total_s": 854.7173523902893, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4828a550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 854.7173523902893, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 30.415384615384614, "ram_util_percent": 40.43076923076923, "gpu_util_percent0": 0.017692307692307695, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -211.73487529297486, "episode_reward_mean": -180.24552410944, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.0367761694332, -181.5612711008306, -181.9685208032597, -170.09694544053087, -182.73506027437915, -180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33817508500057264, "mean_inference_ms": 1.1919104961806997, "mean_action_processing_ms": 0.08767479548604977, "mean_env_wait_ms": 0.5581731855018867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1720000, "timesteps_this_iter": 0, "agent_timesteps_total": 1720000, "timers": {"sample_time_ms": 9960.484, "sample_throughput": 2007.935, "load_time_ms": 0.261, "load_throughput": 76517449.603, "learn_time_ms": 998.274, "learn_throughput": 20034.577, "update_time_ms": 9.428}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0005, "total_loss": 0.7842830121517181, "policy_loss": -0.00012491035677952844, "vf_loss": 0.7991597354412079, "vf_explained_var": -0.0003903508186340332, "kl": 4.690728015099843e-05, "entropy": 1.4751824140548706, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1720000, "num_agent_steps_sampled": 1720000, "num_steps_trained": 1720000, "num_agent_steps_trained": 1720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 355, "training_iteration": 86, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-04-54", "timestamp": 1702710294, "time_this_iter_s": 9.712965488433838, "time_total_s": 864.4303178787231, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 864.4303178787231, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 30.223076923076924, "ram_util_percent": 40.29230769230769, "gpu_util_percent0": 0.01076923076923077, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -161.0960564811169, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -180.89281338761157, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.97214942729647, -161.0960564811169, -174.93712510628131, -172.54864682628045, -172.71297580641664, -169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3383063637439711, "mean_inference_ms": 1.1923712959541108, "mean_action_processing_ms": 0.08768497672856729, "mean_env_wait_ms": 0.5582746424113618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1740000, "timesteps_this_iter": 0, "agent_timesteps_total": 1740000, "timers": {"sample_time_ms": 9820.788, "sample_throughput": 2036.496, "load_time_ms": 0.261, "load_throughput": 76657296.902, "learn_time_ms": 998.022, "learn_throughput": 20039.644, "update_time_ms": 9.571}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0005, "total_loss": 0.6193956434726715, "policy_loss": -0.00012107448386955433, "vf_loss": 0.6341017186641693, "vf_explained_var": -0.0008162856101989746, "kl": 5.644009221050794e-05, "entropy": 1.4584972262382507, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1740000, "num_agent_steps_sampled": 1740000, "num_steps_trained": 1740000, "num_agent_steps_trained": 1740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 87, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-05-04", "timestamp": 1702710304, "time_this_iter_s": 9.753981590270996, "time_total_s": 874.1842994689941, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 874.1842994689941, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 30.383333333333336, "ram_util_percent": 40.65, "gpu_util_percent0": 0.0016666666666666668, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -181.23452864435868, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.64246898360813, -195.96455929816506, -168.27652072032637, -171.92876080298615, -179.33627072242314, -181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3384348839214627, "mean_inference_ms": 1.1928476715938734, "mean_action_processing_ms": 0.0876959251714483, "mean_env_wait_ms": 0.5583775163106879, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1760000, "timesteps_this_iter": 0, "agent_timesteps_total": 1760000, "timers": {"sample_time_ms": 9816.34, "sample_throughput": 2037.419, "load_time_ms": 0.263, "load_throughput": 76135487.384, "learn_time_ms": 996.746, "learn_throughput": 20065.284, "update_time_ms": 9.609}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0005, "total_loss": 0.5694944858551025, "policy_loss": -4.533099955850162e-06, "vf_loss": 0.5840284526348114, "vf_explained_var": -0.0007380843162536621, "kl": 2.5270111505326653e-05, "entropy": 1.452940821647644, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1760000, "num_agent_steps_sampled": 1760000, "num_steps_trained": 1760000, "num_agent_steps_trained": 1760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 365, "training_iteration": 88, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-05-13", "timestamp": 1702710313, "time_this_iter_s": 9.783432960510254, "time_total_s": 883.9677324295044, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d40080160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 883.9677324295044, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 30.48461538461538, "ram_util_percent": 40.4076923076923, "gpu_util_percent0": 0.016923076923076923, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -181.25749140679898, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.31062929116848, -164.75296984619223, -184.59596047865074, -182.42289913272003, -185.56534983711208, -173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33856294244867585, "mean_inference_ms": 1.193316145990868, "mean_action_processing_ms": 0.08770665799147345, "mean_env_wait_ms": 0.5584891767660356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1780000, "timesteps_this_iter": 0, "agent_timesteps_total": 1780000, "timers": {"sample_time_ms": 9836.564, "sample_throughput": 2033.23, "load_time_ms": 0.268, "load_throughput": 74598559.36, "learn_time_ms": 997.328, "learn_throughput": 20053.589, "update_time_ms": 9.554}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0005, "total_loss": 0.49085673689842224, "policy_loss": -1.2683868400031884e-07, "vf_loss": 0.5053350925445557, "vf_explained_var": -0.0006126165390014648, "kl": 3.2178326511811406e-05, "entropy": 1.4478252530097961, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1780000, "num_agent_steps_sampled": 1780000, "num_steps_trained": 1780000, "num_agent_steps_trained": 1780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 370, "training_iteration": 89, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-05-23", "timestamp": 1702710323, "time_this_iter_s": 9.861903667449951, "time_total_s": 893.8296360969543, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d40275b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 893.8296360969543, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 30.22307692307692, "ram_util_percent": 40.4076923076923, "gpu_util_percent0": 0.008461538461538461, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -181.26186251766592, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3386923301760245, "mean_inference_ms": 1.1937841348211027, "mean_action_processing_ms": 0.08771674412768933, "mean_env_wait_ms": 0.5586023090726596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1800000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 9838.452, "sample_throughput": 2032.84, "load_time_ms": 0.268, "load_throughput": 74572033.07, "learn_time_ms": 998.557, "learn_throughput": 20028.894, "update_time_ms": 9.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0005, "total_loss": 0.6772520542144775, "policy_loss": -0.000169142916542242, "vf_loss": 0.6920287907123566, "vf_explained_var": -0.0002090930938720703, "kl": 0.00013372454419859417, "entropy": 1.460758924484253, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1800000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 1800000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 375, "training_iteration": 90, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-05-33", "timestamp": 1702710333, "time_this_iter_s": 9.791890144348145, "time_total_s": 903.6215262413025, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 903.6215262413025, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.675, "ram_util_percent": 40.49166666666667, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -181.26186251766592, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.6765303029171, -167.35678417213003, -168.09083250169462, -178.05200941397115, -170.99706817503997, -167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3386923301760245, "mean_inference_ms": 1.1937841348211027, "mean_action_processing_ms": 0.08771674412768933, "mean_env_wait_ms": 0.5586023090726596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1820000, "timesteps_this_iter": 0, "agent_timesteps_total": 1820000, "timers": {"sample_time_ms": 9838.842, "sample_throughput": 2032.76, "load_time_ms": 0.257, "load_throughput": 77672296.296, "learn_time_ms": 991.009, "learn_throughput": 20181.459, "update_time_ms": 9.476}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0005, "total_loss": 0.30491338670253754, "policy_loss": 4.287548183912193e-05, "vf_loss": 0.319831520318985, "vf_explained_var": 1.7881393432617188e-07, "kl": 0.00013027927598965872, "entropy": 1.496102213859558, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1820000, "num_agent_steps_sampled": 1820000, "num_steps_trained": 1820000, "num_agent_steps_trained": 1820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 375, "training_iteration": 91, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-05-43", "timestamp": 1702710343, "time_this_iter_s": 9.846616983413696, "time_total_s": 913.4681432247162, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 913.4681432247162, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 30.369230769230775, "ram_util_percent": 40.52307692307693, "gpu_util_percent0": 0.019230769230769232, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -181.94605416457935, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.84342758186986, -178.1979468774111, -176.7150459284678, -174.0622471301185, -176.84177749028484, -175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3388243232235506, "mean_inference_ms": 1.1942709519338668, "mean_action_processing_ms": 0.08772913187643662, "mean_env_wait_ms": 0.5587224448084519, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1840000, "timesteps_this_iter": 0, "agent_timesteps_total": 1840000, "timers": {"sample_time_ms": 9802.838, "sample_throughput": 2040.226, "load_time_ms": 0.257, "load_throughput": 77823620.002, "learn_time_ms": 990.174, "learn_throughput": 20198.473, "update_time_ms": 9.455}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0005, "total_loss": 0.7741983234882355, "policy_loss": -0.00015564507958476526, "vf_loss": 0.7892301380634308, "vf_explained_var": -0.00036025047302246094, "kl": 9.637909139420531e-05, "entropy": 1.4876185655593872, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1840000, "num_agent_steps_sampled": 1840000, "num_steps_trained": 1840000, "num_agent_steps_trained": 1840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 92, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-05-53", "timestamp": 1702710353, "time_this_iter_s": 9.744199275970459, "time_total_s": 923.2123425006866, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 923.2123425006866, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.21666666666667, "ram_util_percent": 40.69166666666667, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -182.63740018228566, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.46088058199845, -170.16148302114772, -166.59339407825993, -171.10247912115852, -171.84684835805163, -166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33895573880640906, "mean_inference_ms": 1.1947668615333504, "mean_action_processing_ms": 0.08774185193520205, "mean_env_wait_ms": 0.5588332762553607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1860000, "timesteps_this_iter": 0, "agent_timesteps_total": 1860000, "timers": {"sample_time_ms": 9805.03, "sample_throughput": 2039.769, "load_time_ms": 0.244, "load_throughput": 81800175.524, "learn_time_ms": 986.717, "learn_throughput": 20269.239, "update_time_ms": 9.524}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 0.0005, "total_loss": 0.6827095746994019, "policy_loss": -0.00021108599007124695, "vf_loss": 0.697602242231369, "vf_explained_var": -0.0008692145347595215, "kl": 9.138345141335158e-05, "entropy": 1.4681594371795654, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1860000, "num_agent_steps_sampled": 1860000, "num_steps_trained": 1860000, "num_agent_steps_trained": 1860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 385, "training_iteration": 93, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-06-02", "timestamp": 1702710362, "time_this_iter_s": 9.722002983093262, "time_total_s": 932.9343454837799, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 932.9343454837799, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 30.06153846153846, "ram_util_percent": 40.638461538461534, "gpu_util_percent0": 0.0038461538461538464, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -183.0254090292132, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.8664694447264, -172.08106081172662, -179.43553392089663, -172.74333557233948, -167.37695500635692, -191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33908892966098714, "mean_inference_ms": 1.1952480286515914, "mean_action_processing_ms": 0.08775512748890504, "mean_env_wait_ms": 0.558951608569306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1880000, "timesteps_this_iter": 0, "agent_timesteps_total": 1880000, "timers": {"sample_time_ms": 9805.354, "sample_throughput": 2039.702, "load_time_ms": 0.258, "load_throughput": 77578914.27, "learn_time_ms": 987.423, "learn_throughput": 20254.741, "update_time_ms": 9.474}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 0.0005, "total_loss": 0.6123028993606567, "policy_loss": -0.00024335889483317885, "vf_loss": 0.6270451843738556, "vf_explained_var": -0.0011563897132873535, "kl": 0.00010993043497947719, "entropy": 1.449892520904541, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1880000, "num_agent_steps_sampled": 1880000, "num_steps_trained": 1880000, "num_agent_steps_trained": 1880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 390, "training_iteration": 94, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-06-12", "timestamp": 1702710372, "time_this_iter_s": 9.774344444274902, "time_total_s": 942.7086899280548, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 942.7086899280548, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.253846153846155, "ram_util_percent": 40.823076923076925, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -183.38435683166853, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.15938511982634, -186.32559379860004, -177.5392999920667, -175.59211099910783, -196.86429244283988, -169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3392185405482321, "mean_inference_ms": 1.1956991524948184, "mean_action_processing_ms": 0.08776727142168586, "mean_env_wait_ms": 0.5590741222643253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1900000, "timesteps_this_iter": 0, "agent_timesteps_total": 1900000, "timers": {"sample_time_ms": 9806.395, "sample_throughput": 2039.486, "load_time_ms": 0.258, "load_throughput": 77614803.849, "learn_time_ms": 989.503, "learn_throughput": 20212.165, "update_time_ms": 9.394}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 0.0005, "total_loss": 0.41553543508052826, "policy_loss": -6.633996728333535e-05, "vf_loss": 0.42983056604862213, "vf_explained_var": -0.0015257000923156738, "kl": 0.00010613857828067896, "entropy": 1.4228797554969788, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1900000, "num_agent_steps_sampled": 1900000, "num_steps_trained": 1900000, "num_agent_steps_trained": 1900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 395, "training_iteration": 95, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-06-22", "timestamp": 1702710382, "time_this_iter_s": 9.812713146209717, "time_total_s": 952.5214030742645, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9740d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 952.5214030742645, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.383333333333336, "ram_util_percent": 40.68333333333333, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -182.728075833674, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3393224768582538, "mean_inference_ms": 1.1960836604185614, "mean_action_processing_ms": 0.08777383163819726, "mean_env_wait_ms": 0.5591521498734532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 9822.521, "sample_throughput": 2036.137, "load_time_ms": 0.257, "load_throughput": 77672296.296, "learn_time_ms": 988.29, "learn_throughput": 20236.967, "update_time_ms": 9.324}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.048709793414476e-30, "cur_lr": 0.0005, "total_loss": 0.6274413466453552, "policy_loss": 3.154754750767097e-06, "vf_loss": 0.6415224373340607, "vf_explained_var": -0.0008096098899841309, "kl": 8.75614586535664e-05, "entropy": 1.408424735069275, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1920000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 1920000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 96, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-06-32", "timestamp": 1702710392, "time_this_iter_s": 9.834951877593994, "time_total_s": 962.3563549518585, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402c7430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 962.3563549518585, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 30.515384615384615, "ram_util_percent": 40.776923076923076, "gpu_util_percent0": 0.016153846153846154, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -182.728075833674, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.0386923726323, -190.5141196606434, -173.42508327694807, -203.89888223554095, -185.5373230654563, -193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3393224768582538, "mean_inference_ms": 1.1960836604185614, "mean_action_processing_ms": 0.08777383163819726, "mean_env_wait_ms": 0.5591521498734532, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1940000, "timesteps_this_iter": 0, "agent_timesteps_total": 1940000, "timers": {"sample_time_ms": 9822.508, "sample_throughput": 2036.14, "load_time_ms": 0.258, "load_throughput": 77607623.277, "learn_time_ms": 989.76, "learn_throughput": 20206.911, "update_time_ms": 11.788}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.524354896707238e-30, "cur_lr": 0.0005, "total_loss": 0.043375562876462936, "policy_loss": -7.443714027388637e-06, "vf_loss": 0.057527218014001846, "vf_explained_var": -0.0020426511764526367, "kl": 4.765267852224753e-05, "entropy": 1.414421558380127, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1940000, "num_agent_steps_sampled": 1940000, "num_steps_trained": 1940000, "num_agent_steps_trained": 1940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 97, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-06-42", "timestamp": 1702710402, "time_this_iter_s": 9.810348272323608, "time_total_s": 972.1667032241821, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 972.1667032241821, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.430769230769233, "ram_util_percent": 41.223076923076924, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -182.08077376741613, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.08018167671517, -182.92246605016604, -190.0447240767386, -193.30107886617074, -182.48441345619102, -175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33939092356336503, "mean_inference_ms": 1.1963074928642035, "mean_action_processing_ms": 0.08777135206120888, "mean_env_wait_ms": 0.5591935899177951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1960000, "timesteps_this_iter": 0, "agent_timesteps_total": 1960000, "timers": {"sample_time_ms": 9820.433, "sample_throughput": 2036.57, "load_time_ms": 0.257, "load_throughput": 77932069.863, "learn_time_ms": 994.053, "learn_throughput": 20119.642, "update_time_ms": 11.763}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.262177448353619e-30, "cur_lr": 0.0005, "total_loss": 0.6556704938411713, "policy_loss": -6.759777109799359e-05, "vf_loss": 0.6700189113616943, "vf_explained_var": -0.00031048059463500977, "kl": 7.694743800557013e-05, "entropy": 1.428080677986145, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1960000, "num_agent_steps_sampled": 1960000, "num_steps_trained": 1960000, "num_agent_steps_trained": 1960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 405, "training_iteration": 98, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-06-52", "timestamp": 1702710412, "time_this_iter_s": 9.724618673324585, "time_total_s": 981.8913218975067, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 981.8913218975067, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 29.991666666666664, "ram_util_percent": 40.99166666666667, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.74856590990464, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -181.41446970109845, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.42284789658322, -165.04433191937463, -192.327682791241, -207.31499382548338, -169.733115844132, -200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33945114771043733, "mean_inference_ms": 1.196514732283879, "mean_action_processing_ms": 0.08776718404949263, "mean_env_wait_ms": 0.5592191102564198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 1980000, "timesteps_this_iter": 0, "agent_timesteps_total": 1980000, "timers": {"sample_time_ms": 9812.862, "sample_throughput": 2038.141, "load_time_ms": 0.251, "load_throughput": 79830681.386, "learn_time_ms": 995.802, "learn_throughput": 20084.32, "update_time_ms": 11.672}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.310887241768095e-31, "cur_lr": 0.0005, "total_loss": 0.6073132455348969, "policy_loss": 1.6771411788019108e-05, "vf_loss": 0.6217617392539978, "vf_explained_var": -0.000732421875, "kl": 0.00010591433144080398, "entropy": 1.4465277194976807, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1980000, "num_agent_steps_sampled": 1980000, "num_steps_trained": 1980000, "num_agent_steps_trained": 1980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 410, "training_iteration": 99, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-07-01", "timestamp": 1702710421, "time_this_iter_s": 9.760159969329834, "time_total_s": 991.6514818668365, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9740d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 991.6514818668365, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 30.12307692307692, "ram_util_percent": 40.95384615384615, "gpu_util_percent0": 0.003076923076923077, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -180.8593729136819, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.71642819740487, -167.60121767640206, -189.19855612374474, -203.14262518635397, -190.54392019218085, -183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3394797684342406, "mean_inference_ms": 1.1966371502186899, "mean_action_processing_ms": 0.08775747784220572, "mean_env_wait_ms": 0.5592235830243449, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2000000, "timesteps_this_iter": 0, "agent_timesteps_total": 2000000, "timers": {"sample_time_ms": 9815.153, "sample_throughput": 2037.666, "load_time_ms": 0.251, "load_throughput": 79792713.783, "learn_time_ms": 996.122, "learn_throughput": 20077.854, "update_time_ms": 11.703}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1554436208840474e-31, "cur_lr": 0.0005, "total_loss": 0.583440363407135, "policy_loss": -1.716804555616791e-05, "vf_loss": 0.598213255405426, "vf_explained_var": -0.0002821683883666992, "kl": 9.89803934610678e-05, "entropy": 1.475572407245636, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2000000, "num_agent_steps_sampled": 2000000, "num_steps_trained": 2000000, "num_agent_steps_trained": 2000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -164.37530989054954, "episode_reward_min": -204.19923686111918, "episode_reward_mean": -178.4547041302291, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.5992670855698, -174.0614743225334, -176.6330777209785, -204.19923686111918, -164.37530989054954, -181.24975942622518, -179.45452490785283, -166.7338474877645, -173.4525409856225, -199.78800261407534], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30271873257568827, "mean_inference_ms": 1.2155768834180578, "mean_action_processing_ms": 0.08531316084996107, "mean_env_wait_ms": 0.5471297250639108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 415, "training_iteration": 100, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-07-32", "timestamp": 1702710452, "time_this_iter_s": 30.608198404312134, "time_total_s": 1022.2596802711487, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9d4700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1022.2596802711487, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 30.261538461538457, "ram_util_percent": 41.02820512820512, "gpu_util_percent0": 0.00948717948717949, "vram_util_percent0": 0.015299479166666661}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -180.07445577378203, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.05454196463728, -174.03097159376478, -176.33640443644586, -182.7626896605652, -180.95822686594312, -210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33948171179491277, "mean_inference_ms": 1.1966424699626261, "mean_action_processing_ms": 0.08773987947050416, "mean_env_wait_ms": 0.5591745517304623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2020000, "timesteps_this_iter": 0, "agent_timesteps_total": 2020000, "timers": {"sample_time_ms": 11887.888, "sample_throughput": 1682.385, "load_time_ms": 0.249, "load_throughput": 80458545.943, "learn_time_ms": 996.485, "learn_throughput": 20070.539, "update_time_ms": 11.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5777218104420237e-31, "cur_lr": 0.0005, "total_loss": 0.42006102204322815, "policy_loss": -6.25488316523537e-05, "vf_loss": 0.43519389629364014, "vf_explained_var": -0.0013002753257751465, "kl": 0.00014795066371187104, "entropy": 1.5070300102233887, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2020000, "num_agent_steps_sampled": 2020000, "num_steps_trained": 2020000, "num_agent_steps_trained": 2020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 101, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-07-42", "timestamp": 1702710462, "time_this_iter_s": 9.756452083587646, "time_total_s": 1032.0161323547363, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d40275550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1032.0161323547363, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 30.458333333333332, "ram_util_percent": 41.15, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -180.14210071983285, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3394814574745081, "mean_inference_ms": 1.196631949571931, "mean_action_processing_ms": 0.0877218375748492, "mean_env_wait_ms": 0.559133445703398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2040000, "timesteps_this_iter": 0, "agent_timesteps_total": 2040000, "timers": {"sample_time_ms": 11894.02, "sample_throughput": 1681.517, "load_time_ms": 0.249, "load_throughput": 80427689.358, "learn_time_ms": 999.533, "learn_throughput": 20009.337, "update_time_ms": 11.85}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.888609052210118e-32, "cur_lr": 0.0005, "total_loss": 0.6376846432685852, "policy_loss": 2.4575233101398197e-05, "vf_loss": 0.6530874073505402, "vf_explained_var": -0.0008789300918579102, "kl": 0.00016868107418410716, "entropy": 1.5427300930023193, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2040000, "num_agent_steps_sampled": 2040000, "num_steps_trained": 2040000, "num_agent_steps_trained": 2040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 425, "training_iteration": 102, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-07-52", "timestamp": 1702710472, "time_this_iter_s": 9.80470061302185, "time_total_s": 1041.8208329677582, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1041.8208329677582, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 30.43076923076923, "ram_util_percent": 41.03846153846154, "gpu_util_percent0": 0.013846153846153848, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -213.2967484799135, "episode_reward_mean": -180.14210071983285, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.38128584535903, -184.7135960547076, -182.7393990567796, -196.12649454007453, -183.65058847988894, -165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3394814574745081, "mean_inference_ms": 1.196631949571931, "mean_action_processing_ms": 0.0877218375748492, "mean_env_wait_ms": 0.559133445703398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2060000, "timesteps_this_iter": 0, "agent_timesteps_total": 2060000, "timers": {"sample_time_ms": 11900.063, "sample_throughput": 1680.663, "load_time_ms": 0.249, "load_throughput": 80466263.789, "learn_time_ms": 1002.768, "learn_throughput": 19944.789, "update_time_ms": 11.763}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.944304526105059e-32, "cur_lr": 0.0005, "total_loss": 0.4600924849510193, "policy_loss": 1.8036652166486533e-05, "vf_loss": 0.47593769431114197, "vf_explained_var": -0.0006150007247924805, "kl": 6.069765011501582e-05, "entropy": 1.5863261818885803, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2060000, "num_agent_steps_sampled": 2060000, "num_steps_trained": 2060000, "num_agent_steps_trained": 2060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 425, "training_iteration": 103, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-08-02", "timestamp": 1702710482, "time_this_iter_s": 9.782406568527222, "time_total_s": 1051.6032395362854, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48d475e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1051.6032395362854, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 30.253846153846155, "ram_util_percent": 41.323076923076925, "gpu_util_percent0": 0.004615384615384615, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -180.33694069429515, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-165.65826210674373, -204.5799459613584, -165.067073492677, -167.18425996549402, -178.3664584632473, -195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33948507302279873, "mean_inference_ms": 1.196637843145914, "mean_action_processing_ms": 0.0877053605882242, "mean_env_wait_ms": 0.5590982843413458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2080000, "timesteps_this_iter": 0, "agent_timesteps_total": 2080000, "timers": {"sample_time_ms": 11906.863, "sample_throughput": 1679.704, "load_time_ms": 0.235, "load_throughput": 85111688.312, "learn_time_ms": 1003.073, "learn_throughput": 19938.733, "update_time_ms": 11.662}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9721522630525296e-32, "cur_lr": 0.0005, "total_loss": 0.8770395815372467, "policy_loss": -0.0002737108219880158, "vf_loss": 0.8931326270103455, "vf_explained_var": 0.0002351701259613037, "kl": 0.00010860494177961089, "entropy": 1.5819253325462341, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2080000, "num_agent_steps_sampled": 2080000, "num_steps_trained": 2080000, "num_agent_steps_trained": 2080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 430, "training_iteration": 104, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-08-11", "timestamp": 1702710491, "time_this_iter_s": 9.813106298446655, "time_total_s": 1061.416345834732, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1061.416345834732, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 30.549999999999997, "ram_util_percent": 41.150000000000006, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -181.93906718763773, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.32105606268684, -177.961624420165, -197.78126909604896, -181.3454165110432, -175.4212843332149, -176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33948789952079095, "mean_inference_ms": 1.196630455470585, "mean_action_processing_ms": 0.08768840107769574, "mean_env_wait_ms": 0.5590735073528719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2100000, "timesteps_this_iter": 0, "agent_timesteps_total": 2100000, "timers": {"sample_time_ms": 11910.584, "sample_throughput": 1679.179, "load_time_ms": 0.238, "load_throughput": 84096320.802, "learn_time_ms": 1001.736, "learn_throughput": 19965.34, "update_time_ms": 11.717}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.860761315262648e-33, "cur_lr": 0.0005, "total_loss": 0.7813847362995148, "policy_loss": -0.00015402888671989245, "vf_loss": 0.7972060143947601, "vf_explained_var": -0.0008065700531005859, "kl": 0.0001608890093522941, "entropy": 1.5667243599891663, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2100000, "num_agent_steps_sampled": 2100000, "num_steps_trained": 2100000, "num_agent_steps_trained": 2100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 435, "training_iteration": 105, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-08-21", "timestamp": 1702710501, "time_this_iter_s": 9.83493161201477, "time_total_s": 1071.2512774467468, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1071.2512774467468, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 30.576923076923077, "ram_util_percent": 41.12307692307694, "gpu_util_percent0": 0.01846153846153846, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.3695404204599, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.4079169169473, -167.73025640189877, -180.6303145960961, -171.56477653614496, -186.72308098667204, -191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3394851639981834, "mean_inference_ms": 1.196601695254655, "mean_action_processing_ms": 0.08766995236718018, "mean_env_wait_ms": 0.5590461258564169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2120000, "timesteps_this_iter": 0, "agent_timesteps_total": 2120000, "timers": {"sample_time_ms": 11907.464, "sample_throughput": 1679.619, "load_time_ms": 0.238, "load_throughput": 84130057.166, "learn_time_ms": 1004.378, "learn_throughput": 19912.831, "update_time_ms": 11.645}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.930380657631324e-33, "cur_lr": 0.0005, "total_loss": 0.6967081129550934, "policy_loss": -0.00017141952072252664, "vf_loss": 0.7123783826828003, "vf_explained_var": -0.0008336305618286133, "kl": 0.00015762153927818823, "entropy": 1.5498875975608826, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2120000, "num_agent_steps_sampled": 2120000, "num_steps_trained": 2120000, "num_agent_steps_trained": 2120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 106, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-08-31", "timestamp": 1702710511, "time_this_iter_s": 9.84420657157898, "time_total_s": 1081.0954840183258, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1081.0954840183258, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 30.407692307692308, "ram_util_percent": 41.315384615384616, "gpu_util_percent0": 0.011538461538461537, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.9285215506652, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.83030197584813, -168.7547318696288, -171.61762949679746, -211.73487529297486, -166.21903626054092, -188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3394885397882789, "mean_inference_ms": 1.196589559779679, "mean_action_processing_ms": 0.08765194765792315, "mean_env_wait_ms": 0.5590171391756336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2140000, "timesteps_this_iter": 0, "agent_timesteps_total": 2140000, "timers": {"sample_time_ms": 11930.756, "sample_throughput": 1676.34, "load_time_ms": 0.238, "load_throughput": 83902860.572, "learn_time_ms": 1004.373, "learn_throughput": 19912.917, "update_time_ms": 9.067}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.465190328815662e-33, "cur_lr": 0.0005, "total_loss": 0.47089551389217377, "policy_loss": -0.0001462445260025369, "vf_loss": 0.4862363338470459, "vf_explained_var": -0.000908195972442627, "kl": 0.00013520763157215399, "entropy": 1.5194575786590576, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2140000, "num_agent_steps_sampled": 2140000, "num_steps_trained": 2140000, "num_agent_steps_trained": 2140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 445, "training_iteration": 107, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-08-41", "timestamp": 1702710521, "time_this_iter_s": 9.913881063461304, "time_total_s": 1091.009365081787, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1091.009365081787, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 30.20833333333333, "ram_util_percent": 41.31666666666667, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.68260797152135, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33949366068008346, "mean_inference_ms": 1.1965952103888977, "mean_action_processing_ms": 0.08763470764652238, "mean_env_wait_ms": 0.5589896953177107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2160000, "timesteps_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"sample_time_ms": 11941.888, "sample_throughput": 1674.777, "load_time_ms": 0.238, "load_throughput": 83995273.856, "learn_time_ms": 1005.882, "learn_throughput": 19883.048, "update_time_ms": 9.116}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.232595164407831e-33, "cur_lr": 0.0005, "total_loss": 0.6010026335716248, "policy_loss": 2.705574092676244e-05, "vf_loss": 0.6159061193466187, "vf_explained_var": -0.0003205537796020508, "kl": 9.171329885593327e-05, "entropy": 1.4930562376976013, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2160000, "num_agent_steps_sampled": 2160000, "num_steps_trained": 2160000, "num_agent_steps_trained": 2160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 450, "training_iteration": 108, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-08-51", "timestamp": 1702710531, "time_this_iter_s": 9.916695594787598, "time_total_s": 1100.9260606765747, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1100.9260606765747, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 41.4076923076923, "gpu_util_percent0": 0.01769230769230769, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.68260797152135, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.5243986464482, -183.50532954487716, -187.1771884276755, -203.20576638841592, -164.74856590990464, -191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33949366068008346, "mean_inference_ms": 1.1965952103888977, "mean_action_processing_ms": 0.08763470764652238, "mean_env_wait_ms": 0.5589896953177107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2180000, "timesteps_this_iter": 0, "agent_timesteps_total": 2180000, "timers": {"sample_time_ms": 11948.841, "sample_throughput": 1673.802, "load_time_ms": 0.236, "load_throughput": 84707745.128, "learn_time_ms": 1007.66, "learn_throughput": 19847.972, "update_time_ms": 10.05}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.162975822039155e-34, "cur_lr": 0.0005, "total_loss": 0.044290440157055855, "policy_loss": 2.891540418659133e-06, "vf_loss": 0.0591755136847496, "vf_explained_var": -0.0015906095504760742, "kl": 2.0731893225878206e-05, "entropy": 1.4887967109680176, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2180000, "num_agent_steps_sampled": 2180000, "num_steps_trained": 2180000, "num_agent_steps_trained": 2180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 450, "training_iteration": 109, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-09-01", "timestamp": 1702710541, "time_this_iter_s": 9.84096074104309, "time_total_s": 1110.7670214176178, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48d475e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1110.7670214176178, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 30.084615384615386, "ram_util_percent": 41.46923076923077, "gpu_util_percent0": 0.0007692307692307692, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.00188827080382, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.9898430307926, -170.37782500777448, -199.05376138676593, -186.4093237003396, -213.2967484799135, -169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.339502514278433, "mean_inference_ms": 1.1966039716222037, "mean_action_processing_ms": 0.08761781894892173, "mean_env_wait_ms": 0.5589766520646071, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2200000, "timesteps_this_iter": 0, "agent_timesteps_total": 2200000, "timers": {"sample_time_ms": 11960.312, "sample_throughput": 1672.197, "load_time_ms": 0.237, "load_throughput": 84528496.574, "learn_time_ms": 1009.626, "learn_throughput": 19809.321, "update_time_ms": 10.047}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0814879110195775e-34, "cur_lr": 0.0005, "total_loss": 0.691604346036911, "policy_loss": -9.053039441653254e-06, "vf_loss": 0.7065648436546326, "vf_explained_var": -0.0007458925247192383, "kl": 2.2236092386496153e-05, "entropy": 1.4951426982879639, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2200000, "num_agent_steps_sampled": 2200000, "num_steps_trained": 2200000, "num_agent_steps_trained": 2200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 455, "training_iteration": 110, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-09-11", "timestamp": 1702710551, "time_this_iter_s": 9.897653818130493, "time_total_s": 1120.6646752357483, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1120.6646752357483, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 30.491666666666664, "ram_util_percent": 41.37499999999999, "gpu_util_percent0": 0.010833333333333334, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -181.32392573790545, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.65348597877966, -192.75856428129126, -188.54307788180526, -174.3369452542635, -171.1464059259649, -170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33951383070424784, "mean_inference_ms": 1.1966101165585852, "mean_action_processing_ms": 0.08760086259923688, "mean_env_wait_ms": 0.5589681379002394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2220000, "timesteps_this_iter": 0, "agent_timesteps_total": 2220000, "timers": {"sample_time_ms": 9883.267, "sample_throughput": 2023.622, "load_time_ms": 0.247, "load_throughput": 80846260.601, "learn_time_ms": 1010.153, "learn_throughput": 19798.981, "update_time_ms": 10.062}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5407439555097888e-34, "cur_lr": 0.0005, "total_loss": 0.6589069962501526, "policy_loss": -3.5037706769047716e-05, "vf_loss": 0.6739904284477234, "vf_explained_var": -0.0010818243026733398, "kl": 2.3990141699625767e-05, "entropy": 1.5048437714576721, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2220000, "num_agent_steps_sampled": 2220000, "num_steps_trained": 2220000, "num_agent_steps_trained": 2220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 111, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-09-21", "timestamp": 1702710561, "time_this_iter_s": 9.789585828781128, "time_total_s": 1130.4542610645294, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1130.4542610645294, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 30.530769230769234, "ram_util_percent": 41.36923076923077, "gpu_util_percent0": 0.010769230769230769, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -181.63433364976237, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.4310341457846, -170.1251085677921, -179.05248649506498, -193.93527965858343, -173.9009479043142, -186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3395270126751646, "mean_inference_ms": 1.196606998439548, "mean_action_processing_ms": 0.08758419500127217, "mean_env_wait_ms": 0.5589637082419621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2240000, "timesteps_this_iter": 0, "agent_timesteps_total": 2240000, "timers": {"sample_time_ms": 9881.777, "sample_throughput": 2023.927, "load_time_ms": 0.263, "load_throughput": 75928747.285, "learn_time_ms": 1010.42, "learn_throughput": 19793.741, "update_time_ms": 9.906}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.703719777548944e-35, "cur_lr": 0.0005, "total_loss": 0.648826390504837, "policy_loss": -8.452224393851182e-05, "vf_loss": 0.664166122674942, "vf_explained_var": -0.0008189082145690918, "kl": 5.094163870200674e-05, "entropy": 1.5255165100097656, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2240000, "num_agent_steps_sampled": 2240000, "num_steps_trained": 2240000, "num_agent_steps_trained": 2240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 465, "training_iteration": 112, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-09-30", "timestamp": 1702710570, "time_this_iter_s": 9.815656661987305, "time_total_s": 1140.2699177265167, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d400fe1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1140.2699177265167, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 30.525000000000002, "ram_util_percent": 41.51666666666667, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -181.7849412607832, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.31370638577587, -179.62302516129347, -172.34012133298768, -182.95334449491182, -177.85472229756013, -195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33954126672973045, "mean_inference_ms": 1.196615109710831, "mean_action_processing_ms": 0.08756837561281848, "mean_env_wait_ms": 0.5589564530361145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2260000, "timesteps_this_iter": 0, "agent_timesteps_total": 2260000, "timers": {"sample_time_ms": 9889.344, "sample_throughput": 2022.379, "load_time_ms": 0.263, "load_throughput": 75915004.525, "learn_time_ms": 1009.435, "learn_throughput": 19813.071, "update_time_ms": 9.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.851859888774472e-35, "cur_lr": 0.0005, "total_loss": 0.4925787150859833, "policy_loss": -9.181709537520177e-05, "vf_loss": 0.5080274045467377, "vf_explained_var": -0.0010045170783996582, "kl": 9.761636984173538e-05, "entropy": 1.5356876850128174, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2260000, "num_agent_steps_sampled": 2260000, "num_steps_trained": 2260000, "num_agent_steps_trained": 2260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 470, "training_iteration": 113, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-09-40", "timestamp": 1702710580, "time_this_iter_s": 9.877954244613647, "time_total_s": 1150.1478719711304, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1150.1478719711304, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 30.484615384615385, "ram_util_percent": 41.5076923076923, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.07535095216113, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3395566078086504, "mean_inference_ms": 1.196624032895741, "mean_action_processing_ms": 0.0875521678248974, "mean_env_wait_ms": 0.5589530595048933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2280000, "timesteps_this_iter": 0, "agent_timesteps_total": 2280000, "timers": {"sample_time_ms": 9892.16, "sample_throughput": 2021.803, "load_time_ms": 0.263, "load_throughput": 76087147.392, "learn_time_ms": 1011.848, "learn_throughput": 19765.806, "update_time_ms": 9.994}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.925929944387236e-35, "cur_lr": 0.0005, "total_loss": 0.6783031225204468, "policy_loss": -6.566734578239419e-05, "vf_loss": 0.6938449740409851, "vf_explained_var": -0.0007491707801818848, "kl": 0.00011170127589144041, "entropy": 1.547614336013794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2280000, "num_agent_steps_sampled": 2280000, "num_steps_trained": 2280000, "num_agent_steps_trained": 2280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 475, "training_iteration": 114, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-09-50", "timestamp": 1702710590, "time_this_iter_s": 9.878195762634277, "time_total_s": 1160.0260677337646, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482c00d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1160.0260677337646, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 30.430769230769233, "ram_util_percent": 41.56153846153847, "gpu_util_percent0": 0.004615384615384616, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -218.23234956704644, "episode_reward_mean": -182.07535095216113, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.83948401822911, -174.4557701673193, -175.04630560704607, -180.68145189614188, -200.56937756836473, -201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3395566078086504, "mean_inference_ms": 1.196624032895741, "mean_action_processing_ms": 0.0875521678248974, "mean_env_wait_ms": 0.5589530595048933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2300000, "timesteps_this_iter": 0, "agent_timesteps_total": 2300000, "timers": {"sample_time_ms": 9890.042, "sample_throughput": 2022.236, "load_time_ms": 0.26, "load_throughput": 76924419.991, "learn_time_ms": 1015.458, "learn_throughput": 19695.537, "update_time_ms": 9.944}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.62964972193618e-36, "cur_lr": 0.0005, "total_loss": 0.5030149519443512, "policy_loss": -0.0002312644001101205, "vf_loss": 0.5188709199428558, "vf_explained_var": -0.0007516145706176758, "kl": 0.0001104320384699431, "entropy": 1.5624720454216003, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2300000, "num_agent_steps_sampled": 2300000, "num_steps_trained": 2300000, "num_agent_steps_trained": 2300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 475, "training_iteration": 115, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-10-00", "timestamp": 1702710600, "time_this_iter_s": 9.823055744171143, "time_total_s": 1169.8491234779358, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402729d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1169.8491234779358, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 30.10833333333333, "ram_util_percent": 41.53333333333334, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.99207213386504, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.40785878972062, -183.68179755938272, -187.47170768119767, -176.21527027091804, -194.01841247756255, -180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3395714053897396, "mean_inference_ms": 1.1966291716842692, "mean_action_processing_ms": 0.08753657453481817, "mean_env_wait_ms": 0.5589692018134675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2320000, "timesteps_this_iter": 0, "agent_timesteps_total": 2320000, "timers": {"sample_time_ms": 9906.691, "sample_throughput": 2018.838, "load_time_ms": 0.26, "load_throughput": 76783597.254, "learn_time_ms": 1015.168, "learn_throughput": 19701.174, "update_time_ms": 9.963}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.81482486096809e-36, "cur_lr": 0.0005, "total_loss": 0.5852376818656921, "policy_loss": 1.671886354159824e-05, "vf_loss": 0.6006008982658386, "vf_explained_var": -3.2067298889160156e-05, "kl": 0.00010077082571635643, "entropy": 1.5379926562309265, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2320000, "num_agent_steps_sampled": 2320000, "num_steps_trained": 2320000, "num_agent_steps_trained": 2320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 116, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-10-10", "timestamp": 1702710610, "time_this_iter_s": 9.97501802444458, "time_total_s": 1179.8241415023804, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1179.8241415023804, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 30.523076923076925, "ram_util_percent": 41.75384615384616, "gpu_util_percent0": 0.013846153846153845, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.65675982337433, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.09659035483608, -175.87894884785558, -177.63958072469663, -190.8693787991775, -169.48147112680894, -172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33958865794902926, "mean_inference_ms": 1.1966498699097312, "mean_action_processing_ms": 0.08752161322157853, "mean_env_wait_ms": 0.5589907504707923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2340000, "timesteps_this_iter": 0, "agent_timesteps_total": 2340000, "timers": {"sample_time_ms": 9904.617, "sample_throughput": 2019.26, "load_time_ms": 0.26, "load_throughput": 77037450.638, "learn_time_ms": 1019.7, "learn_throughput": 19613.611, "update_time_ms": 10.018}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.407412430484045e-36, "cur_lr": 0.0005, "total_loss": 0.7307991981506348, "policy_loss": -8.00593396763638e-05, "vf_loss": 0.7460775077342987, "vf_explained_var": -0.0007979869842529297, "kl": 6.370865992683106e-05, "entropy": 1.5198206901550293, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2340000, "num_agent_steps_sampled": 2340000, "num_steps_trained": 2340000, "num_agent_steps_trained": 2340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 485, "training_iteration": 117, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-10-20", "timestamp": 1702710620, "time_this_iter_s": 10.01366662979126, "time_total_s": 1189.8378081321716, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482c00d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1189.8378081321716, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 30.546153846153853, "ram_util_percent": 41.669230769230765, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.08248013951072, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.60639117897497, -181.924158071838, -174.36359761972574, -192.3259198881736, -173.17806824286114, -167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33960480746186605, "mean_inference_ms": 1.1966827160237257, "mean_action_processing_ms": 0.08750653613719357, "mean_env_wait_ms": 0.5590137088795151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2360000, "timesteps_this_iter": 0, "agent_timesteps_total": 2360000, "timers": {"sample_time_ms": 9907.799, "sample_throughput": 2018.612, "load_time_ms": 0.259, "load_throughput": 77193411.245, "learn_time_ms": 1017.619, "learn_throughput": 19653.716, "update_time_ms": 9.964}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2037062152420225e-36, "cur_lr": 0.0005, "total_loss": 0.5910339653491974, "policy_loss": -4.942064365032195e-05, "vf_loss": 0.6061823070049286, "vf_explained_var": -0.0008321404457092285, "kl": 4.2581420701792716e-05, "entropy": 1.5098917484283447, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2360000, "num_agent_steps_sampled": 2360000, "num_steps_trained": 2360000, "num_agent_steps_trained": 2360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 490, "training_iteration": 118, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-10-30", "timestamp": 1702710630, "time_this_iter_s": 9.87661600112915, "time_total_s": 1199.7144241333008, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1199.7144241333008, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 30.833333333333332, "ram_util_percent": 41.89166666666667, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.95263642658927, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.89692249758752, -176.42099773290002, -176.36332077453912, -172.3228582706505, -168.8484832773124, -168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396252044166496, "mean_inference_ms": 1.1967242760347638, "mean_action_processing_ms": 0.08749213147016001, "mean_env_wait_ms": 0.559035355090026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2380000, "timesteps_this_iter": 0, "agent_timesteps_total": 2380000, "timers": {"sample_time_ms": 9920.042, "sample_throughput": 2016.12, "load_time_ms": 0.26, "load_throughput": 77044526.084, "learn_time_ms": 1014.617, "learn_throughput": 19711.877, "update_time_ms": 9.013}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.018531076210112e-37, "cur_lr": 0.0005, "total_loss": 0.4327976554632187, "policy_loss": -6.609506794497122e-05, "vf_loss": 0.4477900415658951, "vf_explained_var": -0.001562952995300293, "kl": 3.175557197021561e-05, "entropy": 1.492632508277893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2380000, "num_agent_steps_sampled": 2380000, "num_steps_trained": 2380000, "num_agent_steps_trained": 2380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 495, "training_iteration": 119, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-10-40", "timestamp": 1702710640, "time_this_iter_s": 9.948787450790405, "time_total_s": 1209.6632115840912, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1209.6632115840912, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 30.523076923076925, "ram_util_percent": 41.88461538461539, "gpu_util_percent0": 0.016153846153846154, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.30695588222986, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396458650777646, "mean_inference_ms": 1.1967615261322717, "mean_action_processing_ms": 0.0874778406175521, "mean_env_wait_ms": 0.5590585116417919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2400000, "timesteps_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"sample_time_ms": 9910.83, "sample_throughput": 2017.994, "load_time_ms": 0.258, "load_throughput": 77564567.73, "learn_time_ms": 1017.076, "learn_throughput": 19664.206, "update_time_ms": 9.134}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.009265538105056e-37, "cur_lr": 0.0005, "total_loss": 0.6265988051891327, "policy_loss": -7.948265137347477e-05, "vf_loss": 0.6414412558078766, "vf_explained_var": -0.0010464787483215332, "kl": 3.5080491337768915e-05, "entropy": 1.4762981534004211, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2400000, "num_agent_steps_sampled": 2400000, "num_steps_trained": 2400000, "num_agent_steps_trained": 2400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 500, "training_iteration": 120, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-10-50", "timestamp": 1702710650, "time_this_iter_s": 9.878530263900757, "time_total_s": 1219.541741847992, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1219.541741847992, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 30.56923076923077, "ram_util_percent": 41.99230769230769, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.30695588222986, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.17934457689182, -168.0454247225592, -173.42043153781893, -170.03551549180887, -178.0031776563541, -172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396458650777646, "mean_inference_ms": 1.1967615261322717, "mean_action_processing_ms": 0.0874778406175521, "mean_env_wait_ms": 0.5590585116417919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2420000, "timesteps_this_iter": 0, "agent_timesteps_total": 2420000, "timers": {"sample_time_ms": 9913.722, "sample_throughput": 2017.406, "load_time_ms": 0.248, "load_throughput": 80597694.081, "learn_time_ms": 1018.944, "learn_throughput": 19628.159, "update_time_ms": 9.321}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.504632769052528e-37, "cur_lr": 0.0005, "total_loss": 0.04725036956369877, "policy_loss": -2.0587157949947255e-05, "vf_loss": 0.06199400871992111, "vf_explained_var": -0.0035418272018432617, "kl": 3.818149749620914e-05, "entropy": 1.4723051190376282, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2420000, "num_agent_steps_sampled": 2420000, "num_steps_trained": 2420000, "num_agent_steps_trained": 2420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 500, "training_iteration": 121, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-00", "timestamp": 1702710660, "time_this_iter_s": 9.8147451877594, "time_total_s": 1229.3564870357513, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482acaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1229.3564870357513, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 30.308333333333334, "ram_util_percent": 42.12500000000001, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.45170280763693, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.80775462845992, -177.00647319615965, -178.2018702539449, -178.46694288901773, -168.71941652663045, -164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33966644673033414, "mean_inference_ms": 1.1968177018622237, "mean_action_processing_ms": 0.08746338562235242, "mean_env_wait_ms": 0.5590771490237768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2440000, "timesteps_this_iter": 0, "agent_timesteps_total": 2440000, "timers": {"sample_time_ms": 9918.295, "sample_throughput": 2016.476, "load_time_ms": 0.234, "load_throughput": 85345487.842, "learn_time_ms": 1021.375, "learn_throughput": 19581.449, "update_time_ms": 9.635}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.52316384526264e-38, "cur_lr": 0.0005, "total_loss": 0.6756914556026459, "policy_loss": -1.8560409644763354e-06, "vf_loss": 0.6903499960899353, "vf_explained_var": -0.0006393194198608398, "kl": 2.5272767576800526e-05, "entropy": 1.4656672477722168, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2440000, "num_agent_steps_sampled": 2440000, "num_steps_trained": 2440000, "num_agent_steps_trained": 2440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 505, "training_iteration": 122, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-10", "timestamp": 1702710670, "time_this_iter_s": 9.866152286529541, "time_total_s": 1239.2226393222809, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1239.2226393222809, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 30.423076923076927, "ram_util_percent": 42.276923076923076, "gpu_util_percent0": 0.012307692307692308, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -164.44593869426038, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.50951866256847, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.44593869426038, -181.18875286365338, -175.9784911635363, -166.04371238238988, -166.67639843131866, -181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396906158421761, "mean_inference_ms": 1.1968732483607658, "mean_action_processing_ms": 0.08744941624801238, "mean_env_wait_ms": 0.5591042616667586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2460000, "timesteps_this_iter": 0, "agent_timesteps_total": 2460000, "timers": {"sample_time_ms": 9917.681, "sample_throughput": 2016.601, "load_time_ms": 0.234, "load_throughput": 85415008.655, "learn_time_ms": 1025.278, "learn_throughput": 19506.909, "update_time_ms": 9.633}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.76158192263132e-38, "cur_lr": 0.0005, "total_loss": 0.6187894940376282, "policy_loss": -2.377281217480487e-05, "vf_loss": 0.6334636509418488, "vf_explained_var": 8.478760719299316e-05, "kl": 1.4192280093250353e-05, "entropy": 1.4650344252586365, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2460000, "num_agent_steps_sampled": 2460000, "num_steps_trained": 2460000, "num_agent_steps_trained": 2460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 510, "training_iteration": 123, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-20", "timestamp": 1702710680, "time_this_iter_s": 9.885502576828003, "time_total_s": 1249.108141899109, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1249.108141899109, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.66666666666666, "ram_util_percent": 42.25, "gpu_util_percent0": 0.009166666666666667, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.96769349811896, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.03475696008985, -176.53906825605537, -168.1138842095904, -169.20591760768914, -177.81740635267903, -170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33971667065941014, "mean_inference_ms": 1.196935726862356, "mean_action_processing_ms": 0.0874357316489023, "mean_env_wait_ms": 0.5591335878556591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2480000, "timesteps_this_iter": 0, "agent_timesteps_total": 2480000, "timers": {"sample_time_ms": 9930.163, "sample_throughput": 2014.066, "load_time_ms": 0.242, "load_throughput": 82491965.778, "learn_time_ms": 1024.396, "learn_throughput": 19523.695, "update_time_ms": 9.545}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.88079096131566e-38, "cur_lr": 0.0005, "total_loss": 0.6058571934700012, "policy_loss": 4.5493889553549494e-05, "vf_loss": 0.6206574440002441, "vf_explained_var": -0.0008413791656494141, "kl": 2.384283371631435e-05, "entropy": 1.4845711588859558, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2480000, "num_agent_steps_sampled": 2480000, "num_steps_trained": 2480000, "num_agent_steps_trained": 2480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 515, "training_iteration": 124, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-30", "timestamp": 1702710690, "time_this_iter_s": 9.950556516647339, "time_total_s": 1259.0586984157562, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1259.0586984157562, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 30.576923076923073, "ram_util_percent": 42.24615384615385, "gpu_util_percent0": 0.006153846153846154, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -184.13531443751043, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.08599478534137, -187.93949941108102, -194.35118727616825, -182.10922007795963, -169.42142757589184, -218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33973873272266353, "mean_inference_ms": 1.1970055587987383, "mean_action_processing_ms": 0.08742272730970474, "mean_env_wait_ms": 0.5591690449018426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2500000, "timesteps_this_iter": 0, "agent_timesteps_total": 2500000, "timers": {"sample_time_ms": 9935.049, "sample_throughput": 2013.075, "load_time_ms": 0.241, "load_throughput": 82834087.094, "learn_time_ms": 1023.689, "learn_throughput": 19537.184, "update_time_ms": 9.544}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.4039548065783e-39, "cur_lr": 0.0005, "total_loss": 0.4323333501815796, "policy_loss": 3.330612214628992e-06, "vf_loss": 0.4472174346446991, "vf_explained_var": -0.0013254880905151367, "kl": 1.2101967182820417e-05, "entropy": 1.4887421131134033, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2500000, "num_agent_steps_sampled": 2500000, "num_steps_trained": 2500000, "num_agent_steps_trained": 2500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 125, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-39", "timestamp": 1702710699, "time_this_iter_s": 9.87857174873352, "time_total_s": 1268.9372701644897, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1268.9372701644897, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 30.58333333333334, "ram_util_percent": 42.34166666666666, "gpu_util_percent0": 0.005833333333333334, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.77497059992987, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33976419083681014, "mean_inference_ms": 1.1970863525926252, "mean_action_processing_ms": 0.0874103634586568, "mean_env_wait_ms": 0.559204682497365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2520000, "timesteps_this_iter": 0, "agent_timesteps_total": 2520000, "timers": {"sample_time_ms": 9934.065, "sample_throughput": 2013.275, "load_time_ms": 0.242, "load_throughput": 82613827.063, "learn_time_ms": 1022.183, "learn_throughput": 19565.972, "update_time_ms": 9.54}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.70197740328915e-39, "cur_lr": 0.0005, "total_loss": 0.6404423415660858, "policy_loss": -7.843131812990123e-05, "vf_loss": 0.6554644107818604, "vf_explained_var": -0.0002956986427307129, "kl": 3.7107580796780226e-05, "entropy": 1.4943637251853943, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2520000, "num_agent_steps_sampled": 2520000, "num_steps_trained": 2520000, "num_agent_steps_trained": 2520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 525, "training_iteration": 126, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-49", "timestamp": 1702710709, "time_this_iter_s": 9.94934868812561, "time_total_s": 1278.8866188526154, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1278.8866188526154, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 30.553846153846152, "ram_util_percent": 42.45384615384615, "gpu_util_percent0": 0.007692307692307693, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.77497059992987, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-218.23234956704644, -189.12650596025074, -193.2358880131711, -172.34144960807424, -204.15916827449377, -202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33976419083681014, "mean_inference_ms": 1.1970863525926252, "mean_action_processing_ms": 0.0874103634586568, "mean_env_wait_ms": 0.559204682497365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2540000, "timesteps_this_iter": 0, "agent_timesteps_total": 2540000, "timers": {"sample_time_ms": 9920.534, "sample_throughput": 2016.021, "load_time_ms": 0.244, "load_throughput": 81808152.916, "learn_time_ms": 1023.141, "learn_throughput": 19547.644, "update_time_ms": 9.642}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.350988701644575e-39, "cur_lr": 0.0005, "total_loss": 0.15076158195734024, "policy_loss": 3.0621813621678484e-05, "vf_loss": 0.16590960323810577, "vf_explained_var": -0.00026613473892211914, "kl": 4.988633210123439e-05, "entropy": 1.5178629755973816, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2540000, "num_agent_steps_sampled": 2540000, "num_steps_trained": 2540000, "num_agent_steps_trained": 2540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 525, "training_iteration": 127, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-11-59", "timestamp": 1702710719, "time_this_iter_s": 9.907153606414795, "time_total_s": 1288.7937724590302, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482c08b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1288.7937724590302, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 30.261538461538464, "ram_util_percent": 42.4076923076923, "gpu_util_percent0": 0.0023076923076923075, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -183.02886746475383, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.11405772601648, -217.2899401577992, -208.114443268451, -205.1063382218118, -208.44386994969705, -179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33978936493054773, "mean_inference_ms": 1.1971805988600634, "mean_action_processing_ms": 0.08739885003399932, "mean_env_wait_ms": 0.559241695563884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2560000, "timesteps_this_iter": 0, "agent_timesteps_total": 2560000, "timers": {"sample_time_ms": 9924.147, "sample_throughput": 2015.287, "load_time_ms": 0.257, "load_throughput": 77758694.846, "learn_time_ms": 1025.766, "learn_throughput": 19497.618, "update_time_ms": 9.741}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1754943508222876e-39, "cur_lr": 0.0005, "total_loss": 0.6853595674037933, "policy_loss": -1.6773319945873055e-05, "vf_loss": 0.7006219327449799, "vf_explained_var": -0.0004297494888305664, "kl": 3.270192613746836e-05, "entropy": 1.5245562195777893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2560000, "num_agent_steps_sampled": 2560000, "num_steps_trained": 2560000, "num_agent_steps_trained": 2560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 530, "training_iteration": 128, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-12-09", "timestamp": 1702710729, "time_this_iter_s": 9.931325674057007, "time_total_s": 1298.7250981330872, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1298.7250981330872, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 30.558333333333326, "ram_util_percent": 42.625, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.015299479166666664}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -181.96826433338873, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.35173386511116, -205.11474375712572, -180.2723940000043, -210.09478001780818, -196.04432206533352, -195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33981732041233287, "mean_inference_ms": 1.1972798005568766, "mean_action_processing_ms": 0.08738764693727165, "mean_env_wait_ms": 0.5592795430517485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2580000, "timesteps_this_iter": 0, "agent_timesteps_total": 2580000, "timers": {"sample_time_ms": 9929.227, "sample_throughput": 2014.255, "load_time_ms": 0.257, "load_throughput": 77917592.421, "learn_time_ms": 1028.234, "learn_throughput": 19450.817, "update_time_ms": 9.712}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.877471754111438e-40, "cur_lr": 0.0005, "total_loss": 0.6172051727771759, "policy_loss": -3.512477981360007e-06, "vf_loss": 0.63248410820961, "vf_explained_var": -0.0009171366691589355, "kl": 3.098713213905979e-05, "entropy": 1.5275446772575378, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2580000, "num_agent_steps_sampled": 2580000, "num_steps_trained": 2580000, "num_agent_steps_trained": 2580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 535, "training_iteration": 129, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-12-19", "timestamp": 1702710739, "time_this_iter_s": 9.996622800827026, "time_total_s": 1308.7217209339142, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dca60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1308.7217209339142, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 30.853846153846145, "ram_util_percent": 42.53846153846154, "gpu_util_percent0": 0.011538461538461537, "vram_util_percent0": 0.015074118589743593}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -181.56382388868224, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.7434303843537, -179.96720248483817, -183.60152282594902, -203.15870975108783, -176.48359301205844, -181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3398467573491214, "mean_inference_ms": 1.197384154244869, "mean_action_processing_ms": 0.08737719191864969, "mean_env_wait_ms": 0.5593139999513546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2600000, "timesteps_this_iter": 0, "agent_timesteps_total": 2600000, "timers": {"sample_time_ms": 9937.093, "sample_throughput": 2012.661, "load_time_ms": 0.257, "load_throughput": 77672296.296, "learn_time_ms": 1024.815, "learn_throughput": 19515.713, "update_time_ms": 9.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.938735877055719e-40, "cur_lr": 0.0005, "total_loss": 0.6605986058712006, "policy_loss": -3.131694914770833e-05, "vf_loss": 0.6759976446628571, "vf_explained_var": -0.0010972023010253906, "kl": 3.1487714315797666e-05, "entropy": 1.5367718935012817, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2600000, "num_agent_steps_sampled": 2600000, "num_steps_trained": 2600000, "num_agent_steps_trained": 2600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 130, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-12-29", "timestamp": 1702710749, "time_this_iter_s": 9.896170139312744, "time_total_s": 1318.617891073227, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dce50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1318.617891073227, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 30.683333333333337, "ram_util_percent": 42.46666666666667, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -181.30715310051744, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.46136513226867, -167.2272477894246, -184.00919656983993, -174.52146336124267, -178.34594412862643, -168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33987237383360414, "mean_inference_ms": 1.197487153472608, "mean_action_processing_ms": 0.08736704189232501, "mean_env_wait_ms": 0.5593496982112663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2620000, "timesteps_this_iter": 0, "agent_timesteps_total": 2620000, "timers": {"sample_time_ms": 9947.824, "sample_throughput": 2010.49, "load_time_ms": 0.257, "load_throughput": 77939310.601, "learn_time_ms": 1024.714, "learn_throughput": 19517.645, "update_time_ms": 9.419}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4693679385278595e-40, "cur_lr": 0.0005, "total_loss": 0.47887785732746124, "policy_loss": -2.538518961525682e-05, "vf_loss": 0.4941564202308655, "vf_explained_var": -0.0010346770286560059, "kl": 1.5060432996261142e-05, "entropy": 1.5253189206123352, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2620000, "num_agent_steps_sampled": 2620000, "num_steps_trained": 2620000, "num_agent_steps_trained": 2620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 545, "training_iteration": 131, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-12-39", "timestamp": 1702710759, "time_this_iter_s": 9.918879985809326, "time_total_s": 1328.5367710590363, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1328.5367710590363, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 30.569230769230767, "ram_util_percent": 42.5, "gpu_util_percent0": 0.015384615384615384, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -181.72085699698434, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3398956938890641, "mean_inference_ms": 1.1975758960659504, "mean_action_processing_ms": 0.08735665255309723, "mean_env_wait_ms": 0.5593911187013133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2640000, "timesteps_this_iter": 0, "agent_timesteps_total": 2640000, "timers": {"sample_time_ms": 9947.055, "sample_throughput": 2010.645, "load_time_ms": 0.254, "load_throughput": 78640742.477, "learn_time_ms": 1023.975, "learn_throughput": 19531.722, "update_time_ms": 9.411}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.346839692639297e-41, "cur_lr": 0.0005, "total_loss": 0.6647339463233948, "policy_loss": -8.211402640423415e-05, "vf_loss": 0.6799659132957458, "vf_explained_var": -0.000720679759979248, "kl": 3.409501944373616e-05, "entropy": 1.5149874687194824, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2640000, "num_agent_steps_sampled": 2640000, "num_steps_trained": 2640000, "num_agent_steps_trained": 2640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 550, "training_iteration": 132, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-12-49", "timestamp": 1702710769, "time_this_iter_s": 9.850696325302124, "time_total_s": 1338.3874673843384, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9b2310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1338.3874673843384, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 30.553846153846152, "ram_util_percent": 42.66923076923077, "gpu_util_percent0": 0.007692307692307693, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -181.72085699698434, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.87158202226163, -171.2904317985132, -168.16852057005158, -166.80992502672456, -183.94881942801695, -187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3398956938890641, "mean_inference_ms": 1.1975758960659504, "mean_action_processing_ms": 0.08735665255309723, "mean_env_wait_ms": 0.5593911187013133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2660000, "timesteps_this_iter": 0, "agent_timesteps_total": 2660000, "timers": {"sample_time_ms": 9940.016, "sample_throughput": 2012.069, "load_time_ms": 0.255, "load_throughput": 78434857.41, "learn_time_ms": 1020.189, "learn_throughput": 19604.208, "update_time_ms": 9.454}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.6734198463196487e-41, "cur_lr": 0.0005, "total_loss": 0.12849219143390656, "policy_loss": -3.430852807184692e-05, "vf_loss": 0.14372418820858002, "vf_explained_var": -0.0016044974327087402, "kl": 2.2697022297957226e-05, "entropy": 1.5197697877883911, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2660000, "num_agent_steps_sampled": 2660000, "num_steps_trained": 2660000, "num_agent_steps_trained": 2660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 550, "training_iteration": 133, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-12-59", "timestamp": 1702710779, "time_this_iter_s": 9.778793573379517, "time_total_s": 1348.166260957718, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1348.166260957718, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 30.166666666666668, "ram_util_percent": 42.76666666666667, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.78465848820463, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.0799370180457, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.97346328213303, -181.4292541588514, -169.8774221297692, -171.11149414494622, -182.93961460005002, -190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3399190969303817, "mean_inference_ms": 1.1976681735356243, "mean_action_processing_ms": 0.08734616554623581, "mean_env_wait_ms": 0.5594289582866285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2680000, "timesteps_this_iter": 0, "agent_timesteps_total": 2680000, "timers": {"sample_time_ms": 9935.581, "sample_throughput": 2012.967, "load_time_ms": 0.249, "load_throughput": 80273760.766, "learn_time_ms": 1020.022, "learn_throughput": 19607.416, "update_time_ms": 9.96}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8367099231598243e-41, "cur_lr": 0.0005, "total_loss": 0.686433345079422, "policy_loss": -3.9035891741479034e-05, "vf_loss": 0.7015737295150757, "vf_explained_var": 0.00045245885848999023, "kl": 1.312425656285754e-05, "entropy": 1.5101370811462402, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2680000, "num_agent_steps_sampled": 2680000, "num_steps_trained": 2680000, "num_agent_steps_trained": 2680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 555, "training_iteration": 134, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-13-09", "timestamp": 1702710789, "time_this_iter_s": 9.950771570205688, "time_total_s": 1358.1170325279236, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1358.1170325279236, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 30.738461538461536, "ram_util_percent": 42.70769230769231, "gpu_util_percent0": 0.009230769230769232, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.5922368846723, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.43187012952976, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.15234222271954, -200.5125806127228, -176.4150792233098, -194.614609960842, -165.78465848820463, -170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.339940022865021, "mean_inference_ms": 1.1977700616494378, "mean_action_processing_ms": 0.08733678911808652, "mean_env_wait_ms": 0.5594678626267043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2700000, "timesteps_this_iter": 0, "agent_timesteps_total": 2700000, "timers": {"sample_time_ms": 9941.051, "sample_throughput": 2011.86, "load_time_ms": 0.261, "load_throughput": 76622287.176, "learn_time_ms": 1017.649, "learn_throughput": 19653.14, "update_time_ms": 10.172}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.183549615799122e-42, "cur_lr": 0.0005, "total_loss": 0.6623479425907135, "policy_loss": 2.958707723577092e-05, "vf_loss": 0.6774610579013824, "vf_explained_var": -0.001004338264465332, "kl": 1.719779410702671e-05, "entropy": 1.5142749547958374, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2700000, "num_agent_steps_sampled": 2700000, "num_steps_trained": 2700000, "num_agent_steps_trained": 2700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 135, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-13-19", "timestamp": 1702710799, "time_this_iter_s": 9.885479211807251, "time_total_s": 1368.0025117397308, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481604c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1368.0025117397308, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 30.53333333333333, "ram_util_percent": 42.76666666666667, "gpu_util_percent0": 0.007500000000000001, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.5922368846723, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.337189234195, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.0200886004432, -208.5710764114692, -185.56482435901535, -167.91498269130366, -170.43464581138866, -192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33996220453956094, "mean_inference_ms": 1.1978751021726586, "mean_action_processing_ms": 0.08732785621352102, "mean_env_wait_ms": 0.559508236790474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2720000, "timesteps_this_iter": 0, "agent_timesteps_total": 2720000, "timers": {"sample_time_ms": 9931.705, "sample_throughput": 2013.753, "load_time_ms": 0.26, "load_throughput": 76945587.966, "learn_time_ms": 1020.762, "learn_throughput": 19593.201, "update_time_ms": 10.217}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.591774807899561e-42, "cur_lr": 0.0005, "total_loss": 0.6174550950527191, "policy_loss": -6.338091094515441e-05, "vf_loss": 0.63285231590271, "vf_explained_var": -0.00039762258529663086, "kl": 3.937040660240143e-05, "entropy": 1.5333834290504456, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2720000, "num_agent_steps_sampled": 2720000, "num_steps_trained": 2720000, "num_agent_steps_trained": 2720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 565, "training_iteration": 136, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-13-29", "timestamp": 1702710809, "time_this_iter_s": 9.911123991012573, "time_total_s": 1377.9136357307434, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ac0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1377.9136357307434, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 30.569230769230767, "ram_util_percent": 42.73846153846153, "gpu_util_percent0": 0.008461538461538461, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.5922368846723, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.53551897875218, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.76867294994503, -201.8402269375277, -172.9326712434735, -176.67042265887142, -183.91389502050015, -206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3399829507072101, "mean_inference_ms": 1.1979782551811906, "mean_action_processing_ms": 0.08731870480730361, "mean_env_wait_ms": 0.5595477674379619, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2740000, "timesteps_this_iter": 0, "agent_timesteps_total": 2740000, "timers": {"sample_time_ms": 9936.218, "sample_throughput": 2012.838, "load_time_ms": 0.258, "load_throughput": 77643539.43, "learn_time_ms": 1015.273, "learn_throughput": 19699.131, "update_time_ms": 10.173}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2958874039497804e-42, "cur_lr": 0.0005, "total_loss": 0.48424631357192993, "policy_loss": 9.526824508832021e-06, "vf_loss": 0.4996405690908432, "vf_explained_var": -0.0013312697410583496, "kl": 6.0919725503927324e-05, "entropy": 1.5403790473937988, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2740000, "num_agent_steps_sampled": 2740000, "num_steps_trained": 2740000, "num_agent_steps_trained": 2740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 570, "training_iteration": 137, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-13-39", "timestamp": 1702710819, "time_this_iter_s": 9.869773864746094, "time_total_s": 1387.7834095954895, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1387.7834095954895, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 30.650000000000002, "ram_util_percent": 42.833333333333336, "gpu_util_percent0": 0.005833333333333334, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.5922368846723, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.81691225402759, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400034673796313, "mean_inference_ms": 1.1980816040323115, "mean_action_processing_ms": 0.087310297030588, "mean_env_wait_ms": 0.5595968376049804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2760000, "timesteps_this_iter": 0, "agent_timesteps_total": 2760000, "timers": {"sample_time_ms": 9944.568, "sample_throughput": 2011.148, "load_time_ms": 0.246, "load_throughput": 81395381.331, "learn_time_ms": 1009.771, "learn_throughput": 19806.474, "update_time_ms": 10.114}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1479437019748902e-42, "cur_lr": 0.0005, "total_loss": 0.6624723970890045, "policy_loss": 3.6958693883093474e-06, "vf_loss": 0.6779506504535675, "vf_explained_var": -0.0005407333374023438, "kl": 3.226919983723153e-05, "entropy": 1.5481916069984436, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2760000, "num_agent_steps_sampled": 2760000, "num_steps_trained": 2760000, "num_agent_steps_trained": 2760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 575, "training_iteration": 138, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-13-49", "timestamp": 1702710829, "time_this_iter_s": 10.008054733276367, "time_total_s": 1397.7914643287659, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ab0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1397.7914643287659, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 30.76153846153846, "ram_util_percent": 42.91538461538461, "gpu_util_percent0": 0.008461538461538461, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.5922368846723, "episode_reward_min": -221.3706280517466, "episode_reward_mean": -182.81691225402759, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-206.33150147130974, -191.64370635561843, -221.3706280517466, -214.08651574723666, -184.83215580158566, -192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400034673796313, "mean_inference_ms": 1.1980816040323115, "mean_action_processing_ms": 0.087310297030588, "mean_env_wait_ms": 0.5595968376049804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2780000, "timesteps_this_iter": 0, "agent_timesteps_total": 2780000, "timers": {"sample_time_ms": 9924.021, "sample_throughput": 2015.312, "load_time_ms": 0.261, "load_throughput": 76601296.685, "learn_time_ms": 1005.766, "learn_throughput": 19885.337, "update_time_ms": 10.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.739718509874451e-43, "cur_lr": 0.0005, "total_loss": 0.27434447407722473, "policy_loss": -0.00018837824521966695, "vf_loss": 0.2901281267404556, "vf_explained_var": -0.0005925893783569336, "kl": 5.241063887273523e-05, "entropy": 1.5595266222953796, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2780000, "num_agent_steps_sampled": 2780000, "num_steps_trained": 2780000, "num_agent_steps_trained": 2780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 575, "training_iteration": 139, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-13-59", "timestamp": 1702710839, "time_this_iter_s": 9.799171447753906, "time_total_s": 1407.5906357765198, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1407.5906357765198, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 30.391666666666666, "ram_util_percent": 42.94166666666666, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.5922368846723, "episode_reward_min": -204.93822821166117, "episode_reward_mean": -181.97133732806594, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.62216884402883, -171.10892797304285, -174.134548646223, -196.01737648210963, -175.3807937843059, -193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34002244955843436, "mean_inference_ms": 1.198189610962105, "mean_action_processing_ms": 0.08730183114741515, "mean_env_wait_ms": 0.5596285709853742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2800000, "timesteps_this_iter": 0, "agent_timesteps_total": 2800000, "timers": {"sample_time_ms": 9915.802, "sample_throughput": 2016.983, "load_time_ms": 0.261, "load_throughput": 76769543.333, "learn_time_ms": 1008.184, "learn_throughput": 19837.655, "update_time_ms": 10.205}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8698592549372255e-43, "cur_lr": 0.0005, "total_loss": 0.729375809431076, "policy_loss": -0.00010726490295454028, "vf_loss": 0.7448426187038422, "vf_explained_var": -0.0008887052536010742, "kl": 8.320713337783836e-05, "entropy": 1.535955548286438, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2800000, "num_agent_steps_sampled": 2800000, "num_steps_trained": 2800000, "num_agent_steps_trained": 2800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 580, "training_iteration": 140, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-14-08", "timestamp": 1702710848, "time_this_iter_s": 9.883421421051025, "time_total_s": 1417.4740571975708, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1417.4740571975708, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 30.853846153846156, "ram_util_percent": 43.10000000000001, "gpu_util_percent0": 0.02076923076923077, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -182.08075751426298, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.14181852572764, -168.2961058245685, -182.3539429785307, -187.80790592652926, -204.93822821166117, -175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34003769310143667, "mean_inference_ms": 1.198280709971269, "mean_action_processing_ms": 0.08729297849132156, "mean_env_wait_ms": 0.5596612611227207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2820000, "timesteps_this_iter": 0, "agent_timesteps_total": 2820000, "timers": {"sample_time_ms": 9901.949, "sample_throughput": 2019.804, "load_time_ms": 0.273, "load_throughput": 73135204.882, "learn_time_ms": 1006.239, "learn_throughput": 19875.986, "update_time_ms": 10.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4349296274686128e-43, "cur_lr": 0.0005, "total_loss": 0.7215739786624908, "policy_loss": -0.0002474936593789834, "vf_loss": 0.7368877232074738, "vf_explained_var": -0.0013257265090942383, "kl": 0.00011382038772311809, "entropy": 1.5066248178482056, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2820000, "num_agent_steps_sampled": 2820000, "num_steps_trained": 2820000, "num_agent_steps_trained": 2820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 585, "training_iteration": 141, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-14-18", "timestamp": 1702710858, "time_this_iter_s": 9.767451763153076, "time_total_s": 1427.2415089607239, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1427.2415089607239, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 30.625, "ram_util_percent": 43.275, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.83885639336947, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.85305240057102, -175.01891726867908, -169.0353488692122, -179.41236802699606, -182.09407714396252, -169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34005494415485715, "mean_inference_ms": 1.1983615429070218, "mean_action_processing_ms": 0.08728462688066906, "mean_env_wait_ms": 0.5597028018073135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2840000, "timesteps_this_iter": 0, "agent_timesteps_total": 2840000, "timers": {"sample_time_ms": 9910.26, "sample_throughput": 2018.111, "load_time_ms": 0.273, "load_throughput": 73250157.178, "learn_time_ms": 1004.475, "learn_throughput": 19910.903, "update_time_ms": 10.314}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.174648137343064e-44, "cur_lr": 0.0005, "total_loss": 0.5789376497268677, "policy_loss": -2.6988030388253037e-06, "vf_loss": 0.5938305258750916, "vf_explained_var": -0.0009210109710693359, "kl": 7.962674829742333e-05, "entropy": 1.4890185594558716, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2840000, "num_agent_steps_sampled": 2840000, "num_steps_trained": 2840000, "num_agent_steps_trained": 2840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 590, "training_iteration": 142, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-14-28", "timestamp": 1702710868, "time_this_iter_s": 9.942537784576416, "time_total_s": 1437.1840467453003, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ac5e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1437.1840467453003, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 30.75384615384616, "ram_util_percent": 43.44615384615384, "gpu_util_percent0": 0.008461538461538461, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.7243087617244, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.60270448199637, -183.04179991370543, -179.68182765543807, -185.27305290127762, -179.68514316463592, -171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400668755953076, "mean_inference_ms": 1.198438343088656, "mean_action_processing_ms": 0.08727582040386993, "mean_env_wait_ms": 0.5597419689079406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2860000, "timesteps_this_iter": 0, "agent_timesteps_total": 2860000, "timers": {"sample_time_ms": 9916.065, "sample_throughput": 2016.929, "load_time_ms": 0.273, "load_throughput": 73147959.54, "learn_time_ms": 1002.548, "learn_throughput": 19949.168, "update_time_ms": 10.315}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.587324068671532e-44, "cur_lr": 0.0005, "total_loss": 0.4068911224603653, "policy_loss": -9.430045791658515e-05, "vf_loss": 0.4216311275959015, "vf_explained_var": -0.001642465591430664, "kl": 3.486428455645729e-05, "entropy": 1.4645699858665466, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2860000, "num_agent_steps_sampled": 2860000, "num_steps_trained": 2860000, "num_agent_steps_trained": 2860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 595, "training_iteration": 143, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-14-38", "timestamp": 1702710878, "time_this_iter_s": 9.81535267829895, "time_total_s": 1446.9993994235992, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1446.9993994235992, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.741666666666664, "ram_util_percent": 43.43333333333333, "gpu_util_percent0": 0.005833333333333334, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.5399303063905, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400778088164909, "mean_inference_ms": 1.1985202316730041, "mean_action_processing_ms": 0.08726717375773367, "mean_env_wait_ms": 0.5597771495085214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2880000, "timesteps_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"sample_time_ms": 9906.02, "sample_throughput": 2018.974, "load_time_ms": 0.272, "load_throughput": 73519789.658, "learn_time_ms": 999.309, "learn_throughput": 20013.826, "update_time_ms": 9.866}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.793662034335766e-44, "cur_lr": 0.0005, "total_loss": 0.6754077076911926, "policy_loss": -0.0001225208325781324, "vf_loss": 0.6900396049022675, "vf_explained_var": -0.0009456276893615723, "kl": 6.259779080391992e-05, "entropy": 1.4509359002113342, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2880000, "num_agent_steps_sampled": 2880000, "num_steps_trained": 2880000, "num_agent_steps_trained": 2880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 144, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-14-48", "timestamp": 1702710888, "time_this_iter_s": 9.834705114364624, "time_total_s": 1456.8341045379639, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1456.8341045379639, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 30.583333333333332, "ram_util_percent": 43.416666666666664, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.5399303063905, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.0396890300839, -175.9865160672344, -173.25768535538512, -171.8535858583885, -180.02111021504993, -170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400778088164909, "mean_inference_ms": 1.1985202316730041, "mean_action_processing_ms": 0.08726717375773367, "mean_env_wait_ms": 0.5597771495085214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2900000, "timesteps_this_iter": 0, "agent_timesteps_total": 2900000, "timers": {"sample_time_ms": 9898.703, "sample_throughput": 2020.467, "load_time_ms": 0.268, "load_throughput": 74691550.174, "learn_time_ms": 997.354, "learn_throughput": 20053.067, "update_time_ms": 9.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.96831017167883e-45, "cur_lr": 0.0005, "total_loss": 0.0429315771907568, "policy_loss": -1.1394214427973282e-05, "vf_loss": 0.05746086873114109, "vf_explained_var": -0.0019672513008117676, "kl": 7.035279952782858e-05, "entropy": 1.4517901539802551, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2900000, "num_agent_steps_sampled": 2900000, "num_steps_trained": 2900000, "num_agent_steps_trained": 2900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 145, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-14-58", "timestamp": 1702710898, "time_this_iter_s": 9.848896503448486, "time_total_s": 1466.6830010414124, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1466.6830010414124, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 30.1, "ram_util_percent": 43.4076923076923, "gpu_util_percent0": 0.01076923076923077, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.46976322399965, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.2153728967345, -184.01067249203678, -185.0436322350178, -172.63628676862473, -169.07807859495097, -171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3400905757808382, "mean_inference_ms": 1.1986156543890782, "mean_action_processing_ms": 0.08725951736919857, "mean_env_wait_ms": 0.559812858575083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2920000, "timesteps_this_iter": 0, "agent_timesteps_total": 2920000, "timers": {"sample_time_ms": 9904.205, "sample_throughput": 2019.344, "load_time_ms": 0.27, "load_throughput": 74071593.819, "learn_time_ms": 995.161, "learn_throughput": 20097.259, "update_time_ms": 9.92}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.484155085839415e-45, "cur_lr": 0.0005, "total_loss": 0.6661690473556519, "policy_loss": 1.7960261998517524e-05, "vf_loss": 0.680688202381134, "vf_explained_var": -0.0005400776863098145, "kl": 2.651158257521713e-05, "entropy": 1.4537104368209839, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2920000, "num_agent_steps_sampled": 2920000, "num_steps_trained": 2920000, "num_agent_steps_trained": 2920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 605, "training_iteration": 146, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-15-08", "timestamp": 1702710908, "time_this_iter_s": 9.972521543502808, "time_total_s": 1476.6555225849152, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1476.6555225849152, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 30.808333333333337, "ram_util_percent": 43.541666666666664, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.57685175110393, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.57131542319533, -191.68890109506756, -171.8442166558717, -173.1748740098275, -191.8714699062432, -179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401023823701792, "mean_inference_ms": 1.1987126426922798, "mean_action_processing_ms": 0.08725220323319116, "mean_env_wait_ms": 0.5598544456839614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2940000, "timesteps_this_iter": 0, "agent_timesteps_total": 2940000, "timers": {"sample_time_ms": 9911.26, "sample_throughput": 2017.907, "load_time_ms": 0.277, "load_throughput": 72303120.152, "learn_time_ms": 993.038, "learn_throughput": 20140.219, "update_time_ms": 9.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2420775429197074e-45, "cur_lr": 0.0005, "total_loss": 0.6116295754909515, "policy_loss": -0.00010958519101844644, "vf_loss": 0.6263199746608734, "vf_explained_var": -6.604194641113281e-05, "kl": 5.598039619614248e-05, "entropy": 1.4580761194229126, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2940000, "num_agent_steps_sampled": 2940000, "num_steps_trained": 2940000, "num_agent_steps_trained": 2940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 610, "training_iteration": 147, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-15-18", "timestamp": 1702710918, "time_this_iter_s": 9.935180187225342, "time_total_s": 1486.5907027721405, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1486.5907027721405, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 31.03076923076923, "ram_util_percent": 43.48461538461538, "gpu_util_percent0": 0.017692307692307695, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.5829924333349, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.6385618515587, -176.1110263973212, -174.41095529139946, -174.9758210863085, -184.33676269866154, -172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401163563098446, "mean_inference_ms": 1.198815552460934, "mean_action_processing_ms": 0.08724508996843827, "mean_env_wait_ms": 0.5598925107394156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2960000, "timesteps_this_iter": 0, "agent_timesteps_total": 2960000, "timers": {"sample_time_ms": 9906.311, "sample_throughput": 2018.915, "load_time_ms": 0.276, "load_throughput": 72521898.504, "learn_time_ms": 996.352, "learn_throughput": 20073.224, "update_time_ms": 9.843}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1210387714598537e-45, "cur_lr": 0.0005, "total_loss": 0.5628499686717987, "policy_loss": 4.962740034097912e-05, "vf_loss": 0.5776444673538208, "vf_explained_var": -0.0007444024085998535, "kl": 8.450117125546885e-05, "entropy": 1.4844178557395935, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2960000, "num_agent_steps_sampled": 2960000, "num_steps_trained": 2960000, "num_agent_steps_trained": 2960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 615, "training_iteration": 148, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-15-28", "timestamp": 1702710928, "time_this_iter_s": 10.019995212554932, "time_total_s": 1496.6106979846954, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1496.6106979846954, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 30.766666666666666, "ram_util_percent": 43.541666666666664, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -181.66427542473372, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.14427049784265, -178.8402956711987, -177.63991850623228, -170.01135817827145, -169.23710251484252, -186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401314748422486, "mean_inference_ms": 1.1989248248186932, "mean_action_processing_ms": 0.08723833633476795, "mean_env_wait_ms": 0.5599349234752495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 2980000, "timesteps_this_iter": 0, "agent_timesteps_total": 2980000, "timers": {"sample_time_ms": 9931.66, "sample_throughput": 2013.762, "load_time_ms": 0.261, "load_throughput": 76601296.685, "learn_time_ms": 997.976, "learn_throughput": 20040.56, "update_time_ms": 9.815}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.6051938572992686e-46, "cur_lr": 0.0005, "total_loss": 0.4768756031990051, "policy_loss": 7.321157188855398e-05, "vf_loss": 0.4917410761117935, "vf_explained_var": -0.0014554858207702637, "kl": 3.1303242524205466e-05, "entropy": 1.4938610196113586, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2980000, "num_agent_steps_sampled": 2980000, "num_steps_trained": 2980000, "num_agent_steps_trained": 2980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 620, "training_iteration": 149, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-15-38", "timestamp": 1702710938, "time_this_iter_s": 10.040459871292114, "time_total_s": 1506.6511578559875, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48419280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1506.6511578559875, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 30.661538461538456, "ram_util_percent": 43.78461538461538, "gpu_util_percent0": 0.017692307692307695, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -182.40426775168933, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401442644398539, "mean_inference_ms": 1.199036739922427, "mean_action_processing_ms": 0.08723159571308622, "mean_env_wait_ms": 0.5599703363104378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3000000, "timesteps_this_iter": 0, "agent_timesteps_total": 3000000, "timers": {"sample_time_ms": 9938.772, "sample_throughput": 2012.321, "load_time_ms": 0.261, "load_throughput": 76482567.469, "learn_time_ms": 992.938, "learn_throughput": 20142.238, "update_time_ms": 9.73}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.8025969286496343e-46, "cur_lr": 0.0005, "total_loss": 0.6665180623531342, "policy_loss": -1.904983504502633e-05, "vf_loss": 0.6815006136894226, "vf_explained_var": -0.0009605884552001953, "kl": 1.606011382226935e-05, "entropy": 1.4963439106941223, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3000000, "num_agent_steps_sampled": 3000000, "num_steps_trained": 3000000, "num_agent_steps_trained": 3000000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -165.86937145189907, "episode_reward_min": -205.2308907672666, "episode_reward_mean": -187.31272028504034, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.24184263347874, -172.06087096644424, -205.2308907672666, -187.28024639092996, -200.59601404283308, -203.83422998993774, -176.82688128650466, -193.61516639082862, -174.57168893028074, -165.86937145189907], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3056261449310334, "mean_inference_ms": 1.2178545109758212, "mean_action_processing_ms": 0.0850168401460458, "mean_env_wait_ms": 0.5506065205473739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 625, "training_iteration": 150, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-16-09", "timestamp": 1702710969, "time_this_iter_s": 30.831151247024536, "time_total_s": 1537.482309103012, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4027a040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1537.482309103012, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 30.356410256410253, "ram_util_percent": 43.65897435897436, "gpu_util_percent0": 0.0023076923076923075, "vram_util_percent0": 0.014973958333333339}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -208.77557152062454, "episode_reward_mean": -182.40426775168933, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.81262461579504, -192.19460586254138, -178.57563759516077, -172.9651541651348, -171.93702566680037, -190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401442644398539, "mean_inference_ms": 1.199036739922427, "mean_action_processing_ms": 0.08723159571308622, "mean_env_wait_ms": 0.5599703363104378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3020000, "timesteps_this_iter": 0, "agent_timesteps_total": 3020000, "timers": {"sample_time_ms": 12043.576, "sample_throughput": 1660.636, "load_time_ms": 0.249, "load_throughput": 80289127.106, "learn_time_ms": 992.736, "learn_throughput": 20146.336, "update_time_ms": 9.756}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4012984643248171e-46, "cur_lr": 0.0005, "total_loss": 0.3124852031469345, "policy_loss": -0.00019093103625422714, "vf_loss": 0.3277507722377777, "vf_explained_var": -0.0016741752624511719, "kl": 4.9905019160911834e-05, "entropy": 1.5074628591537476, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3020000, "num_agent_steps_sampled": 3020000, "num_steps_trained": 3020000, "num_agent_steps_trained": 3020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 625, "training_iteration": 151, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-16-19", "timestamp": 1702710979, "time_this_iter_s": 9.860678434371948, "time_total_s": 1547.342987537384, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48355d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1547.342987537384, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 30.59166666666667, "ram_util_percent": 43.699999999999996, "gpu_util_percent0": 0.008333333333333333, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -182.98136038592503, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.99493067967282, -186.43931974153296, -191.18886837084057, -192.32930607464235, -174.05591132057103, -200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401569388530028, "mean_inference_ms": 1.1991515832017834, "mean_action_processing_ms": 0.08722516549707425, "mean_env_wait_ms": 0.5600015602810248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3040000, "timesteps_this_iter": 0, "agent_timesteps_total": 3040000, "timers": {"sample_time_ms": 12043.845, "sample_throughput": 1660.599, "load_time_ms": 0.25, "load_throughput": 80143383.969, "learn_time_ms": 990.892, "learn_throughput": 20183.834, "update_time_ms": 9.397}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.006492321624086e-47, "cur_lr": 0.0005, "total_loss": 0.6878290474414825, "policy_loss": -0.00015171288917770198, "vf_loss": 0.7027695775032043, "vf_explained_var": -0.0006359219551086426, "kl": 0.00010689665771743129, "entropy": 1.4788844585418701, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3040000, "num_agent_steps_sampled": 3040000, "num_steps_trained": 3040000, "num_agent_steps_trained": 3040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 630, "training_iteration": 152, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-16-29", "timestamp": 1702710989, "time_this_iter_s": 9.924797296524048, "time_total_s": 1557.267784833908, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4027aaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1557.267784833908, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 31.05, "ram_util_percent": 43.94166666666666, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -182.9027076981706, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.11701477856644, -187.98172871216417, -190.79321871378158, -171.59293911294847, -179.9490279172767, -189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34016588591535724, "mean_inference_ms": 1.1992680448570696, "mean_action_processing_ms": 0.087218693480426, "mean_env_wait_ms": 0.5600282726903723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3060000, "timesteps_this_iter": 0, "agent_timesteps_total": 3060000, "timers": {"sample_time_ms": 12055.751, "sample_throughput": 1658.959, "load_time_ms": 0.249, "load_throughput": 80220024.864, "learn_time_ms": 991.645, "learn_throughput": 20168.514, "update_time_ms": 9.398}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.503246160812043e-47, "cur_lr": 0.0005, "total_loss": 0.6520409882068634, "policy_loss": -5.51553722762943e-05, "vf_loss": 0.6665926873683929, "vf_explained_var": -0.0005519986152648926, "kl": 6.832094406039602e-05, "entropy": 1.4496583342552185, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3060000, "num_agent_steps_sampled": 3060000, "num_steps_trained": 3060000, "num_agent_steps_trained": 3060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 635, "training_iteration": 153, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-16-39", "timestamp": 1702710999, "time_this_iter_s": 9.908177137374878, "time_total_s": 1567.175961971283, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48d475e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1567.175961971283, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.0, "ram_util_percent": 43.66923076923077, "gpu_util_percent0": 0.007692307692307693, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -182.60043149192913, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.52673893754354, -177.93070880384687, -166.6042076139966, -196.92668483646221, -182.29903944996158, -177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3401770693283972, "mean_inference_ms": 1.1993787488693397, "mean_action_processing_ms": 0.0872116299939388, "mean_env_wait_ms": 0.5600542589056764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3080000, "timesteps_this_iter": 0, "agent_timesteps_total": 3080000, "timers": {"sample_time_ms": 12057.108, "sample_throughput": 1658.773, "load_time_ms": 0.249, "load_throughput": 80366047.135, "learn_time_ms": 993.249, "learn_throughput": 20135.941, "update_time_ms": 9.494}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7516230804060214e-47, "cur_lr": 0.0005, "total_loss": 0.5526842176914215, "policy_loss": -2.6703548190010196e-05, "vf_loss": 0.5671532452106476, "vf_explained_var": -0.0009636282920837402, "kl": 4.634203289288763e-05, "entropy": 1.444235384464264, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3080000, "num_agent_steps_sampled": 3080000, "num_steps_trained": 3080000, "num_agent_steps_trained": 3080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 154, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-16-49", "timestamp": 1702711009, "time_this_iter_s": 9.85546875, "time_total_s": 1577.031430721283, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1577.031430721283, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 30.658333333333335, "ram_util_percent": 43.94166666666666, "gpu_util_percent0": 0.009166666666666667, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -182.1288769575279, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177.11571111118417, -182.66382621793844, -203.63930648035662, -184.18372967318138, -179.33303314543164, -183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34019096203216564, "mean_inference_ms": 1.199492123707711, "mean_action_processing_ms": 0.0872046331743422, "mean_env_wait_ms": 0.5600748954678718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3100000, "timesteps_this_iter": 0, "agent_timesteps_total": 3100000, "timers": {"sample_time_ms": 12065.152, "sample_throughput": 1657.667, "load_time_ms": 0.25, "load_throughput": 80066889.377, "learn_time_ms": 995.6, "learn_throughput": 20088.386, "update_time_ms": 9.564}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.758115402030107e-48, "cur_lr": 0.0005, "total_loss": 0.3900028169155121, "policy_loss": 1.0077667472074836e-05, "vf_loss": 0.4042883366346359, "vf_explained_var": -0.00138932466506958, "kl": 8.95659089783507e-06, "entropy": 1.429557979106903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3100000, "num_agent_steps_sampled": 3100000, "num_steps_trained": 3100000, "num_agent_steps_trained": 3100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 645, "training_iteration": 155, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-16-59", "timestamp": 1702711019, "time_this_iter_s": 9.934019088745117, "time_total_s": 1586.965449810028, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9b2550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1586.965449810028, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 30.94615384615384, "ram_util_percent": 44.05384615384616, "gpu_util_percent0": 0.014615384615384615, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -181.34231835342752, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3402042723551481, "mean_inference_ms": 1.1996206217741046, "mean_action_processing_ms": 0.08719789640562166, "mean_env_wait_ms": 0.5600878410091008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3120000, "timesteps_this_iter": 0, "agent_timesteps_total": 3120000, "timers": {"sample_time_ms": 12063.299, "sample_throughput": 1657.921, "load_time_ms": 0.259, "load_throughput": 77321485.851, "learn_time_ms": 993.791, "learn_throughput": 20124.948, "update_time_ms": 9.297}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.3790577010150536e-48, "cur_lr": 0.0005, "total_loss": 0.6137645542621613, "policy_loss": -6.494674429990965e-05, "vf_loss": 0.6280949115753174, "vf_explained_var": -0.0007948875427246094, "kl": 3.100343715090048e-05, "entropy": 1.426542043685913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3120000, "num_agent_steps_sampled": 3120000, "num_steps_trained": 3120000, "num_agent_steps_trained": 3120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 650, "training_iteration": 156, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-17-08", "timestamp": 1702711028, "time_this_iter_s": 9.905904293060303, "time_total_s": 1596.8713541030884, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1596.8713541030884, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 30.466666666666665, "ram_util_percent": 44.13333333333333, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -181.34231835342752, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.25215862701526, -170.68494660363328, -167.46234714481633, -189.11159757577784, -184.4862310004619, -204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3402042723551481, "mean_inference_ms": 1.1996206217741046, "mean_action_processing_ms": 0.08719789640562166, "mean_env_wait_ms": 0.5600878410091008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3140000, "timesteps_this_iter": 0, "agent_timesteps_total": 3140000, "timers": {"sample_time_ms": 12053.889, "sample_throughput": 1659.216, "load_time_ms": 0.252, "load_throughput": 79302401.21, "learn_time_ms": 997.787, "learn_throughput": 20044.35, "update_time_ms": 9.383}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1895288505075268e-48, "cur_lr": 0.0005, "total_loss": 0.05102548561990261, "policy_loss": -0.00020958433696094403, "vf_loss": 0.06571950018405914, "vf_explained_var": -0.0024940967559814453, "kl": 0.00015251677809443448, "entropy": 1.4484432339668274, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3140000, "num_agent_steps_sampled": 3140000, "num_steps_trained": 3140000, "num_agent_steps_trained": 3140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 650, "training_iteration": 157, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-17-18", "timestamp": 1702711038, "time_this_iter_s": 9.900597095489502, "time_total_s": 1606.7719511985779, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1606.7719511985779, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 30.95384615384615, "ram_util_percent": 44.19230769230769, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -181.0820445481816, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.5703265047733, -202.50320758931653, -189.4155716766441, -166.44321680874495, -165.5922368846723, -180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.340219583066807, "mean_inference_ms": 1.1997462664959349, "mean_action_processing_ms": 0.08719156943181895, "mean_env_wait_ms": 0.5601081059044359, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3160000, "timesteps_this_iter": 0, "agent_timesteps_total": 3160000, "timers": {"sample_time_ms": 12051.499, "sample_throughput": 1659.545, "load_time_ms": 0.253, "load_throughput": 78981338.857, "learn_time_ms": 999.61, "learn_throughput": 20007.803, "update_time_ms": 9.404}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0947644252537634e-48, "cur_lr": 0.0005, "total_loss": 0.6376703679561615, "policy_loss": -8.350849309834985e-06, "vf_loss": 0.6523109376430511, "vf_explained_var": -0.0004544854164123535, "kl": 0.00021597194841338485, "entropy": 1.4632249474525452, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3160000, "num_agent_steps_sampled": 3160000, "num_steps_trained": 3160000, "num_agent_steps_trained": 3160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 655, "training_iteration": 158, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-17-28", "timestamp": 1702711048, "time_this_iter_s": 9.975313186645508, "time_total_s": 1616.7472643852234, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1616.7472643852234, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 31.000000000000004, "ram_util_percent": 44.199999999999996, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -180.73145237392808, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180.5886197068137, -175.48582706901544, -195.7343062159272, -183.39973588705448, -182.80269209551233, -201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34023970251254987, "mean_inference_ms": 1.199868508837297, "mean_action_processing_ms": 0.0871852646420232, "mean_env_wait_ms": 0.5601289086575805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3180000, "timesteps_this_iter": 0, "agent_timesteps_total": 3180000, "timers": {"sample_time_ms": 12045.362, "sample_throughput": 1660.39, "load_time_ms": 0.252, "load_throughput": 79220020.776, "learn_time_ms": 997.173, "learn_throughput": 20056.709, "update_time_ms": 12.998}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.473822126268817e-49, "cur_lr": 0.0005, "total_loss": 0.6886299848556519, "policy_loss": -8.029508381168782e-05, "vf_loss": 0.7034647464752197, "vf_explained_var": -0.0008321404457092285, "kl": 0.0002000560726639032, "entropy": 1.475448489189148, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3180000, "num_agent_steps_sampled": 3180000, "num_steps_trained": 3180000, "num_agent_steps_trained": 3180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 660, "training_iteration": 159, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-17-38", "timestamp": 1702711058, "time_this_iter_s": 9.97604513168335, "time_total_s": 1626.7233095169067, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1626.7233095169067, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 30.923076923076923, "ram_util_percent": 44.39999999999999, "gpu_util_percent0": 0.006923076923076924, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -180.94738186404803, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.32836777306224, -177.99417223690605, -166.362484412235, -180.0860280620765, -196.56753984505883, -194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34026309083876805, "mean_inference_ms": 1.1999945338863751, "mean_action_processing_ms": 0.08717872125965977, "mean_env_wait_ms": 0.5601449196238696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3200000, "timesteps_this_iter": 0, "agent_timesteps_total": 3200000, "timers": {"sample_time_ms": 12053.973, "sample_throughput": 1659.204, "load_time_ms": 0.256, "load_throughput": 78164442.788, "learn_time_ms": 998.646, "learn_throughput": 20027.118, "update_time_ms": 13.049}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7369110631344085e-49, "cur_lr": 0.0005, "total_loss": 0.6901957094669342, "policy_loss": 6.3627622288287e-05, "vf_loss": 0.7052059769630432, "vf_explained_var": -0.0009441971778869629, "kl": 0.00013183895766744058, "entropy": 1.5073872208595276, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3200000, "num_agent_steps_sampled": 3200000, "num_steps_trained": 3200000, "num_agent_steps_trained": 3200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 665, "training_iteration": 160, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-17-48", "timestamp": 1702711068, "time_this_iter_s": 9.923941135406494, "time_total_s": 1636.6472506523132, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48d475e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1636.6472506523132, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 30.733333333333334, "ram_util_percent": 44.35, "gpu_util_percent0": 0.004166666666666667, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -180.9333177364103, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.35613259824632, -180.12954766661764, -200.81683891832313, -185.4382038591625, -195.5244932955146, -183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3402863881317051, "mean_inference_ms": 1.2001208621579158, "mean_action_processing_ms": 0.08717289276278592, "mean_env_wait_ms": 0.5601653992079919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3220000, "timesteps_this_iter": 0, "agent_timesteps_total": 3220000, "timers": {"sample_time_ms": 9962.685, "sample_throughput": 2007.491, "load_time_ms": 0.256, "load_throughput": 78193586.875, "learn_time_ms": 1000.038, "learn_throughput": 19999.24, "update_time_ms": 13.06}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3684555315672042e-49, "cur_lr": 0.0005, "total_loss": 0.4982118159532547, "policy_loss": 2.169075042468549e-05, "vf_loss": 0.5131874084472656, "vf_explained_var": -0.0013073086738586426, "kl": 4.5075635676461445e-05, "entropy": 1.499727487564087, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3220000, "num_agent_steps_sampled": 3220000, "num_steps_trained": 3220000, "num_agent_steps_trained": 3220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 670, "training_iteration": 161, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-17-58", "timestamp": 1702711078, "time_this_iter_s": 9.957107782363892, "time_total_s": 1646.6043584346771, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1646.6043584346771, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 30.75, "ram_util_percent": 44.64166666666667, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -180.83324740956974, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34030680503814464, "mean_inference_ms": 1.2002446039230599, "mean_action_processing_ms": 0.0871667012448447, "mean_env_wait_ms": 0.5601755547711029, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3240000, "timesteps_this_iter": 0, "agent_timesteps_total": 3240000, "timers": {"sample_time_ms": 9952.448, "sample_throughput": 2009.556, "load_time_ms": 0.256, "load_throughput": 78215459.207, "learn_time_ms": 1001.934, "learn_throughput": 19961.398, "update_time_ms": 13.149}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.842277657836021e-50, "cur_lr": 0.0005, "total_loss": 0.7037524580955505, "policy_loss": -0.00011961937291779523, "vf_loss": 0.7187395691871643, "vf_explained_var": -0.0011979937553405762, "kl": 4.7609145418014975e-05, "entropy": 1.4867510795593262, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3240000, "num_agent_steps_sampled": 3240000, "num_steps_trained": 3240000, "num_agent_steps_trained": 3240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 675, "training_iteration": 162, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-18-08", "timestamp": 1702711088, "time_this_iter_s": 9.82594084739685, "time_total_s": 1656.430299282074, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dca60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1656.430299282074, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 30.469230769230766, "ram_util_percent": 44.7, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -180.83324740956974, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.7409566900817, -184.40207338454468, -202.7874049807029, -175.84367909595738, -186.93290068004166, -190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34030680503814464, "mean_inference_ms": 1.2002446039230599, "mean_action_processing_ms": 0.0871667012448447, "mean_env_wait_ms": 0.5601755547711029, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3260000, "timesteps_this_iter": 0, "agent_timesteps_total": 3260000, "timers": {"sample_time_ms": 9943.698, "sample_throughput": 2011.324, "load_time_ms": 0.256, "load_throughput": 78157160.16, "learn_time_ms": 1002.16, "learn_throughput": 19956.901, "update_time_ms": 13.117}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4211388289180106e-50, "cur_lr": 0.0005, "total_loss": 0.09080982580780983, "policy_loss": -4.738521717229105e-06, "vf_loss": 0.10566063225269318, "vf_explained_var": -0.0021191835403442383, "kl": 4.272053176784807e-05, "entropy": 1.4846073985099792, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3260000, "num_agent_steps_sampled": 3260000, "num_steps_trained": 3260000, "num_agent_steps_trained": 3260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 675, "training_iteration": 163, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-18-18", "timestamp": 1702711098, "time_this_iter_s": 9.884972095489502, "time_total_s": 1666.3152713775635, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481ad700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1666.3152713775635, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 30.974999999999998, "ram_util_percent": 44.83333333333332, "gpu_util_percent0": 0.007500000000000001, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.030729942757, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -180.23649314664712, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.37388344772992, -167.51160531094888, -165.030729942757, -188.51404412735164, -208.77557152062454, -188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34032696272080903, "mean_inference_ms": 1.2003768544872195, "mean_action_processing_ms": 0.08716071616063288, "mean_env_wait_ms": 0.5601919426007904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3280000, "timesteps_this_iter": 0, "agent_timesteps_total": 3280000, "timers": {"sample_time_ms": 9957.064, "sample_throughput": 2008.624, "load_time_ms": 0.256, "load_throughput": 78157160.16, "learn_time_ms": 1001.689, "learn_throughput": 19966.284, "update_time_ms": 13.006}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7105694144590053e-50, "cur_lr": 0.0005, "total_loss": 0.6295941174030304, "policy_loss": -4.443216490912505e-05, "vf_loss": 0.6443561911582947, "vf_explained_var": -0.000827491283416748, "kl": 2.735530404307518e-05, "entropy": 1.4717603921890259, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3280000, "num_agent_steps_sampled": 3280000, "num_steps_trained": 3280000, "num_agent_steps_trained": 3280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 164, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-18-28", "timestamp": 1702711108, "time_this_iter_s": 9.977670192718506, "time_total_s": 1676.292941570282, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9b20d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1676.292941570282, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 30.825000000000003, "ram_util_percent": 44.916666666666664, "gpu_util_percent0": 0.006666666666666667, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.76129929397604, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.8694200527973, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.34006563811596, -180.5086223975074, -175.97575937014986, -173.27982660887386, -194.24361536302234, -174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34034915279938055, "mean_inference_ms": 1.200520636681092, "mean_action_processing_ms": 0.08715572925201105, "mean_env_wait_ms": 0.5602068457177298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3300000, "timesteps_this_iter": 0, "agent_timesteps_total": 3300000, "timers": {"sample_time_ms": 9962.416, "sample_throughput": 2007.545, "load_time_ms": 0.248, "load_throughput": 80582209.414, "learn_time_ms": 1002.975, "learn_throughput": 19940.682, "update_time_ms": 12.932}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.552847072295027e-51, "cur_lr": 0.0005, "total_loss": 0.5849179029464722, "policy_loss": -0.0001912164620356538, "vf_loss": 0.5996896326541901, "vf_explained_var": -0.0016571283340454102, "kl": 7.149401859418703e-05, "entropy": 1.4580557346343994, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3300000, "num_agent_steps_sampled": 3300000, "num_steps_trained": 3300000, "num_agent_steps_trained": 3300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 685, "training_iteration": 165, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-18-38", "timestamp": 1702711118, "time_this_iter_s": 9.961935997009277, "time_total_s": 1686.2548775672913, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48188040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1686.2548775672913, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 31.076923076923077, "ram_util_percent": 44.93846153846153, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.69633964406287, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.2831847959934, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.9212069273015, -181.42608903377484, -178.53068322798524, -165.76129929397604, -169.31972206187348, -167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3403692702461694, "mean_inference_ms": 1.200672671396919, "mean_action_processing_ms": 0.08715056644977079, "mean_env_wait_ms": 0.5602097703238784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3320000, "timesteps_this_iter": 0, "agent_timesteps_total": 3320000, "timers": {"sample_time_ms": 9966.42, "sample_throughput": 2006.739, "load_time_ms": 0.238, "load_throughput": 83919647.859, "learn_time_ms": 1005.004, "learn_throughput": 19900.424, "update_time_ms": 12.937}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.276423536147513e-51, "cur_lr": 0.0005, "total_loss": 0.5646260976791382, "policy_loss": -0.0001641220060877302, "vf_loss": 0.5793600976467133, "vf_explained_var": -0.0012486577033996582, "kl": 0.00014905975279710937, "entropy": 1.4569894075393677, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3320000, "num_agent_steps_sampled": 3320000, "num_steps_trained": 3320000, "num_agent_steps_trained": 3320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 690, "training_iteration": 166, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-18-48", "timestamp": 1702711128, "time_this_iter_s": 9.950169801712036, "time_total_s": 1696.2050473690033, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d40145ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1696.2050473690033, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 30.983333333333334, "ram_util_percent": 44.824999999999996, "gpu_util_percent0": 0.0033333333333333335, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.69633964406287, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.4786205453009, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.15425418940865, -172.30196542803873, -171.3424573935681, -188.1826986780457, -179.8653068946009, -172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3403904361205099, "mean_inference_ms": 1.2008306268796631, "mean_action_processing_ms": 0.08714614140332089, "mean_env_wait_ms": 0.5602168269239752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3340000, "timesteps_this_iter": 0, "agent_timesteps_total": 3340000, "timers": {"sample_time_ms": 9981.926, "sample_throughput": 2003.621, "load_time_ms": 0.238, "load_throughput": 83894469.447, "learn_time_ms": 1007.25, "learn_throughput": 19856.052, "update_time_ms": 12.88}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1382117680737566e-51, "cur_lr": 0.0005, "total_loss": 0.40254929661750793, "policy_loss": -5.999040668247524e-05, "vf_loss": 0.4169706106185913, "vf_explained_var": -0.001191556453704834, "kl": 0.00014304870076842224, "entropy": 1.4361318349838257, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3340000, "num_agent_steps_sampled": 3340000, "num_steps_trained": 3340000, "num_agent_steps_trained": 3340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 695, "training_iteration": 167, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-18-58", "timestamp": 1702711138, "time_this_iter_s": 10.062297344207764, "time_total_s": 1706.267344713211, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1706.267344713211, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 30.884615384615383, "ram_util_percent": 44.9923076923077, "gpu_util_percent0": 0.00923076923076923, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.69633964406287, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.26658754570937, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404113769429188, "mean_inference_ms": 1.2009866089682275, "mean_action_processing_ms": 0.08714209887988003, "mean_env_wait_ms": 0.5602292244530855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3360000, "timesteps_this_iter": 0, "agent_timesteps_total": 3360000, "timers": {"sample_time_ms": 9980.322, "sample_throughput": 2003.943, "load_time_ms": 0.238, "load_throughput": 84037347.225, "learn_time_ms": 1008.511, "learn_throughput": 19831.225, "update_time_ms": 12.854}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0691058840368783e-51, "cur_lr": 0.0005, "total_loss": 0.6243190765380859, "policy_loss": -1.157493583736624e-05, "vf_loss": 0.6385640799999237, "vf_explained_var": -0.0009299516677856445, "kl": 9.05687890137008e-05, "entropy": 1.4233356714248657, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3360000, "num_agent_steps_sampled": 3360000, "num_steps_trained": 3360000, "num_agent_steps_trained": 3360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 700, "training_iteration": 168, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-19-08", "timestamp": 1702711148, "time_this_iter_s": 9.946391582489014, "time_total_s": 1716.2137362957, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1716.2137362957, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 30.491666666666664, "ram_util_percent": 45.16666666666668, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.69633964406287, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.26658754570937, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.1329287217271, -171.03021572440872, -173.0088296116868, -174.4846265338609, -174.48527769537907, -176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404113769429188, "mean_inference_ms": 1.2009866089682275, "mean_action_processing_ms": 0.08714209887988003, "mean_env_wait_ms": 0.5602292244530855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3380000, "timesteps_this_iter": 0, "agent_timesteps_total": 3380000, "timers": {"sample_time_ms": 9980.724, "sample_throughput": 2003.863, "load_time_ms": 0.239, "load_throughput": 83760439.341, "learn_time_ms": 1012.413, "learn_throughput": 19754.775, "update_time_ms": 9.256}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.3455294201843916e-52, "cur_lr": 0.0005, "total_loss": 0.10113020986318588, "policy_loss": 2.4669457252990412e-05, "vf_loss": 0.11546097323298454, "vf_explained_var": -0.0014014244079589844, "kl": 3.00875935210429e-05, "entropy": 1.4355430006980896, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3380000, "num_agent_steps_sampled": 3380000, "num_steps_trained": 3380000, "num_agent_steps_trained": 3380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 700, "training_iteration": 169, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-19-18", "timestamp": 1702711158, "time_this_iter_s": 9.96912169456482, "time_total_s": 1726.182857990265, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1726.182857990265, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 30.883333333333336, "ram_util_percent": 45.36666666666667, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.69633964406287, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.36405351812328, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.2912703273783, -173.18467037464498, -186.6040530438768, -180.69059102915455, -174.92231092273886, -185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34042939590819005, "mean_inference_ms": 1.2011395553109994, "mean_action_processing_ms": 0.08713806237346883, "mean_env_wait_ms": 0.5602434118821528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3400000, "timesteps_this_iter": 0, "agent_timesteps_total": 3400000, "timers": {"sample_time_ms": 9972.569, "sample_throughput": 2005.501, "load_time_ms": 0.236, "load_throughput": 84913533.758, "learn_time_ms": 1014.49, "learn_throughput": 19714.349, "update_time_ms": 9.382}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6727647100921958e-52, "cur_lr": 0.0005, "total_loss": 0.6077587008476257, "policy_loss": -5.849790615597428e-05, "vf_loss": 0.6220594346523285, "vf_explained_var": -0.0005760788917541504, "kl": 1.7064932947952194e-05, "entropy": 1.4242255091667175, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3400000, "num_agent_steps_sampled": 3400000, "num_steps_trained": 3400000, "num_agent_steps_trained": 3400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 705, "training_iteration": 170, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-19-28", "timestamp": 1702711168, "time_this_iter_s": 9.912490844726562, "time_total_s": 1736.0953488349915, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4027a9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1736.0953488349915, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 31.0, "ram_util_percent": 45.29230769230769, "gpu_util_percent0": 0.006923076923076924, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -165.69633964406287, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -179.0551189554231, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.7396277037036, -173.7505548855633, -190.8840687979998, -179.82427289395443, -170.5663210320788, -193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404459687005025, "mean_inference_ms": 1.2012931056390155, "mean_action_processing_ms": 0.08713407766245894, "mean_env_wait_ms": 0.5602552485213055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3420000, "timesteps_this_iter": 0, "agent_timesteps_total": 3420000, "timers": {"sample_time_ms": 9973.714, "sample_throughput": 2005.271, "load_time_ms": 0.248, "load_throughput": 80528059.902, "learn_time_ms": 1017.041, "learn_throughput": 19664.9, "update_time_ms": 9.564}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3363823550460979e-52, "cur_lr": 0.0005, "total_loss": 0.6181559860706329, "policy_loss": -1.7785072262910262e-05, "vf_loss": 0.6323529183864594, "vf_explained_var": -0.0013313889503479004, "kl": 1.2711271653476075e-05, "entropy": 1.4179179072380066, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3420000, "num_agent_steps_sampled": 3420000, "num_steps_trained": 3420000, "num_agent_steps_trained": 3420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 710, "training_iteration": 171, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-19-38", "timestamp": 1702711178, "time_this_iter_s": 9.973249673843384, "time_total_s": 1746.0685985088348, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1746.0685985088348, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 31.150000000000002, "ram_util_percent": 45.36666666666667, "gpu_util_percent0": 0.009166666666666667, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -178.77826784030742, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.85933782800788, -166.60045369056454, -184.30394934949453, -166.8268212704806, -186.01086432658394, -198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34046063617931915, "mean_inference_ms": 1.2014378442773193, "mean_action_processing_ms": 0.08712994012320896, "mean_env_wait_ms": 0.5602732529713758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3440000, "timesteps_this_iter": 0, "agent_timesteps_total": 3440000, "timers": {"sample_time_ms": 9995.961, "sample_throughput": 2000.808, "load_time_ms": 0.262, "load_throughput": 76371158.048, "learn_time_ms": 1014.102, "learn_throughput": 19721.883, "update_time_ms": 9.652}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.6819117752304895e-53, "cur_lr": 0.0005, "total_loss": 0.5234533250331879, "policy_loss": -1.282234198729526e-05, "vf_loss": 0.5377732515335083, "vf_explained_var": -0.0013782382011413574, "kl": 2.067999013599664e-05, "entropy": 1.4307056665420532, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3440000, "num_agent_steps_sampled": 3440000, "num_steps_trained": 3440000, "num_agent_steps_trained": 3440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 715, "training_iteration": 172, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-19-48", "timestamp": 1702711188, "time_this_iter_s": 9.990524291992188, "time_total_s": 1756.059122800827, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482388b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1756.059122800827, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 31.28333333333333, "ram_util_percent": 45.5, "gpu_util_percent0": 0.007500000000000001, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -178.3385056196963, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.33972265119576, -194.9848369020916, -184.08210424126858, -171.10218848933428, -193.36332578005954, -185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34047351471286036, "mean_inference_ms": 1.2015771780461149, "mean_action_processing_ms": 0.08712569477412924, "mean_env_wait_ms": 0.5602898291593899, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3460000, "timesteps_this_iter": 0, "agent_timesteps_total": 3460000, "timers": {"sample_time_ms": 10003.917, "sample_throughput": 1999.217, "load_time_ms": 0.263, "load_throughput": 75963125.962, "learn_time_ms": 1014.902, "learn_throughput": 19706.341, "update_time_ms": 9.691}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3409558876152447e-53, "cur_lr": 0.0005, "total_loss": 0.3975114971399307, "policy_loss": -1.0136032089942681e-05, "vf_loss": 0.41180500388145447, "vf_explained_var": -0.0016650557518005371, "kl": 2.5390438890271483e-05, "entropy": 1.4283407330513, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3460000, "num_agent_steps_sampled": 3460000, "num_steps_trained": 3460000, "num_agent_steps_trained": 3460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 173, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-19-58", "timestamp": 1702711198, "time_this_iter_s": 9.957637310028076, "time_total_s": 1766.016760110855, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481881f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1766.016760110855, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 31.146153846153847, "ram_util_percent": 45.67692307692308, "gpu_util_percent0": 0.016153846153846154, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -177.7486988881537, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34048491022456806, "mean_inference_ms": 1.2017090949048088, "mean_action_processing_ms": 0.08712113697380751, "mean_env_wait_ms": 0.5603092099395685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3480000, "timesteps_this_iter": 0, "agent_timesteps_total": 3480000, "timers": {"sample_time_ms": 9990.816, "sample_throughput": 2001.839, "load_time_ms": 0.264, "load_throughput": 75784695.998, "learn_time_ms": 1014.117, "learn_throughput": 19721.595, "update_time_ms": 9.816}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6704779438076224e-53, "cur_lr": 0.0005, "total_loss": 0.6152477562427521, "policy_loss": -8.71223435385815e-05, "vf_loss": 0.6296874284744263, "vf_explained_var": -0.0007170438766479492, "kl": 6.365848090918169e-05, "entropy": 1.4352564215660095, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3480000, "num_agent_steps_sampled": 3480000, "num_steps_trained": 3480000, "num_agent_steps_trained": 3480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 725, "training_iteration": 174, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-20-08", "timestamp": 1702711208, "time_this_iter_s": 9.832293033599854, "time_total_s": 1775.849053144455, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d40145e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1775.849053144455, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 30.599999999999994, "ram_util_percent": 45.75833333333333, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -221.1303513771941, "episode_reward_mean": -177.7486988881537, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.81455678158846, -221.1303513771941, -176.05751563177043, -207.04203574009227, -170.14985179835614, -194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34048491022456806, "mean_inference_ms": 1.2017090949048088, "mean_action_processing_ms": 0.08712113697380751, "mean_env_wait_ms": 0.5603092099395685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3500000, "timesteps_this_iter": 0, "agent_timesteps_total": 3500000, "timers": {"sample_time_ms": 9980.811, "sample_throughput": 2003.845, "load_time_ms": 0.264, "load_throughput": 75634370.21, "learn_time_ms": 1015.116, "learn_throughput": 19702.179, "update_time_ms": 9.849}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.352389719038112e-54, "cur_lr": 0.0005, "total_loss": 0.2519804835319519, "policy_loss": 9.57765587550341e-06, "vf_loss": 0.2666599452495575, "vf_explained_var": -0.002122938632965088, "kl": 4.0286629898744764e-05, "entropy": 1.4689037799835205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3500000, "num_agent_steps_sampled": 3500000, "num_steps_trained": 3500000, "num_agent_steps_trained": 3500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 725, "training_iteration": 175, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-20-18", "timestamp": 1702711218, "time_this_iter_s": 9.924699783325195, "time_total_s": 1785.7737529277802, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4027a280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1785.7737529277802, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 31.058333333333326, "ram_util_percent": 45.60833333333334, "gpu_util_percent0": 0.005833333333333334, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.36532598451032, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.13787069325852, -175.65756828429068, -190.29907480158792, -181.57578897666554, -185.4727646560116, -179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.340493754326306, "mean_inference_ms": 1.2018414072080983, "mean_action_processing_ms": 0.0871171882555727, "mean_env_wait_ms": 0.5603433448779377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3520000, "timesteps_this_iter": 0, "agent_timesteps_total": 3520000, "timers": {"sample_time_ms": 10003.308, "sample_throughput": 1999.339, "load_time_ms": 0.277, "load_throughput": 72191118.761, "learn_time_ms": 1020.118, "learn_throughput": 19605.569, "update_time_ms": 9.869}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.176194859519056e-54, "cur_lr": 0.0005, "total_loss": 0.7179036438465118, "policy_loss": -0.00020975046732907288, "vf_loss": 0.7326995134353638, "vf_explained_var": -0.0012487173080444336, "kl": 0.00011364749377598682, "entropy": 1.4586037397384644, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3520000, "num_agent_steps_sampled": 3520000, "num_steps_trained": 3520000, "num_agent_steps_trained": 3520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 730, "training_iteration": 176, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-20-28", "timestamp": 1702711228, "time_this_iter_s": 10.216779708862305, "time_total_s": 1795.9905326366425, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9740d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1795.9905326366425, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 31.23846153846154, "ram_util_percent": 45.66153846153847, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.30753572895995, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179.17466416309702, -173.07379552831088, -190.58244250694037, -170.7746865785941, -186.6007198336485, -170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405024688223107, "mean_inference_ms": 1.201969787447695, "mean_action_processing_ms": 0.08711312473994567, "mean_env_wait_ms": 0.5603809075717151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3540000, "timesteps_this_iter": 0, "agent_timesteps_total": 3540000, "timers": {"sample_time_ms": 10001.388, "sample_throughput": 1999.723, "load_time_ms": 0.278, "load_throughput": 71961979.926, "learn_time_ms": 1018.904, "learn_throughput": 19628.929, "update_time_ms": 9.8}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.088097429759528e-54, "cur_lr": 0.0005, "total_loss": 0.708588719367981, "policy_loss": -0.00020761899782817395, "vf_loss": 0.7231268584728241, "vf_explained_var": -0.0012391209602355957, "kl": 0.00018048936503201052, "entropy": 1.4330491423606873, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3540000, "num_agent_steps_sampled": 3540000, "num_steps_trained": 3540000, "num_agent_steps_trained": 3540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 735, "training_iteration": 177, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-20-38", "timestamp": 1702711238, "time_this_iter_s": 9.973666429519653, "time_total_s": 1805.964199066162, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d484191f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1805.964199066162, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 31.09166666666667, "ram_util_percent": 45.80833333333333, "gpu_util_percent0": 0.005833333333333334, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.58419456909104, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.82902206625153, -171.8723511559552, -180.49691030930276, -172.3850077744976, -170.54863489568416, -174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.340507049937585, "mean_inference_ms": 1.202104184459319, "mean_action_processing_ms": 0.08710930702860209, "mean_env_wait_ms": 0.5604218270684737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3560000, "timesteps_this_iter": 0, "agent_timesteps_total": 3560000, "timers": {"sample_time_ms": 10002.408, "sample_throughput": 1999.518, "load_time_ms": 0.278, "load_throughput": 72017582.418, "learn_time_ms": 1016.388, "learn_throughput": 19677.524, "update_time_ms": 9.832}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.044048714879764e-54, "cur_lr": 0.0005, "total_loss": 0.5717962980270386, "policy_loss": -2.957839937867135e-05, "vf_loss": 0.5860427618026733, "vf_explained_var": -0.0004863142967224121, "kl": 0.00012383460363341037, "entropy": 1.4216915965080261, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3560000, "num_agent_steps_sampled": 3560000, "num_steps_trained": 3560000, "num_agent_steps_trained": 3560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 740, "training_iteration": 178, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-20-48", "timestamp": 1702711248, "time_this_iter_s": 9.949232578277588, "time_total_s": 1815.9134316444397, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48238af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1815.9134316444397, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 31.04166666666666, "ram_util_percent": 45.9, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.5764944209707, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.3654632098134, -168.78591845116995, -168.2685973914868, -165.9388982913167, -170.920868874262, -174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405088607700549, "mean_inference_ms": 1.202235306580173, "mean_action_processing_ms": 0.0871059176245337, "mean_env_wait_ms": 0.560474457730421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3580000, "timesteps_this_iter": 0, "agent_timesteps_total": 3580000, "timers": {"sample_time_ms": 10014.385, "sample_throughput": 1997.127, "load_time_ms": 0.304, "load_throughput": 65715691.344, "learn_time_ms": 1012.673, "learn_throughput": 19749.712, "update_time_ms": 9.907}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.22024357439882e-55, "cur_lr": 0.0005, "total_loss": 0.3802592605352402, "policy_loss": 1.7580318965926267e-05, "vf_loss": 0.3942953199148178, "vf_explained_var": -0.001119077205657959, "kl": 5.5023563798883846e-05, "entropy": 1.4053635001182556, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3580000, "num_agent_steps_sampled": 3580000, "num_steps_trained": 3580000, "num_agent_steps_trained": 3580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 745, "training_iteration": 179, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-20-58", "timestamp": 1702711258, "time_this_iter_s": 10.07632064819336, "time_total_s": 1825.989752292633, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48d47b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1825.989752292633, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 31.16923076923077, "ram_util_percent": 46.14615384615385, "gpu_util_percent0": 0.015384615384615384, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.67725150349187, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405098960693014, "mean_inference_ms": 1.202356443106448, "mean_action_processing_ms": 0.08710266419751346, "mean_env_wait_ms": 0.5605306507515939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3600000, "timesteps_this_iter": 0, "agent_timesteps_total": 3600000, "timers": {"sample_time_ms": 10005.704, "sample_throughput": 1998.86, "load_time_ms": 0.305, "load_throughput": 65500179.589, "learn_time_ms": 1009.751, "learn_throughput": 19806.861, "update_time_ms": 9.945}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.61012178719941e-55, "cur_lr": 0.0005, "total_loss": 0.5858942866325378, "policy_loss": -2.3519516040515498e-05, "vf_loss": 0.5999777615070343, "vf_explained_var": -0.0004729628562927246, "kl": 5.361495998190691e-05, "entropy": 1.405994474887848, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3600000, "num_agent_steps_sampled": 3600000, "num_steps_trained": 3600000, "num_agent_steps_trained": 3600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 750, "training_iteration": 180, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-21-08", "timestamp": 1702711268, "time_this_iter_s": 9.831992864608765, "time_total_s": 1835.8217451572418, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1835.8217451572418, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 30.508333333333336, "ram_util_percent": 46.13333333333333, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.67725150349187, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.6532261651853, -172.6350962025088, -172.66651532959386, -171.12909666302656, -177.88596606680056, -171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405098960693014, "mean_inference_ms": 1.202356443106448, "mean_action_processing_ms": 0.08710266419751346, "mean_env_wait_ms": 0.5605306507515939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3620000, "timesteps_this_iter": 0, "agent_timesteps_total": 3620000, "timers": {"sample_time_ms": 10004.87, "sample_throughput": 1999.026, "load_time_ms": 0.293, "load_throughput": 68311140.065, "learn_time_ms": 1009.193, "learn_throughput": 19817.821, "update_time_ms": 9.759}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.305060893599705e-55, "cur_lr": 0.0005, "total_loss": 0.118707075715065, "policy_loss": 1.8496323033190265e-05, "vf_loss": 0.13293498754501343, "vf_explained_var": -0.003678739070892334, "kl": 2.6044016938342462e-05, "entropy": 1.4246413707733154, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3620000, "num_agent_steps_sampled": 3620000, "num_steps_trained": 3620000, "num_agent_steps_trained": 3620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 750, "training_iteration": 181, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-21-18", "timestamp": 1702711278, "time_this_iter_s": 9.98451042175293, "time_total_s": 1845.8062555789948, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1845.8062555789948, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 46.324999999999996, "gpu_util_percent0": 0.004166666666666667, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.75150732523625, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.8731049168071, -172.7642011591981, -181.84842950068563, -182.23326456029514, -184.74634190181104, -204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34051204524434125, "mean_inference_ms": 1.202486049448479, "mean_action_processing_ms": 0.08709958026798559, "mean_env_wait_ms": 0.5605806048443227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3640000, "timesteps_this_iter": 0, "agent_timesteps_total": 3640000, "timers": {"sample_time_ms": 10002.062, "sample_throughput": 1999.588, "load_time_ms": 0.28, "load_throughput": 71514134.697, "learn_time_ms": 1013.633, "learn_throughput": 19731.005, "update_time_ms": 10.119}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.525304467998525e-56, "cur_lr": 0.0005, "total_loss": 0.5608655214309692, "policy_loss": -1.835794372317956e-05, "vf_loss": 0.575044572353363, "vf_explained_var": -0.00021886825561523438, "kl": 8.186316126312931e-06, "entropy": 1.41607004404068, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3640000, "num_agent_steps_sampled": 3640000, "num_steps_trained": 3640000, "num_agent_steps_trained": 3640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 755, "training_iteration": 182, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-21-28", "timestamp": 1702711288, "time_this_iter_s": 10.021329879760742, "time_total_s": 1855.8275854587555, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d4f9b2040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1855.8275854587555, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 30.93076923076923, "ram_util_percent": 46.43076923076922, "gpu_util_percent0": 0.006923076923076922, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -214.35096496202175, "episode_reward_mean": -177.3546726881818, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-204.24245417971036, -172.06442472842346, -179.41562338598845, -169.5306627301829, -214.35096496202175, -190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405088770643674, "mean_inference_ms": 1.2026235631655147, "mean_action_processing_ms": 0.08709633721022475, "mean_env_wait_ms": 0.560627031462624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3660000, "timesteps_this_iter": 0, "agent_timesteps_total": 3660000, "timers": {"sample_time_ms": 10007.735, "sample_throughput": 1998.454, "load_time_ms": 0.278, "load_throughput": 71937295.258, "learn_time_ms": 1014.108, "learn_throughput": 19721.764, "update_time_ms": 10.367}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.2626522339992624e-56, "cur_lr": 0.0005, "total_loss": 0.5939496159553528, "policy_loss": -0.00013738632905302417, "vf_loss": 0.6082353591918945, "vf_explained_var": -0.0009895563125610352, "kl": 3.68449208126842e-05, "entropy": 1.414831519126892, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3660000, "num_agent_steps_sampled": 3660000, "num_steps_trained": 3660000, "num_agent_steps_trained": 3660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 183, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-21-38", "timestamp": 1702711298, "time_this_iter_s": 9.967549800872803, "time_total_s": 1865.7951352596283, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402c9670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1865.7951352596283, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 30.875, "ram_util_percent": 46.34166666666667, "gpu_util_percent0": 0.0033333333333333335, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -176.65447165515383, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.0831991059794, -166.00076449026344, -203.86421913415077, -182.36595799939002, -178.61803883578042, -203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405001043298409, "mean_inference_ms": 1.2027664829150497, "mean_action_processing_ms": 0.08709335914211652, "mean_env_wait_ms": 0.5606766879587934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3680000, "timesteps_this_iter": 0, "agent_timesteps_total": 3680000, "timers": {"sample_time_ms": 10024.371, "sample_throughput": 1995.138, "load_time_ms": 0.278, "load_throughput": 71992859.595, "learn_time_ms": 1016.592, "learn_throughput": 19673.584, "update_time_ms": 10.203}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6313261169996312e-56, "cur_lr": 0.0005, "total_loss": 0.540116161108017, "policy_loss": 2.7070044862576026e-05, "vf_loss": 0.5543915331363678, "vf_explained_var": -0.0008186101913452148, "kl": 7.880657460834772e-05, "entropy": 1.430250346660614, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3680000, "num_agent_steps_sampled": 3680000, "num_steps_trained": 3680000, "num_agent_steps_trained": 3680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 765, "training_iteration": 184, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-21-48", "timestamp": 1702711308, "time_this_iter_s": 10.015522480010986, "time_total_s": 1875.8106577396393, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1875.8106577396393, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 31.183333333333337, "ram_util_percent": 46.416666666666664, "gpu_util_percent0": 0.0075, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -176.2450938869066, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.71389496715707, -171.05986055807324, -182.86526105922454, -189.51031415145573, -199.10885291789293, -166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404910394324298, "mean_inference_ms": 1.2029156467923063, "mean_action_processing_ms": 0.08709013055832562, "mean_env_wait_ms": 0.5607218663521144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3700000, "timesteps_this_iter": 0, "agent_timesteps_total": 3700000, "timers": {"sample_time_ms": 10036.563, "sample_throughput": 1992.714, "load_time_ms": 0.277, "load_throughput": 72116643.741, "learn_time_ms": 1019.222, "learn_throughput": 19622.804, "update_time_ms": 10.619}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.156630584998156e-57, "cur_lr": 0.0005, "total_loss": 0.40333622694015503, "policy_loss": -9.525756671813213e-05, "vf_loss": 0.41772326827049255, "vf_explained_var": -0.0012803077697753906, "kl": 7.991361334869218e-05, "entropy": 1.429177165031433, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3700000, "num_agent_steps_sampled": 3700000, "num_steps_trained": 3700000, "num_agent_steps_trained": 3700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 770, "training_iteration": 185, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-21-58", "timestamp": 1702711318, "time_this_iter_s": 10.051666975021362, "time_total_s": 1885.8623247146606, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dce50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1885.8623247146606, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 31.069230769230764, "ram_util_percent": 46.76153846153846, "gpu_util_percent0": 0.016923076923076923, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -175.47413730772678, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34048412814066437, "mean_inference_ms": 1.203067300157438, "mean_action_processing_ms": 0.08708692074873371, "mean_env_wait_ms": 0.5607701769345687, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3720000, "timesteps_this_iter": 0, "agent_timesteps_total": 3720000, "timers": {"sample_time_ms": 10021.917, "sample_throughput": 1995.626, "load_time_ms": 0.271, "load_throughput": 73746004.396, "learn_time_ms": 1012.866, "learn_throughput": 19745.958, "update_time_ms": 10.788}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.078315292499078e-57, "cur_lr": 0.0005, "total_loss": 0.5615333020687103, "policy_loss": 3.516197253450315e-05, "vf_loss": 0.5757693350315094, "vf_explained_var": -0.0007393956184387207, "kl": 7.025519291814497e-05, "entropy": 1.4271193742752075, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3720000, "num_agent_steps_sampled": 3720000, "num_steps_trained": 3720000, "num_agent_steps_trained": 3720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 775, "training_iteration": 186, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-22-08", "timestamp": 1702711328, "time_this_iter_s": 9.938346147537231, "time_total_s": 1895.8006708621979, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48214a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1895.8006708621979, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 30.575, "ram_util_percent": 46.9, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.014973958333333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -175.47413730772678, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-166.97892313403088, -190.7850116631595, -167.9780863062801, -178.8887872883583, -169.40078014723792, -178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34048412814066437, "mean_inference_ms": 1.203067300157438, "mean_action_processing_ms": 0.08708692074873371, "mean_env_wait_ms": 0.5607701769345687, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3740000, "timesteps_this_iter": 0, "agent_timesteps_total": 3740000, "timers": {"sample_time_ms": 10056.051, "sample_throughput": 1988.852, "load_time_ms": 0.27, "load_throughput": 73999717.713, "learn_time_ms": 1007.852, "learn_throughput": 19844.183, "update_time_ms": 10.866}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.039157646249539e-57, "cur_lr": 0.0005, "total_loss": 0.11192825064063072, "policy_loss": -6.613731526883271e-07, "vf_loss": 0.12635711580514908, "vf_explained_var": -0.002095460891723633, "kl": 2.5106062717328292e-05, "entropy": 1.4428201913833618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3740000, "num_agent_steps_sampled": 3740000, "num_steps_trained": 3740000, "num_agent_steps_trained": 3740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 775, "training_iteration": 187, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-22-19", "timestamp": 1702711339, "time_this_iter_s": 10.329209566116333, "time_total_s": 1906.1298804283142, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1906.1298804283142, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 34.54166666666666, "ram_util_percent": 46.958333333333336, "gpu_util_percent0": 0.015000000000000001, "vram_util_percent0": 0.015265570746527781}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -175.56757023980302, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.09949743286998, -166.99224799578153, -170.5396192792045, -195.42646610288773, -172.44069415368577, -174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34047819802337104, "mean_inference_ms": 1.2032270086958698, "mean_action_processing_ms": 0.08708480850650195, "mean_env_wait_ms": 0.5608255710927036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3760000, "timesteps_this_iter": 0, "agent_timesteps_total": 3760000, "timers": {"sample_time_ms": 10047.049, "sample_throughput": 1990.634, "load_time_ms": 0.282, "load_throughput": 70891642.018, "learn_time_ms": 1021.409, "learn_throughput": 19580.788, "update_time_ms": 10.911}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0195788231247695e-57, "cur_lr": 0.0005, "total_loss": 0.5629120469093323, "policy_loss": -1.284923575450847e-05, "vf_loss": 0.5772919952869415, "vf_explained_var": -0.0002943873405456543, "kl": 1.620098240240342e-05, "entropy": 1.4367119073867798, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3760000, "num_agent_steps_sampled": 3760000, "num_steps_trained": 3760000, "num_agent_steps_trained": 3760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 780, "training_iteration": 188, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-22-29", "timestamp": 1702711349, "time_this_iter_s": 9.997296571731567, "time_total_s": 1916.1271770000458, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1916.1271770000458, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 31.353846153846153, "ram_util_percent": 46.94615384615385, "gpu_util_percent0": 0.02769230769230769, "vram_util_percent0": 0.015268179086538465}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -175.46188738058208, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.66705208221384, -168.88025185898888, -170.76898687141662, -173.71173324060138, -165.69633964406287, -172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404768777220088, "mean_inference_ms": 1.2034035272892873, "mean_action_processing_ms": 0.08708335593733495, "mean_env_wait_ms": 0.5608843852523562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3780000, "timesteps_this_iter": 0, "agent_timesteps_total": 3780000, "timers": {"sample_time_ms": 10090.267, "sample_throughput": 1982.108, "load_time_ms": 0.256, "load_throughput": 78222752.704, "learn_time_ms": 1023.456, "learn_throughput": 19541.637, "update_time_ms": 10.88}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.0978941156238476e-58, "cur_lr": 0.0005, "total_loss": 0.5525461435317993, "policy_loss": -4.049282195639492e-05, "vf_loss": 0.566970020532608, "vf_explained_var": -0.0005813837051391602, "kl": 3.3221713467535e-05, "entropy": 1.4383363127708435, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3780000, "num_agent_steps_sampled": 3780000, "num_steps_trained": 3780000, "num_agent_steps_trained": 3780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 785, "training_iteration": 189, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-22-39", "timestamp": 1702711359, "time_this_iter_s": 10.380667924880981, "time_total_s": 1926.5078449249268, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d482ea9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1926.5078449249268, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 33.94166666666667, "ram_util_percent": 47.21666666666667, "gpu_util_percent0": 0.028333333333333335, "vram_util_percent0": 0.015218098958333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -175.8650016348328, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.33205285098995, -177.26668437152014, -185.07666994753848, -182.3599133834471, -172.46725492216248, -169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234, -178.7539814013299, -194.65672316306367, -180.03761597243337, -167.83745123807023, -172.75001734745965], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404882902318381, "mean_inference_ms": 1.2035974023004459, "mean_action_processing_ms": 0.0870838003071352, "mean_env_wait_ms": 0.5609655000961888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3800000, "timesteps_this_iter": 0, "agent_timesteps_total": 3800000, "timers": {"sample_time_ms": 10185.775, "sample_throughput": 1963.523, "load_time_ms": 0.281, "load_throughput": 71156230.384, "learn_time_ms": 1040.706, "learn_throughput": 19217.731, "update_time_ms": 10.723}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5489470578119238e-58, "cur_lr": 0.0005, "total_loss": 0.5920100212097168, "policy_loss": -1.6988848842380833e-05, "vf_loss": 0.6066098213195801, "vf_explained_var": -0.0007932782173156738, "kl": 5.1547172391419593e-05, "entropy": 1.4582846760749817, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3800000, "num_agent_steps_sampled": 3800000, "num_steps_trained": 3800000, "num_agent_steps_trained": 3800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 790, "training_iteration": 190, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-22-50", "timestamp": 1702711370, "time_this_iter_s": 10.89130163192749, "time_total_s": 1937.3991465568542, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d48224e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1937.3991465568542, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 38.614285714285714, "ram_util_percent": 47.25000000000001, "gpu_util_percent0": 0.09714285714285713, "vram_util_percent0": 0.01561918712797619}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -175.80020790544083, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-169.9905305200103, -173.18970805986694, -177.49354280988095, -169.95131735358515, -167.01828388116584, -173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234, -178.7539814013299, -194.65672316306367, -180.03761597243337, -167.83745123807023, -172.75001734745965, -167.4631357888953, -186.46894596597588, -180.1899046401666, -181.8776820492689, -167.02353409215578], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34050826194167916, "mean_inference_ms": 1.203805673024947, "mean_action_processing_ms": 0.08708556640083245, "mean_env_wait_ms": 0.5610616562334426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3820000, "timesteps_this_iter": 0, "agent_timesteps_total": 3820000, "timers": {"sample_time_ms": 10273.969, "sample_throughput": 1946.667, "load_time_ms": 0.281, "load_throughput": 71222686.364, "learn_time_ms": 1043.418, "learn_throughput": 19167.779, "update_time_ms": 10.767}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2744735289059619e-58, "cur_lr": 0.0005, "total_loss": 0.4680182933807373, "policy_loss": 9.313297204799342e-06, "vf_loss": 0.4826071262359619, "vf_explained_var": -0.0012947320938110352, "kl": 3.4353647804463705e-05, "entropy": 1.459814429283142, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3820000, "num_agent_steps_sampled": 3820000, "num_steps_trained": 3820000, "num_agent_steps_trained": 3820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 795, "training_iteration": 191, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-23-01", "timestamp": 1702711381, "time_this_iter_s": 10.72022032737732, "time_total_s": 1948.1193668842316, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dcc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1948.1193668842316, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 36.65384615384615, "ram_util_percent": 47.315384615384616, "gpu_util_percent0": 0.04615384615384615, "vram_util_percent0": 0.0165702624198718}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -176.6772543199095, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234, -178.7539814013299, -194.65672316306367, -180.03761597243337, -167.83745123807023, -172.75001734745965, -167.4631357888953, -186.46894596597588, -180.1899046401666, -181.8776820492689, -167.02353409215578, -172.0025990343986, -187.97357113209566, -207.51192944347386, -189.45827518735314, -188.40164927405743], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405335131366741, "mean_inference_ms": 1.2040376149741043, "mean_action_processing_ms": 0.08708884757034192, "mean_env_wait_ms": 0.561160376757622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3840000, "timesteps_this_iter": 0, "agent_timesteps_total": 3840000, "timers": {"sample_time_ms": 10325.891, "sample_throughput": 1936.879, "load_time_ms": 0.292, "load_throughput": 68567990.845, "learn_time_ms": 1040.492, "learn_throughput": 19221.668, "update_time_ms": 10.223}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.3723676445298095e-59, "cur_lr": 0.0005, "total_loss": 0.5739856660366058, "policy_loss": -1.4420700264139441e-05, "vf_loss": 0.5885474681854248, "vf_explained_var": -0.0004801154136657715, "kl": 1.9901268639155312e-05, "entropy": 1.4547386765480042, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3840000, "num_agent_steps_sampled": 3840000, "num_steps_trained": 3840000, "num_agent_steps_trained": 3840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 192, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-23-11", "timestamp": 1702711391, "time_this_iter_s": 10.471513986587524, "time_total_s": 1958.590880870819, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d402dc9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1958.590880870819, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 34.38333333333334, "ram_util_percent": 47.150000000000006, "gpu_util_percent0": 0.04583333333333334, "vram_util_percent0": 0.016004774305555556}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -212.29644133883826, "episode_reward_mean": -176.6772543199095, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-173.13259299989681, -167.47343878424658, -182.60469525382177, -179.86992097433057, -171.8078275161531, -171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234, -178.7539814013299, -194.65672316306367, -180.03761597243337, -167.83745123807023, -172.75001734745965, -167.4631357888953, -186.46894596597588, -180.1899046401666, -181.8776820492689, -167.02353409215578, -172.0025990343986, -187.97357113209566, -207.51192944347386, -189.45827518735314, -188.40164927405743], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405335131366741, "mean_inference_ms": 1.2040376149741043, "mean_action_processing_ms": 0.08708884757034192, "mean_env_wait_ms": 0.561160376757622, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3860000, "timesteps_this_iter": 0, "agent_timesteps_total": 3860000, "timers": {"sample_time_ms": 10349.368, "sample_throughput": 1932.485, "load_time_ms": 0.292, "load_throughput": 68584809.092, "learn_time_ms": 1040.219, "learn_throughput": 19226.713, "update_time_ms": 9.953}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1861838222649047e-59, "cur_lr": 0.0005, "total_loss": 0.34009526669979095, "policy_loss": -0.00028118828711853894, "vf_loss": 0.35502301156520844, "vf_explained_var": -0.003040611743927002, "kl": 8.184705742886322e-05, "entropy": 1.464658498764038, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3860000, "num_agent_steps_sampled": 3860000, "num_steps_trained": 3860000, "num_agent_steps_trained": 3860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 193, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-23-22", "timestamp": 1702711402, "time_this_iter_s": 10.2316575050354, "time_total_s": 1968.8225383758545, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cdc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1968.8225383758545, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 33.53846153846153, "ram_util_percent": 47.06923076923078, "gpu_util_percent0": 0.03923076923076923, "vram_util_percent0": 0.016063201121794875}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -217.12642427095201, "episode_reward_mean": -177.4953764182774, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.77856321220503, -174.5947135162209, -169.7413767142085, -176.49507687155457, -168.18970911359125, -163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234, -178.7539814013299, -194.65672316306367, -180.03761597243337, -167.83745123807023, -172.75001734745965, -167.4631357888953, -186.46894596597588, -180.1899046401666, -181.8776820492689, -167.02353409215578, -172.0025990343986, -187.97357113209566, -207.51192944347386, -189.45827518735314, -188.40164927405743, -217.12642427095201, -180.3657821107984, -204.75116764626756, -186.57064517440762, -167.8866661628136], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405635285846845, "mean_inference_ms": 1.2042774598544583, "mean_action_processing_ms": 0.08709314890865776, "mean_env_wait_ms": 0.5612654224401851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3880000, "timesteps_this_iter": 0, "agent_timesteps_total": 3880000, "timers": {"sample_time_ms": 10348.484, "sample_throughput": 1932.65, "load_time_ms": 0.305, "load_throughput": 65623155.754, "learn_time_ms": 1039.692, "learn_throughput": 19236.464, "update_time_ms": 9.975}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5930919111324524e-59, "cur_lr": 0.0005, "total_loss": 0.49691474437713623, "policy_loss": 6.72279368504336e-05, "vf_loss": 0.5112803280353546, "vf_explained_var": -3.8743019104003906e-05, "kl": 8.295878266786905e-05, "entropy": 1.4432803988456726, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3880000, "num_agent_steps_sampled": 3880000, "num_steps_trained": 3880000, "num_agent_steps_trained": 3880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 805, "training_iteration": 194, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-23-32", "timestamp": 1702711412, "time_this_iter_s": 10.006118535995483, "time_total_s": 1978.82865691185, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481cd670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1978.82865691185, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 31.441666666666663, "ram_util_percent": 47.20000000000001, "gpu_util_percent0": 0.0025, "vram_util_percent0": 0.015950520833333336}}
{"episode_reward_max": -163.25485387328118, "episode_reward_min": -217.12642427095201, "episode_reward_mean": -177.51813728000067, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-163.25485387328118, -178.9822632723875, -169.02354328775635, -191.68147880598727, -170.1375945623175, -168.48482962426132, -169.89556976962382, -164.89899720146445, -175.55268010226928, -174.79312770640018, -169.1707022356094, -178.37344022971888, -189.14783049259538, -168.8400473087169, -177.35948464304815, -190.57252996261974, -181.417580513019, -185.61392286943445, -192.77963972664898, -171.47334789294464, -183.88356830480745, -163.37023372365766, -168.35855897023453, -212.29644133883826, -193.45523951923832, -209.79913265950282, -172.93074912057767, -186.4773383119435, -176.5938319460402, -182.07114058563877, -170.30211885699694, -176.67333207231604, -166.85439857462256, -169.1136806981588, -182.41838118755481, -174.26267998188538, -172.68313306098352, -172.20343200012707, -172.3427781537485, -166.86343127342923, -165.36572821532903, -166.68538430020251, -177.3389443487936, -171.9974090644686, -195.0080166727545, -176.63345885907967, -168.48625688019138, -172.43797703106986, -167.65301196051314, -168.57117360249987, -168.95671414165474, -173.27920113883482, -173.0752972866866, -164.14351324407104, -190.12930087228642, -177.025858227624, -172.3006375983696, -169.30324974717317, -168.0651934878639, -193.2994636798094, -173.80204345413932, -173.65817982065312, -173.71541707691864, -180.41649842015963, -167.5703869639522, -170.5749336522605, -187.95402613580288, -175.91660697807572, -172.89519118245798, -176.03412379808904, -181.2660400428903, -181.37539024910362, -168.14577083930786, -175.64121545318176, -166.50182245785234, -178.7539814013299, -194.65672316306367, -180.03761597243337, -167.83745123807023, -172.75001734745965, -167.4631357888953, -186.46894596597588, -180.1899046401666, -181.8776820492689, -167.02353409215578, -172.0025990343986, -187.97357113209566, -207.51192944347386, -189.45827518735314, -188.40164927405743, -217.12642427095201, -180.3657821107984, -204.75116764626756, -186.57064517440762, -167.8866661628136, -176.72454149447475, -168.69227453415124, -183.22181742853215, -163.73598022362486, -170.70091191931593], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3405925724150324, "mean_inference_ms": 1.204519030821134, "mean_action_processing_ms": 0.08709738852009967, "mean_env_wait_ms": 0.5613681816160443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 5, "timesteps_total": 3900000, "timesteps_this_iter": 0, "agent_timesteps_total": 3900000, "timers": {"sample_time_ms": 10343.759, "sample_throughput": 1933.533, "load_time_ms": 0.305, "load_throughput": 65541120.4, "learn_time_ms": 1041.975, "learn_throughput": 19194.317, "update_time_ms": 10.086}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.965459555662262e-60, "cur_lr": 0.0005, "total_loss": 0.6499521136283875, "policy_loss": -8.863258284641518e-06, "vf_loss": 0.6643064022064209, "vf_explained_var": -0.0005998611450195312, "kl": 4.433235803122382e-05, "entropy": 1.4345356822013855, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3900000, "num_agent_steps_sampled": 3900000, "num_steps_trained": 3900000, "num_agent_steps_trained": 3900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 810, "training_iteration": 195, "trial_id": "64f8a_00000", "experiment_id": "33323c480b2d4cfaa6bec0aab01f3a3b", "date": "2023-12-16_13-23-42", "timestamp": 1702711422, "time_this_iter_s": 10.035299062728882, "time_total_s": 1988.8639559745789, "pid": 38462, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 5, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 5, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 5, "episode_limit": 10000, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "five team cooperate", "team_prefix": ["1", "2", "3", "4", "5"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f6d481be700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1988.8639559745789, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 31.23076923076923, "ram_util_percent": 47.37692307692306, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.016000600961538464}}
