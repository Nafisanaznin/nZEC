{"episode_reward_max": -1234.4721357736978, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -1234.4721357736978, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978], "episode_lengths": [960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44623249899460293, "mean_inference_ms": 1.2561002209332928, "mean_action_processing_ms": 0.11366736008150892, "mean_env_wait_ms": 0.7305810156275404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 7680, "timesteps_this_iter": 0, "agent_timesteps_total": 7680, "timers": {"sample_time_ms": 2479.197, "sample_throughput": 3097.778, "load_time_ms": 0.738, "load_throughput": 10411200.621, "learn_time_ms": 4198.622, "learn_throughput": 1829.171, "update_time_ms": 2.688}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 47.26287472607752, "policy_loss": -0.0027166634214760657, "vf_loss": 47.28538790401459, "vf_explained_var": -0.0013117411484320958, "kl": 0.010358560247444379, "entropy": 2.1868117724855742, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7680, "num_agent_steps_sampled": 7680, "num_steps_trained": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-07-28", "timestamp": 1708844848, "time_this_iter_s": 6.6643218994140625, "time_total_s": 6.6643218994140625, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1311c529d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6.6643218994140625, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.800000000000004, "ram_util_percent": 11.91, "gpu_util_percent0": 0.083, "vram_util_percent0": 0.026814778645833332}}
{"episode_reward_max": -1182.7169705545843, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -1208.594553164141, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843], "episode_lengths": [960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4460720619545038, "mean_inference_ms": 1.255385242348654, "mean_action_processing_ms": 0.11397110829664484, "mean_env_wait_ms": 0.7321593614448568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 15360, "timesteps_this_iter": 0, "agent_timesteps_total": 15360, "timers": {"sample_time_ms": 4585.218, "sample_throughput": 1674.948, "load_time_ms": 0.473, "load_throughput": 16223749.544, "learn_time_ms": 4242.037, "learn_throughput": 1810.451, "update_time_ms": 2.763}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 9.664458853892029, "policy_loss": -0.0008860058183017827, "vf_loss": 9.684771298416308, "vf_explained_var": -0.020207241099948686, "kl": 0.011800046635608888, "entropy": 2.1786541752517223, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 15360, "num_agent_steps_sampled": 15360, "num_steps_trained": 15360, "num_agent_steps_trained": 15360, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-07-35", "timestamp": 1708844855, "time_this_iter_s": 6.748745918273926, "time_total_s": 13.413067817687988, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1318db6670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13.413067817687988, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.255555555555556, "ram_util_percent": 12.0, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.026814778645833332}}
{"episode_reward_max": -1102.1288217312897, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -1173.105976019857, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897], "episode_lengths": [960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4455001927170521, "mean_inference_ms": 1.2503712685501516, "mean_action_processing_ms": 0.11373305056832468, "mean_env_wait_ms": 0.7316496195608165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 23040, "timesteps_this_iter": 0, "agent_timesteps_total": 23040, "timers": {"sample_time_ms": 5294.454, "sample_throughput": 1450.575, "load_time_ms": 0.386, "load_throughput": 19884107.852, "learn_time_ms": 4248.689, "learn_throughput": 1807.617, "update_time_ms": 2.735}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 9.080373639057447, "policy_loss": -0.0012924545868978992, "vf_loss": 9.100543882557153, "vf_explained_var": -0.07363432669080794, "kl": 0.012838843123915922, "entropy": 2.1445518505449095, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 23040, "num_agent_steps_sampled": 23040, "num_steps_trained": 23040, "num_agent_steps_trained": 23040, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-07-41", "timestamp": 1708844861, "time_this_iter_s": 6.665531396865845, "time_total_s": 20.078599214553833, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f13117129d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20.078599214553833, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.17777777777778, "ram_util_percent": 11.988888888888889, "gpu_util_percent0": 0.012222222222222223, "vram_util_percent0": 0.026814778645833332}}
{"episode_reward_max": -966.7584749459169, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -1121.519100751372, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169], "episode_lengths": [960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4451231765631787, "mean_inference_ms": 1.2480705023261913, "mean_action_processing_ms": 0.11367186264535944, "mean_env_wait_ms": 0.7312293964728988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 30720, "timesteps_this_iter": 0, "agent_timesteps_total": 30720, "timers": {"sample_time_ms": 5652.959, "sample_throughput": 1358.581, "load_time_ms": 0.342, "load_throughput": 22447564.265, "learn_time_ms": 4266.002, "learn_throughput": 1800.281, "update_time_ms": 2.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 6.16559150164655, "policy_loss": -0.0006909149030131326, "vf_loss": 6.184872512356378, "vf_explained_var": -0.11588452197611332, "kl": 0.012003739161668156, "entropy": 2.0990843664233885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 30720, "num_agent_steps_sampled": 30720, "num_steps_trained": 30720, "num_agent_steps_trained": 30720, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-07-48", "timestamp": 1708844868, "time_this_iter_s": 6.76041579246521, "time_total_s": 26.839015007019043, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1318c25310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 26.839015007019043, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.666666666666668, "ram_util_percent": 12.0, "gpu_util_percent0": 0.02555555555555556, "vram_util_percent0": 0.026814778645833332}}
{"episode_reward_max": -898.2696805899682, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -1076.8692167190911, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682], "episode_lengths": [960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4453319162484326, "mean_inference_ms": 1.2479405627802378, "mean_action_processing_ms": 0.11380720011882202, "mean_env_wait_ms": 0.7313497605149225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"sample_time_ms": 5889.739, "sample_throughput": 1303.963, "load_time_ms": 0.319, "load_throughput": 24085729.565, "learn_time_ms": 4261.669, "learn_throughput": 1802.111, "update_time_ms": 2.79}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 6.976359239497772, "policy_loss": -0.004831644076148223, "vf_loss": 6.997975933976704, "vf_explained_var": -0.14684730488806963, "kl": 0.016233573170210274, "entropy": 2.003177612243841, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 38400, "num_steps_trained": 38400, "num_agent_steps_trained": 38400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-07-55", "timestamp": 1708844875, "time_this_iter_s": 6.741769313812256, "time_total_s": 33.5807843208313, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1311691820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 33.5807843208313, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.011111111111113, "ram_util_percent": 11.955555555555556, "gpu_util_percent0": 0.044444444444444446, "vram_util_percent0": 0.026814778645833332}}
{"episode_reward_max": -775.7804513796933, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -1026.6877558291915, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933], "episode_lengths": [960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44525314211606787, "mean_inference_ms": 1.2477869646499118, "mean_action_processing_ms": 0.11387840129407278, "mean_env_wait_ms": 0.7315187897788752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 46080, "timesteps_this_iter": 0, "agent_timesteps_total": 46080, "timers": {"sample_time_ms": 6027.468, "sample_throughput": 1274.167, "load_time_ms": 0.3, "load_throughput": 25558520.011, "learn_time_ms": 4264.791, "learn_throughput": 1800.792, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 5.170646532860094, "policy_loss": -0.00821669556019818, "vf_loss": 5.19427076025022, "vf_explained_var": -0.199985070930173, "kl": 0.018296722472129545, "entropy": 1.90669043843324, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 46080, "num_agent_steps_sampled": 46080, "num_steps_trained": 46080, "num_agent_steps_trained": 46080, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-02", "timestamp": 1708844882, "time_this_iter_s": 6.726370334625244, "time_total_s": 40.30715465545654, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f131032f0d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 40.30715465545654, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.240000000000002, "ram_util_percent": 12.0, "gpu_util_percent0": 0.02, "vram_util_percent0": 0.026814778645833332}}
{"episode_reward_max": -582.4548103020594, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -963.2259064681728, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594], "episode_lengths": [960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.446321359909059, "mean_inference_ms": 1.2491654808531583, "mean_action_processing_ms": 0.11411739403223084, "mean_env_wait_ms": 0.732775084442042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 53760, "timesteps_this_iter": 0, "agent_timesteps_total": 53760, "timers": {"sample_time_ms": 6158.271, "sample_throughput": 1247.103, "load_time_ms": 0.308, "load_throughput": 24956921.2, "learn_time_ms": 4347.766, "learn_throughput": 1766.424, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 3.467191395748008, "policy_loss": -0.008814079778934078, "vf_loss": 3.489791483817195, "vf_explained_var": -0.32187522055270773, "kl": 0.016034190346298754, "entropy": 1.6992847174406052, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 53760, "num_agent_steps_sampled": 53760, "num_steps_trained": 53760, "num_agent_steps_trained": 53760, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-09", "timestamp": 1708844889, "time_this_iter_s": 7.484909534454346, "time_total_s": 47.79206418991089, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1318c6a310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 47.79206418991089, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.010000000000005, "ram_util_percent": 11.989999999999998, "gpu_util_percent0": 0.183, "vram_util_percent0": 0.02946370442708333}}
{"episode_reward_max": -452.394555912825, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -899.3719876487544, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594, -452.394555912825], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4472384366948624, "mean_inference_ms": 1.2508785458282308, "mean_action_processing_ms": 0.11434227058661824, "mean_env_wait_ms": 0.7338053960299897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 61440, "timesteps_this_iter": 0, "agent_timesteps_total": 61440, "timers": {"sample_time_ms": 6314.459, "sample_throughput": 1216.256, "load_time_ms": 0.3, "load_throughput": 25598295.198, "learn_time_ms": 4367.345, "learn_throughput": 1758.505, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 1.9853072065721638, "policy_loss": -0.001905199759619336, "vf_loss": 2.0010886446580116, "vf_explained_var": -0.5284553018864244, "kl": 0.010929833546472404, "entropy": 1.6062206051622827, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 61440, "num_agent_steps_sampled": 61440, "num_steps_trained": 61440, "num_agent_steps_trained": 61440, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-16", "timestamp": 1708844896, "time_this_iter_s": 7.040433883666992, "time_total_s": 54.83249807357788, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1311c529d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 54.83249807357788, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.35, "ram_util_percent": 12.03, "gpu_util_percent0": 0.06300000000000001, "vram_util_percent0": 0.030525716145833336}}
{"episode_reward_max": -364.6403118105634, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -839.9573570000665, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594, -452.394555912825, -364.6403118105634], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44787155820571833, "mean_inference_ms": 1.2517996798985669, "mean_action_processing_ms": 0.11448496879273601, "mean_env_wait_ms": 0.7345047132750803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 69120, "timesteps_this_iter": 0, "agent_timesteps_total": 69120, "timers": {"sample_time_ms": 6390.583, "sample_throughput": 1201.768, "load_time_ms": 0.29, "load_throughput": 26437196.104, "learn_time_ms": 4368.036, "learn_throughput": 1758.227, "update_time_ms": 2.801}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 1.1358708887415407, "policy_loss": -0.0018792066487852328, "vf_loss": 1.1512424016424727, "vf_explained_var": -0.6481798152284076, "kl": 0.009174081590164937, "entropy": 1.5327132713670533, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 69120, "num_agent_steps_sampled": 69120, "num_steps_trained": 69120, "num_agent_steps_trained": 69120, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-23", "timestamp": 1708844903, "time_this_iter_s": 6.810488700866699, "time_total_s": 61.64298677444458, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1318db64c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 61.64298677444458, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.5, "ram_util_percent": 12.0, "gpu_util_percent0": 0.08333333333333334, "vram_util_percent0": 0.02968117042824074}}
{"episode_reward_max": -364.6403118105634, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -792.4607265426789, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594, -452.394555912825, -364.6403118105634, -364.99105242619015], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4485681635983301, "mean_inference_ms": 1.253407578390463, "mean_action_processing_ms": 0.11466146483157887, "mean_env_wait_ms": 0.7354536175253751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"sample_time_ms": 6453.869, "sample_throughput": 1189.984, "load_time_ms": 0.283, "load_throughput": 27098725.263, "learn_time_ms": 4375.105, "learn_throughput": 1755.386, "update_time_ms": 3.653}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 0.9265233439937978, "policy_loss": -8.425856231042417e-05, "vf_loss": 0.9394257365844775, "vf_explained_var": -0.652914443363746, "kl": 0.008008517105068336, "entropy": 1.4419849272817373, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 76800, "num_steps_trained": 76800, "num_agent_steps_trained": 76800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-30", "timestamp": 1708844910, "time_this_iter_s": 7.0743443965911865, "time_total_s": 68.71733117103577, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1311691ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 68.71733117103577, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.37, "ram_util_percent": 12.029999999999998, "gpu_util_percent0": 0.13999999999999999, "vram_util_percent0": 0.030330403645833337}}
{"episode_reward_max": -302.41357342470013, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -747.9109853501354, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594, -452.394555912825, -364.6403118105634, -364.99105242619015, -302.41357342470013], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44905729950339707, "mean_inference_ms": 1.2543540944149987, "mean_action_processing_ms": 0.11476792754147894, "mean_env_wait_ms": 0.7360551011465777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84480, "timesteps_this_iter": 0, "agent_timesteps_total": 84480, "timers": {"sample_time_ms": 6896.408, "sample_throughput": 1113.623, "load_time_ms": 0.23, "load_throughput": 33346019.379, "learn_time_ms": 4384.002, "learn_throughput": 1751.824, "update_time_ms": 3.682}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 0.631156091548822, "policy_loss": -0.0009104854450470157, "vf_loss": 0.6444103915297698, "vf_explained_var": -0.8228855741520723, "kl": 0.0061483020692906605, "entropy": 1.357347441681971, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84480, "num_agent_steps_sampled": 84480, "num_steps_trained": 84480, "num_agent_steps_trained": 84480, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-37", "timestamp": 1708844917, "time_this_iter_s": 6.705467700958252, "time_total_s": 75.42279887199402, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1310499d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 75.42279887199402, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 30.28888888888889, "ram_util_percent": 12.022222222222222, "gpu_util_percent0": 0.026666666666666665, "vram_util_percent0": 0.02840621383101852}}
{"episode_reward_max": -302.41357342470013, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -710.9620782752523, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594, -452.394555912825, -364.6403118105634, -364.99105242619015, -302.41357342470013, -304.5241004515385], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4494063415714806, "mean_inference_ms": 1.2549878155579688, "mean_action_processing_ms": 0.11486488542181615, "mean_env_wait_ms": 0.7365521137467224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 92160, "timesteps_this_iter": 0, "agent_timesteps_total": 92160, "timers": {"sample_time_ms": 6904.534, "sample_throughput": 1112.313, "load_time_ms": 0.23, "load_throughput": 33373658.019, "learn_time_ms": 4381.289, "learn_throughput": 1752.909, "update_time_ms": 3.679}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 0.716121943888235, "policy_loss": 0.0020232483345049936, "vf_loss": 0.7258200535643482, "vf_explained_var": -0.8002722148473064, "kl": 0.005738045564460966, "entropy": 1.2868974413722754, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 92160, "num_agent_steps_sampled": 92160, "num_steps_trained": 92160, "num_agent_steps_trained": 92160, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-44", "timestamp": 1708844924, "time_this_iter_s": 6.717882871627808, "time_total_s": 82.14068174362183, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f1310499f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 82.14068174362183, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.233333333333334, "ram_util_percent": 12.0, "gpu_util_percent0": 0.022222222222222223, "vram_util_percent0": 0.027628580729166668}}
{"episode_reward_max": -300.7105303238091, "episode_reward_min": -1234.4721357736978, "episode_reward_mean": -679.4042668943722, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.4721357736978, -1182.7169705545843, -1102.1288217312897, -966.7584749459169, -898.2696805899682, -775.7804513796933, -582.4548103020594, -452.394555912825, -364.6403118105634, -364.99105242619015, -302.41357342470013, -304.5241004515385, -300.7105303238091], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44965251399440503, "mean_inference_ms": 1.2554235044486222, "mean_action_processing_ms": 0.114937834547702, "mean_env_wait_ms": 0.7369381208878166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 99840, "timesteps_this_iter": 0, "agent_timesteps_total": 99840, "timers": {"sample_time_ms": 6906.916, "sample_throughput": 1111.929, "load_time_ms": 0.243, "load_throughput": 31655124.528, "learn_time_ms": 4387.407, "learn_throughput": 1750.465, "update_time_ms": 3.785}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 0.8456972175012348, "policy_loss": -0.00099655076549728, "vf_loss": 0.8580356658148958, "vf_explained_var": -0.7403916312226405, "kl": 0.008166824142418724, "entropy": 1.297525657961766, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 99840, "num_agent_steps_sampled": 99840, "num_steps_trained": 99840, "num_agent_steps_trained": 99840, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 13, "training_iteration": 13, "trial_id": "85019_00000", "experiment_id": "f351f9e5b272468697c6f4c3a04d985b", "date": "2024-02-25_13-08-51", "timestamp": 1708844931, "time_this_iter_s": 6.779304027557373, "time_total_s": 88.9199857711792, "pid": 18619, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 20, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 10, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f131033d4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 20, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 88.9199857711792, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.533333333333335, "ram_util_percent": 12.033333333333333, "gpu_util_percent0": 0.02444444444444445, "vram_util_percent0": 0.027628580729166668}}
