{"episode_reward_max": -1179.869915535466, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -1229.1319488533686, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4391246295992467, "mean_inference_ms": 1.2083859274960456, "mean_action_processing_ms": 0.11143965974186511, "mean_env_wait_ms": 0.7082214588677349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 61440, "timesteps_this_iter": 0, "agent_timesteps_total": 61440, "timers": {"sample_time_ms": 19075.17, "sample_throughput": 3220.941, "load_time_ms": 0.627, "load_throughput": 97984044.776, "learn_time_ms": 2874.567, "learn_throughput": 21373.657, "update_time_ms": 11.253}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 199.71140797932944, "policy_loss": -0.004439446027390659, "vf_loss": 199.73617362976074, "vf_explained_var": -3.653268019358317e-06, "kl": 0.00783629448900077, "entropy": 2.1890148520469666, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 61440, "num_agent_steps_sampled": 61440, "num_steps_trained": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-50-41", "timestamp": 1708840241, "time_this_iter_s": 21.95167326927185, "time_total_s": 21.95167326927185, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1513a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 21.95167326927185, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.56666666666667, "ram_util_percent": 7.419999999999999, "gpu_util_percent0": 0.043666666666666666, "vram_util_percent0": 0.02702229817708334}}
{"episode_reward_max": -1102.5670685545585, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -1177.4223142948406, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.440579052570248, "mean_inference_ms": 1.2113480448828804, "mean_action_processing_ms": 0.11172560763007747, "mean_env_wait_ms": 0.7106257272413399, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 122880, "timesteps_this_iter": 0, "agent_timesteps_total": 122880, "timers": {"sample_time_ms": 20622.71, "sample_throughput": 2979.24, "load_time_ms": 0.433, "load_throughput": 141865146.028, "learn_time_ms": 2869.157, "learn_throughput": 21413.955, "update_time_ms": 11.09}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 127.1145601272583, "policy_loss": 0.010366638908938816, "vf_loss": 127.12417952219646, "vf_explained_var": -2.366801102956136e-06, "kl": 0.008357390951346133, "entropy": 2.1658750573794046, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 122880, "num_agent_steps_sampled": 122880, "num_steps_trained": 122880, "num_agent_steps_trained": 122880, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16, "training_iteration": 2, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-51-03", "timestamp": 1708840263, "time_this_iter_s": 22.132412910461426, "time_total_s": 44.084086179733276, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1a5dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 44.084086179733276, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.98, "ram_util_percent": 7.716666666666668, "gpu_util_percent0": 0.024000000000000007, "vram_util_percent0": 0.02608235677083334}}
{"episode_reward_max": -976.9993664443066, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -1118.0351888477912, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44116115341751044, "mean_inference_ms": 1.212470604458275, "mean_action_processing_ms": 0.11180344922559655, "mean_env_wait_ms": 0.7110005356606189, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 184320, "timesteps_this_iter": 0, "agent_timesteps_total": 184320, "timers": {"sample_time_ms": 21115.67, "sample_throughput": 2909.687, "load_time_ms": 0.357, "load_throughput": 171989791.608, "learn_time_ms": 2858.77, "learn_throughput": 21491.761, "update_time_ms": 11.337}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 67.53503449757893, "policy_loss": -0.002999337390065193, "vf_loss": 67.55694977442424, "vf_explained_var": -7.64926274617513e-06, "kl": 0.01106660749102654, "entropy": 2.1127590437730155, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184320, "num_agent_steps_sampled": 184320, "num_steps_trained": 184320, "num_agent_steps_trained": 184320, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24, "training_iteration": 3, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-51-25", "timestamp": 1708840285, "time_this_iter_s": 22.049941301345825, "time_total_s": 66.1340274810791, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb77418da60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.1340274810791, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.3, "ram_util_percent": 7.810000000000001, "gpu_util_percent0": 0.002333333333333333, "vram_util_percent0": 0.02608235677083334}}
{"episode_reward_max": -861.6631973954121, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -1062.968841524339, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44314295025009687, "mean_inference_ms": 1.217480274047214, "mean_action_processing_ms": 0.11224468761958975, "mean_env_wait_ms": 0.7133206502174441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 245760, "timesteps_this_iter": 0, "agent_timesteps_total": 245760, "timers": {"sample_time_ms": 21608.585, "sample_throughput": 2843.314, "load_time_ms": 0.341, "load_throughput": 180366080.672, "learn_time_ms": 2863.923, "learn_throughput": 21453.092, "update_time_ms": 12.741}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 34.83823974927267, "policy_loss": 0.002891141310101375, "vf_loss": 34.85389733314514, "vf_explained_var": -3.320227066675822e-05, "kl": 0.010458119835675461, "entropy": 2.064048488934835, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 245760, "num_agent_steps_sampled": 245760, "num_steps_trained": 245760, "num_agent_steps_trained": 245760, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32, "training_iteration": 4, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-51-48", "timestamp": 1708840308, "time_this_iter_s": 23.11331057548523, "time_total_s": 89.24733805656433, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3d894edc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 89.24733805656433, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.521875, "ram_util_percent": 7.893750000000001, "gpu_util_percent0": 0.065, "vram_util_percent0": 0.0269622802734375}}
{"episode_reward_max": -684.3258873158351, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -994.9230896494482, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44543808493375076, "mean_inference_ms": 1.2227553752679285, "mean_action_processing_ms": 0.11271972006487796, "mean_env_wait_ms": 0.7159747025512928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"sample_time_ms": 21941.293, "sample_throughput": 2800.2, "load_time_ms": 0.316, "load_throughput": 194195959.126, "learn_time_ms": 2862.345, "learn_throughput": 21464.919, "update_time_ms": 12.4}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 10.001258969306946, "policy_loss": 0.007317453855648637, "vf_loss": 10.011281867822012, "vf_explained_var": -0.00010425100723902385, "kl": 0.010830313342012232, "entropy": 1.950609803199768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 307200, "num_agent_steps_sampled": 307200, "num_steps_trained": 307200, "num_agent_steps_trained": 307200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 5, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-52-11", "timestamp": 1708840331, "time_this_iter_s": 23.21058964729309, "time_total_s": 112.45792770385742, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3d98a7a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 112.45792770385742, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.4, "ram_util_percent": 7.932258064516129, "gpu_util_percent0": 0.04838709677419355, "vram_util_percent0": 0.02790159820228495}}
{"episode_reward_max": -552.5829090403864, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -928.3979789787586, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4472609076542297, "mean_inference_ms": 1.22646549409921, "mean_action_processing_ms": 0.11306046697389782, "mean_env_wait_ms": 0.7180530657194195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 368640, "timesteps_this_iter": 0, "agent_timesteps_total": 368640, "timers": {"sample_time_ms": 22070.791, "sample_throughput": 2783.77, "load_time_ms": 0.308, "load_throughput": 199251060.124, "learn_time_ms": 2858.568, "learn_throughput": 21493.277, "update_time_ms": 12.158}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 3.438785801331202, "policy_loss": -0.010684290551580489, "vf_loss": 3.465673118829727, "vf_explained_var": -0.0001497715711593628, "kl": 0.010986466066848758, "entropy": 1.8400325377782185, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368640, "num_agent_steps_sampled": 368640, "num_steps_trained": 368640, "num_agent_steps_trained": 368640, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 48, "training_iteration": 6, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-52-34", "timestamp": 1708840354, "time_this_iter_s": 22.677930116653442, "time_total_s": 135.13585782051086, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb7740d9280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 135.13585782051086, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.90333333333333, "ram_util_percent": 8.026666666666666, "gpu_util_percent0": 0.03266666666666667, "vram_util_percent0": 0.02628445095486111}}
{"episode_reward_max": -474.041455456373, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -866.9417340700985, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4491863715715313, "mean_inference_ms": 1.2305349546547502, "mean_action_processing_ms": 0.11341167182272528, "mean_env_wait_ms": 0.7202222774518996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 430080, "timesteps_this_iter": 0, "agent_timesteps_total": 430080, "timers": {"sample_time_ms": 22287.86, "sample_throughput": 2756.658, "load_time_ms": 0.295, "load_throughput": 207940779.749, "learn_time_ms": 2874.002, "learn_throughput": 21377.856, "update_time_ms": 12.122}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 3.004209299882253, "policy_loss": 0.0022073939132193723, "vf_loss": 3.017724633216858, "vf_explained_var": -3.7165979544321694e-05, "kl": 0.008221004764133491, "entropy": 1.7366938591003418, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 430080, "num_agent_steps_sampled": 430080, "num_steps_trained": 430080, "num_agent_steps_trained": 430080, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 56, "training_iteration": 7, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-52-58", "timestamp": 1708840378, "time_this_iter_s": 23.691810846328735, "time_total_s": 158.8276686668396, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3d88853a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 158.8276686668396, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.665625000000006, "ram_util_percent": 8.078125, "gpu_util_percent0": 0.0828125, "vram_util_percent0": 0.027918497721354168}}
{"episode_reward_max": -397.028610496504, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -810.8158138065197, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4507736834121592, "mean_inference_ms": 1.2338086263220036, "mean_action_processing_ms": 0.1136915226760224, "mean_env_wait_ms": 0.7219016717350779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 491520, "timesteps_this_iter": 0, "agent_timesteps_total": 491520, "timers": {"sample_time_ms": 22378.828, "sample_throughput": 2745.452, "load_time_ms": 0.287, "load_throughput": 213790760.353, "learn_time_ms": 2875.521, "learn_throughput": 21366.565, "update_time_ms": 12.029}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 4.042331079641978, "policy_loss": -0.014244947815313935, "vf_loss": 4.07167175412178, "vf_explained_var": -0.00020783642927805582, "kl": 0.0064266167467697715, "entropy": 1.638092855612437, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 491520, "num_agent_steps_sampled": 491520, "num_steps_trained": 491520, "num_agent_steps_trained": 491520, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 64, "training_iteration": 8, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-53-20", "timestamp": 1708840400, "time_this_iter_s": 22.910314559936523, "time_total_s": 181.73798322677612, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3d98a7ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 181.73798322677612, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.954838709677418, "ram_util_percent": 8.174193548387095, "gpu_util_percent0": 0.04258064516129032, "vram_util_percent0": 0.02729780955981183}}
{"episode_reward_max": -340.41395998958404, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -760.5938247356976, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4520040918282032, "mean_inference_ms": 1.2363783110701232, "mean_action_processing_ms": 0.11390467450599646, "mean_env_wait_ms": 0.7231799760383476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 552960, "timesteps_this_iter": 0, "agent_timesteps_total": 552960, "timers": {"sample_time_ms": 22418.291, "sample_throughput": 2740.619, "load_time_ms": 0.283, "load_throughput": 217405543.667, "learn_time_ms": 2878.465, "learn_throughput": 21344.713, "update_time_ms": 12.016}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 4.519106924533844, "policy_loss": 0.0021988594477685788, "vf_loss": 4.5320761402448015, "vf_explained_var": -0.00035073359807332355, "kl": 0.005450498943597874, "entropy": 1.6258275707562764, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552960, "num_agent_steps_sampled": 552960, "num_steps_trained": 552960, "num_agent_steps_trained": 552960, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 72, "training_iteration": 9, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-53-43", "timestamp": 1708840423, "time_this_iter_s": 22.724195957183838, "time_total_s": 204.46217918395996, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774165c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 204.46217918395996, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.077419354838714, "ram_util_percent": 8.206451612903225, "gpu_util_percent0": 0.03935483870967743, "vram_util_percent0": 0.02685546875}}
{"episode_reward_max": -307.6971996296125, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -718.5792609902343, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45305545414533943, "mean_inference_ms": 1.2383407519896852, "mean_action_processing_ms": 0.11406778459480882, "mean_env_wait_ms": 0.7241808359087114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 614400, "timesteps_this_iter": 0, "agent_timesteps_total": 614400, "timers": {"sample_time_ms": 22447.569, "sample_throughput": 2737.045, "load_time_ms": 0.276, "load_throughput": 222421921.077, "learn_time_ms": 2881.169, "learn_throughput": 21324.675, "update_time_ms": 12.262}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0005, "total_loss": 3.4974117477734885, "policy_loss": -3.548858997722467e-05, "vf_loss": 3.512807995080948, "vf_explained_var": -4.0372212727864586e-05, "kl": 0.002869238344828773, "entropy": 1.5934625367323558, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 614400, "num_agent_steps_sampled": 614400, "num_steps_trained": 614400, "num_agent_steps_trained": 614400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 10, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-54-06", "timestamp": 1708840446, "time_this_iter_s": 22.693845987319946, "time_total_s": 227.1560251712799, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c66d310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 227.1560251712799, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.916666666666675, "ram_util_percent": 8.276666666666669, "gpu_util_percent0": 0.04600000000000001, "vram_util_percent0": 0.02685546875}}
{"episode_reward_max": -287.6117242493099, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -681.742703527875, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45397499509858685, "mean_inference_ms": 1.2400964187315333, "mean_action_processing_ms": 0.11420926261299841, "mean_env_wait_ms": 0.7250776534856119, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 675840, "timesteps_this_iter": 0, "agent_timesteps_total": 675840, "timers": {"sample_time_ms": 22843.97, "sample_throughput": 2689.55, "load_time_ms": 0.235, "load_throughput": 260986467.247, "learn_time_ms": 2882.208, "learn_throughput": 21316.989, "update_time_ms": 12.271}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0005, "total_loss": 2.8813354472319284, "policy_loss": -0.002833406596134106, "vf_loss": 2.899257078766823, "vf_explained_var": -0.000564637283484141, "kl": 0.004976920700755727, "entropy": 1.5585893740256627, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 675840, "num_agent_steps_sampled": 675840, "num_steps_trained": 675840, "num_agent_steps_trained": 675840, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 88, "training_iteration": 11, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-54-29", "timestamp": 1708840469, "time_this_iter_s": 22.981682062149048, "time_total_s": 250.13770723342896, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c26e9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 250.13770723342896, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 32.16451612903225, "ram_util_percent": 8.30645161290323, "gpu_util_percent0": 0.05064516129032258, "vram_util_percent0": 0.027057606686827957}}
{"episode_reward_max": -281.3400444313222, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -649.0812072969769, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1198.6801818374163, -1256.5366127598572, -1241.9160347096422, -1261.0098543493991, -1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45475811011594075, "mean_inference_ms": 1.2415057568857921, "mean_action_processing_ms": 0.11431808262244497, "mean_env_wait_ms": 0.7257753166525743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 737280, "timesteps_this_iter": 0, "agent_timesteps_total": 737280, "timers": {"sample_time_ms": 22892.465, "sample_throughput": 2683.853, "load_time_ms": 0.234, "load_throughput": 262181338.651, "learn_time_ms": 2884.108, "learn_throughput": 21302.946, "update_time_ms": 12.293}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0005, "total_loss": 2.320554554462433, "policy_loss": -0.003994045391057928, "vf_loss": 2.339701568086942, "vf_explained_var": -0.0004672879974047343, "kl": 0.0017373190407094323, "entropy": 1.5239815960327785, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 737280, "num_agent_steps_sampled": 737280, "num_steps_trained": 737280, "num_agent_steps_trained": 737280, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 96, "training_iteration": 12, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-54-52", "timestamp": 1708840492, "time_this_iter_s": 22.62672734260559, "time_total_s": 272.76443457603455, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c26eca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 272.76443457603455, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.083333333333332, "ram_util_percent": 8.33666666666667, "gpu_util_percent0": 0.023000000000000007, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.514888703534, "episode_reward_min": -1267.6812775387384, "episode_reward_mean": -595.763329702591, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179.869915535466, -1230.5171892492665, -1196.844524847163, -1267.6812775387384, -1143.1368143617722, -1130.922060618907, -1124.5065579425582, -1105.3224020821037, -1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4560725855005977, "mean_inference_ms": 1.243871606994652, "mean_action_processing_ms": 0.11450158321434273, "mean_env_wait_ms": 0.7270471235929084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 798720, "timesteps_this_iter": 0, "agent_timesteps_total": 798720, "timers": {"sample_time_ms": 22926.224, "sample_throughput": 2679.901, "load_time_ms": 0.236, "load_throughput": 260854375.706, "learn_time_ms": 2882.988, "learn_throughput": 21311.226, "update_time_ms": 12.248}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 1.531147912144661, "policy_loss": 0.004022896445045869, "vf_loss": 1.5421242614587147, "vf_explained_var": 0.00025139500697453815, "kl": 0.007070798871154693, "entropy": 1.5175990760326385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 798720, "num_agent_steps_sampled": 798720, "num_steps_trained": 798720, "num_agent_steps_trained": 798720, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 104, "training_iteration": 13, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-55-14", "timestamp": 1708840514, "time_this_iter_s": 22.358662366867065, "time_total_s": 295.1230969429016, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774165430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 295.1230969429016, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.46, "ram_util_percent": 8.413333333333334, "gpu_util_percent0": 0.013333333333333334, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.514888703534, "episode_reward_min": -1151.4574542489752, "episode_reward_mean": -525.4557281282039, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102.5670685545585, -1151.4574542489752, -1144.3601132579122, -1103.428966823713, -999.9997413576002, -998.5800779631992, -989.6802135448766, -977.950809957469, -1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45789088849658827, "mean_inference_ms": 1.247542012842728, "mean_action_processing_ms": 0.1147861515743238, "mean_env_wait_ms": 0.7287847605970785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 860160, "timesteps_this_iter": 0, "agent_timesteps_total": 860160, "timers": {"sample_time_ms": 22893.044, "sample_throughput": 2683.785, "load_time_ms": 0.228, "load_throughput": 269220682.992, "learn_time_ms": 2886.266, "learn_throughput": 21287.017, "update_time_ms": 11.69}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 0.8563944846391678, "policy_loss": 0.001522025588201359, "vf_loss": 0.869524950782458, "vf_explained_var": -0.00019756207863489786, "kl": 0.014081735360226352, "entropy": 1.5004540433486302, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860160, "num_agent_steps_sampled": 860160, "num_steps_trained": 860160, "num_agent_steps_trained": 860160, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 112, "training_iteration": 14, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-55-37", "timestamp": 1708840537, "time_this_iter_s": 22.813716888427734, "time_total_s": 317.93681383132935, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1da430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 317.93681383132935, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.13870967741935, "ram_util_percent": 8.480645161290322, "gpu_util_percent0": 0.022580645161290328, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.514888703534, "episode_reward_min": -1052.8987971123643, "episode_reward_mean": -463.7927871663298, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1016.4082547534817, -981.5702424962437, -1052.8987971123643, -976.9993664443066, -895.7300724754168, -902.3557041912677, -924.130806857636, -879.3291930234542, -870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45954232572577103, "mean_inference_ms": 1.2506654084905588, "mean_action_processing_ms": 0.11504519963732442, "mean_env_wait_ms": 0.7304533471955239, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 921600, "timesteps_this_iter": 0, "agent_timesteps_total": 921600, "timers": {"sample_time_ms": 22834.561, "sample_throughput": 2690.658, "load_time_ms": 0.229, "load_throughput": 268491391.707, "learn_time_ms": 2887.965, "learn_throughput": 21274.493, "update_time_ms": 11.754}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 0.8261129930615425, "policy_loss": 0.007423759748538335, "vf_loss": 0.8336424256364504, "vf_explained_var": 0.0007255946596463522, "kl": 0.00630650853933427, "entropy": 1.5110842883586884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 921600, "num_agent_steps_sampled": 921600, "num_steps_trained": 921600, "num_agent_steps_trained": 921600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 15, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-56-00", "timestamp": 1708840560, "time_this_iter_s": 22.623771905899048, "time_total_s": 340.5605857372284, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b51f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 340.5605857372284, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 30.253333333333337, "ram_util_percent": 8.506666666666666, "gpu_util_percent0": 0.021333333333333336, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.514888703534, "episode_reward_min": -954.7552790112928, "episode_reward_mean": -410.067931293106, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-870.3519034523816, -954.7552790112928, -861.6631973954121, -893.8422400250046, -773.9486725868076, -726.3760602235303, -705.954319163036, -684.3258873158351, -724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4609227724383543, "mean_inference_ms": 1.2532037364470723, "mean_action_processing_ms": 0.11524305450921486, "mean_env_wait_ms": 0.7317546613425485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 983040, "timesteps_this_iter": 0, "agent_timesteps_total": 983040, "timers": {"sample_time_ms": 22807.984, "sample_throughput": 2693.794, "load_time_ms": 0.225, "load_throughput": 273535758.157, "learn_time_ms": 2891.607, "learn_throughput": 21247.701, "update_time_ms": 11.786}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 0.6556790259977182, "policy_loss": -0.005581440404057503, "vf_loss": 0.675832654039065, "vf_explained_var": -0.0007838383316993713, "kl": 0.005805434034603725, "entropy": 1.4717328995466232, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 983040, "num_agent_steps_sampled": 983040, "num_steps_trained": 983040, "num_agent_steps_trained": 983040, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 128, "training_iteration": 16, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-56-22", "timestamp": 1708840582, "time_this_iter_s": 22.427600860595703, "time_total_s": 362.9881865978241, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774ab6e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 362.9881865978241, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.306666666666665, "ram_util_percent": 8.583333333333334, "gpu_util_percent0": 0.004666666666666667, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.514888703534, "episode_reward_min": -740.0337138088165, "episode_reward_mean": -368.74052044974485, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-724.3621701770494, -734.1589135105778, -740.0337138088165, -692.7609204134225, -587.7236858295961, -604.9483050970157, -571.3292912731805, -552.5829090403864, -634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46172630100170553, "mean_inference_ms": 1.254272107642211, "mean_action_processing_ms": 0.11531614039900162, "mean_env_wait_ms": 0.7324137941432579, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1044480, "timesteps_this_iter": 0, "agent_timesteps_total": 1044480, "timers": {"sample_time_ms": 22737.21, "sample_throughput": 2702.179, "load_time_ms": 0.225, "load_throughput": 272465677.479, "learn_time_ms": 2881.546, "learn_throughput": 21321.886, "update_time_ms": 11.87}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 0.6578511620561281, "policy_loss": 0.0024496020196238533, "vf_loss": 0.6702627216776212, "vf_explained_var": 0.0001886412501335144, "kl": 0.011436314969614614, "entropy": 1.51470780869325, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1044480, "num_agent_steps_sampled": 1044480, "num_steps_trained": 1044480, "num_agent_steps_trained": 1044480, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 136, "training_iteration": 17, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-56-45", "timestamp": 1708840605, "time_this_iter_s": 22.85174059867859, "time_total_s": 385.8399271965027, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb7740d9700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 385.8399271965027, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 30.17, "ram_util_percent": 8.679999999999998, "gpu_util_percent0": 0.018333333333333333, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -634.3610175969462, "episode_reward_mean": -339.6598197491983, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-634.3610175969462, -617.4641526912986, -593.3740880243756, -604.3959554496853, -533.4547974830548, -496.08563631434254, -474.041455456373, -502.05557464831764, -475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46244972445282956, "mean_inference_ms": 1.255285183005445, "mean_action_processing_ms": 0.1153737308567574, "mean_env_wait_ms": 0.7329637242752642, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1105920, "timesteps_this_iter": 0, "agent_timesteps_total": 1105920, "timers": {"sample_time_ms": 22724.691, "sample_throughput": 2703.667, "load_time_ms": 0.226, "load_throughput": 271318212.003, "learn_time_ms": 2884.053, "learn_throughput": 21303.354, "update_time_ms": 11.997}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0005, "total_loss": 0.6987616010010242, "policy_loss": 0.012166304048150778, "vf_loss": 0.701716477672259, "vf_explained_var": 0.00044125566879908246, "kl": 0.0038882486566459797, "entropy": 1.521839365363121, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1105920, "num_agent_steps_sampled": 1105920, "num_steps_trained": 1105920, "num_agent_steps_trained": 1105920, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 144, "training_iteration": 18, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-57-08", "timestamp": 1708840628, "time_this_iter_s": 22.904587745666504, "time_total_s": 408.7445149421692, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774165670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 408.7445149421692, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.50322580645161, "ram_util_percent": 8.683870967741933, "gpu_util_percent0": 0.028387096774193554, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -523.6023451843898, "episode_reward_mean": -318.1632905340958, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-475.9910118828062, -501.6527266422382, -523.6023451843898, -478.7505693335798, -419.4226517544617, -418.40290014055756, -431.7304345948022, -422.8313226790621, -397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628248564895738, "mean_inference_ms": 1.2555894591418826, "mean_action_processing_ms": 0.11536797441725424, "mean_env_wait_ms": 0.7330646779250766, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1167360, "timesteps_this_iter": 0, "agent_timesteps_total": 1167360, "timers": {"sample_time_ms": 22708.785, "sample_throughput": 2705.561, "load_time_ms": 0.225, "load_throughput": 273245719.181, "learn_time_ms": 2882.609, "learn_throughput": 21314.026, "update_time_ms": 11.934}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005, "total_loss": 0.6713602977494398, "policy_loss": 0.0028591915033757687, "vf_loss": 0.6838711127638817, "vf_explained_var": 0.0011661872267723083, "kl": 0.01022873621453376, "entropy": 1.5497866868972778, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1167360, "num_agent_steps_sampled": 1167360, "num_steps_trained": 1167360, "num_agent_steps_trained": 1167360, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 152, "training_iteration": 19, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-57-30", "timestamp": 1708840650, "time_this_iter_s": 22.523041486740112, "time_total_s": 431.2675564289093, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c2ba4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 431.2675564289093, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.253333333333337, "ram_util_percent": 8.719999999999997, "gpu_util_percent0": 0.009000000000000001, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -426.48320353666793, "episode_reward_mean": -307.7702501100747, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-397.028610496504, -409.8981294305286, -426.48320353666793, -417.67772305916367, -341.6676203466652, -352.27495074663017, -356.7246993482694, -380.86322086962946, -369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4629427888004058, "mean_inference_ms": 1.2553731373654735, "mean_action_processing_ms": 0.11531611731550258, "mean_env_wait_ms": 0.7329453710405182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1228800, "timesteps_this_iter": 0, "agent_timesteps_total": 1228800, "timers": {"sample_time_ms": 22708.73, "sample_throughput": 2705.567, "load_time_ms": 0.233, "load_throughput": 263225779.122, "learn_time_ms": 2881.607, "learn_throughput": 21321.438, "update_time_ms": 11.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005, "total_loss": 1.0640353386600812, "policy_loss": -0.00017968671939646205, "vf_loss": 1.079035259783268, "vf_explained_var": 0.00032786279916763306, "kl": 0.006465391923787441, "entropy": 1.490102117260297, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1228800, "num_agent_steps_sampled": 1228800, "num_steps_trained": 1228800, "num_agent_steps_trained": 1228800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 20, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-57-53", "timestamp": 1708840673, "time_this_iter_s": 22.693537950515747, "time_total_s": 453.96109437942505, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774244d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 453.96109437942505, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.14666666666667, "ram_util_percent": 8.783333333333335, "gpu_util_percent0": 0.025, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -382.0965903153669, "episode_reward_mean": -300.7211630711905, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-369.95362522371636, -382.0965903153669, -340.41395998958404, -346.5486305131071, -329.9415159292042, -324.08890421689085, -346.88513726101695, -344.75967065158346, -346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4630791547856548, "mean_inference_ms": 1.2551943489660085, "mean_action_processing_ms": 0.11527323491928473, "mean_env_wait_ms": 0.7329013806967339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1290240, "timesteps_this_iter": 0, "agent_timesteps_total": 1290240, "timers": {"sample_time_ms": 22677.17, "sample_throughput": 2709.333, "load_time_ms": 0.239, "load_throughput": 257286379.553, "learn_time_ms": 2884.788, "learn_throughput": 21297.922, "update_time_ms": 11.827}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005, "total_loss": 0.7191142762700716, "policy_loss": 0.008016350291048488, "vf_loss": 0.7259862422943115, "vf_explained_var": 0.00025540590286254883, "kl": 0.011255592046836682, "entropy": 1.5029014199972153, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1290240, "num_agent_steps_sampled": 1290240, "num_steps_trained": 1290240, "num_agent_steps_trained": 1290240, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 168, "training_iteration": 21, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-58-16", "timestamp": 1708840696, "time_this_iter_s": 22.72121834754944, "time_total_s": 476.6823127269745, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b5790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 476.6823127269745, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.420000000000005, "ram_util_percent": 8.863333333333333, "gpu_util_percent0": 0.022000000000000006, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -296.04507993665544, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346.26277353262185, -357.1221922512787, -307.6971996296125, -366.8281047763047, -319.92084208089835, -342.6821224226887, -299.0100166379481, -287.6117242493099, -302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4631608808797545, "mean_inference_ms": 1.2550031911574293, "mean_action_processing_ms": 0.11522365461209573, "mean_env_wait_ms": 0.7328283531678662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1351680, "timesteps_this_iter": 0, "agent_timesteps_total": 1351680, "timers": {"sample_time_ms": 22667.553, "sample_throughput": 2710.482, "load_time_ms": 0.254, "load_throughput": 241856440.882, "learn_time_ms": 2883.06, "learn_throughput": 21310.693, "update_time_ms": 11.869}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0005, "total_loss": 0.7985845319926739, "policy_loss": 0.0056771842840438085, "vf_loss": 0.8077318395177523, "vf_explained_var": 0.0009781817595163982, "kl": 0.002151889735008202, "entropy": 1.4851387043793995, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1351680, "num_agent_steps_sampled": 1351680, "num_steps_trained": 1351680, "num_agent_steps_trained": 1351680, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 176, "training_iteration": 22, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-58-38", "timestamp": 1708840718, "time_this_iter_s": 22.47746777534485, "time_total_s": 499.15978050231934, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b5820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 499.15978050231934, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.429999999999996, "ram_util_percent": 8.893333333333334, "gpu_util_percent0": 0.008666666666666666, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -292.02065678188467, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302.8991740651911, -348.0697610121097, -295.2978937853418, -311.52549698077786, -290.4379872143815, -283.230595401117, -284.383990604048, -291.480820777065, -281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46317869656847904, "mean_inference_ms": 1.25475374181075, "mean_action_processing_ms": 0.11516812110631808, "mean_env_wait_ms": 0.7327235516430133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1413120, "timesteps_this_iter": 0, "agent_timesteps_total": 1413120, "timers": {"sample_time_ms": 22724.82, "sample_throughput": 2703.652, "load_time_ms": 0.256, "load_throughput": 240031704.322, "learn_time_ms": 2890.212, "learn_throughput": 21257.953, "update_time_ms": 13.333}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005, "total_loss": 0.5861928810675939, "policy_loss": 0.006348872130426268, "vf_loss": 0.5948677410682043, "vf_explained_var": -0.0005306676030158997, "kl": 0.006262420158085054, "entropy": 1.5062867800394695, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1413120, "num_agent_steps_sampled": 1413120, "num_steps_trained": 1413120, "num_agent_steps_trained": 1413120, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 184, "training_iteration": 23, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-59-01", "timestamp": 1708840741, "time_this_iter_s": 23.0364887714386, "time_total_s": 522.1962692737579, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b51f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 522.1962692737579, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.30645161290322, "ram_util_percent": 8.919354838709678, "gpu_util_percent0": 0.024838709677419364, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -292.56237121063623, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-281.3400444313222, -287.44704185852567, -294.4514659858923, -305.6660437844231, -274.4589322642196, -271.89673283815887, -279.67893064108694, -270.2841056990113, -283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4632004099016313, "mean_inference_ms": 1.2546015156001427, "mean_action_processing_ms": 0.11512637293320019, "mean_env_wait_ms": 0.7326527087987693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1474560, "timesteps_this_iter": 0, "agent_timesteps_total": 1474560, "timers": {"sample_time_ms": 22732.723, "sample_throughput": 2702.712, "load_time_ms": 0.258, "load_throughput": 238146232.104, "learn_time_ms": 2887.612, "learn_throughput": 21277.097, "update_time_ms": 13.351}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005, "total_loss": 0.8814743918677171, "policy_loss": -0.0013786119064510178, "vf_loss": 0.8974499131242434, "vf_explained_var": 0.00033248960971832275, "kl": 0.006248801092321325, "entropy": 1.4635987331469853, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1474560, "num_agent_steps_sampled": 1474560, "num_steps_trained": 1474560, "num_agent_steps_trained": 1474560, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 192, "training_iteration": 24, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-59-24", "timestamp": 1708840764, "time_this_iter_s": 22.77726674079895, "time_total_s": 544.9735360145569, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3da26f790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 544.9735360145569, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.209999999999994, "ram_util_percent": 9.020000000000001, "gpu_util_percent0": 0.018000000000000002, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -293.0082208517253, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-283.0492890169876, -289.6478790582806, -284.1489951843434, -269.514888703534, -286.94043507917706, -295.0466124045919, -290.5273514258538, -277.431628303758, -316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4632165450430964, "mean_inference_ms": 1.254490670609362, "mean_action_processing_ms": 0.11508727746408223, "mean_env_wait_ms": 0.7325829252883806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 22720.726, "sample_throughput": 2704.139, "load_time_ms": 0.259, "load_throughput": 237553500.885, "learn_time_ms": 2899.692, "learn_throughput": 21188.455, "update_time_ms": 13.403}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005, "total_loss": 0.6826344691216946, "policy_loss": -0.006695588701404631, "vf_loss": 0.7040573681394259, "vf_explained_var": 0.0014794617891311646, "kl": 0.012019131162257205, "entropy": 1.4802444477876027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1536000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 1536000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 25, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_11-59-47", "timestamp": 1708840787, "time_this_iter_s": 22.6513614654541, "time_total_s": 567.624897480011, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1510d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 567.624897480011, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.683333333333334, "ram_util_percent": 9.073333333333332, "gpu_util_percent0": 0.005333333333333333, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -292.49344323930285, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316.5274176100343, -297.9514758313696, -286.7229059958365, -296.89275808665883, -292.6357338897469, -282.038354789796, -295.67701475061847, -273.3874418784671, -273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4632646293149821, "mean_inference_ms": 1.2544766688496063, "mean_action_processing_ms": 0.1150634132708943, "mean_env_wait_ms": 0.7325881458202689, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1597440, "timesteps_this_iter": 0, "agent_timesteps_total": 1597440, "timers": {"sample_time_ms": 22780.05, "sample_throughput": 2697.097, "load_time_ms": 0.259, "load_throughput": 237159983.214, "learn_time_ms": 2903.651, "learn_throughput": 21159.567, "update_time_ms": 13.438}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005, "total_loss": 0.5924625669916471, "policy_loss": 0.008197749479829023, "vf_loss": 0.5988835915923119, "vf_explained_var": -0.000251603623231252, "kl": 0.006155989491162472, "entropy": 1.4657255709171295, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1597440, "num_agent_steps_sampled": 1597440, "num_steps_trained": 1597440, "num_agent_steps_trained": 1597440, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 208, "training_iteration": 26, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-00-10", "timestamp": 1708840810, "time_this_iter_s": 22.936758041381836, "time_total_s": 590.5616555213928, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb77418dc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 590.5616555213928, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.330000000000002, "ram_util_percent": 9.1, "gpu_util_percent0": 0.02166666666666667, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -293.46594163422304, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.2713464458143, -332.01578164300247, -274.45998317285785, -278.24469295058765, -281.9699118987203, -280.9688937731766, -274.2550151953368, -280.2232427394079, -270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46329268452657696, "mean_inference_ms": 1.254500148638449, "mean_action_processing_ms": 0.11503852326189204, "mean_env_wait_ms": 0.7325998002237477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1658880, "timesteps_this_iter": 0, "agent_timesteps_total": 1658880, "timers": {"sample_time_ms": 22780.755, "sample_throughput": 2697.013, "load_time_ms": 0.266, "load_throughput": 231285260.959, "learn_time_ms": 2906.834, "learn_throughput": 21136.398, "update_time_ms": 13.399}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0005, "total_loss": 0.8146355537076791, "policy_loss": 0.009456454310566187, "vf_loss": 0.8195141131679217, "vf_explained_var": 0.0008654122551282247, "kl": 0.0032772772102968397, "entropy": 1.4355469594399135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1658880, "num_agent_steps_sampled": 1658880, "num_steps_trained": 1658880, "num_agent_steps_trained": 1658880, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 216, "training_iteration": 27, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-00-33", "timestamp": 1708840833, "time_this_iter_s": 22.849689722061157, "time_total_s": 613.411345243454, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3da26f430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 613.411345243454, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.429999999999996, "ram_util_percent": 9.17333333333333, "gpu_util_percent0": 0.027000000000000003, "vram_util_percent0": 0.026611328125}}
{"episode_reward_max": -269.17562913106997, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -294.11336582173897, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-270.8338655421568, -273.4950544242477, -288.21969516959473, -306.97117128915426, -295.3932289183537, -277.2896911016741, -308.22488896785865, -281.1852511384526, -308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633382026038301, "mean_inference_ms": 1.2545856180870583, "mean_action_processing_ms": 0.11501506263620093, "mean_env_wait_ms": 0.7326127939036282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1720320, "timesteps_this_iter": 0, "agent_timesteps_total": 1720320, "timers": {"sample_time_ms": 22762.979, "sample_throughput": 2699.119, "load_time_ms": 0.265, "load_throughput": 232202232.618, "learn_time_ms": 2902.522, "learn_throughput": 21167.801, "update_time_ms": 13.253}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0005, "total_loss": 0.6889129864672819, "policy_loss": 0.0009464770264457911, "vf_loss": 0.7019501949350039, "vf_explained_var": 0.001906489332516988, "kl": 0.004705613782069425, "entropy": 1.399838164448738, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1720320, "num_agent_steps_sampled": 1720320, "num_steps_trained": 1720320, "num_agent_steps_trained": 1720320, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 224, "training_iteration": 28, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-00-55", "timestamp": 1708840855, "time_this_iter_s": 22.65593671798706, "time_total_s": 636.067281961441, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774165c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 636.067281961441, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.58666666666667, "ram_util_percent": 9.203333333333331, "gpu_util_percent0": 0.011666666666666665, "vram_util_percent0": 0.026459418402777782}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -293.2058758919204, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308.88123575806645, -279.17256105636176, -292.8224271116018, -295.50719078480796, -269.17562913106997, -280.1568132338432, -315.4889114049393, -298.46598150382454, -295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46340458221765723, "mean_inference_ms": 1.2547504102261768, "mean_action_processing_ms": 0.11499036922270646, "mean_env_wait_ms": 0.7326268095748509, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1781760, "timesteps_this_iter": 0, "agent_timesteps_total": 1781760, "timers": {"sample_time_ms": 22788.953, "sample_throughput": 2696.043, "load_time_ms": 0.284, "load_throughput": 216153361.651, "learn_time_ms": 2903.484, "learn_throughput": 21160.788, "update_time_ms": 13.286}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0005, "total_loss": 0.5821321730812391, "policy_loss": 0.004244997204902272, "vf_loss": 0.5921585535009702, "vf_explained_var": 0.0001331120729446411, "kl": 0.002487164490351764, "entropy": 1.427525927623113, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1781760, "num_agent_steps_sampled": 1781760, "num_steps_trained": 1781760, "num_agent_steps_trained": 1781760, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 232, "training_iteration": 29, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-01-18", "timestamp": 1708840878, "time_this_iter_s": 22.83989381790161, "time_total_s": 658.9071757793427, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb774ab6e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 658.9071757793427, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.379999999999995, "ram_util_percent": 9.273333333333335, "gpu_util_percent0": 0.022000000000000006, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -292.28363131646165, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-295.65042470170266, -270.8607183456295, -293.48664923598466, -276.5447115384045, -286.2422309913025, -273.2142216556932, -295.15376291393335, -287.4808420942633, -286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46346417832140463, "mean_inference_ms": 1.2548945274012704, "mean_action_processing_ms": 0.11496279695890692, "mean_env_wait_ms": 0.7325977074991167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1843200, "timesteps_this_iter": 0, "agent_timesteps_total": 1843200, "timers": {"sample_time_ms": 22803.846, "sample_throughput": 2694.282, "load_time_ms": 0.277, "load_throughput": 222172633.641, "learn_time_ms": 2906.406, "learn_throughput": 21139.512, "update_time_ms": 13.546}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005, "total_loss": 0.6446971769134203, "policy_loss": 0.008371583030869564, "vf_loss": 0.6509305636088053, "vf_explained_var": 0.0013761321703592937, "kl": 0.010997217360151504, "entropy": 1.4613560338815053, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1843200, "num_agent_steps_sampled": 1843200, "num_steps_trained": 1843200, "num_agent_steps_trained": 1843200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 30, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-01-41", "timestamp": 1708840901, "time_this_iter_s": 22.872670888900757, "time_total_s": 681.7798466682434, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1a5dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 681.7798466682434, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.486666666666675, "ram_util_percent": 9.310000000000002, "gpu_util_percent0": 0.022666666666666665, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -294.24396943819096, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.74848634631417, -285.03255811172585, -304.6222148540155, -287.0854391868859, -310.1980927608606, -329.6893845401497, -326.2481969941315, -304.2827821669493, -369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46350828364607866, "mean_inference_ms": 1.2550084866631415, "mean_action_processing_ms": 0.11493747923288009, "mean_env_wait_ms": 0.7326019197892668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1904640, "timesteps_this_iter": 0, "agent_timesteps_total": 1904640, "timers": {"sample_time_ms": 22813.055, "sample_throughput": 2693.195, "load_time_ms": 0.272, "load_throughput": 226090575.329, "learn_time_ms": 2907.357, "learn_throughput": 21132.596, "update_time_ms": 13.422}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0005, "total_loss": 0.7579844184219837, "policy_loss": 0.006677759268010656, "vf_loss": 0.765495295325915, "vf_explained_var": 0.0007331594824790955, "kl": 0.0024418543119584988, "entropy": 1.419051890571912, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1904640, "num_agent_steps_sampled": 1904640, "num_steps_trained": 1904640, "num_agent_steps_trained": 1904640, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 248, "training_iteration": 31, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-02-04", "timestamp": 1708840924, "time_this_iter_s": 22.780559062957764, "time_total_s": 704.5604057312012, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c2ba4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 704.5604057312012, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.80333333333333, "ram_util_percent": 9.336666666666666, "gpu_util_percent0": 0.013333333333333334, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -369.1043539357852, "episode_reward_mean": -293.3617027745964, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-369.1043539357852, -335.3989393034295, -323.97261712159616, -334.1855529868873, -276.14852146154817, -293.9179730265397, -305.36873572913726, -302.35093322153875, -288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46357643979730634, "mean_inference_ms": 1.2552417102266764, "mean_action_processing_ms": 0.11492220741799493, "mean_env_wait_ms": 0.7326614968693422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1966080, "timesteps_this_iter": 0, "agent_timesteps_total": 1966080, "timers": {"sample_time_ms": 22871.477, "sample_throughput": 2686.315, "load_time_ms": 0.256, "load_throughput": 240345120.09, "learn_time_ms": 2907.181, "learn_throughput": 21133.872, "update_time_ms": 15.736}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0005, "total_loss": 0.715435279533267, "policy_loss": 0.0068202904270341, "vf_loss": 0.7223303889234861, "vf_explained_var": 0.002134852111339569, "kl": 0.004009767729561038, "entropy": 1.371697838107745, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1966080, "num_agent_steps_sampled": 1966080, "num_steps_trained": 1966080, "num_agent_steps_trained": 1966080, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 256, "training_iteration": 32, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-02-27", "timestamp": 1708840947, "time_this_iter_s": 23.079309225082397, "time_total_s": 727.6397149562836, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb7740d9f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 727.6397149562836, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.451612903225808, "ram_util_percent": 9.422580645161291, "gpu_util_percent0": 0.029354838709677426, "vram_util_percent0": 0.026448567708333343}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -331.6493938289767, "episode_reward_mean": -290.5169183829824, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-288.18196690148653, -300.71912429617845, -317.3962464154492, -293.6259528937624, -271.62047949281975, -306.74266694803026, -300.93825383900196, -296.30504158809185, -287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46366762307777265, "mean_inference_ms": 1.2555462915894764, "mean_action_processing_ms": 0.1149149978112574, "mean_env_wait_ms": 0.7327789547757988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2027520, "timesteps_this_iter": 0, "agent_timesteps_total": 2027520, "timers": {"sample_time_ms": 22897.922, "sample_throughput": 2683.213, "load_time_ms": 0.254, "load_throughput": 242106386.471, "learn_time_ms": 2925.84, "learn_throughput": 20999.097, "update_time_ms": 14.393}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0005, "total_loss": 0.6491987978418668, "policy_loss": 0.0015535921168824036, "vf_loss": 0.6615497668584188, "vf_explained_var": 0.0013775452971458435, "kl": 0.0037672266732139783, "entropy": 1.3905283759037654, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2027520, "num_agent_steps_sampled": 2027520, "num_steps_trained": 2027520, "num_agent_steps_trained": 2027520, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 264, "training_iteration": 33, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-02-51", "timestamp": 1708840971, "time_this_iter_s": 23.42610812187195, "time_total_s": 751.0658230781555, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1d14c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 751.0658230781555, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 30.61666666666667, "ram_util_percent": 9.456666666666667, "gpu_util_percent0": 0.023000000000000007, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -331.6493938289767, "episode_reward_mean": -288.9514746224808, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287.05951394833636, -286.7022361994115, -280.51153761496715, -287.19999101629736, -293.34914152837086, -275.7624699665576, -273.9407059808025, -271.09220431935296, -273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4637752331389191, "mean_inference_ms": 1.2558774948673037, "mean_action_processing_ms": 0.11491336832351663, "mean_env_wait_ms": 0.7329173611706432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2088960, "timesteps_this_iter": 0, "agent_timesteps_total": 2088960, "timers": {"sample_time_ms": 22921.584, "sample_throughput": 2680.443, "load_time_ms": 0.252, "load_throughput": 244032232.727, "learn_time_ms": 2926.001, "learn_throughput": 20997.94, "update_time_ms": 14.38}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0005, "total_loss": 0.553802323838075, "policy_loss": 0.0010719627995664875, "vf_loss": 0.5669301450252533, "vf_explained_var": 0.0006198758880297343, "kl": 0.0028562413275873646, "entropy": 1.4200044522682826, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2088960, "num_agent_steps_sampled": 2088960, "num_steps_trained": 2088960, "num_agent_steps_trained": 2088960, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 272, "training_iteration": 34, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-03-13", "timestamp": 1708840993, "time_this_iter_s": 22.843096494674683, "time_total_s": 773.9089195728302, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b53a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 773.9089195728302, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 29.720000000000006, "ram_util_percent": 9.496666666666668, "gpu_util_percent0": 0.007000000000000001, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -331.6493938289767, "episode_reward_mean": -290.3081290296695, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-273.4937808015194, -281.21151348343807, -278.7474556223547, -277.09538840119507, -276.6421715737928, -311.23226476349913, -311.37454523793235, -289.16230820356236, -321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507, -312.3169459474358, -291.5497931972926, -291.275764450458, -290.3652238504456, -304.9193252828094, -286.63055711206505, -315.6586712433624, -298.5669602090933], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46388804140900064, "mean_inference_ms": 1.2562384249564096, "mean_action_processing_ms": 0.1149130958408612, "mean_env_wait_ms": 0.7330220063534025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2150400, "timesteps_this_iter": 0, "agent_timesteps_total": 2150400, "timers": {"sample_time_ms": 22954.975, "sample_throughput": 2676.544, "load_time_ms": 0.251, "load_throughput": 245076593.21, "learn_time_ms": 2917.381, "learn_throughput": 21059.985, "update_time_ms": 14.899}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0005, "total_loss": 0.7260317082206408, "policy_loss": 0.005911761429160833, "vf_loss": 0.7344054033358892, "vf_explained_var": 0.00035423537095387775, "kl": 0.002133782448671203, "entropy": 1.4285555730263393, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2150400, "num_agent_steps_sampled": 2150400, "num_steps_trained": 2150400, "num_agent_steps_trained": 2150400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 35, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-03-36", "timestamp": 1708841016, "time_this_iter_s": 22.89837336540222, "time_total_s": 796.8072929382324, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c1a58b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 796.8072929382324, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.66666666666667, "ram_util_percent": 9.600000000000001, "gpu_util_percent0": 0.024666666666666667, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -331.6493938289767, "episode_reward_mean": -290.035258996218, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.44837879588266, -299.0509199576087, -331.6493938289767, -320.9371803539376, -278.0953783203616, -296.8298668459657, -277.97063700431426, -289.58024870554766, -283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507, -312.3169459474358, -291.5497931972926, -291.275764450458, -290.3652238504456, -304.9193252828094, -286.63055711206505, -315.6586712433624, -298.5669602090933, -296.73539202627234, -276.79517210621276, -277.3534174045708, -287.2964872715779, -274.6753211423795, -300.928265037332, -287.9579128726179, -269.9304568811831], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46400403521723566, "mean_inference_ms": 1.256571312859569, "mean_action_processing_ms": 0.11491144397127467, "mean_env_wait_ms": 0.7331215633046264, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2211840, "timesteps_this_iter": 0, "agent_timesteps_total": 2211840, "timers": {"sample_time_ms": 22954.845, "sample_throughput": 2676.559, "load_time_ms": 0.255, "load_throughput": 241042033.262, "learn_time_ms": 2914.901, "learn_throughput": 21077.903, "update_time_ms": 14.873}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005, "total_loss": 0.6497079767286777, "policy_loss": 0.008742581975335876, "vf_loss": 0.6554741362730662, "vf_explained_var": -6.665537754694621e-05, "kl": 0.008315024373321952, "entropy": 1.4508942713340123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2211840, "num_agent_steps_sampled": 2211840, "num_steps_trained": 2211840, "num_agent_steps_trained": 2211840, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 288, "training_iteration": 36, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-03-59", "timestamp": 1708841039, "time_this_iter_s": 22.99342370033264, "time_total_s": 819.8007166385651, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b59d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 819.8007166385651, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.483333333333334, "ram_util_percent": 9.590000000000002, "gpu_util_percent0": 0.025666666666666674, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -268.71451147568763, "episode_reward_min": -330.1646734062874, "episode_reward_mean": -288.2243203530983, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-283.75013710813573, -293.9092741676307, -310.15576281754943, -279.5169566420376, -270.7925448333981, -287.1432354160362, -281.83894228949356, -274.08241686015816, -272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507, -312.3169459474358, -291.5497931972926, -291.275764450458, -290.3652238504456, -304.9193252828094, -286.63055711206505, -315.6586712433624, -298.5669602090933, -296.73539202627234, -276.79517210621276, -277.3534174045708, -287.2964872715779, -274.6753211423795, -300.928265037332, -287.9579128726179, -269.9304568811831, -279.05678929078346, -275.7655152332752, -272.38072610940253, -269.7640733388879, -279.9983892734509, -281.5043445593675, -284.00841868769663, -291.98988300775], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4641161787967604, "mean_inference_ms": 1.256996448494783, "mean_action_processing_ms": 0.1149134561063946, "mean_env_wait_ms": 0.7332499991080036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2273280, "timesteps_this_iter": 0, "agent_timesteps_total": 2273280, "timers": {"sample_time_ms": 22977.793, "sample_throughput": 2673.886, "load_time_ms": 0.248, "load_throughput": 247881913.967, "learn_time_ms": 2907.759, "learn_throughput": 21129.671, "update_time_ms": 14.763}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005, "total_loss": 0.5914182811975479, "policy_loss": 0.0009591063092860471, "vf_loss": 0.6045553137858709, "vf_explained_var": 0.000736561914285024, "kl": 0.011472626956674503, "entropy": 1.409640411535899, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2273280, "num_agent_steps_sampled": 2273280, "num_steps_trained": 2273280, "num_agent_steps_trained": 2273280, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 296, "training_iteration": 37, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-04-22", "timestamp": 1708841062, "time_this_iter_s": 23.02791714668274, "time_total_s": 842.8286337852478, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c26e940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 842.8286337852478, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 29.873333333333335, "ram_util_percent": 9.699999999999998, "gpu_util_percent0": 0.004666666666666667, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -267.46166053395666, "episode_reward_min": -330.1646734062874, "episode_reward_mean": -287.7136748979912, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-272.06772087611375, -277.88092065769894, -289.3012469379239, -271.72229006344986, -314.8661456882789, -311.0247242879132, -292.5170456427952, -297.69161387421104, -296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507, -312.3169459474358, -291.5497931972926, -291.275764450458, -290.3652238504456, -304.9193252828094, -286.63055711206505, -315.6586712433624, -298.5669602090933, -296.73539202627234, -276.79517210621276, -277.3534174045708, -287.2964872715779, -274.6753211423795, -300.928265037332, -287.9579128726179, -269.9304568811831, -279.05678929078346, -275.7655152332752, -272.38072610940253, -269.7640733388879, -279.9983892734509, -281.5043445593675, -284.00841868769663, -291.98988300775, -269.54145984555, -274.0208004288159, -271.7072562403166, -267.46166053395666, -278.297331687722, -279.5112860807557, -306.27650411687915, -283.30842568974344], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4642312677006042, "mean_inference_ms": 1.2573901886369048, "mean_action_processing_ms": 0.11491530480811116, "mean_env_wait_ms": 0.7334005372547148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2334720, "timesteps_this_iter": 0, "agent_timesteps_total": 2334720, "timers": {"sample_time_ms": 22978.48, "sample_throughput": 2673.806, "load_time_ms": 0.248, "load_throughput": 247667503.854, "learn_time_ms": 2914.061, "learn_throughput": 21083.981, "update_time_ms": 14.833}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005, "total_loss": 0.6050726796189944, "policy_loss": 0.002466246058853964, "vf_loss": 0.6175192420681318, "vf_explained_var": -4.217028617858887e-05, "kl": 0.007462877499468353, "entropy": 1.491296648979187, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2334720, "num_agent_steps_sampled": 2334720, "num_steps_trained": 2334720, "num_agent_steps_trained": 2334720, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 304, "training_iteration": 38, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-04-45", "timestamp": 1708841085, "time_this_iter_s": 22.798149824142456, "time_total_s": 865.6267836093903, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb74c6b5040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 865.6267836093903, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.55333333333333, "ram_util_percent": 9.703333333333331, "gpu_util_percent0": 0.022666666666666672, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -267.46166053395666, "episode_reward_min": -355.2862754660413, "episode_reward_mean": -291.0263380560049, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-296.43975405056574, -312.8428368229584, -297.83577988324737, -315.86504207458853, -319.5898158725314, -278.7580443559203, -289.62328514151767, -276.8456527629398, -303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507, -312.3169459474358, -291.5497931972926, -291.275764450458, -290.3652238504456, -304.9193252828094, -286.63055711206505, -315.6586712433624, -298.5669602090933, -296.73539202627234, -276.79517210621276, -277.3534174045708, -287.2964872715779, -274.6753211423795, -300.928265037332, -287.9579128726179, -269.9304568811831, -279.05678929078346, -275.7655152332752, -272.38072610940253, -269.7640733388879, -279.9983892734509, -281.5043445593675, -284.00841868769663, -291.98988300775, -269.54145984555, -274.0208004288159, -271.7072562403166, -267.46166053395666, -278.297331687722, -279.5112860807557, -306.27650411687915, -283.30842568974344, -324.68953320978164, -319.6090358329484, -355.2862754660413, -346.59913331039064, -315.9504204573308, -328.628143119442, -339.42940136796665, -328.14608106585064], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46435222266432313, "mean_inference_ms": 1.257813020821348, "mean_action_processing_ms": 0.11491832481906027, "mean_env_wait_ms": 0.7335057447389989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2396160, "timesteps_this_iter": 0, "agent_timesteps_total": 2396160, "timers": {"sample_time_ms": 23000.73, "sample_throughput": 2671.22, "load_time_ms": 0.228, "load_throughput": 269276946.458, "learn_time_ms": 2917.468, "learn_throughput": 21059.36, "update_time_ms": 14.896}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005, "total_loss": 1.191011767834425, "policy_loss": -0.0074276389786973596, "vf_loss": 1.213091457883517, "vf_explained_var": 0.0017832964658737183, "kl": 0.010079258419864345, "entropy": 1.4652313242355983, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2396160, "num_agent_steps_sampled": 2396160, "num_steps_trained": 2396160, "num_agent_steps_trained": 2396160, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 312, "training_iteration": 39, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-05-08", "timestamp": 1708841108, "time_this_iter_s": 23.03262734413147, "time_total_s": 888.6594109535217, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb76c26eb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 888.6594109535217, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.610000000000003, "ram_util_percent": 9.763333333333334, "gpu_util_percent0": 0.02666666666666667, "vram_util_percent0": 0.02644856770833334}}
{"episode_reward_max": -267.2085757324452, "episode_reward_min": -355.2862754660413, "episode_reward_mean": -289.1586551532615, "episode_len_mean": 960.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-303.3804052300971, -283.52326418210106, -308.5715944538856, -279.85922457149775, -270.4093166774947, -273.96791089775724, -279.7863077728568, -286.1630231054762, -283.0245782420316, -273.7191716484785, -268.71451147568763, -275.0790337498582, -280.4071360417221, -284.7188581708261, -280.3080878709191, -293.4291645802524, -274.2182452212447, -282.5660154714662, -274.67158629031655, -277.1271987918921, -315.60759098816976, -313.2135300302605, -307.8643858023589, -314.5821492200804, -322.50334113096744, -299.83374471543664, -297.7785802059229, -303.2840515566484, -330.1646734062874, -280.3155981435272, -283.9014387496788, -290.1373310582039, -279.155395383045, -325.5613207208002, -280.9171236595672, -275.5276074804585, -280.59436417328726, -292.4097977876718, -280.5050935545422, -281.94578063121565, -285.40707231986426, -288.6735180813842, -272.75574637100584, -273.6778147060911, -273.69410341585717, -282.90601776965735, -274.8039435803744, -294.100893599203, -272.4705408908766, -272.821394081934, -270.86853902939157, -277.31992395737507, -312.3169459474358, -291.5497931972926, -291.275764450458, -290.3652238504456, -304.9193252828094, -286.63055711206505, -315.6586712433624, -298.5669602090933, -296.73539202627234, -276.79517210621276, -277.3534174045708, -287.2964872715779, -274.6753211423795, -300.928265037332, -287.9579128726179, -269.9304568811831, -279.05678929078346, -275.7655152332752, -272.38072610940253, -269.7640733388879, -279.9983892734509, -281.5043445593675, -284.00841868769663, -291.98988300775, -269.54145984555, -274.0208004288159, -271.7072562403166, -267.46166053395666, -278.297331687722, -279.5112860807557, -306.27650411687915, -283.30842568974344, -324.68953320978164, -319.6090358329484, -355.2862754660413, -346.59913331039064, -315.9504204573308, -328.628143119442, -339.42940136796665, -328.14608106585064, -272.70139745638477, -272.00729773081775, -273.9639835709351, -267.2085757324452, -275.9503499961568, -283.4062182425932, -278.19640967499396, -277.5976882856064], "episode_lengths": [960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960, 960]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644800805211509, "mean_inference_ms": 1.2582179529002562, "mean_action_processing_ms": 0.11492117046094025, "mean_env_wait_ms": 0.7335889246377201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 2457600, "timesteps_this_iter": 0, "agent_timesteps_total": 2457600, "timers": {"sample_time_ms": 22989.611, "sample_throughput": 2672.512, "load_time_ms": 0.228, "load_throughput": 269333233.445, "learn_time_ms": 2924.524, "learn_throughput": 21008.55, "update_time_ms": 14.884}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0005, "total_loss": 0.6259602506955465, "policy_loss": 0.00545456189623413, "vf_loss": 0.6350771014889082, "vf_explained_var": 0.0022241671880086264, "kl": 0.0033000612826678357, "entropy": 1.4571505039930344, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2457600, "num_agent_steps_sampled": 2457600, "num_steps_trained": 2457600, "num_agent_steps_trained": 2457600, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 320, "training_iteration": 40, "trial_id": "c1812_00000", "experiment_id": "c6cc8a84022643a8a1212d10886761df", "date": "2024-02-25_12-05-31", "timestamp": 1708841131, "time_this_iter_s": 22.787713766098022, "time_total_s": 911.4471247196198, "pid": 8434, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 625, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 5000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "magym", "env_args": {"max_steps": 960, "map_name": "PowerGrid"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": true, "force_coop": false, "local_mode": true, "share_policy": "all", "evaluation_interval": 50, "framework": "torch", "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 50, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-128"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box([9.0e-04 0.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], [4.5e-03 8.0e+00 1.5e+01 8.0e+00 1.0e+01 1.0e+01], (6,), float32))", "space_act": "Discrete(9)", "num_agents": 8, "episode_limit": 2500, "policy_mapping_info": {"Checkers": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "Switch2": {"description": "two team cooperate", "team_prefix": ["red_", "blue_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "PowerGrid": {"description": "eight team cooperate", "team_prefix": ["1", "2", "3", "4", "5", "6", "7", "8"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["1", "2", "3", "4", "5", "6", "7", "8"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "magym_PowerGrid", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb3d9977f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 5000, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 911.4471247196198, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.8, "ram_util_percent": 9.816666666666666, "gpu_util_percent0": 0.010666666666666666, "vram_util_percent0": 0.02644856770833334}}
