{"episode_reward_max": -74.1880086468453, "episode_reward_min": -178.28987566620376, "episode_reward_mean": -113.42286219170924, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -59.42995855540127}, "policy_reward_max": {"shared_policy": -24.729336215615096}, "policy_reward_mean": {"shared_policy": -37.807620730569745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.2787926016392, -101.36081839359184, -100.86673864162012, -95.38566203937725, -117.52061164574181, -94.1126257604757, -108.47077123022437, -98.77195851987776, -138.9453275210482, -110.19625391013822, -151.0274603038983, -125.64253643828525, -95.30076694553296, -137.72703739289608, -115.34287285560059, -99.97874651710455, -124.36516253745614, -103.40717948188704, -93.4627615956121, -132.46580491233627, -92.7559426304368, -99.5463716607788, -134.17687559785924, -110.22061824744227, -95.09586785456496, -128.99221703049923, -106.51996836195228, -120.07387248342414, -119.84195774977053, -128.39833233996623, -130.36901954019572, -95.24842001990801, -124.00863568536916, -105.81035201389913, -116.08363139254398, -125.8720246342503, -137.07206056942022, -92.33742524574953, -143.2449797780164, -108.6060526359208, -98.94655261005548, -138.4509095802295, -119.09709996907199, -120.26129707962959, -100.42124340852688, -85.65676547991393, -99.07990724258518, -102.06202507414703, -115.9331575945177, -95.26355480998714, -89.85855102314866, -134.66328930616373, -97.86567649896861, -94.5465181068392, -110.53307065333766, -112.91386060719056, -108.8033992051969, -137.33874360706852, -132.9905172404189, -108.76537894469007, -112.85960603977693, -74.1880086468453, -83.22220527961156, -113.50872854970017, -108.52930158608712, -113.42416632032746, -110.04394450940461, -100.71603016009558, -112.32095491500779, -126.18200484362787, -151.42659832974, -114.75908427748773, -114.30258450454079, -78.81024421879157, -74.22731141434404, -79.99428310735387, -104.6756668503518, -123.31022963913442, -127.11134314155636, -127.61351123083804, -161.32212500405228, -100.77211301221459, -109.88646638041038, -116.1395417556152, -118.45971991153003, -117.05357392964845, -107.42774952128586, -90.38928700808846, -178.28987566620376, -153.30519146776192, -122.16788252110695, -120.88788336080256, -105.9280476760177, -110.02743158171997, -110.31651727208181, -153.09923436851804, -100.2626986643585, -119.3604902885849, -139.2947265766284, -123.77771633996902, -86.25242143565572, -134.30810029671926, -170.9714880766425, -129.23701833972794, -116.85319453747199, -94.54601729570264, -140.33564911535223, -105.95138521380939, -104.1029924038133, -120.08972052063635, -107.14045584799882, -80.99784728908652, -88.94020549962231, -93.81001256425296, -121.19040515278216, -113.54988611370003, -132.6792687108054, -112.8398421379044, -96.2857679647316, -129.82054434499003, -109.47664012380673, -81.13404436735298, -101.38056101796127, -84.06329783862454, -77.11016317835629, -111.5603230930269, -120.51444492986553, -147.23455049916134], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-44.75959753387973, -44.75959753387973, -44.75959753387973, -33.78693946453059, -33.78693946453059, -33.78693946453059, -33.622246213873346, -33.622246213873346, -33.622246213873346, -31.79522067979244, -31.79522067979244, -31.79522067979244, -39.17353721524725, -39.17353721524725, -39.17353721524725, -31.370875253491903, -31.370875253491903, -31.370875253491903, -36.156923743408136, -36.156923743408136, -36.156923743408136, -32.92398617329256, -32.92398617329256, -32.92398617329256, -46.31510917368274, -46.31510917368274, -46.31510917368274, -36.732084636712734, -36.732084636712734, -36.732084636712734, -50.342486767966086, -50.342486767966086, -50.342486767966086, -41.880845479428395, -41.880845479428395, -41.880845479428395, -31.76692231517764, -31.76692231517764, -31.76692231517764, -45.90901246429873, -45.90901246429873, -45.90901246429873, -38.44762428520019, -38.44762428520019, -38.44762428520019, -33.32624883903487, -33.32624883903487, -33.32624883903487, -41.45505417915206, -41.45505417915206, -41.45505417915206, -34.469059827295666, -34.469059827295666, -34.469059827295666, -31.154253865204034, -31.154253865204034, -31.154253865204034, -44.15526830411208, -44.15526830411208, -44.15526830411208, -30.91864754347894, -30.91864754347894, -30.91864754347894, -33.18212388692625, -33.18212388692625, -33.18212388692625, -44.72562519928642, -44.72562519928642, -44.72562519928642, -36.74020608248077, -36.74020608248077, -36.74020608248077, -31.698622618188324, -31.698622618188324, -31.698622618188324, -42.99740567683309, -42.99740567683309, -42.99740567683309, -35.50665612065075, -35.50665612065075, -35.50665612065075, -40.02462416114139, -40.02462416114139, -40.02462416114139, -39.94731924992351, -39.94731924992351, -39.94731924992351, -42.79944411332205, -42.79944411332205, -42.79944411332205, -43.4563398467319, -43.4563398467319, -43.4563398467319, -31.749473339969345, -31.749473339969345, -31.749473339969345, -41.33621189512306, -41.33621189512306, -41.33621189512306, -35.27011733796639, -35.27011733796639, -35.27011733796639, -38.694543797514655, -38.694543797514655, -38.694543797514655, -41.95734154475009, -41.95734154475009, -41.95734154475009, -45.690686856473405, -45.690686856473405, -45.690686856473405, -30.779141748583196, -30.779141748583196, -30.779141748583196, -47.74832659267215, -47.74832659267215, -47.74832659267215, -36.20201754530692, -36.20201754530692, -36.20201754530692, -32.982184203351835, -32.982184203351835, -32.982184203351835, -46.15030319340981, -46.15030319340981, -46.15030319340981, -39.69903332302397, -39.69903332302397, -39.69903332302397, -40.087099026543214, -40.087099026543214, -40.087099026543214, -33.473747802842276, -33.473747802842276, -33.473747802842276, -28.55225515997132, -28.55225515997132, -28.55225515997132, -33.02663574752839, -33.02663574752839, -33.02663574752839, -34.02067502471567, -34.02067502471567, -34.02067502471567, -38.64438586483924, -38.64438586483924, -38.64438586483924, -31.754518269995707, -31.754518269995707, -31.754518269995707, -29.952850341049544, -29.952850341049544, -29.952850341049544, -44.88776310205455, -44.88776310205455, -44.88776310205455, -32.621892166322866, -32.621892166322866, -32.621892166322866, -31.515506035613093, -31.515506035613093, -31.515506035613093, -36.84435688444589, -36.84435688444589, -36.84435688444589, -37.63795353573019, -37.63795353573019, -37.63795353573019, -36.26779973506562, -36.26779973506562, -36.26779973506562, -45.77958120235617, -45.77958120235617, -45.77958120235617, -44.33017241347298, -44.33017241347298, -44.33017241347298, -36.25512631489669, -36.25512631489669, -36.25512631489669, -37.619868679925645, -37.619868679925645, -37.619868679925645, -24.729336215615096, -24.729336215615096, -24.729336215615096, -27.740735093203842, -27.740735093203842, -27.740735093203842, -37.83624284990004, -37.83624284990004, -37.83624284990004, -36.17643386202904, -36.17643386202904, -36.17643386202904, -37.808055440109186, -37.808055440109186, -37.808055440109186, -36.68131483646818, -36.68131483646818, -36.68131483646818, -33.57201005336518, -33.57201005336518, -33.57201005336518, -37.44031830500261, -37.44031830500261, -37.44031830500261, -42.060668281209296, -42.060668281209296, -42.060668281209296, -50.47553277657995, -50.47553277657995, -50.47553277657995, -38.25302809249591, -38.25302809249591, -38.25302809249591, -38.100861501513585, -38.100861501513585, -38.100861501513585, -26.270081406263852, -26.270081406263852, -26.270081406263852, -24.742437138114663, -24.742437138114663, -24.742437138114663, -26.66476103578462, -26.66476103578462, -26.66476103578462, -34.89188895011728, -34.89188895011728, -34.89188895011728, -41.10340987971147, -41.10340987971147, -41.10340987971147, -42.37044771385213, -42.37044771385213, -42.37044771385213, -42.537837076946005, -42.537837076946005, -42.537837076946005, -53.77404166801743, -53.77404166801743, -53.77404166801743, -33.59070433740485, -33.59070433740485, -33.59070433740485, -36.62882212680346, -36.62882212680346, -36.62882212680346, -38.71318058520508, -38.71318058520508, -38.71318058520508, -39.486573303843336, -39.486573303843336, -39.486573303843336, -39.0178579765495, -39.0178579765495, -39.0178579765495, -35.80924984042861, -35.80924984042861, -35.80924984042861, -30.129762336029476, -30.129762336029476, -30.129762336029476, -59.42995855540127, -59.42995855540127, -59.42995855540127, -51.10173048925397, -51.10173048925397, -51.10173048925397, -40.722627507035625, -40.722627507035625, -40.722627507035625, -40.29596112026752, -40.29596112026752, -40.29596112026752, -35.30934922533923, -35.30934922533923, -35.30934922533923, -36.67581052724001, -36.67581052724001, -36.67581052724001, -36.77217242402724, -36.77217242402724, -36.77217242402724, -51.03307812283936, -51.03307812283936, -51.03307812283936, -33.42089955478616, -33.42089955478616, -33.42089955478616, -39.78683009619496, -39.78683009619496, -39.78683009619496, -46.43157552554279, -46.43157552554279, -46.43157552554279, -41.25923877998965, -41.25923877998965, -41.25923877998965, -28.750807145218573, -28.750807145218573, -28.750807145218573, -44.7693667655731, -44.7693667655731, -44.7693667655731, -56.990496025547486, -56.990496025547486, -56.990496025547486, -43.079006113242635, -43.079006113242635, -43.079006113242635, -38.95106484582398, -38.95106484582398, -38.95106484582398, -31.515339098567523, -31.515339098567523, -31.515339098567523, -46.778549705117385, -46.778549705117385, -46.778549705117385, -35.31712840460314, -35.31712840460314, -35.31712840460314, -34.700997467937775, -34.700997467937775, -34.700997467937775, -40.029906840212135, -40.029906840212135, -40.029906840212135, -35.713485282666284, -35.713485282666284, -35.713485282666284, -26.99928242969549, -26.99928242969549, -26.99928242969549, -29.646735166540747, -29.646735166540747, -29.646735166540747, -31.270004188084332, -31.270004188084332, -31.270004188084332, -40.39680171759404, -40.39680171759404, -40.39680171759404, -37.8499620379, -37.8499620379, -37.8499620379, -44.22642290360179, -44.22642290360179, -44.22642290360179, -37.61328071263479, -37.61328071263479, -37.61328071263479, -32.095255988243856, -32.095255988243856, -32.095255988243856, -43.27351478166334, -43.27351478166334, -43.27351478166334, -36.49221337460222, -36.49221337460222, -36.49221337460222, -27.044681455784314, -27.044681455784314, -27.044681455784314, -33.793520339320416, -33.793520339320416, -33.793520339320416, -28.021099279541517, -28.021099279541517, -28.021099279541517, -25.70338772611877, -25.70338772611877, -25.70338772611877, -37.1867743643423, -37.1867743643423, -37.1867743643423, -40.171481643288516, -40.171481643288516, -40.171481643288516, -49.07818349972043, -49.07818349972043, -49.07818349972043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29486665424798586, "mean_inference_ms": 1.1028181348357935, "mean_action_processing_ms": 0.06865047358304624, "mean_env_wait_ms": 0.5786935823554361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 3200, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"sample_time_ms": 6621.567, "sample_throughput": 483.269, "load_time_ms": 0.409, "load_throughput": 7826106.589, "learn_time_ms": 3553.698, "learn_throughput": 900.47, "update_time_ms": 2.037}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 446.3620971679687, "policy_loss": -0.004272313258688598, "vf_loss": 446.3814392089844, "vf_explained_var": 0.002227783203125, "kl": 0.004813964665124947, "entropy": 1.6046886801719666, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3200, "num_agent_steps_sampled": 9600, "num_steps_trained": 3200, "num_agent_steps_trained": 9600}, "done": false, "episodes_total": 128, "training_iteration": 1, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-05-22", "timestamp": 1701842722, "time_this_iter_s": 10.156211137771606, "time_total_s": 10.156211137771606, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa8345940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10.156211137771606, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.75333333333333, "ram_util_percent": 27.973333333333333}}
{"episode_reward_max": -69.54583265455429, "episode_reward_min": -239.86284228498812, "episode_reward_mean": -115.8459785911295, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -79.95428076166273}, "policy_reward_max": {"shared_policy": -23.181944218184768}, "policy_reward_mean": {"shared_policy": -38.61532619704317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.71841352752034, -131.22683487001038, -88.44578520014618, -97.62639524336434, -101.48805220563864, -96.23751562398802, -88.76738289415297, -124.59836543654777, -121.42171460607916, -119.30208417139903, -105.65891301559667, -105.16414943538261, -107.2906995093932, -108.52827405699549, -80.34790093975981, -136.5512212546434, -121.98030716952782, -95.63625345341107, -108.8962774787741, -139.58659966940334, -73.62359337409046, -135.2227986768952, -97.89601474826715, -148.69419396697705, -127.87598781791395, -101.71151113586983, -106.11381352797089, -128.9486433797079, -110.74449939601371, -82.38578720320523, -158.77830409311088, -96.24909172856361, -107.20253268072327, -108.83714144863144, -87.22156110598848, -111.87536923351117, -185.1952540220294, -107.50041982166715, -111.59028750625433, -109.02304610339955, -118.16404869140884, -99.17946891827445, -109.94932618644498, -78.8623995716184, -135.19855758507438, -144.4038482019266, -96.71001121474286, -95.87778621944673, -115.00041471669525, -76.86202522411195, -132.8809951194883, -110.35520417323227, -103.67064976551477, -99.14133793978189, -142.51028356248244, -100.7699938025607, -171.9771816519486, -146.44063830612615, -111.66651664534999, -185.51933999299612, -125.81434247658225, -90.27274376100607, -133.08842741480606, -102.97301627294426, -107.01143816895734, -97.40286243638809, -97.65273011379394, -105.52215852769943, -94.0274826828417, -92.40030386175447, -131.97688012682104, -112.01903045934587, -127.97983314608913, -128.07074258287165, -135.27870957073483, -124.24017256627404, -100.2224076541929, -95.16641744335732, -123.64068319671308, -106.23644729819787, -114.8546857738296, -125.00054454924987, -122.01026384304933, -105.12771652940621, -79.42066596511107, -110.94054018502301, -105.2057063310726, -118.41045310515096, -69.54583265455429, -239.86284228498812, -90.21621885702827, -95.49113291287227, -120.10280335472874, -217.11699479887693, -115.30623511309611, -98.69927006841702, -88.0004125000696, -106.5942985378341, -74.57589051875587, -183.1717850021273, -109.65616709876267, -113.05332971038861, -161.47949440554373, -120.97338758680468, -136.54151653897978, -124.65330483342954, -107.44594901605002, -121.95539491386914, -177.75657926566592, -92.28141551731527, -107.46769985449666, -105.53026236377184, -137.4339239896007, -95.66999727452163, -129.12947176553752, -131.31338110807482, -102.99209711513033, -99.45845767341945, -95.58569592121036, -151.44963186033996, -124.80981744571025, -116.65224249065697, -135.344478482163, -115.92055103521776, -114.56132925957291, -127.45276287129363, -134.90587249461828, -94.85690690406774], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-26.90613784250677, -26.90613784250677, -26.90613784250677, -43.742278290003455, -43.742278290003455, -43.742278290003455, -29.48192840004871, -29.48192840004871, -29.48192840004871, -32.54213174778811, -32.54213174778811, -32.54213174778811, -33.82935073521287, -33.82935073521287, -33.82935073521287, -32.07917187466266, -32.07917187466266, -32.07917187466266, -29.58912763138435, -29.58912763138435, -29.58912763138435, -41.53278847884925, -41.53278847884925, -41.53278847884925, -40.47390486869304, -40.47390486869304, -40.47390486869304, -39.76736139046634, -39.76736139046634, -39.76736139046634, -35.219637671865556, -35.219637671865556, -35.219637671865556, -35.05471647846085, -35.05471647846085, -35.05471647846085, -35.76356650313106, -35.76356650313106, -35.76356650313106, -36.17609135233185, -36.17609135233185, -36.17609135233185, -26.782633646586614, -26.782633646586614, -26.782633646586614, -45.51707375154781, -45.51707375154781, -45.51707375154781, -40.6601023898426, -40.6601023898426, -40.6601023898426, -31.87875115113702, -31.87875115113702, -31.87875115113702, -36.298759159591356, -36.298759159591356, -36.298759159591356, -46.52886655646782, -46.52886655646782, -46.52886655646782, -24.54119779136348, -24.54119779136348, -24.54119779136348, -45.0742662256317, -45.0742662256317, -45.0742662256317, -32.63200491608906, -32.63200491608906, -32.63200491608906, -49.56473132232569, -49.56473132232569, -49.56473132232569, -42.62532927263799, -42.62532927263799, -42.62532927263799, -33.90383704528994, -33.90383704528994, -33.90383704528994, -35.371271175990316, -35.371271175990316, -35.371271175990316, -42.98288112656931, -42.98288112656931, -42.98288112656931, -36.91483313200456, -36.91483313200456, -36.91483313200456, -27.461929067735078, -27.461929067735078, -27.461929067735078, -52.926101364370275, -52.926101364370275, -52.926101364370275, -32.08303057618787, -32.08303057618787, -32.08303057618787, -35.73417756024111, -35.73417756024111, -35.73417756024111, -36.279047149543835, -36.279047149543835, -36.279047149543835, -29.07385370199616, -29.07385370199616, -29.07385370199616, -37.29178974450373, -37.29178974450373, -37.29178974450373, -61.73175134067645, -61.73175134067645, -61.73175134067645, -35.83347327388907, -35.83347327388907, -35.83347327388907, -37.19676250208481, -37.19676250208481, -37.19676250208481, -36.34101536779986, -36.34101536779986, -36.34101536779986, -39.38801623046964, -39.38801623046964, -39.38801623046964, -33.059822972758155, -33.059822972758155, -33.059822972758155, -36.649775395481655, -36.649775395481655, -36.649775395481655, -26.28746652387282, -26.28746652387282, -26.28746652387282, -45.06618586169147, -45.06618586169147, -45.06618586169147, -48.134616067308855, -48.134616067308855, -48.134616067308855, -32.23667040491428, -32.23667040491428, -32.23667040491428, -31.959262073148892, -31.959262073148892, -31.959262073148892, -38.33347157223174, -38.33347157223174, -38.33347157223174, -25.620675074703986, -25.620675074703986, -25.620675074703986, -44.29366503982943, -44.29366503982943, -44.29366503982943, -36.7850680577441, -36.7850680577441, -36.7850680577441, -34.556883255171606, -34.556883255171606, -34.556883255171606, -33.04711264659397, -33.04711264659397, -33.04711264659397, -47.503427854160826, -47.503427854160826, -47.503427854160826, -33.58999793418689, -33.58999793418689, -33.58999793418689, -57.3257272173162, -57.3257272173162, -57.3257272173162, -48.81354610204206, -48.81354610204206, -48.81354610204206, -37.22217221511666, -37.22217221511666, -37.22217221511666, -61.83977999766538, -61.83977999766538, -61.83977999766538, -41.938114158860756, -41.938114158860756, -41.938114158860756, -30.09091458700204, -30.09091458700204, -30.09091458700204, -44.36280913826868, -44.36280913826868, -44.36280913826868, -34.3243387576481, -34.3243387576481, -34.3243387576481, -35.670479389652456, -35.670479389652456, -35.670479389652456, -32.467620812129375, -32.467620812129375, -32.467620812129375, -32.550910037931324, -32.550910037931324, -32.550910037931324, -35.1740528425665, -35.1740528425665, -35.1740528425665, -31.3424942276139, -31.3424942276139, -31.3424942276139, -30.800101287251486, -30.800101287251486, -30.800101287251486, -43.992293375607005, -43.992293375607005, -43.992293375607005, -37.33967681978195, -37.33967681978195, -37.33967681978195, -42.6599443820297, -42.6599443820297, -42.6599443820297, -42.69024752762385, -42.69024752762385, -42.69024752762385, -45.09290319024494, -45.09290319024494, -45.09290319024494, -41.41339085542468, -41.41339085542468, -41.41339085542468, -33.40746921806429, -33.40746921806429, -33.40746921806429, -31.72213914778579, -31.72213914778579, -31.72213914778579, -41.213561065571014, -41.213561065571014, -41.213561065571014, -35.412149099399294, -35.412149099399294, -35.412149099399294, -38.28489525794323, -38.28489525794323, -38.28489525794323, -41.6668481830833, -41.6668481830833, -41.6668481830833, -40.67008794768311, -40.67008794768311, -40.67008794768311, -35.04257217646873, -35.04257217646873, -35.04257217646873, -26.47355532170369, -26.47355532170369, -26.47355532170369, -36.98018006167432, -36.98018006167432, -36.98018006167432, -35.068568777024225, -35.068568777024225, -35.068568777024225, -39.470151035050314, -39.470151035050314, -39.470151035050314, -23.181944218184768, -23.181944218184768, -23.181944218184768, -79.95428076166273, -79.95428076166273, -79.95428076166273, -30.07207295234275, -30.07207295234275, -30.07207295234275, -31.830377637624082, -31.830377637624082, -31.830377637624082, -40.03426778490959, -40.03426778490959, -40.03426778490959, -72.37233159962565, -72.37233159962565, -72.37233159962565, -38.43541170436538, -38.43541170436538, -38.43541170436538, -32.899756689472355, -32.899756689472355, -32.899756689472355, -29.33347083335653, -29.33347083335653, -29.33347083335653, -35.53143284594473, -35.53143284594473, -35.53143284594473, -24.858630172918645, -24.858630172918645, -24.858630172918645, -61.05726166737575, -61.05726166737575, -61.05726166737575, -36.552055699587555, -36.552055699587555, -36.552055699587555, -37.68444323679623, -37.68444323679623, -37.68444323679623, -53.82649813518124, -53.82649813518124, -53.82649813518124, -40.32446252893489, -40.32446252893489, -40.32446252893489, -45.513838846326585, -45.513838846326585, -45.513838846326585, -41.55110161114319, -41.55110161114319, -41.55110161114319, -35.815316338683324, -35.815316338683324, -35.815316338683324, -40.65179830462305, -40.65179830462305, -40.65179830462305, -59.2521930885553, -59.2521930885553, -59.2521930885553, -30.7604718391051, -30.7604718391051, -30.7604718391051, -35.82256661816558, -35.82256661816558, -35.82256661816558, -35.176754121257275, -35.176754121257275, -35.176754121257275, -45.811307996533586, -45.811307996533586, -45.811307996533586, -31.88999909150723, -31.88999909150723, -31.88999909150723, -43.04315725517917, -43.04315725517917, -43.04315725517917, -43.771127036024915, -43.771127036024915, -43.771127036024915, -34.33069903837679, -34.33069903837679, -34.33069903837679, -33.15281922447314, -33.15281922447314, -33.15281922447314, -31.86189864040344, -31.86189864040344, -31.86189864040344, -50.48321062011332, -50.48321062011332, -50.48321062011332, -41.60327248190341, -41.60327248190341, -41.60327248190341, -38.884080830219, -38.884080830219, -38.884080830219, -45.114826160720995, -45.114826160720995, -45.114826160720995, -38.640183678405926, -38.640183678405926, -38.640183678405926, -38.18710975319097, -38.18710975319097, -38.18710975319097, -42.48425429043122, -42.48425429043122, -42.48425429043122, -44.96862416487275, -44.96862416487275, -44.96862416487275, -31.618968968022568, -31.618968968022568, -31.618968968022568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934273807839701, "mean_inference_ms": 1.0903479437998658, "mean_action_processing_ms": 0.06755063951322761, "mean_env_wait_ms": 0.5781107108270055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 6400, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"sample_time_ms": 8349.164, "sample_throughput": 383.272, "load_time_ms": 0.296, "load_throughput": 10828376.603, "learn_time_ms": 3500.147, "learn_throughput": 914.247, "update_time_ms": 1.967}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 477.3311370849609, "policy_loss": -0.003171888621174723, "vf_loss": 477.3498931884766, "vf_explained_var": -0.0010563492774963378, "kl": 0.003561530809928587, "entropy": 1.595075535774231, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6400, "num_agent_steps_sampled": 19200, "num_steps_trained": 6400, "num_agent_steps_trained": 19200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 256, "training_iteration": 2, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-05-32", "timestamp": 1701842732, "time_this_iter_s": 9.94014859199524, "time_total_s": 20.096359729766846, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa84521f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20.096359729766846, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.77857142857143, "ram_util_percent": 29.064285714285713}}
{"episode_reward_max": -60.617929044639446, "episode_reward_min": -180.1260989277436, "episode_reward_mean": -112.27104223459826, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -60.04203297591456}, "policy_reward_max": {"shared_policy": -20.205976348213152}, "policy_reward_mean": {"shared_policy": -37.42368074486608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.17915263578018, -106.38581977530035, -125.5987430753658, -145.07078379231837, -106.25581503213667, -122.01915786773695, -82.5680361493292, -118.65167629424326, -111.33022457202384, -111.87130068995833, -86.14217540858854, -112.88495271973525, -151.58922064859772, -119.30856964245206, -90.04449788852834, -127.47808060525246, -104.0775077042092, -83.64710829461882, -131.7308919994115, -123.6847672186749, -116.99118334262661, -142.18260709307512, -90.13258065694222, -180.1260989277436, -153.3043400974287, -79.9278513888436, -92.99292040198111, -115.25182631560878, -82.9873526640932, -73.13479339788731, -90.83585056866751, -110.28419320817406, -87.06415148519208, -123.8531011658186, -114.34342703866832, -102.85166452129182, -149.16451453851383, -128.87615602882516, -110.30169903644078, -100.51844844190393, -112.73753601135556, -100.30787565161995, -101.57770369459466, -100.12296920535591, -94.23560499659911, -118.55500232593074, -116.74349178022216, -100.29720519025562, -100.02812991163897, -155.63542083574623, -151.3626017199168, -112.30882501989889, -129.48096294723857, -105.43667849431057, -60.617929044639446, -152.72828319509932, -116.57896190255417, -102.69538857711272, -89.51914815467393, -116.47027933428659, -106.09622823277036, -90.52664723123853, -75.8901640993127, -96.83987110633274, -103.32922932687073, -153.20362888052077, -92.60651169949742, -124.52589736556341, -108.24271121412463, -119.3888840825801, -100.24137349071813, -92.2695485967263, -97.48228535212604, -106.05878105773009, -101.64038288842724, -91.03148292501014, -121.3523222493784, -113.1558422591349, -161.68871631098094, -111.25840267380016, -175.42016758533666, -115.4535551443532, -129.65922262266085, -102.21418479488148, -116.86853793443048, -156.44759520453968, -113.09261821890787, -109.11437065723489, -108.23169966375221, -66.63439548811292, -104.3006990210058, -92.31713909822682, -116.27673126964956, -108.91791510985409, -99.60289799540409, -121.69339903505217, -110.56501608748158, -106.83239300871816, -116.31323727034491, -119.53123970305835, -87.46572580627137, -103.50573072952199, -111.49124893217659, -124.05170847348714, -94.05582846544446, -105.1686851302187, -117.39395476609913, -121.80939838314437, -109.14818161630906, -136.48280732940094, -120.23726661990855, -87.64088630084493, -129.97905976514875, -148.0172041374683, -106.40343914640822, -99.97832586996093, -88.7370092440114, -91.54818885820698, -104.79609839349087, -92.7038705785672, -152.0779650481448, -75.44114454962408, -107.08470900966971, -82.03993021271503, -157.7990307902337, -136.63386097299815, -126.8246401175973, -103.77834049861701], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-49.726384211926764, -49.726384211926764, -49.726384211926764, -35.4619399251001, -35.4619399251001, -35.4619399251001, -41.866247691788594, -41.866247691788594, -41.866247691788594, -48.35692793077276, -48.35692793077276, -48.35692793077276, -35.418605010712234, -35.418605010712234, -35.418605010712234, -40.67305262257895, -40.67305262257895, -40.67305262257895, -27.522678716443053, -27.522678716443053, -27.522678716443053, -39.55055876474774, -39.55055876474774, -39.55055876474774, -37.110074857341296, -37.110074857341296, -37.110074857341296, -37.29043356331946, -37.29043356331946, -37.29043356331946, -28.7140584695295, -28.7140584695295, -28.7140584695295, -37.628317573245084, -37.628317573245084, -37.628317573245084, -50.52974021619927, -50.52974021619927, -50.52974021619927, -39.769523214150716, -39.769523214150716, -39.769523214150716, -30.014832629509453, -30.014832629509453, -30.014832629509453, -42.49269353508413, -42.49269353508413, -42.49269353508413, -34.69250256806969, -34.69250256806969, -34.69250256806969, -27.88236943153961, -27.88236943153961, -27.88236943153961, -43.91029733313717, -43.91029733313717, -43.91029733313717, -41.228255739558314, -41.228255739558314, -41.228255739558314, -38.99706111420886, -38.99706111420886, -38.99706111420886, -47.39420236435832, -47.39420236435832, -47.39420236435832, -30.044193552314095, -30.044193552314095, -30.044193552314095, -60.04203297591456, -60.04203297591456, -60.04203297591456, -51.10144669914289, -51.10144669914289, -51.10144669914289, -26.642617129614532, -26.642617129614532, -26.642617129614532, -30.997640133993713, -30.997640133993713, -30.997640133993713, -38.41727543853627, -38.41727543853627, -38.41727543853627, -27.662450888031064, -27.662450888031064, -27.662450888031064, -24.378264465962438, -24.378264465962438, -24.378264465962438, -30.278616856222513, -30.278616856222513, -30.278616856222513, -36.761397736058036, -36.761397736058036, -36.761397736058036, -29.021383828397347, -29.021383828397347, -29.021383828397347, -41.284367055272874, -41.284367055272874, -41.284367055272874, -38.1144756795561, -38.1144756795561, -38.1144756795561, -34.28388817376394, -34.28388817376394, -34.28388817376394, -49.721504846171285, -49.721504846171285, -49.721504846171285, -42.95871867627505, -42.95871867627505, -42.95871867627505, -36.767233012146924, -36.767233012146924, -36.767233012146924, -33.506149480634626, -33.506149480634626, -33.506149480634626, -37.57917867045185, -37.57917867045185, -37.57917867045185, -33.43595855054001, -33.43595855054001, -33.43595855054001, -33.859234564864906, -33.859234564864906, -33.859234564864906, -33.374323068451965, -33.374323068451965, -33.374323068451965, -31.4118683321997, -31.4118683321997, -31.4118683321997, -39.51833410864357, -39.51833410864357, -39.51833410864357, -38.914497260074064, -38.914497260074064, -38.914497260074064, -33.432401730085196, -33.432401730085196, -33.432401730085196, -33.34270997054632, -33.34270997054632, -33.34270997054632, -51.878473611915396, -51.878473611915396, -51.878473611915396, -50.454200573305606, -50.454200573305606, -50.454200573305606, -37.43627500663296, -37.43627500663296, -37.43627500663296, -43.16032098241286, -43.16032098241286, -43.16032098241286, -35.14555949810352, -35.14555949810352, -35.14555949810352, -20.205976348213152, -20.205976348213152, -20.205976348213152, -50.90942773169978, -50.90942773169978, -50.90942773169978, -38.85965396751805, -38.85965396751805, -38.85965396751805, -34.23179619237091, -34.23179619237091, -34.23179619237091, -29.83971605155801, -29.83971605155801, -29.83971605155801, -38.82342644476222, -38.82342644476222, -38.82342644476222, -35.365409410923476, -35.365409410923476, -35.365409410923476, -30.175549077079506, -30.175549077079506, -30.175549077079506, -25.296721366437563, -25.296721366437563, -25.296721366437563, -32.27995703544424, -32.27995703544424, -32.27995703544424, -34.44307644229027, -34.44307644229027, -34.44307644229027, -51.06787629350693, -51.06787629350693, -51.06787629350693, -30.868837233165817, -30.868837233165817, -30.868837233165817, -41.50863245518784, -41.50863245518784, -41.50863245518784, -36.08090373804154, -36.08090373804154, -36.08090373804154, -39.79629469419337, -39.79629469419337, -39.79629469419337, -33.413791163572704, -33.413791163572704, -33.413791163572704, -30.756516198908788, -30.756516198908788, -30.756516198908788, -32.49409511737534, -32.49409511737534, -32.49409511737534, -35.35292701924337, -35.35292701924337, -35.35292701924337, -33.88012762947575, -33.88012762947575, -33.88012762947575, -30.343827641670035, -30.343827641670035, -30.343827641670035, -40.45077408312615, -40.45077408312615, -40.45077408312615, -37.71861408637833, -37.71861408637833, -37.71861408637833, -53.896238770326995, -53.896238770326995, -53.896238770326995, -37.08613422460004, -37.08613422460004, -37.08613422460004, -58.4733891951122, -58.4733891951122, -58.4733891951122, -38.48451838145106, -38.48451838145106, -38.48451838145106, -43.219740874220285, -43.219740874220285, -43.219740874220285, -34.07139493162716, -34.07139493162716, -34.07139493162716, -38.95617931147684, -38.95617931147684, -38.95617931147684, -52.14919840151325, -52.14919840151325, -52.14919840151325, -37.697539406302624, -37.697539406302624, -37.697539406302624, -36.37145688574495, -36.37145688574495, -36.37145688574495, -36.07723322125073, -36.07723322125073, -36.07723322125073, -22.211465162704307, -22.211465162704307, -22.211465162704307, -34.76689967366858, -34.76689967366858, -34.76689967366858, -30.772379699408955, -30.772379699408955, -30.772379699408955, -38.75891042321651, -38.75891042321651, -38.75891042321651, -36.30597170328469, -36.30597170328469, -36.30597170328469, -33.200965998468035, -33.200965998468035, -33.200965998468035, -40.56446634501741, -40.56446634501741, -40.56446634501741, -36.855005362493856, -36.855005362493856, -36.855005362493856, -35.61079766957274, -35.61079766957274, -35.61079766957274, -38.77107909011497, -38.77107909011497, -38.77107909011497, -39.84374656768614, -39.84374656768614, -39.84374656768614, -29.155241935423803, -29.155241935423803, -29.155241935423803, -34.501910243173995, -34.501910243173995, -34.501910243173995, -37.163749644058846, -37.163749644058846, -37.163749644058846, -41.35056949116237, -41.35056949116237, -41.35056949116237, -31.35194282181481, -31.35194282181481, -31.35194282181481, -35.056228376739554, -35.056228376739554, -35.056228376739554, -39.131318255366395, -39.131318255366395, -39.131318255366395, -40.603132794381466, -40.603132794381466, -40.603132794381466, -36.38272720543634, -36.38272720543634, -36.38272720543634, -45.49426910980029, -45.49426910980029, -45.49426910980029, -40.07908887330283, -40.07908887330283, -40.07908887330283, -29.2136287669483, -29.2136287669483, -29.2136287669483, -43.32635325504961, -43.32635325504961, -43.32635325504961, -49.339068045822714, -49.339068045822714, -49.339068045822714, -35.467813048802725, -35.467813048802725, -35.467813048802725, -33.32610862332031, -33.32610862332031, -33.32610862332031, -29.579003081337117, -29.579003081337117, -29.579003081337117, -30.51606295273567, -30.51606295273567, -30.51606295273567, -34.93203279783028, -34.93203279783028, -34.93203279783028, -30.901290192855754, -30.901290192855754, -30.901290192855754, -50.69265501604825, -50.69265501604825, -50.69265501604825, -25.14704818320804, -25.14704818320804, -25.14704818320804, -35.69490300322326, -35.69490300322326, -35.69490300322326, -27.34664340423833, -27.34664340423833, -27.34664340423833, -52.599676930077926, -52.599676930077926, -52.599676930077926, -45.54462032433274, -45.54462032433274, -45.54462032433274, -42.274880039199104, -42.274880039199104, -42.274880039199104, -34.59278016620565, -34.59278016620565, -34.59278016620565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29384366001589646, "mean_inference_ms": 1.084521665832373, "mean_action_processing_ms": 0.06707270137221476, "mean_env_wait_ms": 0.5767357099827298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"sample_time_ms": 8881.406, "sample_throughput": 360.303, "load_time_ms": 0.257, "load_throughput": 12454475.224, "learn_time_ms": 3481.126, "learn_throughput": 919.243, "update_time_ms": 1.944}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 438.7015899658203, "policy_loss": -0.003292179420765251, "vf_loss": 438.72060241699216, "vf_explained_var": -0.011475837230682373, "kl": 0.002412727099697231, "entropy": 1.5848856449127198, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 28800, "num_steps_trained": 9600, "num_agent_steps_trained": 28800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 384, "training_iteration": 3, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-05-42", "timestamp": 1701842742, "time_this_iter_s": 9.918716430664062, "time_total_s": 30.015076160430908, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa80d9f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 30.015076160430908, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.47142857142857, "ram_util_percent": 29.292857142857144}}
{"episode_reward_max": -60.33389976718815, "episode_reward_min": -157.69681094589808, "episode_reward_mean": -104.61253217651803, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -52.565603648632674}, "policy_reward_max": {"shared_policy": -20.11129992239606}, "policy_reward_mean": {"shared_policy": -34.87084405883934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.20994230318524, -93.48303662845967, -122.28064268920122, -66.70967739894714, -90.12425235105671, -101.89109561847826, -114.20537308277726, -107.31551823732201, -88.7840930113917, -117.72024478082957, -111.49127865124463, -118.12947583457338, -94.27185846425408, -93.3383219456213, -96.91256789206396, -109.11320165527606, -157.69681094589808, -104.32751281282404, -87.88420365713523, -103.03127361844705, -126.41477112185262, -121.74875043961046, -141.52155351575993, -120.61691412834018, -97.37490818029764, -118.62447090031273, -109.63972360005083, -111.75956451154761, -73.72078494302228, -102.34289999618191, -76.2295180653351, -112.9933753783624, -87.72852907001517, -102.26952219524452, -74.92385092952537, -122.8455254958317, -107.65772335821914, -132.94910347636926, -95.37700545384317, -119.33680815043904, -110.0878576496761, -87.63960430208269, -60.33389976718815, -117.25304236541649, -94.71807056617824, -111.47517261018385, -107.99068730567241, -88.73042463467368, -91.58352482318708, -136.00193640490093, -84.87930813014542, -122.81691943982669, -105.17970919590816, -100.73516710149667, -86.60459288350545, -101.38917013158418, -80.26905145243633, -82.71778910299794, -108.70570092445024, -74.8430847031807, -129.74360706871713, -98.65315075646313, -148.4821650948832, -82.52180063139785, -83.83199681196903, -81.13517219165911, -101.88203214496319, -122.91974189927899, -102.63142032280741, -87.78594856327399, -85.64825953406762, -135.5042586106925, -108.99518891086753, -132.08313071156238, -90.00959292678992, -94.14012079970384, -73.3788542797391, -86.0992826963533, -84.39966624383946, -108.97789057436873, -99.36883351709284, -101.54806586424951, -106.17806622571857, -91.1878241151875, -99.2347673458062, -151.7112351820769, -126.5014596803339, -155.26537263276495, -113.78224172650988, -123.21193274913138, -86.04696822410665, -102.13490542973254, -112.44069632405167, -103.80179880293062, -123.30961576424795, -76.64891384820376, -94.33170976704433, -131.27114150781662, -122.36649161478152, -145.31436070259667, -120.9094370628255, -92.77140700841571, -114.4357380228655, -100.09118929364283, -95.25348732320757, -100.36087890478586, -100.9434144900764, -101.19889358601637, -118.30288530628488, -125.7154347008209, -87.52401091408757, -89.76973400579458, -144.27579452343062, -76.49776719454093, -109.8401756606997, -81.51535342292289, -94.8912751630345, -85.87567841187763, -105.66294555677852, -104.36138043923918, -107.35630491003815, -111.96844693619778, -108.92376389483024, -90.06359654736765, -85.74163146086786, -104.47967378060513, -99.2343359668135, -133.0094043246184], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-35.40331410106173, -35.40331410106173, -35.40331410106173, -31.161012209486568, -31.161012209486568, -31.161012209486568, -40.76021422973373, -40.76021422973373, -40.76021422973373, -22.236559132982386, -22.236559132982386, -22.236559132982386, -30.041417450352238, -30.041417450352238, -30.041417450352238, -33.963698539492746, -33.963698539492746, -33.963698539492746, -38.068457694259074, -38.068457694259074, -38.068457694259074, -35.771839412440684, -35.771839412440684, -35.771839412440684, -29.594697670463876, -29.594697670463876, -29.594697670463876, -39.24008159360983, -39.24008159360983, -39.24008159360983, -37.16375955041487, -37.16375955041487, -37.16375955041487, -39.37649194485778, -39.37649194485778, -39.37649194485778, -31.423952821418048, -31.423952821418048, -31.423952821418048, -31.11277398187377, -31.11277398187377, -31.11277398187377, -32.30418929735464, -32.30418929735464, -32.30418929735464, -36.37106721842537, -36.37106721842537, -36.37106721842537, -52.565603648632674, -52.565603648632674, -52.565603648632674, -34.77583760427467, -34.77583760427467, -34.77583760427467, -29.29473455237842, -29.29473455237842, -29.29473455237842, -34.34375787281569, -34.34375787281569, -34.34375787281569, -42.13825704061754, -42.13825704061754, -42.13825704061754, -40.5829168132035, -40.5829168132035, -40.5829168132035, -47.17385117191999, -47.17385117191999, -47.17385117191999, -40.20563804278005, -40.20563804278005, -40.20563804278005, -32.45830272676585, -32.45830272676585, -32.45830272676585, -39.54149030010426, -39.54149030010426, -39.54149030010426, -36.54657453335026, -36.54657453335026, -36.54657453335026, -37.25318817051586, -37.25318817051586, -37.25318817051586, -24.57359498100741, -24.57359498100741, -24.57359498100741, -34.114299998727326, -34.114299998727326, -34.114299998727326, -25.409839355111703, -25.409839355111703, -25.409839355111703, -37.664458459454096, -37.664458459454096, -37.664458459454096, -29.242843023338384, -29.242843023338384, -29.242843023338384, -34.089840731748176, -34.089840731748176, -34.089840731748176, -24.974616976508443, -24.974616976508443, -24.974616976508443, -40.94850849861055, -40.94850849861055, -40.94850849861055, -35.88590778607304, -35.88590778607304, -35.88590778607304, -44.31636782545644, -44.31636782545644, -44.31636782545644, -31.792335151281044, -31.792335151281044, -31.792335151281044, -39.77893605014633, -39.77893605014633, -39.77893605014633, -36.695952549892034, -36.695952549892034, -36.695952549892034, -29.21320143402754, -29.21320143402754, -29.21320143402754, -20.11129992239606, -20.11129992239606, -20.11129992239606, -39.08434745513887, -39.08434745513887, -39.08434745513887, -31.57269018872609, -31.57269018872609, -31.57269018872609, -37.158390870061254, -37.158390870061254, -37.158390870061254, -35.996895768557465, -35.996895768557465, -35.996895768557465, -29.576808211557893, -29.576808211557893, -29.576808211557893, -30.52784160772902, -30.52784160772902, -30.52784160772902, -45.33397880163365, -45.33397880163365, -45.33397880163365, -28.29310271004848, -28.29310271004848, -28.29310271004848, -40.938973146608866, -40.938973146608866, -40.938973146608866, -35.05990306530273, -35.05990306530273, -35.05990306530273, -33.57838903383223, -33.57838903383223, -33.57838903383223, -28.868197627835137, -28.868197627835137, -28.868197627835137, -33.796390043861365, -33.796390043861365, -33.796390043861365, -26.756350484145443, -26.756350484145443, -26.756350484145443, -27.572596367665987, -27.572596367665987, -27.572596367665987, -36.23523364148343, -36.23523364148343, -36.23523364148343, -24.94769490106024, -24.94769490106024, -24.94769490106024, -43.24786902290569, -43.24786902290569, -43.24786902290569, -32.88438358548771, -32.88438358548771, -32.88438358548771, -49.49405503162776, -49.49405503162776, -49.49405503162776, -27.50726687713262, -27.50726687713262, -27.50726687713262, -27.943998937323006, -27.943998937323006, -27.943998937323006, -27.045057397219722, -27.045057397219722, -27.045057397219722, -33.9606773816544, -33.9606773816544, -33.9606773816544, -40.973247299759656, -40.973247299759656, -40.973247299759656, -34.21047344093583, -34.21047344093583, -34.21047344093583, -29.261982854424648, -29.261982854424648, -29.261982854424648, -28.549419844689208, -28.549419844689208, -28.549419844689208, -45.168086203564165, -45.168086203564165, -45.168086203564165, -36.331729636955856, -36.331729636955856, -36.331729636955856, -44.02771023718746, -44.02771023718746, -44.02771023718746, -30.003197642263338, -30.003197642263338, -30.003197642263338, -31.380040266567956, -31.380040266567956, -31.380040266567956, -24.459618093246355, -24.459618093246355, -24.459618093246355, -28.699760898784437, -28.699760898784437, -28.699760898784437, -28.13322208127982, -28.13322208127982, -28.13322208127982, -36.32596352478957, -36.32596352478957, -36.32596352478957, -33.122944505697625, -33.122944505697625, -33.122944505697625, -33.84935528808314, -33.84935528808314, -33.84935528808314, -35.39268874190618, -35.39268874190618, -35.39268874190618, -30.395941371729158, -30.395941371729158, -30.395941371729158, -33.07825578193538, -33.07825578193538, -33.07825578193538, -50.57041172735896, -50.57041172735896, -50.57041172735896, -42.167153226777934, -42.167153226777934, -42.167153226777934, -51.75512421092162, -51.75512421092162, -51.75512421092162, -37.92741390883664, -37.92741390883664, -37.92741390883664, -41.07064424971043, -41.07064424971043, -41.07064424971043, -28.682322741368885, -28.682322741368885, -28.682322741368885, -34.04496847657752, -34.04496847657752, -34.04496847657752, -37.480232108017205, -37.480232108017205, -37.480232108017205, -34.600599600976864, -34.600599600976864, -34.600599600976864, -41.10320525474935, -41.10320525474935, -41.10320525474935, -25.54963794940126, -25.54963794940126, -25.54963794940126, -31.443903255681445, -31.443903255681445, -31.443903255681445, -43.75704716927222, -43.75704716927222, -43.75704716927222, -40.78883053826051, -40.78883053826051, -40.78883053826051, -48.43812023419888, -48.43812023419888, -48.43812023419888, -40.30314568760851, -40.30314568760851, -40.30314568760851, -30.923802336138575, -30.923802336138575, -30.923802336138575, -38.145246007621814, -38.145246007621814, -38.145246007621814, -33.36372976454762, -33.36372976454762, -33.36372976454762, -31.7511624410692, -31.7511624410692, -31.7511624410692, -33.45362630159527, -33.45362630159527, -33.45362630159527, -33.647804830025464, -33.647804830025464, -33.647804830025464, -33.732964528672134, -33.732964528672134, -33.732964528672134, -39.434295102094964, -39.434295102094964, -39.434295102094964, -41.90514490027367, -41.90514490027367, -41.90514490027367, -29.17467030469588, -29.17467030469588, -29.17467030469588, -29.923244668598187, -29.923244668598187, -29.923244668598187, -48.091931507810216, -48.091931507810216, -48.091931507810216, -25.499255731513635, -25.499255731513635, -25.499255731513635, -36.6133918868999, -36.6133918868999, -36.6133918868999, -27.171784474307636, -27.171784474307636, -27.171784474307636, -31.630425054344837, -31.630425054344837, -31.630425054344837, -28.62522613729253, -28.62522613729253, -28.62522613729253, -35.22098185225951, -35.22098185225951, -35.22098185225951, -34.78712681307972, -34.78712681307972, -34.78712681307972, -35.7854349700127, -35.7854349700127, -35.7854349700127, -37.32281564539927, -37.32281564539927, -37.32281564539927, -36.30792129827675, -36.30792129827675, -36.30792129827675, -30.02119884912257, -30.02119884912257, -30.02119884912257, -28.580543820289286, -28.580543820289286, -28.580543820289286, -34.826557926868354, -34.826557926868354, -34.826557926868354, -33.078111988937806, -33.078111988937806, -33.078111988937806, -44.33646810820613, -44.33646810820613, -44.33646810820613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2938458979311385, "mean_inference_ms": 1.0853286795612056, "mean_action_processing_ms": 0.06697014173244407, "mean_env_wait_ms": 0.5772655042444634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12800, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"sample_time_ms": 9163.195, "sample_throughput": 349.223, "load_time_ms": 0.237, "load_throughput": 13496000.804, "learn_time_ms": 3473.933, "learn_throughput": 921.146, "update_time_ms": 1.941}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 368.06333923339844, "policy_loss": -0.0038433276580956744, "vf_loss": 368.0827667236328, "vf_explained_var": -0.027041029930114747, "kl": 0.005642336701311878, "entropy": 1.573970913887024, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12800, "num_agent_steps_sampled": 38400, "num_steps_trained": 12800, "num_agent_steps_trained": 38400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 512, "training_iteration": 4, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-05-52", "timestamp": 1701842752, "time_this_iter_s": 9.992066860198975, "time_total_s": 40.00714302062988, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa8345a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 40.00714302062988, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.84666666666666, "ram_util_percent": 29.27333333333333}}
{"episode_reward_max": -68.30459447900958, "episode_reward_min": -150.72569322603556, "episode_reward_mean": -106.86204889207632, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -50.24189774201185}, "policy_reward_max": {"shared_policy": -22.768198159669854}, "policy_reward_mean": {"shared_policy": -35.62068296402544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.01293220112024, -108.92868948368094, -79.00602863481723, -117.52487260889067, -92.87174734099302, -138.2812462400924, -109.32556262116098, -87.71418256247227, -150.72569322603556, -111.39131951983548, -104.6003667715385, -95.68679660532072, -117.9091566889587, -126.28255593109994, -105.90657265151488, -97.04198214956229, -118.17320540946544, -112.58449447445831, -85.07547985498293, -118.9064784916734, -103.31183577703354, -94.68480008823852, -88.14816626691685, -84.94313531174313, -82.35378028550709, -97.133857126235, -120.77009605939826, -111.10580515046172, -101.51455621366624, -86.51028810740202, -125.68427810832368, -95.05861371900414, -94.02608289836259, -135.60894028969992, -133.38983146554907, -92.99890301365119, -109.27445982021923, -101.74421261992228, -105.29142057180142, -87.50616629850948, -126.72103451929252, -96.39659638752876, -118.21270022670143, -87.6021378124487, -147.81104020599392, -139.4562121621233, -83.14371962703957, -106.07722952186471, -125.71347563935129, -149.12027570494612, -85.04450172262443, -119.83427280313076, -119.31497988104998, -100.25357241567833, -112.79202029991235, -98.97458757013686, -138.5187522868478, -134.82268456133153, -147.1360550185008, -109.9408785849564, -126.6002484489702, -90.56733672187703, -103.28923966865497, -124.94112075996512, -92.94979387197257, -127.14756216299001, -118.71911294062585, -104.02557335064469, -135.29110407512604, -125.70550975339623, -92.19857772095507, -82.5144767841545, -94.25582386551874, -120.76647294616994, -102.90280599658587, -146.549678913831, -86.19368103430928, -101.12662201112481, -86.06465671431071, -119.4385372000433, -113.07173123897871, -90.92813039700212, -87.37378778869791, -92.0292297261173, -131.28111337799876, -92.06927468979026, -107.43642154711401, -88.03972995150215, -121.69239471037287, -101.85363026010296, -100.83352715225504, -75.87498579614805, -102.95308680367907, -104.40672228101072, -92.94333509147391, -72.28818859529224, -97.52701123277669, -68.30459447900958, -129.75206879467385, -92.95315855568616, -86.44159054090024, -121.15383779565288, -110.15835460855533, -72.87698160056726, -123.5545286291636, -113.95624693380263, -94.45497181913775, -107.09805742693626, -86.0469738257788, -101.58999144202689, -108.62928417711476, -139.68094480490754, -107.13935956329401, -111.59604993136925, -126.75527516850386, -120.84882753514408, -83.8381288456621, -125.87378582142092, -93.2987115561919, -100.4746543984631, -78.9094206178821, -97.74329705856557, -97.75919658184671, -140.14432770137256, -84.18414669589501, -99.90575210212137, -121.9494989321666, -98.52468504963866], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-34.33764406704006, -34.33764406704006, -34.33764406704006, -36.30956316122698, -36.30956316122698, -36.30956316122698, -26.335342878272424, -26.335342878272424, -26.335342878272424, -39.17495753629692, -39.17495753629692, -39.17495753629692, -30.957249113664346, -30.957249113664346, -30.957249113664346, -46.09374874669747, -46.09374874669747, -46.09374874669747, -36.441854207053666, -36.441854207053666, -36.441854207053666, -29.23806085415743, -29.23806085415743, -29.23806085415743, -50.24189774201185, -50.24189774201185, -50.24189774201185, -37.13043983994515, -37.13043983994515, -37.13043983994515, -34.86678892384617, -34.86678892384617, -34.86678892384617, -31.89559886844022, -31.89559886844022, -31.89559886844022, -39.30305222965291, -39.30305222965291, -39.30305222965291, -42.09418531036664, -42.09418531036664, -42.09418531036664, -35.302190883838286, -35.302190883838286, -35.302190883838286, -32.34732738318743, -32.34732738318743, -32.34732738318743, -39.39106846982182, -39.39106846982182, -39.39106846982182, -37.52816482481942, -37.52816482481942, -37.52816482481942, -28.35849328499433, -28.35849328499433, -28.35849328499433, -39.63549283055776, -39.63549283055776, -39.63549283055776, -34.43727859234451, -34.43727859234451, -34.43727859234451, -31.561600029412865, -31.561600029412865, -31.561600029412865, -29.3827220889723, -29.3827220889723, -29.3827220889723, -28.314378437247687, -28.314378437247687, -28.314378437247687, -27.45126009516902, -27.45126009516902, -27.45126009516902, -32.37795237541163, -32.37795237541163, -32.37795237541163, -40.25669868646611, -40.25669868646611, -40.25669868646611, -37.035268383487235, -37.035268383487235, -37.035268383487235, -33.838185404555425, -33.838185404555425, -33.838185404555425, -28.836762702467343, -28.836762702467343, -28.836762702467343, -41.89475936944122, -41.89475936944122, -41.89475936944122, -31.686204573001362, -31.686204573001362, -31.686204573001362, -31.342027632787513, -31.342027632787513, -31.342027632787513, -45.202980096566634, -45.202980096566634, -45.202980096566634, -44.463277155183015, -44.463277155183015, -44.463277155183015, -30.999634337883723, -30.999634337883723, -30.999634337883723, -36.42481994007311, -36.42481994007311, -36.42481994007311, -33.91473753997409, -33.91473753997409, -33.91473753997409, -35.09714019060047, -35.09714019060047, -35.09714019060047, -29.168722099503167, -29.168722099503167, -29.168722099503167, -42.24034483976417, -42.24034483976417, -42.24034483976417, -32.132198795842946, -32.132198795842946, -32.132198795842946, -39.404233408900495, -39.404233408900495, -39.404233408900495, -29.200712604149576, -29.200712604149576, -29.200712604149576, -49.27034673533131, -49.27034673533131, -49.27034673533131, -46.4854040540411, -46.4854040540411, -46.4854040540411, -27.71457320901317, -27.71457320901317, -27.71457320901317, -35.35907650728824, -35.35907650728824, -35.35907650728824, -41.904491879783755, -41.904491879783755, -41.904491879783755, -49.706758568315394, -49.706758568315394, -49.706758568315394, -28.34816724087479, -28.34816724087479, -28.34816724087479, -39.94475760104357, -39.94475760104357, -39.94475760104357, -39.77165996034997, -39.77165996034997, -39.77165996034997, -33.417857471892795, -33.417857471892795, -33.417857471892795, -37.59734009997079, -37.59734009997079, -37.59734009997079, -32.991529190045625, -32.991529190045625, -32.991529190045625, -46.172917428949276, -46.172917428949276, -46.172917428949276, -44.940894853777166, -44.940894853777166, -44.940894853777166, -49.0453516728336, -49.0453516728336, -49.0453516728336, -36.646959528318796, -36.646959528318796, -36.646959528318796, -42.2000828163234, -42.2000828163234, -42.2000828163234, -30.189112240625704, -30.189112240625704, -30.189112240625704, -34.42974655621834, -34.42974655621834, -34.42974655621834, -41.6470402533217, -41.6470402533217, -41.6470402533217, -30.983264623990845, -30.983264623990845, -30.983264623990845, -42.38252072099667, -42.38252072099667, -42.38252072099667, -39.5730376468753, -39.5730376468753, -39.5730376468753, -34.675191116881564, -34.675191116881564, -34.675191116881564, -45.09703469170872, -45.09703469170872, -45.09703469170872, -41.901836584465414, -41.901836584465414, -41.901836584465414, -30.73285924031835, -30.73285924031835, -30.73285924031835, -27.50482559471817, -27.50482559471817, -27.50482559471817, -31.4186079551729, -31.4186079551729, -31.4186079551729, -40.25549098205664, -40.25549098205664, -40.25549098205664, -34.30093533219527, -34.30093533219527, -34.30093533219527, -48.84989297127703, -48.84989297127703, -48.84989297127703, -28.731227011436427, -28.731227011436427, -28.731227011436427, -33.70887400370828, -33.70887400370828, -33.70887400370828, -28.688218904770245, -28.688218904770245, -28.688218904770245, -39.81284573334777, -39.81284573334777, -39.81284573334777, -37.69057707965957, -37.69057707965957, -37.69057707965957, -30.3093767990007, -30.3093767990007, -30.3093767990007, -29.124595929565967, -29.124595929565967, -29.124595929565967, -30.676409908705747, -30.676409908705747, -30.676409908705747, -43.760371125999555, -43.760371125999555, -43.760371125999555, -30.6897582299301, -30.6897582299301, -30.6897582299301, -35.812140515704655, -35.812140515704655, -35.812140515704655, -29.346576650500722, -29.346576650500722, -29.346576650500722, -40.564131570124275, -40.564131570124275, -40.564131570124275, -33.951210086700996, -33.951210086700996, -33.951210086700996, -33.61117571741836, -33.61117571741836, -33.61117571741836, -25.291661932049337, -25.291661932049337, -25.291661932049337, -34.31769560122635, -34.31769560122635, -34.31769560122635, -34.80224076033689, -34.80224076033689, -34.80224076033689, -30.98111169715794, -30.98111169715794, -30.98111169715794, -24.096062865097426, -24.096062865097426, -24.096062865097426, -32.50900374425889, -32.50900374425889, -32.50900374425889, -22.768198159669854, -22.768198159669854, -22.768198159669854, -43.25068959822461, -43.25068959822461, -43.25068959822461, -30.984386185228722, -30.984386185228722, -30.984386185228722, -28.81386351363343, -28.81386351363343, -28.81386351363343, -40.38461259855094, -40.38461259855094, -40.38461259855094, -36.71945153618511, -36.71945153618511, -36.71945153618511, -24.29232720018909, -24.29232720018909, -24.29232720018909, -41.18484287638785, -41.18484287638785, -41.18484287638785, -37.98541564460087, -37.98541564460087, -37.98541564460087, -31.48499060637926, -31.48499060637926, -31.48499060637926, -35.69935247564544, -35.69935247564544, -35.69935247564544, -28.682324608592946, -28.682324608592946, -28.682324608592946, -33.86333048067566, -33.86333048067566, -33.86333048067566, -36.20976139237156, -36.20976139237156, -36.20976139237156, -46.56031493496915, -46.56031493496915, -46.56031493496915, -35.71311985443135, -35.71311985443135, -35.71311985443135, -37.198683310456396, -37.198683310456396, -37.198683310456396, -42.251758389501326, -42.251758389501326, -42.251758389501326, -40.282942511714694, -40.282942511714694, -40.282942511714694, -27.94604294855406, -27.94604294855406, -27.94604294855406, -41.95792860714028, -41.95792860714028, -41.95792860714028, -31.09957051873063, -31.09957051873063, -31.09957051873063, -33.49155146615438, -33.49155146615438, -33.49155146615438, -26.30314020596071, -26.30314020596071, -26.30314020596071, -32.58109901952187, -32.58109901952187, -32.58109901952187, -32.58639886061555, -32.58639886061555, -32.58639886061555, -46.714775900457546, -46.714775900457546, -46.714775900457546, -28.061382231965013, -28.061382231965013, -28.061382231965013, -33.30191736737378, -33.30191736737378, -33.30191736737378, -40.649832977388876, -40.649832977388876, -40.649832977388876, -32.841561683212866, -32.841561683212866, -32.841561683212866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29365131761288543, "mean_inference_ms": 1.0848815989013045, "mean_action_processing_ms": 0.0669450493471584, "mean_env_wait_ms": 0.5771566812608117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 9328.273, "sample_throughput": 343.043, "load_time_ms": 0.226, "load_throughput": 14137110.596, "learn_time_ms": 3462.379, "learn_throughput": 924.22, "update_time_ms": 1.989}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 378.5350830078125, "policy_loss": -0.002857055496152938, "vf_loss": 378.55339965820315, "vf_explained_var": -0.028793156147003174, "kl": 0.0033413066075436313, "entropy": 1.5542283535003663, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 48000, "num_steps_trained": 16000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 5, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-06-02", "timestamp": 1701842762, "time_this_iter_s": 9.929399013519287, "time_total_s": 49.93654203414917, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa8054040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 49.93654203414917, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.871428571428574, "ram_util_percent": 29.335714285714285}}
{"episode_reward_max": -72.86762697341439, "episode_reward_min": -159.75215415838124, "episode_reward_mean": -105.66519893373868, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -53.25071805279379}, "policy_reward_max": {"shared_policy": -24.28920899113811}, "policy_reward_mean": {"shared_policy": -35.2217329779129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.3609909561062, -102.81292017409953, -111.9835759670753, -113.53398753214542, -105.68389474193383, -92.55064927545565, -99.65734172656978, -92.51907524343385, -83.90580291072303, -127.1012927110725, -89.66318769067205, -128.47452016596492, -89.03244964703697, -119.00470029807173, -107.62049125838978, -109.5746933334036, -144.33779042390103, -142.28384407322517, -112.33318276079657, -126.92983594992046, -101.63543542526659, -96.92754395542887, -103.04845986598903, -84.59583313992371, -81.76994905732445, -86.8857073396055, -103.08105174110106, -88.04121978896626, -120.82333282478866, -100.82795097882047, -99.6244959648909, -96.10300176466681, -159.75215415838124, -121.22847855962965, -94.44732201073514, -91.08715371376948, -110.6094513460435, -111.94478214967917, -82.85962095338239, -96.6584410623455, -146.61085052543308, -84.01990929597453, -107.11383377188861, -123.4165310614304, -92.66940924487069, -83.75468264686363, -102.14132779851305, -107.16413378905605, -127.25850025425308, -108.07214868722234, -95.05977937916168, -96.58699839956344, -86.53294970553311, -104.49664881790152, -132.54211814737124, -90.7525358760221, -115.6136077209789, -114.77241733363287, -133.72796481835005, -110.72780564315607, -87.74941523890678, -109.83344007002114, -106.42111501741542, -86.66455832724698, -89.5049685921967, -102.07301839230213, -96.96572130010982, -120.99522646852371, -88.2478837974981, -83.58705402872624, -98.66683069996265, -144.5980578434074, -128.12403995024601, -102.76452671287224, -87.60713241555331, -123.37753815307431, -147.1978391887411, -114.91200728356151, -101.42953869361264, -131.52287536861286, -99.56952860547409, -125.27036657966477, -116.89879294702095, -110.27405762107212, -97.54221059538402, -140.0872624428695, -120.29085008703767, -98.10719045853847, -83.39919278863981, -92.05834643720915, -91.99799144781292, -103.34647316532828, -72.86762697341439, -103.5080977740746, -83.85788681349104, -108.33241011361321, -124.40189511403729, -84.19574180108931, -91.00042030836238, -123.59568484740814, -90.4649840480579, -79.64894005085395, -102.12018867747696, -80.32863778945703, -93.40078429171871, -104.47226599361339, -111.87470742477926, -127.83244671605122, -127.90091414867288, -86.7162849694129, -113.68666630797543, -83.26764270014029, -101.79599966710339, -91.3793939416096, -106.73858217836992, -102.19509091990457, -89.22209663697042, -93.73813068709133, -95.84423807946847, -126.10750412553907, -102.48079931827782, -118.07893956981705, -146.41037104052123, -104.62576513218318, -102.42878157295225, -108.61891819070912, -95.09936868313746, -119.4724406346425], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-34.12033031870207, -34.12033031870207, -34.12033031870207, -34.270973391366496, -34.270973391366496, -34.270973391366496, -37.32785865569174, -37.32785865569174, -37.32785865569174, -37.844662510715125, -37.844662510715125, -37.844662510715125, -35.22796491397795, -35.22796491397795, -35.22796491397795, -30.850216425151874, -30.850216425151874, -30.850216425151874, -33.21911390885659, -33.21911390885659, -33.21911390885659, -30.83969174781129, -30.83969174781129, -30.83969174781129, -27.968600970241017, -27.968600970241017, -27.968600970241017, -42.367097570357494, -42.367097570357494, -42.367097570357494, -29.887729230224018, -29.887729230224018, -29.887729230224018, -42.8248400553216, -42.8248400553216, -42.8248400553216, -29.677483215679, -29.677483215679, -29.677483215679, -39.66823343269058, -39.66823343269058, -39.66823343269058, -35.873497086129944, -35.873497086129944, -35.873497086129944, -36.52489777780124, -36.52489777780124, -36.52489777780124, -48.11259680796697, -48.11259680796697, -48.11259680796697, -47.4279480244084, -47.4279480244084, -47.4279480244084, -37.444394253598865, -37.444394253598865, -37.444394253598865, -42.30994531664013, -42.30994531664013, -42.30994531664013, -33.878478475088855, -33.878478475088855, -33.878478475088855, -32.3091813184763, -32.3091813184763, -32.3091813184763, -34.34948662199634, -34.34948662199634, -34.34948662199634, -28.198611046641265, -28.198611046641265, -28.198611046641265, -27.256649685774843, -27.256649685774843, -27.256649685774843, -28.961902446535163, -28.961902446535163, -28.961902446535163, -34.36035058036703, -34.36035058036703, -34.36035058036703, -29.347073262988754, -29.347073262988754, -29.347073262988754, -40.27444427492954, -40.27444427492954, -40.27444427492954, -33.609316992940144, -33.609316992940144, -33.609316992940144, -33.20816532163032, -33.20816532163032, -33.20816532163032, -32.034333921555614, -32.034333921555614, -32.034333921555614, -53.25071805279379, -53.25071805279379, -53.25071805279379, -40.40949285320992, -40.40949285320992, -40.40949285320992, -31.482440670245058, -31.482440670245058, -31.482440670245058, -30.36238457125649, -30.36238457125649, -30.36238457125649, -36.86981711534782, -36.86981711534782, -36.86981711534782, -37.3149273832264, -37.3149273832264, -37.3149273832264, -27.619873651127467, -27.619873651127467, -27.619873651127467, -32.21948035411517, -32.21948035411517, -32.21948035411517, -48.87028350847766, -48.87028350847766, -48.87028350847766, -28.006636431991506, -28.006636431991506, -28.006636431991506, -35.70461125729623, -35.70461125729623, -35.70461125729623, -41.13884368714345, -41.13884368714345, -41.13884368714345, -30.889803081623587, -30.889803081623587, -30.889803081623587, -27.918227548954523, -27.918227548954523, -27.918227548954523, -34.04710926617104, -34.04710926617104, -34.04710926617104, -35.721377929685346, -35.721377929685346, -35.721377929685346, -42.419500084751036, -42.419500084751036, -42.419500084751036, -36.02404956240743, -36.02404956240743, -36.02404956240743, -31.68659312638721, -31.68659312638721, -31.68659312638721, -32.195666133187814, -32.195666133187814, -32.195666133187814, -28.844316568511037, -28.844316568511037, -28.844316568511037, -34.832216272633836, -34.832216272633836, -34.832216272633836, -44.180706049123735, -44.180706049123735, -44.180706049123735, -30.25084529200734, -30.25084529200734, -30.25084529200734, -38.53786924032629, -38.53786924032629, -38.53786924032629, -38.25747244454428, -38.25747244454428, -38.25747244454428, -44.57598827278336, -44.57598827278336, -44.57598827278336, -36.9092685477187, -36.9092685477187, -36.9092685477187, -29.2498050796356, -29.2498050796356, -29.2498050796356, -36.61114669000705, -36.61114669000705, -36.61114669000705, -35.47370500580516, -35.47370500580516, -35.47370500580516, -28.888186109082323, -28.888186109082323, -28.888186109082323, -29.83498953073225, -29.83498953073225, -29.83498953073225, -34.02433946410072, -34.02433946410072, -34.02433946410072, -32.321907100036626, -32.321907100036626, -32.321907100036626, -40.331742156174535, -40.331742156174535, -40.331742156174535, -29.41596126583272, -29.41596126583272, -29.41596126583272, -27.862351342908735, -27.862351342908735, -27.862351342908735, -32.8889435666542, -32.8889435666542, -32.8889435666542, -48.19935261446911, -48.19935261446911, -48.19935261446911, -42.708013316748676, -42.708013316748676, -42.708013316748676, -34.25484223762408, -34.25484223762408, -34.25484223762408, -29.20237747185108, -29.20237747185108, -29.20237747185108, -41.12584605102478, -41.12584605102478, -41.12584605102478, -49.06594639624706, -49.06594639624706, -49.06594639624706, -38.304002427853824, -38.304002427853824, -38.304002427853824, -33.80984623120422, -33.80984623120422, -33.80984623120422, -43.840958456204305, -43.840958456204305, -43.840958456204305, -33.189842868491326, -33.189842868491326, -33.189842868491326, -41.756788859888275, -41.756788859888275, -41.756788859888275, -38.966264315673634, -38.966264315673634, -38.966264315673634, -36.75801920702404, -36.75801920702404, -36.75801920702404, -32.51407019846134, -32.51407019846134, -32.51407019846134, -46.6957541476232, -46.6957541476232, -46.6957541476232, -40.09695002901255, -40.09695002901255, -40.09695002901255, -32.70239681951282, -32.70239681951282, -32.70239681951282, -27.799730929546584, -27.799730929546584, -27.799730929546584, -30.686115479069727, -30.686115479069727, -30.686115479069727, -30.66599714927097, -30.66599714927097, -30.66599714927097, -34.448824388442745, -34.448824388442745, -34.448824388442745, -24.28920899113811, -24.28920899113811, -24.28920899113811, -34.502699258024855, -34.502699258024855, -34.502699258024855, -27.952628937830344, -27.952628937830344, -27.952628937830344, -36.11080337120437, -36.11080337120437, -36.11080337120437, -41.46729837134577, -41.46729837134577, -41.46729837134577, -28.065247267029772, -28.065247267029772, -28.065247267029772, -30.333473436120798, -30.333473436120798, -30.333473436120798, -41.19856161580273, -41.19856161580273, -41.19856161580273, -30.154994682685974, -30.154994682685974, -30.154994682685974, -26.549646683617976, -26.549646683617976, -26.549646683617976, -34.04006289249232, -34.04006289249232, -34.04006289249232, -26.77621259648567, -26.77621259648567, -26.77621259648567, -31.13359476390623, -31.13359476390623, -31.13359476390623, -34.824088664537825, -34.824088664537825, -34.824088664537825, -37.29156914159308, -37.29156914159308, -37.29156914159308, -42.61081557201707, -42.61081557201707, -42.61081557201707, -42.633638049557625, -42.633638049557625, -42.633638049557625, -28.905428323137606, -28.905428323137606, -28.905428323137606, -37.8955554359918, -37.8955554359918, -37.8955554359918, -27.75588090004679, -27.75588090004679, -27.75588090004679, -33.931999889034465, -33.931999889034465, -33.931999889034465, -30.459797980536543, -30.459797980536543, -30.459797980536543, -35.57952739279, -35.57952739279, -35.57952739279, -34.06503030663487, -34.06503030663487, -34.06503030663487, -29.740698878990155, -29.740698878990155, -29.740698878990155, -31.246043562363766, -31.246043562363766, -31.246043562363766, -31.948079359822827, -31.948079359822827, -31.948079359822827, -42.035834708513015, -42.035834708513015, -42.035834708513015, -34.16026643942591, -34.16026643942591, -34.16026643942591, -39.359646523272346, -39.359646523272346, -39.359646523272346, -48.80345701350705, -48.80345701350705, -48.80345701350705, -34.87525504406106, -34.87525504406106, -34.87525504406106, -34.14292719098408, -34.14292719098408, -34.14292719098408, -36.20630606356972, -36.20630606356972, -36.20630606356972, -31.69978956104584, -31.69978956104584, -31.69978956104584, -39.82414687821417, -39.82414687821417, -39.82414687821417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29387427372185193, "mean_inference_ms": 1.0850862018590566, "mean_action_processing_ms": 0.06682018110959595, "mean_env_wait_ms": 0.577390929645725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"sample_time_ms": 9435.721, "sample_throughput": 339.137, "load_time_ms": 0.239, "load_throughput": 13383851.886, "learn_time_ms": 3459.892, "learn_throughput": 924.884, "update_time_ms": 1.981}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 356.10887451171874, "policy_loss": -0.004247837136266775, "vf_loss": 356.128271484375, "vf_explained_var": -0.016402792930603028, "kl": 0.00499884178234915, "entropy": 1.522017812728882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 57600, "num_steps_trained": 19200, "num_agent_steps_trained": 57600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 768, "training_iteration": 6, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-06-12", "timestamp": 1701842772, "time_this_iter_s": 9.9817636013031, "time_total_s": 59.91830563545227, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa8065430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 59.91830563545227, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.61428571428571, "ram_util_percent": 29.464285714285715}}
{"episode_reward_max": -64.18157300012744, "episode_reward_min": -141.69046864634223, "episode_reward_mean": -101.7825386025954, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -47.230156215447444}, "policy_reward_max": {"shared_policy": -21.393857666709145}, "policy_reward_mean": {"shared_policy": -33.9275128675318}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.60490861337377, -116.68701213190192, -110.01546930184169, -122.29307091022339, -90.79997145742412, -97.09441807632764, -115.49697414114013, -122.30719334308183, -93.04391941383275, -133.02901189510135, -102.78316482790129, -105.8951978425238, -91.30548784627808, -112.42182147830943, -116.51046070543708, -101.99062998650902, -109.39065317994546, -87.88843357496943, -106.71580990361107, -111.9180882145414, -124.2341918816421, -136.25556101392135, -103.46845207066609, -102.61848203922318, -134.64316358306402, -85.8596998133212, -72.0111196047555, -86.91820585627106, -119.94319634398869, -101.47206502964995, -108.58600668587438, -73.08511241377134, -107.27976609799931, -77.4590904452895, -95.83135378170913, -87.45813753530682, -103.87039707880669, -101.41356003501113, -104.9999108146705, -116.93969817512229, -141.69046864634223, -78.03448609563915, -87.19745497683029, -134.1170510157037, -98.01571978527991, -104.29428235645342, -105.34577445450044, -133.17953859917998, -111.16095428725578, -110.57549350193501, -127.7914654516671, -87.60753808882158, -107.29311149847042, -64.18157300012744, -105.56826435068278, -89.68953398088787, -102.4768793707989, -115.41697126722272, -92.77755530108728, -91.40170637367147, -132.71812569279564, -99.42180935330393, -101.16744796914044, -89.48279288884194, -120.43220174045658, -98.17972759235762, -87.04881143850332, -113.62205371894973, -102.50274171446496, -96.3966283018131, -80.98136041140779, -94.08875442758404, -94.25600774504608, -107.95091515201614, -111.91962360898775, -129.5866440932277, -73.19386618692948, -98.37656157099042, -105.23872699062075, -91.1440682205631, -94.66565150207593, -80.7632673653301, -83.82019120956296, -84.96418912645875, -102.28342842077262, -131.53248043920036, -113.1351219980011, -93.0448186976051, -93.0633299273392, -85.7862016867783, -90.38009247846682, -100.97263269141622, -93.29605084823908, -111.84306159160775, -103.8929444124092, -115.66026780144277, -108.95313766689509, -82.2788187180743, -110.731459229061, -88.61346277054629, -83.88895830428537, -106.09952635049167, -97.45209744804433, -123.73414660177673, -119.98807181207692, -91.38871109600935, -85.37037717717538, -124.46569218890161, -112.34721126213968, -116.42802443641071, -83.71634542932316, -97.00846640071256, -99.50846562500983, -115.11883579321338, -83.98517860033134, -130.38495845717682, -83.7753053191977, -93.03984014729494, -91.23958857003501, -118.124882889278, -90.94776571142947, -85.53552052299894, -88.6062301341932, -82.91221185649161, -93.25120696284921, -73.87866250273025, -90.89280968403264, -86.33168290242207], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.868302871124584, -33.868302871124584, -33.868302871124584, -38.89567071063399, -38.89567071063399, -38.89567071063399, -36.671823100613885, -36.671823100613885, -36.671823100613885, -40.76435697007448, -40.76435697007448, -40.76435697007448, -30.266657152474743, -30.266657152474743, -30.266657152474743, -32.36480602544256, -32.36480602544256, -32.36480602544256, -38.498991380380005, -38.498991380380005, -38.498991380380005, -40.76906444769397, -40.76906444769397, -40.76906444769397, -31.014639804610926, -31.014639804610926, -31.014639804610926, -44.34300396503377, -44.34300396503377, -44.34300396503377, -34.26105494263379, -34.26105494263379, -34.26105494263379, -35.29839928084127, -35.29839928084127, -35.29839928084127, -30.43516261542604, -30.43516261542604, -30.43516261542604, -37.473940492769806, -37.473940492769806, -37.473940492769806, -38.83682023514569, -38.83682023514569, -38.83682023514569, -33.996876662169704, -33.996876662169704, -33.996876662169704, -36.46355105998183, -36.46355105998183, -36.46355105998183, -29.296144524989806, -29.296144524989806, -29.296144524989806, -35.57193663453704, -35.57193663453704, -35.57193663453704, -37.30602940484715, -37.30602940484715, -37.30602940484715, -41.41139729388073, -41.41139729388073, -41.41139729388073, -45.418520337973796, -45.418520337973796, -45.418520337973796, -34.48948402355536, -34.48948402355536, -34.48948402355536, -34.20616067974106, -34.20616067974106, -34.20616067974106, -44.88105452768797, -44.88105452768797, -44.88105452768797, -28.619899937773727, -28.619899937773727, -28.619899937773727, -24.003706534918503, -24.003706534918503, -24.003706534918503, -28.972735285423674, -28.972735285423674, -28.972735285423674, -39.981065447996244, -39.981065447996244, -39.981065447996244, -33.82402167654999, -33.82402167654999, -33.82402167654999, -36.19533556195815, -36.19533556195815, -36.19533556195815, -24.361704137923773, -24.361704137923773, -24.361704137923773, -35.75992203266644, -35.75992203266644, -35.75992203266644, -25.8196968150965, -25.8196968150965, -25.8196968150965, -31.94378459390305, -31.94378459390305, -31.94378459390305, -29.15271251176892, -29.15271251176892, -29.15271251176892, -34.623465692935575, -34.623465692935575, -34.623465692935575, -33.80452001167035, -33.80452001167035, -33.80452001167035, -34.999970271556826, -34.999970271556826, -34.999970271556826, -38.97989939170745, -38.97989939170745, -38.97989939170745, -47.230156215447444, -47.230156215447444, -47.230156215447444, -26.011495365213072, -26.011495365213072, -26.011495365213072, -29.065818325610095, -29.065818325610095, -29.065818325610095, -44.705683671901255, -44.705683671901255, -44.705683671901255, -32.67190659509331, -32.67190659509331, -32.67190659509331, -34.764760785484484, -34.764760785484484, -34.764760785484484, -35.11525815150016, -35.11525815150016, -35.11525815150016, -44.393179533060014, -44.393179533060014, -44.393179533060014, -37.053651429085235, -37.053651429085235, -37.053651429085235, -36.85849783397835, -36.85849783397835, -36.85849783397835, -42.59715515055569, -42.59715515055569, -42.59715515055569, -29.202512696273846, -29.202512696273846, -29.202512696273846, -35.764370499490106, -35.764370499490106, -35.764370499490106, -21.393857666709145, -21.393857666709145, -21.393857666709145, -35.189421450227606, -35.189421450227606, -35.189421450227606, -29.89651132696263, -29.89651132696263, -29.89651132696263, -34.158959790266294, -34.158959790266294, -34.158959790266294, -38.47232375574088, -38.47232375574088, -38.47232375574088, -30.925851767029066, -30.925851767029066, -30.925851767029066, -30.46723545789048, -30.46723545789048, -30.46723545789048, -44.23937523093189, -44.23937523093189, -44.23937523093189, -33.14060311776798, -33.14060311776798, -33.14060311776798, -33.722482656380144, -33.722482656380144, -33.722482656380144, -29.827597629613972, -29.827597629613972, -29.827597629613972, -40.14406724681884, -40.14406724681884, -40.14406724681884, -32.7265758641192, -32.7265758641192, -32.7265758641192, -29.01627047950109, -29.01627047950109, -29.01627047950109, -37.87401790631657, -37.87401790631657, -37.87401790631657, -34.167580571488315, -34.167580571488315, -34.167580571488315, -32.132209433937696, -32.132209433937696, -32.132209433937696, -26.99378680380261, -26.99378680380261, -26.99378680380261, -31.362918142528027, -31.362918142528027, -31.362918142528027, -31.41866924834872, -31.41866924834872, -31.41866924834872, -35.983638384005346, -35.983638384005346, -35.983638384005346, -37.306541202995895, -37.306541202995895, -37.306541202995895, -43.19554803107589, -43.19554803107589, -43.19554803107589, -24.39795539564315, -24.39795539564315, -24.39795539564315, -32.792187190330154, -32.792187190330154, -32.792187190330154, -35.07957566354027, -35.07957566354027, -35.07957566354027, -30.38135607352104, -30.38135607352104, -30.38135607352104, -31.555217167358638, -31.555217167358638, -31.555217167358638, -26.921089121776696, -26.921089121776696, -26.921089121776696, -27.940063736520983, -27.940063736520983, -27.940063736520983, -28.321396375486245, -28.321396375486245, -28.321396375486245, -34.09447614025754, -34.09447614025754, -34.09447614025754, -43.84416014640012, -43.84416014640012, -43.84416014640012, -37.71170733266702, -37.71170733266702, -37.71170733266702, -31.014939565868367, -31.014939565868367, -31.014939565868367, -31.02110997577973, -31.02110997577973, -31.02110997577973, -28.59540056225944, -28.59540056225944, -28.59540056225944, -30.12669749282228, -30.12669749282228, -30.12669749282228, -33.6575442304721, -33.6575442304721, -33.6575442304721, -31.098683616079697, -31.098683616079697, -31.098683616079697, -37.28102053053591, -37.28102053053591, -37.28102053053591, -34.630981470803036, -34.630981470803036, -34.630981470803036, -38.55342260048091, -38.55342260048091, -38.55342260048091, -36.31771255563167, -36.31771255563167, -36.31771255563167, -27.42627290602476, -27.42627290602476, -27.42627290602476, -36.91048640968698, -36.91048640968698, -36.91048640968698, -29.537820923515433, -29.537820923515433, -29.537820923515433, -27.962986101428484, -27.962986101428484, -27.962986101428484, -35.366508783497224, -35.366508783497224, -35.366508783497224, -32.48403248268145, -32.48403248268145, -32.48403248268145, -41.24471553392559, -41.24471553392559, -41.24471553392559, -39.996023937358956, -39.996023937358956, -39.996023937358956, -30.462903698669784, -30.462903698669784, -30.462903698669784, -28.456792392391787, -28.456792392391787, -28.456792392391787, -41.488564062967185, -41.488564062967185, -41.488564062967185, -37.449070420713234, -37.449070420713234, -37.449070420713234, -38.809341478803574, -38.809341478803574, -38.809341478803574, -27.905448476441045, -27.905448476441045, -27.905448476441045, -32.33615546690419, -32.33615546690419, -32.33615546690419, -33.16948854166994, -33.16948854166994, -33.16948854166994, -38.372945264404464, -38.372945264404464, -38.372945264404464, -27.995059533443776, -27.995059533443776, -27.995059533443776, -43.461652819058926, -43.461652819058926, -43.461652819058926, -27.9251017730659, -27.9251017730659, -27.9251017730659, -31.01328004909831, -31.01328004909831, -31.01328004909831, -30.413196190011647, -30.413196190011647, -30.413196190011647, -39.37496096309268, -39.37496096309268, -39.37496096309268, -30.315921903809816, -30.315921903809816, -30.315921903809816, -28.51184017433298, -28.51184017433298, -28.51184017433298, -29.535410044731073, -29.535410044731073, -29.535410044731073, -27.63740395216386, -27.63740395216386, -27.63740395216386, -31.083735654283075, -31.083735654283075, -31.083735654283075, -24.62622083424341, -24.62622083424341, -24.62622083424341, -30.297603228010846, -30.297603228010846, -30.297603228010846, -28.77722763414068, -28.77722763414068, -28.77722763414068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2935693379060683, "mean_inference_ms": 1.0848268962993102, "mean_action_processing_ms": 0.06676739834498137, "mean_env_wait_ms": 0.5776149599388567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 22400, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"sample_time_ms": 9514.698, "sample_throughput": 336.322, "load_time_ms": 0.231, "load_throughput": 13863421.809, "learn_time_ms": 3458.408, "learn_throughput": 925.281, "update_time_ms": 1.969}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 338.12733764648436, "policy_loss": -0.0022626463323881297, "vf_loss": 338.14455261230466, "vf_explained_var": -0.06472634077072144, "kl": 0.003112879768051302, "entropy": 1.498534095287323, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 22400, "num_agent_steps_sampled": 67200, "num_steps_trained": 22400, "num_agent_steps_trained": 67200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 896, "training_iteration": 7, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-06-22", "timestamp": 1701842782, "time_this_iter_s": 9.965857982635498, "time_total_s": 69.88416361808777, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa830a430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 69.88416361808777, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.707142857142856, "ram_util_percent": 29.300000000000004}}
{"episode_reward_max": -69.51790083765096, "episode_reward_min": -166.78469835913586, "episode_reward_mean": -102.4180209823938, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -55.59489945304528}, "policy_reward_max": {"shared_policy": -23.172633612550325}, "policy_reward_mean": {"shared_policy": -34.1393403274646}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.03583076547572, -82.47941299868276, -90.94852813074823, -114.9326880661211, -139.6562034021778, -90.3843107437833, -126.15930664240832, -109.3047456149909, -89.0423674465071, -104.1229157915788, -146.8092804717995, -90.43324321535013, -98.2222879666367, -114.27825652734744, -91.16970446853487, -87.51061530256037, -113.13301228643587, -108.90863082159461, -88.84646918183441, -106.56587517438967, -108.07843546029991, -96.09219353439819, -96.09576238146677, -117.79602021273465, -132.23098077967725, -92.23452411834755, -118.61869576259504, -91.68176592111337, -111.29155831997717, -71.07593065422624, -91.20670444121525, -84.19660724293888, -90.25257284718688, -95.28836747963047, -111.8442717189381, -121.02816350582196, -94.77225008587865, -94.34609488110044, -69.51790083765096, -86.35103081966123, -129.83179628627244, -90.45998056751569, -101.25729073314186, -80.8188596602381, -93.92167113239512, -122.574086800733, -115.895463280301, -139.7198620206992, -127.52557965229077, -102.46726610154145, -101.7936417482549, -96.31874412889444, -103.87053925090818, -117.67078437042048, -80.06284556499477, -94.16565049833042, -101.54934538687077, -160.22491805052306, -84.88440661187069, -118.06710564088861, -111.70972807863728, -101.63734577881449, -85.43879427600491, -90.68921153957872, -85.43258580775094, -81.34059724351405, -91.77356573010138, -95.91565910910768, -94.44540687070855, -96.65628242952646, -122.73416950428866, -84.88481176677871, -89.60611467003743, -81.70250454217867, -106.52009445450717, -85.40621256133517, -116.64251022229259, -89.67073021642209, -122.55691709317091, -105.72590060048046, -80.48208195060884, -153.80293703044092, -99.23786284744867, -107.18269081879657, -103.59356708732238, -80.53466460032602, -99.88161817176503, -99.5944989110806, -83.36762255039493, -86.91192985129925, -116.54867985482333, -100.63718538752643, -98.27473177948696, -92.28503446325573, -111.07267922990168, -103.68030482032567, -89.31126372535772, -106.75791419829474, -113.4901380878124, -109.85127800040439, -106.00826190363732, -92.22414404589256, -91.1351982876827, -98.7446276036092, -85.7883962041719, -127.67639181726722, -100.8371247207282, -106.8328139904835, -87.8225625248418, -98.04994874078403, -112.25575182775607, -93.50088207518165, -111.12109575486733, -75.49664333663293, -75.93445972872182, -114.16473931035473, -98.71573104446622, -91.24192121533038, -114.01945908531417, -127.16042708042126, -127.91429050090656, -115.7822037014768, -117.83078910150034, -78.31542926842954, -99.05617861610513, -90.85945549164731, -166.78469835913586, -93.22188103624973], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-34.67861025515856, -34.67861025515856, -34.67861025515856, -27.493137666227593, -27.493137666227593, -27.493137666227593, -30.316176043582733, -30.316176043582733, -30.316176043582733, -38.31089602204038, -38.31089602204038, -38.31089602204038, -46.55206780072593, -46.55206780072593, -46.55206780072593, -30.12810358126107, -30.12810358126107, -30.12810358126107, -42.0531022141361, -42.0531022141361, -42.0531022141361, -36.43491520499698, -36.43491520499698, -36.43491520499698, -29.680789148835714, -29.680789148835714, -29.680789148835714, -34.70763859719291, -34.70763859719291, -34.70763859719291, -48.93642682393319, -48.93642682393319, -48.93642682393319, -30.144414405116702, -30.144414405116702, -30.144414405116702, -32.74076265554556, -32.74076265554556, -32.74076265554556, -38.09275217578247, -38.09275217578247, -38.09275217578247, -30.389901489511633, -30.389901489511633, -30.389901489511633, -29.170205100853437, -29.170205100853437, -29.170205100853437, -37.71100409547862, -37.71100409547862, -37.71100409547862, -36.30287694053155, -36.30287694053155, -36.30287694053155, -29.61548972727811, -29.61548972727811, -29.61548972727811, -35.521958391463215, -35.521958391463215, -35.521958391463215, -36.02614515343329, -36.02614515343329, -36.02614515343329, -32.030731178132726, -32.030731178132726, -32.030731178132726, -32.031920793822266, -32.031920793822266, -32.031920793822266, -39.26534007091153, -39.26534007091153, -39.26534007091153, -44.07699359322574, -44.07699359322574, -44.07699359322574, -30.744841372782528, -30.744841372782528, -30.744841372782528, -39.539565254198344, -39.539565254198344, -39.539565254198344, -30.56058864037111, -30.56058864037111, -30.56058864037111, -37.09718610665908, -37.09718610665908, -37.09718610665908, -23.691976884742076, -23.691976884742076, -23.691976884742076, -30.402234813738424, -30.402234813738424, -30.402234813738424, -28.065535747646294, -28.065535747646294, -28.065535747646294, -30.084190949062293, -30.084190949062293, -30.084190949062293, -31.762789159876817, -31.762789159876817, -31.762789159876817, -37.28142390631273, -37.28142390631273, -37.28142390631273, -40.342721168607305, -40.342721168607305, -40.342721168607305, -31.590750028626218, -31.590750028626218, -31.590750028626218, -31.448698293700126, -31.448698293700126, -31.448698293700126, -23.172633612550325, -23.172633612550325, -23.172633612550325, -28.78367693988708, -28.78367693988708, -28.78367693988708, -43.277265428757445, -43.277265428757445, -43.277265428757445, -30.153326855838536, -30.153326855838536, -30.153326855838536, -33.75243024438063, -33.75243024438063, -33.75243024438063, -26.939619886746033, -26.939619886746033, -26.939619886746033, -31.30722371079837, -31.30722371079837, -31.30722371079837, -40.85802893357767, -40.85802893357767, -40.85802893357767, -38.63182109343366, -38.63182109343366, -38.63182109343366, -46.573287340233065, -46.573287340233065, -46.573287340233065, -42.50852655076353, -42.50852655076353, -42.50852655076353, -34.15575536718047, -34.15575536718047, -34.15575536718047, -33.931213916084985, -33.931213916084985, -33.931213916084985, -32.10624804296483, -32.10624804296483, -32.10624804296483, -34.623513083636055, -34.623513083636055, -34.623513083636055, -39.223594790140154, -39.223594790140154, -39.223594790140154, -26.68761518833158, -26.68761518833158, -26.68761518833158, -31.38855016611014, -31.38855016611014, -31.38855016611014, -33.84978179562359, -33.84978179562359, -33.84978179562359, -53.408306016841024, -53.408306016841024, -53.408306016841024, -28.2948022039569, -28.2948022039569, -28.2948022039569, -39.355701880296216, -39.355701880296216, -39.355701880296216, -37.236576026212425, -37.236576026212425, -37.236576026212425, -33.87911525960482, -33.87911525960482, -33.87911525960482, -28.47959809200164, -28.47959809200164, -28.47959809200164, -30.22973717985958, -30.22973717985958, -30.22973717985958, -28.477528602583632, -28.477528602583632, -28.477528602583632, -27.113532414504665, -27.113532414504665, -27.113532414504665, -30.59118857670044, -30.59118857670044, -30.59118857670044, -31.97188636970253, -31.97188636970253, -31.97188636970253, -31.48180229023619, -31.48180229023619, -31.48180229023619, -32.21876080984217, -32.21876080984217, -32.21876080984217, -40.91138983476287, -40.91138983476287, -40.91138983476287, -28.294937255592917, -28.294937255592917, -28.294937255592917, -29.868704890012484, -29.868704890012484, -29.868704890012484, -27.234168180726222, -27.234168180726222, -27.234168180726222, -35.50669815150238, -35.50669815150238, -35.50669815150238, -28.468737520445067, -28.468737520445067, -28.468737520445067, -38.88083674076421, -38.88083674076421, -38.88083674076421, -29.89024340547404, -29.89024340547404, -29.89024340547404, -40.85230569772365, -40.85230569772365, -40.85230569772365, -35.24196686682685, -35.24196686682685, -35.24196686682685, -26.82736065020294, -26.82736065020294, -26.82736065020294, -51.26764567681364, -51.26764567681364, -51.26764567681364, -33.07928761581621, -33.07928761581621, -33.07928761581621, -35.72756360626553, -35.72756360626553, -35.72756360626553, -34.53118902910743, -34.53118902910743, -34.53118902910743, -26.844888200108674, -26.844888200108674, -26.844888200108674, -33.29387272392168, -33.29387272392168, -33.29387272392168, -33.198166303693554, -33.198166303693554, -33.198166303693554, -27.789207516798292, -27.789207516798292, -27.789207516798292, -28.97064328376642, -28.97064328376642, -28.97064328376642, -38.8495599516078, -38.8495599516078, -38.8495599516078, -33.54572846250879, -33.54572846250879, -33.54572846250879, -32.758243926495666, -32.758243926495666, -32.758243926495666, -30.761678154418583, -30.761678154418583, -30.761678154418583, -37.02422640996723, -37.02422640996723, -37.02422640996723, -34.56010160677521, -34.56010160677521, -34.56010160677521, -29.770421241785908, -29.770421241785908, -29.770421241785908, -35.585971399431585, -35.585971399431585, -35.585971399431585, -37.83004602927079, -37.83004602927079, -37.83004602927079, -36.617092666801454, -36.617092666801454, -36.617092666801454, -35.33608730121246, -35.33608730121246, -35.33608730121246, -30.74138134863085, -30.74138134863085, -30.74138134863085, -30.37839942922756, -30.37839942922756, -30.37839942922756, -32.91487586786975, -32.91487586786975, -32.91487586786975, -28.59613206805729, -28.59613206805729, -28.59613206805729, -42.558797272422446, -42.558797272422446, -42.558797272422446, -33.6123749069094, -33.6123749069094, -33.6123749069094, -35.61093799682781, -35.61093799682781, -35.61093799682781, -29.274187508280615, -29.274187508280615, -29.274187508280615, -32.683316246928, -32.683316246928, -32.683316246928, -37.418583942585364, -37.418583942585364, -37.418583942585364, -31.16696069172723, -31.16696069172723, -31.16696069172723, -37.04036525162242, -37.04036525162242, -37.04036525162242, -25.16554777887765, -25.16554777887765, -25.16554777887765, -25.31148657624061, -25.31148657624061, -25.31148657624061, -38.05491310345159, -38.05491310345159, -38.05491310345159, -32.905243681488734, -32.905243681488734, -32.905243681488734, -30.41397373844347, -30.41397373844347, -30.41397373844347, -38.006486361771394, -38.006486361771394, -38.006486361771394, -42.38680902680708, -42.38680902680708, -42.38680902680708, -42.63809683363553, -42.63809683363553, -42.63809683363553, -38.59406790049229, -38.59406790049229, -38.59406790049229, -39.27692970050012, -39.27692970050012, -39.27692970050012, -26.105143089476492, -26.105143089476492, -26.105143089476492, -33.018726205368395, -33.018726205368395, -33.018726205368395, -30.286485163882436, -30.286485163882436, -30.286485163882436, -55.59489945304528, -55.59489945304528, -55.59489945304528, -31.07396034541658, -31.07396034541658, -31.07396034541658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2938307689915439, "mean_inference_ms": 1.0856150891658767, "mean_action_processing_ms": 0.06679154798335515, "mean_env_wait_ms": 0.5782625134217267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 25600, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"sample_time_ms": 9580.457, "sample_throughput": 334.013, "load_time_ms": 0.225, "load_throughput": 14201055.733, "learn_time_ms": 3456.567, "learn_throughput": 925.774, "update_time_ms": 1.98}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005000000000000001, "total_loss": 332.98801879882814, "policy_loss": -0.0018887069759706775, "vf_loss": 333.00473937988284, "vf_explained_var": -0.04726643562316894, "kl": 0.003335917704438196, "entropy": 1.483808171749115, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 25600, "num_agent_steps_sampled": 76800, "num_steps_trained": 25600, "num_agent_steps_trained": 76800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1024, "training_iteration": 8, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-06-32", "timestamp": 1701842792, "time_this_iter_s": 10.012570142745972, "time_total_s": 79.89673376083374, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa8065f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 79.89673376083374, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.45333333333333, "ram_util_percent": 29.293333333333333}}
{"episode_reward_max": -70.09888606635502, "episode_reward_min": -138.3553505324971, "episode_reward_mean": -99.22213848802168, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -46.118450177499064}, "policy_reward_max": {"shared_policy": -23.366295355451673}, "policy_reward_mean": {"shared_policy": -33.0740461626739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-126.43678788337776, -82.1067151656467, -108.61862398405167, -104.81283802125941, -138.05134550131262, -89.54663373416935, -120.8013908531721, -104.39973804931003, -102.30746830894302, -103.08871645648404, -75.79660935806558, -90.50291549166454, -100.5361489394935, -110.89540754197678, -87.81429857150573, -80.99001356704147, -74.77743015970968, -112.86628977937964, -110.63261407506857, -101.40450224711465, -97.30940298815575, -117.01128507852255, -108.39508806373273, -107.57263049488486, -104.81650042841976, -70.20141190706434, -105.84078942720464, -98.10986197836735, -102.71670762617386, -84.9033119400589, -71.93389373745497, -109.98308892280664, -73.00121508231756, -89.37356514812078, -82.72332228434276, -100.9270941026181, -95.64929665205287, -118.951019037762, -107.58930965322836, -102.88276713894561, -95.4605145614928, -99.89048726794397, -117.00169297386813, -75.57137344226052, -116.73033207391934, -103.17917766936202, -100.6974349634452, -135.98406020460544, -86.98593049310574, -97.42849684371961, -99.4057309948547, -116.04452880287505, -97.60319191916055, -107.64348507902835, -84.28510021100071, -86.96843498615851, -80.91908686822013, -130.29982921066238, -72.97740176365585, -77.91722980128894, -103.17868079875869, -108.96354639178347, -84.20384820871536, -89.15673568341936, -93.46076768513434, -95.38548871751478, -101.8635083725017, -77.8884749283716, -88.60771217861607, -120.86279011856615, -83.22655034781666, -91.8792420924715, -97.9689324977292, -80.32059572213046, -91.31345518876495, -118.72486452965809, -111.53488787855703, -91.89732917241302, -96.38490634865923, -77.54789340845035, -101.09158499652456, -90.15818612031097, -138.3553505324971, -106.27847864280152, -120.81828029126262, -78.39442038638856, -117.60055988091526, -91.88072088802976, -74.88652105650694, -111.413678236789, -96.34707438274023, -111.67157747478433, -92.41517970168174, -109.74680676683906, -112.85317025716418, -115.25613378414167, -99.47929295483382, -105.60484483390472, -102.94307505831698, -84.21592384317194, -96.78678453794272, -108.57370861389674, -70.09888606635502, -110.4277115645494, -82.48391611465695, -98.52377967832984, -93.9261175919845, -82.23789134198033, -118.07492375595223, -112.14634112317108, -94.63181430133115, -111.78085122235947, -103.57103824768761, -97.83260493827126, -101.66964779295, -118.34346322797224, -100.98178728278072, -83.59413043581503, -136.29855562733053, -80.11398777781376, -126.78441752628297, -103.52786734901066, -86.37974626277413, -83.7915598431673, -90.00189266093126, -96.242101240295, -102.42912398104896, -84.12643648888977], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-42.14559596112592, -42.14559596112592, -42.14559596112592, -27.368905055215546, -27.368905055215546, -27.368905055215546, -36.20620799468388, -36.20620799468388, -36.20620799468388, -34.93761267375313, -34.93761267375313, -34.93761267375313, -46.017115167104215, -46.017115167104215, -46.017115167104215, -29.848877911389764, -29.848877911389764, -29.848877911389764, -40.26713028439066, -40.26713028439066, -40.26713028439066, -34.79991268310335, -34.79991268310335, -34.79991268310335, -34.102489436314336, -34.102489436314336, -34.102489436314336, -34.3629054854947, -34.3629054854947, -34.3629054854947, -25.265536452688515, -25.265536452688515, -25.265536452688515, -30.167638497221525, -30.167638497221525, -30.167638497221525, -33.51204964649783, -33.51204964649783, -33.51204964649783, -36.965135847325605, -36.965135847325605, -36.965135847325605, -29.27143285716857, -29.27143285716857, -29.27143285716857, -26.996671189013842, -26.996671189013842, -26.996671189013842, -24.925810053236592, -24.925810053236592, -24.925810053236592, -37.62209659312658, -37.62209659312658, -37.62209659312658, -36.87753802502286, -36.87753802502286, -36.87753802502286, -33.80150074903824, -33.80150074903824, -33.80150074903824, -32.4364676627186, -32.4364676627186, -32.4364676627186, -39.00376169284085, -39.00376169284085, -39.00376169284085, -36.13169602124426, -36.13169602124426, -36.13169602124426, -35.85754349829493, -35.85754349829493, -35.85754349829493, -34.93883347613992, -34.93883347613992, -34.93883347613992, -23.400470635688116, -23.400470635688116, -23.400470635688116, -35.28026314240154, -35.28026314240154, -35.28026314240154, -32.70328732612245, -32.70328732612245, -32.70328732612245, -34.238902542057964, -34.238902542057964, -34.238902542057964, -28.30110398001963, -28.30110398001963, -28.30110398001963, -23.977964579151646, -23.977964579151646, -23.977964579151646, -36.66102964093556, -36.66102964093556, -36.66102964093556, -24.333738360772514, -24.333738360772514, -24.333738360772514, -29.791188382706913, -29.791188382706913, -29.791188382706913, -27.574440761447583, -27.574440761447583, -27.574440761447583, -33.64236470087271, -33.64236470087271, -33.64236470087271, -31.88309888401761, -31.88309888401761, -31.88309888401761, -39.65033967925399, -39.65033967925399, -39.65033967925399, -35.86310321774279, -35.86310321774279, -35.86310321774279, -34.29425571298187, -34.29425571298187, -34.29425571298187, -31.82017152049761, -31.82017152049761, -31.82017152049761, -33.296829089314656, -33.296829089314656, -33.296829089314656, -39.000564324622715, -39.000564324622715, -39.000564324622715, -25.19045781408683, -25.19045781408683, -25.19045781408683, -38.91011069130646, -38.91011069130646, -38.91011069130646, -34.39305922312067, -34.39305922312067, -34.39305922312067, -33.56581165448174, -33.56581165448174, -33.56581165448174, -45.328020068201795, -45.328020068201795, -45.328020068201795, -28.99531016436857, -28.99531016436857, -28.99531016436857, -32.47616561457322, -32.47616561457322, -32.47616561457322, -33.13524366495154, -33.13524366495154, -33.13524366495154, -38.68150960095834, -38.68150960095834, -38.68150960095834, -32.53439730638685, -32.53439730638685, -32.53439730638685, -35.88116169300946, -35.88116169300946, -35.88116169300946, -28.095033403666925, -28.095033403666925, -28.095033403666925, -28.989478328719493, -28.989478328719493, -28.989478328719493, -26.97302895607339, -26.97302895607339, -26.97302895607339, -43.43327640355414, -43.43327640355414, -43.43327640355414, -24.325800587885286, -24.325800587885286, -24.325800587885286, -25.972409933762997, -25.972409933762997, -25.972409933762997, -34.39289359958624, -34.39289359958624, -34.39289359958624, -36.32118213059449, -36.32118213059449, -36.32118213059449, -28.067949402905132, -28.067949402905132, -28.067949402905132, -29.718911894473116, -29.718911894473116, -29.718911894473116, -31.153589228378113, -31.153589228378113, -31.153589228378113, -31.795162905838225, -31.795162905838225, -31.795162905838225, -33.954502790833914, -33.954502790833914, -33.954502790833914, -25.962824976123873, -25.962824976123873, -25.962824976123873, -29.53590405953869, -29.53590405953869, -29.53590405953869, -40.28759670618872, -40.28759670618872, -40.28759670618872, -27.742183449272236, -27.742183449272236, -27.742183449272236, -30.626414030823828, -30.626414030823828, -30.626414030823828, -32.656310832576395, -32.656310832576395, -32.656310832576395, -26.77353190737683, -26.77353190737683, -26.77353190737683, -30.43781839625497, -30.43781839625497, -30.43781839625497, -39.57495484321936, -39.57495484321936, -39.57495484321936, -37.17829595951901, -37.17829595951901, -37.17829595951901, -30.632443057471008, -30.632443057471008, -30.632443057471008, -32.128302116219764, -32.128302116219764, -32.128302116219764, -25.849297802816793, -25.849297802816793, -25.849297802816793, -33.69719499884152, -33.69719499884152, -33.69719499884152, -30.052728706770335, -30.052728706770335, -30.052728706770335, -46.118450177499064, -46.118450177499064, -46.118450177499064, -35.42615954760052, -35.42615954760052, -35.42615954760052, -40.27276009708753, -40.27276009708753, -40.27276009708753, -26.131473462129506, -26.131473462129506, -26.131473462129506, -39.20018662697175, -39.20018662697175, -39.20018662697175, -30.626906962676575, -30.626906962676575, -30.626906962676575, -24.962173685502318, -24.962173685502318, -24.962173685502318, -37.13789274559632, -37.13789274559632, -37.13789274559632, -32.11569146091339, -32.11569146091339, -32.11569146091339, -37.22385915826144, -37.22385915826144, -37.22385915826144, -30.80505990056057, -30.80505990056057, -30.80505990056057, -36.58226892227968, -36.58226892227968, -36.58226892227968, -37.61772341905472, -37.61772341905472, -37.61772341905472, -38.41871126138055, -38.41871126138055, -38.41871126138055, -33.15976431827795, -33.15976431827795, -33.15976431827795, -35.201614944634905, -35.201614944634905, -35.201614944634905, -34.314358352772324, -34.314358352772324, -34.314358352772324, -28.07197461439065, -28.07197461439065, -28.07197461439065, -32.26226151264757, -32.26226151264757, -32.26226151264757, -36.191236204632226, -36.191236204632226, -36.191236204632226, -23.366295355451673, -23.366295355451673, -23.366295355451673, -36.80923718818314, -36.80923718818314, -36.80923718818314, -27.494638704885638, -27.494638704885638, -27.494638704885638, -32.84125989277662, -32.84125989277662, -32.84125989277662, -31.308705863994845, -31.308705863994845, -31.308705863994845, -27.41263044732678, -27.41263044732678, -27.41263044732678, -39.358307918650745, -39.358307918650745, -39.358307918650745, -37.3821137077237, -37.3821137077237, -37.3821137077237, -31.543938100443718, -31.543938100443718, -31.543938100443718, -37.26028374078648, -37.26028374078648, -37.26028374078648, -34.523679415895884, -34.523679415895884, -34.523679415895884, -32.61086831275708, -32.61086831275708, -32.61086831275708, -33.889882597649994, -33.889882597649994, -33.889882597649994, -39.44782107599075, -39.44782107599075, -39.44782107599075, -33.6605957609269, -33.6605957609269, -33.6605957609269, -27.86471014527166, -27.86471014527166, -27.86471014527166, -45.43285187577684, -45.43285187577684, -45.43285187577684, -26.70466259260457, -26.70466259260457, -26.70466259260457, -42.26147250876099, -42.26147250876099, -42.26147250876099, -34.509289116336895, -34.509289116336895, -34.509289116336895, -28.793248754258038, -28.793248754258038, -28.793248754258038, -27.930519947722434, -27.930519947722434, -27.930519947722434, -30.00063088697708, -30.00063088697708, -30.00063088697708, -32.080700413431664, -32.080700413431664, -32.080700413431664, -34.14304132701636, -34.14304132701636, -34.14304132701636, -28.042145496296584, -28.042145496296584, -28.042145496296584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2940301079579698, "mean_inference_ms": 1.0855613800019162, "mean_action_processing_ms": 0.06677673026996454, "mean_env_wait_ms": 0.5784058073345875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"sample_time_ms": 9627.69, "sample_throughput": 332.375, "load_time_ms": 0.221, "load_throughput": 14504797.695, "learn_time_ms": 3458.233, "learn_throughput": 925.328, "update_time_ms": 1.982}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 298.9235015869141, "policy_loss": -0.0028275579831873896, "vf_loss": 298.94118347167966, "vf_explained_var": -0.03595670461654663, "kl": 0.0042613229690425134, "entropy": 1.4873677968978882, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 86400, "num_steps_trained": 28800, "num_agent_steps_trained": 86400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1152, "training_iteration": 9, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-06-42", "timestamp": 1701842802, "time_this_iter_s": 10.009466409683228, "time_total_s": 89.90620017051697, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa9faaca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 89.90620017051697, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.66428571428571, "ram_util_percent": 29.235714285714288}}
{"episode_reward_max": -62.046051994682394, "episode_reward_min": -135.508850028449, "episode_reward_mean": -99.5708562408253, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -45.16961667614967}, "policy_reward_max": {"shared_policy": -20.682017331560793}, "policy_reward_mean": {"shared_policy": -33.19028541360843}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-95.56361371106662, -88.35282971845224, -82.93798416576351, -92.6785576254014, -118.22787212329365, -86.79129609851252, -107.83275946284951, -98.89582578741074, -105.86558104152783, -110.03447237010757, -101.20604949250816, -108.39167761003131, -114.74000792094702, -62.046051994682394, -95.17421713119846, -91.58070112442677, -117.17406156210183, -116.50701602576926, -106.0458265370015, -86.2170002641906, -103.88808467654266, -107.94167947905378, -96.97608089933962, -132.9276648591751, -99.73877700856127, -70.72067715280008, -97.70093750439993, -105.33097645675247, -113.5343036715543, -88.85855306737025, -94.32932889774229, -90.61962788296854, -86.79505219820433, -85.11554559643251, -103.2981084274092, -104.21880084127359, -87.35541973816795, -93.37706477540634, -104.64827954079729, -105.42981357378899, -97.57950529910339, -126.28106841664979, -89.99917195284283, -103.22824680515981, -95.51915904886269, -114.3050363752809, -97.58773271823962, -100.77940573409191, -94.00238314739715, -101.3369266844161, -72.75579511612959, -110.07580168444511, -113.4154590865922, -96.03448045157829, -111.03672595987847, -74.25515950323961, -113.11154034183097, -92.44611018478547, -104.58335216663606, -130.42650859135122, -89.97128111359937, -88.33297097742958, -105.3097885296467, -85.58373013806597, -96.47680830271743, -74.60499289201863, -111.60790622311005, -76.42133778465004, -82.93488620579356, -97.13688529124883, -79.18144737102472, -82.00167616621702, -101.4421954413638, -99.00586613982401, -89.80660667566109, -89.44846215691734, -87.33786364103759, -107.58938127067701, -87.81747886429365, -100.40972867404064, -114.18569324673241, -70.46976836001362, -106.7732673490923, -125.54815819167936, -110.98262601040526, -131.87086911761122, -123.19479579878684, -96.1166997610841, -102.3172253860616, -90.6812143032267, -101.80586825015222, -113.28109492683163, -133.52115042677906, -94.8921036924897, -121.95489335182832, -109.8838014883107, -101.2739522645314, -86.65496500408368, -100.88088710829756, -77.91087899333085, -105.29023355050474, -118.52308955684384, -95.93112832937643, -95.56344710222764, -96.04124050660766, -109.0952463671916, -79.57743597129046, -107.0011035371727, -75.56424331094273, -111.67459725337245, -100.64721361671609, -109.65170341798765, -76.01455650406989, -86.66478391910526, -83.31004861685051, -100.64947993199299, -116.86577082838708, -89.9667489705673, -97.65139689152623, -97.10481083509231, -87.73681064345924, -107.63690486537394, -112.37171902535437, -135.508850028449, -106.52087543879402, -102.36971133477701, -101.28260505630351, -94.4048892411412], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-31.854537903688858, -31.854537903688858, -31.854537903688858, -29.450943239484072, -29.450943239484072, -29.450943239484072, -27.645994721921163, -27.645994721921163, -27.645994721921163, -30.892852541800444, -30.892852541800444, -30.892852541800444, -39.40929070776457, -39.40929070776457, -39.40929070776457, -28.93043203283751, -28.93043203283751, -28.93043203283751, -35.94425315428317, -35.94425315428317, -35.94425315428317, -32.96527526247024, -32.96527526247024, -32.96527526247024, -35.288527013842625, -35.288527013842625, -35.288527013842625, -36.678157456702515, -36.678157456702515, -36.678157456702515, -33.73534983083604, -33.73534983083604, -33.73534983083604, -36.130559203343736, -36.130559203343736, -36.130559203343736, -38.24666930698232, -38.24666930698232, -38.24666930698232, -20.682017331560793, -20.682017331560793, -20.682017331560793, -31.724739043732825, -31.724739043732825, -31.724739043732825, -30.526900374808918, -30.526900374808918, -30.526900374808918, -39.05802052070059, -39.05802052070059, -39.05802052070059, -38.835672008589775, -38.835672008589775, -38.835672008589775, -35.34860884566717, -35.34860884566717, -35.34860884566717, -28.739000088063545, -28.739000088063545, -28.739000088063545, -34.629361558847556, -34.629361558847556, -34.629361558847556, -35.98055982635126, -35.98055982635126, -35.98055982635126, -32.32536029977989, -32.32536029977989, -32.32536029977989, -44.30922161972503, -44.30922161972503, -44.30922161972503, -33.246259002853776, -33.246259002853776, -33.246259002853776, -23.573559050933362, -23.573559050933362, -23.573559050933362, -32.5669791681333, -32.5669791681333, -32.5669791681333, -35.110325485584156, -35.110325485584156, -35.110325485584156, -37.84476789051812, -37.84476789051812, -37.84476789051812, -29.61951768912341, -29.61951768912341, -29.61951768912341, -31.443109632580768, -31.443109632580768, -31.443109632580768, -30.20654262765619, -30.20654262765619, -30.20654262765619, -28.931684066068097, -28.931684066068097, -28.931684066068097, -28.371848532144178, -28.371848532144178, -28.371848532144178, -34.43270280913641, -34.43270280913641, -34.43270280913641, -34.73960028042454, -34.73960028042454, -34.73960028042454, -29.118473246055995, -29.118473246055995, -29.118473246055995, -31.125688258468777, -31.125688258468777, -31.125688258468777, -34.882759846932444, -34.882759846932444, -34.882759846932444, -35.143271191263, -35.143271191263, -35.143271191263, -32.5265017663678, -32.5265017663678, -32.5265017663678, -42.09368947221656, -42.09368947221656, -42.09368947221656, -29.999723984280948, -29.999723984280948, -29.999723984280948, -34.40941560171995, -34.40941560171995, -34.40941560171995, -31.83971968295424, -31.83971968295424, -31.83971968295424, -38.101678791760285, -38.101678791760285, -38.101678791760285, -32.529244239413224, -32.529244239413224, -32.529244239413224, -33.5931352446973, -33.5931352446973, -33.5931352446973, -31.334127715799056, -31.334127715799056, -31.334127715799056, -33.77897556147202, -33.77897556147202, -33.77897556147202, -24.251931705376528, -24.251931705376528, -24.251931705376528, -36.69193389481506, -36.69193389481506, -36.69193389481506, -37.805153028864034, -37.805153028864034, -37.805153028864034, -32.011493483859425, -32.011493483859425, -32.011493483859425, -37.01224198662618, -37.01224198662618, -37.01224198662618, -24.751719834413205, -24.751719834413205, -24.751719834413205, -37.70384678061033, -37.70384678061033, -37.70384678061033, -30.815370061595168, -30.815370061595168, -30.815370061595168, -34.86111738887867, -34.86111738887867, -34.86111738887867, -43.47550286378375, -43.47550286378375, -43.47550286378375, -29.990427037866457, -29.990427037866457, -29.990427037866457, -29.444323659143162, -29.444323659143162, -29.444323659143162, -35.103262843215575, -35.103262843215575, -35.103262843215575, -28.527910046021997, -28.527910046021997, -28.527910046021997, -32.158936100905834, -32.158936100905834, -32.158936100905834, -24.86833096400621, -24.86833096400621, -24.86833096400621, -37.202635407703355, -37.202635407703355, -37.202635407703355, -25.47377926155001, -25.47377926155001, -25.47377926155001, -27.64496206859785, -27.64496206859785, -27.64496206859785, -32.37896176374963, -32.37896176374963, -32.37896176374963, -26.39381579034158, -26.39381579034158, -26.39381579034158, -27.333892055405677, -27.333892055405677, -27.333892055405677, -33.814065147121276, -33.814065147121276, -33.814065147121276, -33.00195537994135, -33.00195537994135, -33.00195537994135, -29.935535558553696, -29.935535558553696, -29.935535558553696, -29.81615405230576, -29.81615405230576, -29.81615405230576, -29.112621213679226, -29.112621213679226, -29.112621213679226, -35.86312709022565, -35.86312709022565, -35.86312709022565, -29.27249295476455, -29.27249295476455, -29.27249295476455, -33.46990955801352, -33.46990955801352, -33.46990955801352, -38.0618977489108, -38.0618977489108, -38.0618977489108, -23.489922786671226, -23.489922786671226, -23.489922786671226, -35.59108911636412, -35.59108911636412, -35.59108911636412, -41.84938606389313, -41.84938606389313, -41.84938606389313, -36.99420867013507, -36.99420867013507, -36.99420867013507, -43.95695637253707, -43.95695637253707, -43.95695637253707, -41.06493193292897, -41.06493193292897, -41.06493193292897, -32.03889992036135, -32.03889992036135, -32.03889992036135, -34.10574179535389, -34.10574179535389, -34.10574179535389, -30.22707143440889, -30.22707143440889, -30.22707143440889, -33.935289416717396, -33.935289416717396, -33.935289416717396, -37.76036497561056, -37.76036497561056, -37.76036497561056, -44.5070501422597, -44.5070501422597, -44.5070501422597, -31.630701230829878, -31.630701230829878, -31.630701230829878, -40.65163111727609, -40.65163111727609, -40.65163111727609, -36.62793382943692, -36.62793382943692, -36.62793382943692, -33.75798408817713, -33.75798408817713, -33.75798408817713, -28.884988334694565, -28.884988334694565, -28.884988334694565, -33.62696236943252, -33.62696236943252, -33.62696236943252, -25.97029299777694, -25.97029299777694, -25.97029299777694, -35.096744516834924, -35.096744516834924, -35.096744516834924, -39.507696518947974, -39.507696518947974, -39.507696518947974, -31.977042776458813, -31.977042776458813, -31.977042776458813, -31.854482367409226, -31.854482367409226, -31.854482367409226, -32.013746835535905, -32.013746835535905, -32.013746835535905, -36.36508212239723, -36.36508212239723, -36.36508212239723, -26.52581199043015, -26.52581199043015, -26.52581199043015, -35.6670345123909, -35.6670345123909, -35.6670345123909, -25.188081103647555, -25.188081103647555, -25.188081103647555, -37.22486575112415, -37.22486575112415, -37.22486575112415, -33.549071205572034, -33.549071205572034, -33.549071205572034, -36.5505678059959, -36.5505678059959, -36.5505678059959, -25.338185501356616, -25.338185501356616, -25.338185501356616, -28.888261306368413, -28.888261306368413, -28.888261306368413, -27.770016205616834, -27.770016205616834, -27.770016205616834, -33.549826643997655, -33.549826643997655, -33.549826643997655, -38.955256942795714, -38.955256942795714, -38.955256942795714, -29.988916323522457, -29.988916323522457, -29.988916323522457, -32.55046563050874, -32.55046563050874, -32.55046563050874, -32.36827027836411, -32.36827027836411, -32.36827027836411, -29.245603547819755, -29.245603547819755, -29.245603547819755, -35.87896828845798, -35.87896828845798, -35.87896828845798, -37.45723967511811, -37.45723967511811, -37.45723967511811, -45.16961667614967, -45.16961667614967, -45.16961667614967, -35.50695847959799, -35.50695847959799, -35.50695847959799, -34.123237111592346, -34.123237111592346, -34.123237111592346, -33.760868352101156, -33.760868352101156, -33.760868352101156, -31.468296413713727, -31.468296413713727, -31.468296413713727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29400804520308943, "mean_inference_ms": 1.0857593342310297, "mean_action_processing_ms": 0.06678864261604191, "mean_env_wait_ms": 0.578527267878996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 9668.397, "sample_throughput": 330.975, "load_time_ms": 0.217, "load_throughput": 14771926.921, "learn_time_ms": 3458.26, "learn_throughput": 925.321, "update_time_ms": 1.993}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005000000000000001, "total_loss": 279.0376861572266, "policy_loss": -0.003360714379348817, "vf_loss": 279.0558135986328, "vf_explained_var": -0.033378565311431886, "kl": 0.004720049621297895, "entropy": 1.4771803736686706, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 96000, "num_steps_trained": 32000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1280, "training_iteration": 10, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-06-52", "timestamp": 1701842812, "time_this_iter_s": 9.9987633228302, "time_total_s": 99.90496349334717, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa830af70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 99.90496349334717, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.635714285714283, "ram_util_percent": 29.407142857142848}}
{"episode_reward_max": -72.94632734340419, "episode_reward_min": -147.38125969737888, "episode_reward_mean": -102.01349990622997, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -49.12708656579296}, "policy_reward_max": {"shared_policy": -24.315442447801406}, "policy_reward_mean": {"shared_policy": -34.004499968743325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.28183993927232, -112.14743959944089, -92.23701555993647, -118.62777916587505, -110.22365792434069, -94.63923457162767, -98.62292185266486, -98.43542288582712, -120.78661366028685, -96.34385502235274, -90.42957521077314, -87.02587761410905, -103.15621671340892, -132.5552455783351, -100.43037735136762, -112.39166943111782, -98.33238392563692, -110.318031877482, -75.45544514530324, -78.26801273891844, -81.28958441276504, -112.61133490769394, -131.15562138559775, -86.1089343024165, -83.91215254544298, -111.7092947170811, -103.3219527108474, -118.10106046299958, -105.31098326153284, -109.14626581654626, -80.56982803864653, -112.35470519199121, -98.76224554510996, -123.09825944761508, -108.08661502536921, -120.5851458987791, -92.31265087095217, -105.0670228159683, -103.40786229977051, -106.17525856836626, -73.43996488103257, -103.59798163592814, -90.95018800143524, -91.91855869290521, -94.34362749562543, -140.97552918481225, -107.76769897066887, -74.9518345200437, -120.02766597033246, -93.79714531063281, -111.05045944752676, -79.87474931644361, -86.4185156364689, -98.95630773426359, -97.34962903457186, -80.30597339840502, -111.10953560406959, -84.55031748261649, -81.69162658204827, -123.37423410085694, -98.40117021726284, -99.31329523573547, -111.72448778171506, -88.6220210758249, -107.83748440838211, -92.41897050400065, -77.24929029434927, -139.4905801291499, -115.52842930123573, -96.12041379762974, -88.12025961787347, -109.84346900721967, -113.16748258163977, -130.05653893445103, -108.93501710309897, -97.21517726344605, -116.99299103214109, -102.58629828536466, -142.27564125532516, -147.38125969737888, -142.4704651944363, -94.92401312461271, -75.46666266263694, -94.72420542209353, -95.04879654097441, -110.68173442603818, -115.39898871784953, -140.4911180964824, -94.396794508047, -87.1907498432172, -82.05397677692808, -119.65545535404378, -90.40953368223417, -92.13086722513769, -125.56118724303938, -91.49659797960342, -114.75787400169047, -106.16838111486975, -101.02656650654735, -105.20815358467063, -86.20463480861787, -85.58962453587378, -99.10125169182949, -93.6610122226648, -92.27574237914891, -110.45063613302614, -91.69947642473898, -104.84741233865888, -72.94632734340419, -116.6067390552281, -103.58260810550334, -96.6222683742399, -97.61550621906994, -78.83872453760426, -81.108026691751, -99.86587532900505, -135.62762513186283, -120.56684871973094, -104.45205996800117, -101.97058561342519, -99.03443265305715, -118.84392410850415, -85.12771840169442, -80.30847903325424, -81.27562520877413, -79.41355993629128, -124.790117371467, -83.51180913837462], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.09394664642412, -33.09394664642412, -33.09394664642412, -37.3824798664803, -37.3824798664803, -37.3824798664803, -30.74567185331216, -30.74567185331216, -30.74567185331216, -39.54259305529171, -39.54259305529171, -39.54259305529171, -36.74121930811358, -36.74121930811358, -36.74121930811358, -31.546411523875918, -31.546411523875918, -31.546411523875918, -32.874307284221615, -32.874307284221615, -32.874307284221615, -32.811807628609046, -32.811807628609046, -32.811807628609046, -40.26220455342896, -40.26220455342896, -40.26220455342896, -32.11461834078424, -32.11461834078424, -32.11461834078424, -30.143191736924376, -30.143191736924376, -30.143191736924376, -29.00862587136969, -29.00862587136969, -29.00862587136969, -34.38540557113632, -34.38540557113632, -34.38540557113632, -44.18508185944503, -44.18508185944503, -44.18508185944503, -33.476792450455854, -33.476792450455854, -33.476792450455854, -37.46388981037259, -37.46388981037259, -37.46388981037259, -32.77746130854563, -32.77746130854563, -32.77746130854563, -36.772677292494, -36.772677292494, -36.772677292494, -25.151815048434422, -25.151815048434422, -25.151815048434422, -26.089337579639487, -26.089337579639487, -26.089337579639487, -27.096528137588336, -27.096528137588336, -27.096528137588336, -37.53711163589797, -37.53711163589797, -37.53711163589797, -43.71854046186593, -43.71854046186593, -43.71854046186593, -28.702978100805495, -28.702978100805495, -28.702978100805495, -27.97071751514766, -27.97071751514766, -27.97071751514766, -37.23643157236036, -37.23643157236036, -37.23643157236036, -34.4406509036158, -34.4406509036158, -34.4406509036158, -39.36702015433321, -39.36702015433321, -39.36702015433321, -35.103661087177606, -35.103661087177606, -35.103661087177606, -36.382088605515435, -36.382088605515435, -36.382088605515435, -26.856609346215507, -26.856609346215507, -26.856609346215507, -37.451568397330405, -37.451568397330405, -37.451568397330405, -32.92074851503665, -32.92074851503665, -32.92074851503665, -41.03275314920504, -41.03275314920504, -41.03275314920504, -36.028871675123064, -36.028871675123064, -36.028871675123064, -40.195048632926394, -40.195048632926394, -40.195048632926394, -30.770883623650747, -30.770883623650747, -30.770883623650747, -35.0223409386561, -35.0223409386561, -35.0223409386561, -34.46928743325684, -34.46928743325684, -34.46928743325684, -35.3917528561221, -35.3917528561221, -35.3917528561221, -24.479988293677525, -24.479988293677525, -24.479988293677525, -34.53266054530937, -34.53266054530937, -34.53266054530937, -30.316729333811757, -30.316729333811757, -30.316729333811757, -30.63951956430173, -30.63951956430173, -30.63951956430173, -31.44787583187512, -31.44787583187512, -31.44787583187512, -46.99184306160408, -46.99184306160408, -46.99184306160408, -35.92256632355629, -35.92256632355629, -35.92256632355629, -24.983944840014576, -24.983944840014576, -24.983944840014576, -40.00922199011084, -40.00922199011084, -40.00922199011084, -31.26571510354426, -31.26571510354426, -31.26571510354426, -37.01681981584227, -37.01681981584227, -37.01681981584227, -26.624916438814523, -26.624916438814523, -26.624916438814523, -28.806171878822973, -28.806171878822973, -28.806171878822973, -32.985435911421185, -32.985435911421185, -32.985435911421185, -32.44987634485728, -32.44987634485728, -32.44987634485728, -26.76865779946836, -26.76865779946836, -26.76865779946836, -37.0365118680232, -37.0365118680232, -37.0365118680232, -28.183439160872176, -28.183439160872176, -28.183439160872176, -27.23054219401607, -27.23054219401607, -27.23054219401607, -41.12474470028564, -41.12474470028564, -41.12474470028564, -32.80039007242094, -32.80039007242094, -32.80039007242094, -33.10443174524516, -33.10443174524516, -33.10443174524516, -37.24149592723837, -37.24149592723837, -37.24149592723837, -29.540673691941638, -29.540673691941638, -29.540673691941638, -35.94582813612737, -35.94582813612737, -35.94582813612737, -30.806323501333566, -30.806323501333566, -30.806323501333566, -25.749763431449733, -25.749763431449733, -25.749763431449733, -46.496860043049956, -46.496860043049956, -46.496860043049956, -38.50947643374523, -38.50947643374523, -38.50947643374523, -32.04013793254324, -32.04013793254324, -32.04013793254324, -29.37341987262449, -29.37341987262449, -29.37341987262449, -36.614489669073244, -36.614489669073244, -36.614489669073244, -37.7224941938799, -37.7224941938799, -37.7224941938799, -43.35217964481704, -43.35217964481704, -43.35217964481704, -36.31167236769967, -36.31167236769967, -36.31167236769967, -32.40505908781535, -32.40505908781535, -32.40505908781535, -38.99766367738036, -38.99766367738036, -38.99766367738036, -34.195432761788226, -34.195432761788226, -34.195432761788226, -47.42521375177504, -47.42521375177504, -47.42521375177504, -49.12708656579296, -49.12708656579296, -49.12708656579296, -47.49015506481209, -47.49015506481209, -47.49015506481209, -31.64133770820422, -31.64133770820422, -31.64133770820422, -25.155554220878955, -25.155554220878955, -25.155554220878955, -31.574735140697832, -31.574735140697832, -31.574735140697832, -31.6829321803248, -31.6829321803248, -31.6829321803248, -36.89391147534609, -36.89391147534609, -36.89391147534609, -38.46632957261651, -38.46632957261651, -38.46632957261651, -46.83037269882747, -46.83037269882747, -46.83037269882747, -31.465598169349004, -31.465598169349004, -31.465598169349004, -29.063583281072397, -29.063583281072397, -29.063583281072397, -27.351325592309372, -27.351325592309372, -27.351325592309372, -39.885151784681284, -39.885151784681284, -39.885151784681284, -30.13651122741138, -30.13651122741138, -30.13651122741138, -30.710289075045864, -30.710289075045864, -30.710289075045864, -41.85372908101314, -41.85372908101314, -41.85372908101314, -30.498865993201147, -30.498865993201147, -30.498865993201147, -38.25262466723012, -38.25262466723012, -38.25262466723012, -35.38946037162326, -35.38946037162326, -35.38946037162326, -33.675522168849106, -33.675522168849106, -33.675522168849106, -35.06938452822354, -35.06938452822354, -35.06938452822354, -28.73487826953931, -28.73487826953931, -28.73487826953931, -28.52987484529128, -28.52987484529128, -28.52987484529128, -33.033750563943165, -33.033750563943165, -33.033750563943165, -31.220337407554915, -31.220337407554915, -31.220337407554915, -30.75858079304962, -30.75858079304962, -30.75858079304962, -36.81687871100871, -36.81687871100871, -36.81687871100871, -30.56649214157965, -30.56649214157965, -30.56649214157965, -34.949137446219616, -34.949137446219616, -34.949137446219616, -24.315442447801406, -24.315442447801406, -24.315442447801406, -38.86891301840938, -38.86891301840938, -38.86891301840938, -34.52753603516778, -34.52753603516778, -34.52753603516778, -32.2074227914133, -32.2074227914133, -32.2074227914133, -32.5385020730233, -32.5385020730233, -32.5385020730233, -26.279574845868087, -26.279574845868087, -26.279574845868087, -27.036008897250348, -27.036008897250348, -27.036008897250348, -33.28862510966837, -33.28862510966837, -33.28862510966837, -45.20920837728764, -45.20920837728764, -45.20920837728764, -40.18894957324364, -40.18894957324364, -40.18894957324364, -34.817353322667046, -34.817353322667046, -34.817353322667046, -33.99019520447506, -33.99019520447506, -33.99019520447506, -33.01147755101904, -33.01147755101904, -33.01147755101904, -39.6146413695014, -39.6146413695014, -39.6146413695014, -28.375906133898145, -28.375906133898145, -28.375906133898145, -26.76949301108474, -26.76949301108474, -26.76949301108474, -27.091875069591392, -27.091875069591392, -27.091875069591392, -26.47118664543042, -26.47118664543042, -26.47118664543042, -41.59670579048896, -41.59670579048896, -41.59670579048896, -27.83726971279153, -27.83726971279153, -27.83726971279153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29350746721338306, "mean_inference_ms": 1.0844404421551368, "mean_action_processing_ms": 0.06671883274840315, "mean_env_wait_ms": 0.5780425770289993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 35200, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"sample_time_ms": 9999.235, "sample_throughput": 320.024, "load_time_ms": 0.194, "load_throughput": 16498798.771, "learn_time_ms": 3445.815, "learn_throughput": 928.663, "update_time_ms": 1.978}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 272.56865234375, "policy_loss": -0.0026911128282081976, "vf_loss": 272.58604125976564, "vf_explained_var": -0.05689826011657715, "kl": 0.0028479661974432054, "entropy": 1.4691437125205993, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 35200, "num_agent_steps_sampled": 105600, "num_steps_trained": 35200, "num_agent_steps_trained": 105600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1408, "training_iteration": 11, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-07-02", "timestamp": 1701842822, "time_this_iter_s": 9.877211093902588, "time_total_s": 109.78217458724976, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa830a040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 109.78217458724976, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.321428571428573, "ram_util_percent": 29.485714285714284}}
{"episode_reward_max": -69.24590143805304, "episode_reward_min": -156.7193619686993, "episode_reward_mean": -104.28202319399928, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -52.23978732289977}, "policy_reward_max": {"shared_policy": -23.081967146017686}, "policy_reward_mean": {"shared_policy": -34.76067439799976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.73923558601973, -102.89072502898262, -82.00192691341775, -115.34436680673592, -90.732667168398, -116.41378050081899, -141.3854673154, -120.21930701101614, -88.91916091867307, -111.62265626533681, -96.22225431534018, -89.81769298662925, -96.4812469667447, -93.51075235276754, -146.67549577534666, -124.12662779434763, -115.78260035069455, -88.91782596672664, -112.33274107913803, -94.1534009541866, -100.04034022606122, -112.21593551457889, -106.28954966967609, -147.6024666226694, -130.87994562766983, -83.55651716134675, -101.2051928211312, -104.71380237826257, -89.33034139674852, -96.59088754799534, -100.5600584020015, -108.62541981964678, -79.28153786611544, -121.46966049800147, -117.60886812671957, -91.87088537092193, -113.24260598376495, -132.65040459356524, -109.6532585653444, -98.17436826096196, -121.28219943952912, -92.87638754614767, -114.33471322777736, -141.28180624063708, -89.45724792035358, -104.8003498096234, -114.56724984194815, -115.15121423081091, -138.09448686941343, -82.87013380389608, -85.68245391569423, -106.07092597537864, -97.70231809353407, -156.7193619686993, -105.40570155334248, -86.95321332714431, -105.009496827852, -132.3769580756917, -114.61120409901946, -95.7662825018411, -75.45350907672271, -106.77935856730507, -83.5134477027597, -127.13320020588066, -90.55564024363005, -112.236782359721, -101.30012261951997, -74.8489559853675, -82.36070499458715, -76.86626906590763, -111.43542641270164, -87.52666964608804, -130.84594909624636, -81.16080073046864, -105.76985877948553, -120.71654321065114, -78.73938951922511, -90.92849936029272, -114.62644841258407, -111.40431580684336, -77.08408830198718, -118.21667279007207, -115.05248068324295, -101.45917925498739, -121.96887317064441, -73.87815648554351, -117.04069689970868, -82.1533665870697, -126.06547091888035, -111.85018973027147, -128.80796412864495, -119.78118351738321, -97.17732615355474, -91.91151403517841, -135.92170749603528, -105.29150495664065, -126.00771899799527, -103.43482442647644, -143.57173390936407, -74.36498229678007, -103.6172844164473, -116.4716360334197, -102.26161642326274, -119.83875258155746, -86.86534290176036, -93.71630132119468, -95.62874134886286, -97.98304465139768, -96.79023476692261, -107.00316227859346, -69.24590143805304, -75.59278426647963, -99.06748986853385, -98.4142384419435, -77.12270889396406, -123.16725347951412, -74.83014160882622, -89.48302001762629, -75.87497442221812, -115.93913251528429, -77.97264146777421, -94.31516014514652, -114.38104975475731, -98.38256540907967, -106.12087337179145, -118.01978593698745, -104.63034899753899, -113.25557175828371], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-30.91307852867323, -30.91307852867323, -30.91307852867323, -34.296908342994165, -34.296908342994165, -34.296908342994165, -27.333975637805935, -27.333975637805935, -27.333975637805935, -38.44812226891196, -38.44812226891196, -38.44812226891196, -30.244222389466007, -30.244222389466007, -30.244222389466007, -38.80459350027302, -38.80459350027302, -38.80459350027302, -47.12848910513334, -47.12848910513334, -47.12848910513334, -40.073102337005395, -40.073102337005395, -40.073102337005395, -29.639720306224376, -29.639720306224376, -29.639720306224376, -37.207552088445595, -37.207552088445595, -37.207552088445595, -32.074084771780065, -32.074084771780065, -32.074084771780065, -29.939230995543063, -29.939230995543063, -29.939230995543063, -32.160415655581566, -32.160415655581566, -32.160415655581566, -31.170250784255856, -31.170250784255856, -31.170250784255856, -48.89183192511555, -48.89183192511555, -48.89183192511555, -41.37554259811588, -41.37554259811588, -41.37554259811588, -38.594200116898186, -38.594200116898186, -38.594200116898186, -29.639275322242185, -29.639275322242185, -29.639275322242185, -37.444247026379344, -37.444247026379344, -37.444247026379344, -31.384466984728867, -31.384466984728867, -31.384466984728867, -33.346780075353756, -33.346780075353756, -33.346780075353756, -37.405311838192944, -37.405311838192944, -37.405311838192944, -35.42984988989201, -35.42984988989201, -35.42984988989201, -49.200822207556456, -49.200822207556456, -49.200822207556456, -43.62664854255662, -43.62664854255662, -43.62664854255662, -27.852172387115594, -27.852172387115594, -27.852172387115594, -33.73506427371039, -33.73506427371039, -33.73506427371039, -34.90460079275417, -34.90460079275417, -34.90460079275417, -29.776780465582846, -29.776780465582846, -29.776780465582846, -32.19696251599845, -32.19696251599845, -32.19696251599845, -33.52001946733383, -33.52001946733383, -33.52001946733383, -36.20847327321559, -36.20847327321559, -36.20847327321559, -26.427179288705172, -26.427179288705172, -26.427179288705172, -40.48988683266715, -40.48988683266715, -40.48988683266715, -39.20295604223985, -39.20295604223985, -39.20295604223985, -30.623628456973996, -30.623628456973996, -30.623628456973996, -37.74753532792166, -37.74753532792166, -37.74753532792166, -44.21680153118842, -44.21680153118842, -44.21680153118842, -36.55108618844812, -36.55108618844812, -36.55108618844812, -32.72478942032066, -32.72478942032066, -32.72478942032066, -40.42739981317638, -40.42739981317638, -40.42739981317638, -30.958795848715894, -30.958795848715894, -30.958795848715894, -38.11157107592581, -38.11157107592581, -38.11157107592581, -47.09393541354569, -47.09393541354569, -47.09393541354569, -29.81908264011786, -29.81908264011786, -29.81908264011786, -34.933449936541145, -34.933449936541145, -34.933449936541145, -38.18908328064938, -38.18908328064938, -38.18908328064938, -38.383738076936964, -38.383738076936964, -38.383738076936964, -46.03149562313779, -46.03149562313779, -46.03149562313779, -27.62337793463203, -27.62337793463203, -27.62337793463203, -28.56081797189807, -28.56081797189807, -28.56081797189807, -35.35697532512621, -35.35697532512621, -35.35697532512621, -32.56743936451134, -32.56743936451134, -32.56743936451134, -52.23978732289977, -52.23978732289977, -52.23978732289977, -35.13523385111416, -35.13523385111416, -35.13523385111416, -28.984404442381418, -28.984404442381418, -28.984404442381418, -35.00316560928403, -35.00316560928403, -35.00316560928403, -44.12565269189722, -44.12565269189722, -44.12565269189722, -38.20373469967316, -38.20373469967316, -38.20373469967316, -31.92209416728037, -31.92209416728037, -31.92209416728037, -25.15116969224091, -25.15116969224091, -25.15116969224091, -35.59311952243502, -35.59311952243502, -35.59311952243502, -27.837815900919917, -27.837815900919917, -27.837815900919917, -42.37773340196023, -42.37773340196023, -42.37773340196023, -30.185213414543377, -30.185213414543377, -30.185213414543377, -37.412260786573654, -37.412260786573654, -37.412260786573654, -33.766707539840006, -33.766707539840006, -33.766707539840006, -24.9496519951225, -24.9496519951225, -24.9496519951225, -27.453568331529045, -27.453568331529045, -27.453568331529045, -25.62208968863587, -25.62208968863587, -25.62208968863587, -37.14514213756723, -37.14514213756723, -37.14514213756723, -29.175556548695997, -29.175556548695997, -29.175556548695997, -43.61531636541547, -43.61531636541547, -43.61531636541547, -27.053600243489548, -27.053600243489548, -27.053600243489548, -35.25661959316182, -35.25661959316182, -35.25661959316182, -40.23884773688371, -40.23884773688371, -40.23884773688371, -26.246463173075025, -26.246463173075025, -26.246463173075025, -30.30949978676424, -30.30949978676424, -30.30949978676424, -38.208816137528025, -38.208816137528025, -38.208816137528025, -37.13477193561446, -37.13477193561446, -37.13477193561446, -25.694696100662394, -25.694696100662394, -25.694696100662394, -39.40555759669072, -39.40555759669072, -39.40555759669072, -38.35082689441431, -38.35082689441431, -38.35082689441431, -33.819726418329125, -33.819726418329125, -33.819726418329125, -40.65629105688146, -40.65629105688146, -40.65629105688146, -24.626052161847813, -24.626052161847813, -24.626052161847813, -39.01356563323622, -39.01356563323622, -39.01356563323622, -27.38445552902324, -27.38445552902324, -27.38445552902324, -42.021823639626774, -42.021823639626774, -42.021823639626774, -37.283396576757156, -37.283396576757156, -37.283396576757156, -42.93598804288167, -42.93598804288167, -42.93598804288167, -39.92706117246109, -39.92706117246109, -39.92706117246109, -32.392442051184915, -32.392442051184915, -32.392442051184915, -30.63717134505946, -30.63717134505946, -30.63717134505946, -45.30723583201176, -45.30723583201176, -45.30723583201176, -35.09716831888019, -35.09716831888019, -35.09716831888019, -42.00257299933177, -42.00257299933177, -42.00257299933177, -34.47827480882549, -34.47827480882549, -34.47827480882549, -47.85724463645468, -47.85724463645468, -47.85724463645468, -24.78832743226001, -24.78832743226001, -24.78832743226001, -34.539094805482435, -34.539094805482435, -34.539094805482435, -38.823878677806576, -38.823878677806576, -38.823878677806576, -34.087205474420934, -34.087205474420934, -34.087205474420934, -39.946250860519164, -39.946250860519164, -39.946250860519164, -28.955114300586803, -28.955114300586803, -28.955114300586803, -31.23876710706489, -31.23876710706489, -31.23876710706489, -31.87624711628762, -31.87624711628762, -31.87624711628762, -32.66101488379922, -32.66101488379922, -32.66101488379922, -32.263411588974215, -32.263411588974215, -32.263411588974215, -35.667720759531164, -35.667720759531164, -35.667720759531164, -23.081967146017686, -23.081967146017686, -23.081967146017686, -25.1975947554932, -25.1975947554932, -25.1975947554932, -33.02249662284462, -33.02249662284462, -33.02249662284462, -32.804746147314496, -32.804746147314496, -32.804746147314496, -25.70756963132134, -25.70756963132134, -25.70756963132134, -41.055751159838046, -41.055751159838046, -41.055751159838046, -24.943380536275416, -24.943380536275416, -24.943380536275416, -29.82767333920876, -29.82767333920876, -29.82767333920876, -25.291658140739365, -25.291658140739365, -25.291658140739365, -38.64637750509474, -38.64637750509474, -38.64637750509474, -25.990880489258064, -25.990880489258064, -25.990880489258064, -31.43838671504881, -31.43838671504881, -31.43838671504881, -38.12701658491912, -38.12701658491912, -38.12701658491912, -32.79418846969321, -32.79418846969321, -32.79418846969321, -35.37362445726381, -35.37362445726381, -35.37362445726381, -39.339928645662496, -39.339928645662496, -39.339928645662496, -34.876782999179646, -34.876782999179646, -34.876782999179646, -37.75185725276122, -37.75185725276122, -37.75185725276122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2935387616927282, "mean_inference_ms": 1.085063969790012, "mean_action_processing_ms": 0.0667335161277799, "mean_env_wait_ms": 0.5785404793008759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"sample_time_ms": 9993.774, "sample_throughput": 320.199, "load_time_ms": 0.194, "load_throughput": 16486638.988, "learn_time_ms": 3445.307, "learn_throughput": 928.8, "update_time_ms": 1.986}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005000000000000001, "total_loss": 262.5464492797852, "policy_loss": -0.0027479628836253765, "vf_loss": 262.5638626098633, "vf_explained_var": -0.081493079662323, "kl": 0.004726088167625186, "entropy": 1.4664952158927917, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 115200, "num_steps_trained": 38400, "num_agent_steps_trained": 115200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1536, "training_iteration": 12, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-07-12", "timestamp": 1701842832, "time_this_iter_s": 10.011107444763184, "time_total_s": 119.79328203201294, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa849f430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 119.79328203201294, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.85333333333334, "ram_util_percent": 29.506666666666668}}
{"episode_reward_max": -60.00305659276482, "episode_reward_min": -151.6670603055404, "episode_reward_mean": -100.64817949965403, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -50.55568676851345}, "policy_reward_max": {"shared_policy": -20.001018864254945}, "policy_reward_mean": {"shared_policy": -33.54939316655135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.14683468808808, -98.77393893660381, -116.95555262312745, -127.80596361778234, -102.08531263057354, -121.45330051684566, -102.11074878957065, -102.79451027412588, -115.74263291084671, -99.31027413020335, -92.24659719952857, -101.61159092328307, -87.92492791577138, -111.39710311200841, -105.40249333645042, -92.15309328393937, -90.87239794074507, -112.9009371878221, -104.85791869019431, -67.77387368697211, -122.85570335818427, -90.12708972624826, -92.63084800375398, -104.85955473725309, -104.21316680955627, -83.4968394124959, -79.54421703046299, -127.62394671823414, -76.21860412601745, -91.14199553883412, -115.20245705637146, -98.41821275685764, -136.13002509122376, -122.05715112897768, -73.41441740990133, -88.46845841795657, -118.08252024669328, -110.47485135811381, -102.52762958827601, -82.66282210715002, -114.51767792936116, -96.13271230980462, -89.98183832783157, -81.4529868761575, -120.95847979811771, -82.3367289991203, -121.99754007319011, -151.6670603055404, -85.40319578723118, -77.42574627419843, -116.50254834280528, -104.29995874514104, -68.64964099898981, -112.82086128887812, -117.74747376192376, -131.98439518926958, -104.508707081765, -84.69987666608482, -60.00305659276482, -108.66323956205814, -96.54546459129884, -133.3467319537071, -113.17158076835145, -100.38055849408691, -84.92566362039342, -91.71388635805764, -107.5972446062408, -104.07101141026895, -119.17313938351668, -76.39593492846777, -95.5532515220763, -89.32997374671093, -131.31870855826136, -73.77287917772927, -72.39562338627114, -120.35218407697155, -109.10252577469191, -93.39667438540468, -74.33398278153733, -105.1961580515598, -101.64317613311829, -83.58221660893342, -92.80162901253308, -100.99312030363336, -101.6416462404841, -102.97909741931971, -116.57172665537239, -95.76654666267325, -118.96627193658001, -88.71566299462417, -77.15075685881865, -104.61805573852126, -88.82217890783974, -89.24201705390315, -109.45637111394366, -99.52654385944935, -121.76696239896215, -73.63111742578448, -87.54974823226023, -89.18299754654959, -83.53665957568883, -99.42634991078562, -84.21888569527388, -93.20471614966857, -110.19712913322174, -94.07466500743921, -100.12606561051166, -111.43388563662901, -116.96158866592744, -135.2678347883821, -92.76571202690688, -112.60937516620808, -90.26722878921724, -119.30825040735942, -115.08829880493123, -102.84086253936299, -87.42680033721173, -124.74596965765878, -90.21185107941729, -97.8089893317105, -79.0437778220105, -104.43982339421626, -90.68531960918449, -77.74944239999716, -74.16540488503976, -114.80688932961367, -116.22640030577834, -124.42354129017986], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-32.382278229362704, -32.382278229362704, -32.382278229362704, -32.92464631220127, -32.92464631220127, -32.92464631220127, -38.98518420770916, -38.98518420770916, -38.98518420770916, -42.60198787259411, -42.60198787259411, -42.60198787259411, -34.02843754352451, -34.02843754352451, -34.02843754352451, -40.48443350561526, -40.48443350561526, -40.48443350561526, -34.036916263190214, -34.036916263190214, -34.036916263190214, -34.264836758041945, -34.264836758041945, -34.264836758041945, -38.58087763694891, -38.58087763694891, -38.58087763694891, -33.10342471006777, -33.10342471006777, -33.10342471006777, -30.74886573317621, -30.74886573317621, -30.74886573317621, -33.87053030776106, -33.87053030776106, -33.87053030776106, -29.308309305257136, -29.308309305257136, -29.308309305257136, -37.1323677040028, -37.1323677040028, -37.1323677040028, -35.1341644454835, -35.1341644454835, -35.1341644454835, -30.717697761313126, -30.717697761313126, -30.717697761313126, -30.290799313581694, -30.290799313581694, -30.290799313581694, -37.633645729274036, -37.633645729274036, -37.633645729274036, -34.952639563398094, -34.952639563398094, -34.952639563398094, -22.5912912289907, -22.5912912289907, -22.5912912289907, -40.95190111939476, -40.95190111939476, -40.95190111939476, -30.042363242082743, -30.042363242082743, -30.042363242082743, -30.876949334584676, -30.876949334584676, -30.876949334584676, -34.953184912417726, -34.953184912417726, -34.953184912417726, -34.7377222698521, -34.7377222698521, -34.7377222698521, -27.832279804165303, -27.832279804165303, -27.832279804165303, -26.514739010154344, -26.514739010154344, -26.514739010154344, -42.541315572744715, -42.541315572744715, -42.541315572744715, -25.406201375339165, -25.406201375339165, -25.406201375339165, -30.38066517961139, -30.38066517961139, -30.38066517961139, -38.40081901879046, -38.40081901879046, -38.40081901879046, -32.80607091895255, -32.80607091895255, -32.80607091895255, -45.376675030407895, -45.376675030407895, -45.376675030407895, -40.68571704299257, -40.68571704299257, -40.68571704299257, -24.47147246996711, -24.47147246996711, -24.47147246996711, -29.489486139318856, -29.489486139318856, -29.489486139318856, -39.360840082231086, -39.360840082231086, -39.360840082231086, -36.82495045270456, -36.82495045270456, -36.82495045270456, -34.17587652942533, -34.17587652942533, -34.17587652942533, -27.554274035716677, -27.554274035716677, -27.554274035716677, -38.17255930978706, -38.17255930978706, -38.17255930978706, -32.044237436601556, -32.044237436601556, -32.044237436601556, -29.9939461092772, -29.9939461092772, -29.9939461092772, -27.150995625385814, -27.150995625385814, -27.150995625385814, -40.319493266039274, -40.319493266039274, -40.319493266039274, -27.445576333040098, -27.445576333040098, -27.445576333040098, -40.665846691063365, -40.665846691063365, -40.665846691063365, -50.55568676851345, -50.55568676851345, -50.55568676851345, -28.46773192907707, -28.46773192907707, -28.46773192907707, -25.808582091399483, -25.808582091399483, -25.808582091399483, -38.83418278093513, -38.83418278093513, -38.83418278093513, -34.766652915047, -34.766652915047, -34.766652915047, -22.88321366632994, -22.88321366632994, -22.88321366632994, -37.60695376295937, -37.60695376295937, -37.60695376295937, -39.24915792064123, -39.24915792064123, -39.24915792064123, -43.994798396423185, -43.994798396423185, -43.994798396423185, -34.83623569392166, -34.83623569392166, -34.83623569392166, -28.23329222202825, -28.23329222202825, -28.23329222202825, -20.001018864254945, -20.001018864254945, -20.001018864254945, -36.22107985401941, -36.22107985401941, -36.22107985401941, -32.18182153043293, -32.18182153043293, -32.18182153043293, -44.44891065123568, -44.44891065123568, -44.44891065123568, -37.72386025611715, -37.72386025611715, -37.72386025611715, -33.46018616469564, -33.46018616469564, -33.46018616469564, -28.308554540131148, -28.308554540131148, -28.308554540131148, -30.571295452685867, -30.571295452685867, -30.571295452685867, -35.86574820208026, -35.86574820208026, -35.86574820208026, -34.69033713675632, -34.69033713675632, -34.69033713675632, -39.72437979450554, -39.72437979450554, -39.72437979450554, -25.465311642822577, -25.465311642822577, -25.465311642822577, -31.851083840692077, -31.851083840692077, -31.851083840692077, -29.776657915570294, -29.776657915570294, -29.776657915570294, -43.77290285275376, -43.77290285275376, -43.77290285275376, -24.590959725909755, -24.590959725909755, -24.590959725909755, -24.131874462090366, -24.131874462090366, -24.131874462090366, -40.11739469232384, -40.11739469232384, -40.11739469232384, -36.36750859156396, -36.36750859156396, -36.36750859156396, -31.132224795134896, -31.132224795134896, -31.132224795134896, -24.777994260512436, -24.777994260512436, -24.777994260512436, -35.06538601718659, -35.06538601718659, -35.06538601718659, -33.88105871103946, -33.88105871103946, -33.88105871103946, -27.860738869644454, -27.860738869644454, -27.860738869644454, -30.933876337511045, -30.933876337511045, -30.933876337511045, -33.664373434544466, -33.664373434544466, -33.664373434544466, -33.880548746828005, -33.880548746828005, -33.880548746828005, -34.326365806439895, -34.326365806439895, -34.326365806439895, -38.85724221845748, -38.85724221845748, -38.85724221845748, -31.92218222089109, -31.92218222089109, -31.92218222089109, -39.65542397886002, -39.65542397886002, -39.65542397886002, -29.571887664874694, -29.571887664874694, -29.571887664874694, -25.71691895293953, -25.71691895293953, -25.71691895293953, -34.87268524617376, -34.87268524617376, -34.87268524617376, -29.607392969279932, -29.607392969279932, -29.607392969279932, -29.7473390179677, -29.7473390179677, -29.7473390179677, -36.48545703798121, -36.48545703798121, -36.48545703798121, -33.17551461981646, -33.17551461981646, -33.17551461981646, -40.58898746632071, -40.58898746632071, -40.58898746632071, -24.543705808594826, -24.543705808594826, -24.543705808594826, -29.183249410753415, -29.183249410753415, -29.183249410753415, -29.72766584884988, -29.72766584884988, -29.72766584884988, -27.845553191896272, -27.845553191896272, -27.845553191896272, -33.142116636928534, -33.142116636928534, -33.142116636928534, -28.07296189842465, -28.07296189842465, -28.07296189842465, -31.068238716556195, -31.068238716556195, -31.068238716556195, -36.73237637774057, -36.73237637774057, -36.73237637774057, -31.358221669146406, -31.358221669146406, -31.358221669146406, -33.3753552035039, -33.3753552035039, -33.3753552035039, -37.144628545542986, -37.144628545542986, -37.144628545542986, -38.987196221975815, -38.987196221975815, -38.987196221975815, -45.08927826279404, -45.08927826279404, -45.08927826279404, -30.92190400896895, -30.92190400896895, -30.92190400896895, -37.53645838873602, -37.53645838873602, -37.53645838873602, -30.0890762630724, -30.0890762630724, -30.0890762630724, -39.76941680245312, -39.76941680245312, -39.76941680245312, -38.362766268310395, -38.362766268310395, -38.362766268310395, -34.28028751312099, -34.28028751312099, -34.28028751312099, -29.142266779070567, -29.142266779070567, -29.142266779070567, -41.581989885886244, -41.581989885886244, -41.581989885886244, -30.070617026472448, -30.070617026472448, -30.070617026472448, -32.602996443903514, -32.602996443903514, -32.602996443903514, -26.347925940670166, -26.347925940670166, -26.347925940670166, -34.81327446473875, -34.81327446473875, -34.81327446473875, -30.228439869728163, -30.228439869728163, -30.228439869728163, -25.916480799999057, -25.916480799999057, -25.916480799999057, -24.721801628346608, -24.721801628346608, -24.721801628346608, -38.26896310987125, -38.26896310987125, -38.26896310987125, -38.74213343525945, -38.74213343525945, -38.74213343525945, -41.47451376339329, -41.47451376339329, -41.47451376339329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29356902426405174, "mean_inference_ms": 1.0851669109789488, "mean_action_processing_ms": 0.06674441611324664, "mean_env_wait_ms": 0.5786463617203926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 41600, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"sample_time_ms": 9999.65, "sample_throughput": 320.011, "load_time_ms": 0.194, "load_throughput": 16458335.745, "learn_time_ms": 3446.153, "learn_throughput": 928.572, "update_time_ms": 1.995}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 189.9315933227539, "policy_loss": -0.003026407796734354, "vf_loss": 189.9492218017578, "vf_explained_var": -0.13158305883407592, "kl": 0.004780552041661034, "entropy": 1.460114312171936, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 41600, "num_agent_steps_sampled": 124800, "num_steps_trained": 41600, "num_agent_steps_trained": 124800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1664, "training_iteration": 13, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-07-22", "timestamp": 1701842842, "time_this_iter_s": 9.9901602268219, "time_total_s": 129.78344225883484, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa830a670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 129.78344225883484, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.485714285714284, "ram_util_percent": 29.45}}
{"episode_reward_max": -63.33655442711326, "episode_reward_min": -150.51559016296773, "episode_reward_mean": -98.1408880455638, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {"shared_policy": -50.171863387655954}, "policy_reward_max": {"shared_policy": -21.11218480903775}, "policy_reward_mean": {"shared_policy": -32.713629348521266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.27849205602696, -109.47044662054044, -105.31401821791324, -131.34061738691372, -93.3406335152523, -89.69045444752965, -96.90757816732075, -115.67147226511598, -107.11528397013774, -116.0998481533583, -91.80386087702888, -74.26731534933735, -101.20869903887822, -95.64475398658962, -84.58947667185696, -123.82798126831639, -96.03511205389299, -120.27292105892023, -102.56665000798392, -106.35264140847869, -66.63694646019518, -105.95887177466773, -82.11477304604921, -117.92570780272422, -115.02811833965826, -86.46756587021699, -95.2899903586245, -102.62892477058827, -122.36331353331101, -107.75095791218698, -122.04949382875569, -89.96167961112081, -87.23784039936005, -79.96942222411522, -69.0529580736675, -75.4861042514249, -90.47793508098904, -79.96333898779548, -80.82005076314188, -72.86968771001908, -91.2945167929386, -92.86944162750478, -85.79227648432907, -97.79620191995622, -108.34774191007736, -115.22170328217993, -104.51564556709351, -120.00836213040316, -75.0255442990719, -90.04170976667187, -92.61423282148272, -84.84243396040571, -77.15593244522339, -96.18463793127749, -98.74930930150391, -105.20041338587016, -114.01972916685288, -82.36555156828972, -124.35109043063088, -81.509133827889, -88.94697930109358, -110.62821196935357, -98.07625828576845, -111.34339722379343, -78.23131048998094, -107.57471249912875, -91.46448420396199, -91.8253141995442, -102.45173748348604, -121.86861171104748, -103.74732262737825, -96.51998533635135, -93.08618915970108, -83.09779656700745, -86.60404070234378, -63.33655442711326, -93.3964021082369, -87.04110033552037, -90.52206430313436, -86.73333299425232, -84.60498713563145, -98.84169213551587, -104.39682398140552, -103.6838878387318, -87.28411494499821, -81.68100648213546, -122.82497430103099, -110.2237380698194, -97.9273465092964, -105.56276704339909, -87.98701373281651, -119.53453253123489, -123.57786240870911, -85.06128022649779, -103.41437523363179, -109.53487750478511, -95.90881588948889, -84.80670165459011, -100.20048438578372, -73.69782250047372, -106.68793417822022, -138.16094241326584, -128.51533395345749, -103.18264067417336, -98.84130681621232, -150.51559016296773, -85.01735388609957, -85.20435767831641, -98.49138300327341, -97.96500043587217, -102.65562299552728, -110.58660578785677, -83.80348725541606, -102.4187771896749, -84.1174705156956, -82.07465938119194, -106.25261200249193, -126.26391473694339, -114.0305050757614, -109.20541945273777, -71.35052300619925, -91.86828866464121, -98.38817695251818, -106.76697536535178, -81.11172037521192, -111.44078583150288, -93.98863995823451, -86.11918570552129], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-30.092830685342317, -30.092830685342317, -30.092830685342317, -36.49014887351349, -36.49014887351349, -36.49014887351349, -35.104672739304405, -35.104672739304405, -35.104672739304405, -43.780205795637904, -43.780205795637904, -43.780205795637904, -31.113544505084107, -31.113544505084107, -31.113544505084107, -29.89681814917656, -29.89681814917656, -29.89681814917656, -32.3025260557736, -32.3025260557736, -32.3025260557736, -38.557157421705334, -38.557157421705334, -38.557157421705334, -35.705094656712554, -35.705094656712554, -35.705094656712554, -38.69994938445279, -38.69994938445279, -38.69994938445279, -30.601286959009606, -30.601286959009606, -30.601286959009606, -24.755771783112465, -24.755771783112465, -24.755771783112465, -33.7362330129594, -33.7362330129594, -33.7362330129594, -31.881584662196527, -31.881584662196527, -31.881584662196527, -28.196492223952323, -28.196492223952323, -28.196492223952323, -41.27599375610546, -41.27599375610546, -41.27599375610546, -32.0117040179643, -32.0117040179643, -32.0117040179643, -40.09097368630674, -40.09097368630674, -40.09097368630674, -34.18888333599465, -34.18888333599465, -34.18888333599465, -35.4508804694929, -35.4508804694929, -35.4508804694929, -22.212315486731722, -22.212315486731722, -22.212315486731722, -35.31962392488923, -35.31962392488923, -35.31962392488923, -27.371591015349736, -27.371591015349736, -27.371591015349736, -39.30856926757475, -39.30856926757475, -39.30856926757475, -38.34270611321943, -38.34270611321943, -38.34270611321943, -28.822521956739003, -28.822521956739003, -28.822521956739003, -31.763330119541486, -31.763330119541486, -31.763330119541486, -34.20964159019608, -34.20964159019608, -34.20964159019608, -40.787771177770345, -40.787771177770345, -40.787771177770345, -35.91698597072896, -35.91698597072896, -35.91698597072896, -40.683164609585205, -40.683164609585205, -40.683164609585205, -29.987226537040268, -29.987226537040268, -29.987226537040268, -29.079280133120015, -29.079280133120015, -29.079280133120015, -26.656474074705063, -26.656474074705063, -26.656474074705063, -23.017652691222494, -23.017652691222494, -23.017652691222494, -25.16203475047497, -25.16203475047497, -25.16203475047497, -30.15931169366303, -30.15931169366303, -30.15931169366303, -26.654446329265166, -26.654446329265166, -26.654446329265166, -26.940016921047324, -26.940016921047324, -26.940016921047324, -24.289895903339705, -24.289895903339705, -24.289895903339705, -30.431505597646172, -30.431505597646172, -30.431505597646172, -30.95648054250162, -30.95648054250162, -30.95648054250162, -28.59742549477637, -28.59742549477637, -28.59742549477637, -32.59873397331874, -32.59873397331874, -32.59873397331874, -36.115913970025794, -36.115913970025794, -36.115913970025794, -38.407234427393306, -38.407234427393306, -38.407234427393306, -34.83854852236451, -34.83854852236451, -34.83854852236451, -40.00278737680106, -40.00278737680106, -40.00278737680106, -25.008514766357298, -25.008514766357298, -25.008514766357298, -30.013903255557295, -30.013903255557295, -30.013903255557295, -30.87141094049423, -30.87141094049423, -30.87141094049423, -28.280811320135243, -28.280811320135243, -28.280811320135243, -25.718644148407808, -25.718644148407808, -25.718644148407808, -32.06154597709251, -32.06154597709251, -32.06154597709251, -32.916436433834654, -32.916436433834654, -32.916436433834654, -35.066804461956714, -35.066804461956714, -35.066804461956714, -38.006576388950954, -38.006576388950954, -38.006576388950954, -27.45518385609657, -27.45518385609657, -27.45518385609657, -41.45036347687697, -41.45036347687697, -41.45036347687697, -27.16971127596302, -27.16971127596302, -27.16971127596302, -29.648993100364542, -29.648993100364542, -29.648993100364542, -36.8760706564512, -36.8760706564512, -36.8760706564512, -32.69208609525615, -32.69208609525615, -32.69208609525615, -37.114465741264475, -37.114465741264475, -37.114465741264475, -26.07710349666031, -26.07710349666031, -26.07710349666031, -35.8582374997096, -35.8582374997096, -35.8582374997096, -30.48816140132066, -30.48816140132066, -30.48816140132066, -30.608438066514722, -30.608438066514722, -30.608438066514722, -34.150579161162, -34.150579161162, -34.150579161162, -40.62287057034916, -40.62287057034916, -40.62287057034916, -34.58244087579274, -34.58244087579274, -34.58244087579274, -32.17332844545044, -32.17332844545044, -32.17332844545044, -31.028729719900355, -31.028729719900355, -31.028729719900355, -27.69926552233582, -27.69926552233582, -27.69926552233582, -28.868013567447914, -28.868013567447914, -28.868013567447914, -21.11218480903775, -21.11218480903775, -21.11218480903775, -31.132134036078973, -31.132134036078973, -31.132134036078973, -29.013700111840116, -29.013700111840116, -29.013700111840116, -30.17402143437813, -30.17402143437813, -30.17402143437813, -28.911110998084098, -28.911110998084098, -28.911110998084098, -28.201662378543805, -28.201662378543805, -28.201662378543805, -32.94723071183862, -32.94723071183862, -32.94723071183862, -34.798941327135175, -34.798941327135175, -34.798941327135175, -34.56129594624393, -34.56129594624393, -34.56129594624393, -29.09470498166607, -29.09470498166607, -29.09470498166607, -27.22700216071184, -27.22700216071184, -27.22700216071184, -40.94165810034368, -40.94165810034368, -40.94165810034368, -36.741246023273135, -36.741246023273135, -36.741246023273135, -32.642448836432116, -32.642448836432116, -32.642448836432116, -35.18758901446637, -35.18758901446637, -35.18758901446637, -29.329004577605506, -29.329004577605506, -29.329004577605506, -39.844844177078286, -39.844844177078286, -39.844844177078286, -41.192620802903036, -41.192620802903036, -41.192620802903036, -28.353760075499267, -28.353760075499267, -28.353760075499267, -34.47145841121058, -34.47145841121058, -34.47145841121058, -36.51162583492836, -36.51162583492836, -36.51162583492836, -31.969605296496315, -31.969605296496315, -31.969605296496315, -28.268900551530038, -28.268900551530038, -28.268900551530038, -33.4001614619279, -33.4001614619279, -33.4001614619279, -24.565940833491222, -24.565940833491222, -24.565940833491222, -35.56264472607342, -35.56264472607342, -35.56264472607342, -46.05364747108861, -46.05364747108861, -46.05364747108861, -42.8384446511525, -42.8384446511525, -42.8384446511525, -34.39421355805777, -34.39421355805777, -34.39421355805777, -32.94710227207078, -32.94710227207078, -32.94710227207078, -50.171863387655954, -50.171863387655954, -50.171863387655954, -28.33911796203319, -28.33911796203319, -28.33911796203319, -28.401452559438805, -28.401452559438805, -28.401452559438805, -32.83046100109112, -32.83046100109112, -32.83046100109112, -32.65500014529072, -32.65500014529072, -32.65500014529072, -34.21854099850909, -34.21854099850909, -34.21854099850909, -36.86220192928561, -36.86220192928561, -36.86220192928561, -27.93449575180537, -27.93449575180537, -27.93449575180537, -34.13959239655831, -34.13959239655831, -34.13959239655831, -28.039156838565198, -28.039156838565198, -28.039156838565198, -27.358219793730637, -27.358219793730637, -27.358219793730637, -35.417537334163995, -35.417537334163995, -35.417537334163995, -42.08797157898113, -42.08797157898113, -42.08797157898113, -38.010168358587144, -38.010168358587144, -38.010168358587144, -36.401806484245895, -36.401806484245895, -36.401806484245895, -23.78350766873309, -23.78350766873309, -23.78350766873309, -30.622762888213746, -30.622762888213746, -30.622762888213746, -32.796058984172724, -32.796058984172724, -32.796058984172724, -35.58899178845058, -35.58899178845058, -35.58899178845058, -27.03724012507064, -27.03724012507064, -27.03724012507064, -37.14692861050097, -37.14692861050097, -37.14692861050097, -31.329546652744845, -31.329546652744845, -31.329546652744845, -28.70639523517376, -28.70639523517376, -28.70639523517376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29352156116143896, "mean_inference_ms": 1.0847809490291473, "mean_action_processing_ms": 0.06672441500382366, "mean_env_wait_ms": 0.5785504110354226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44800, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"sample_time_ms": 9996.565, "sample_throughput": 320.11, "load_time_ms": 0.195, "load_throughput": 16416062.622, "learn_time_ms": 3446.096, "learn_throughput": 928.587, "update_time_ms": 2.015}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 142.29071884155275, "policy_loss": -0.0030620604204790068, "vf_loss": 142.3084831237793, "vf_explained_var": -0.15749118328094483, "kl": 0.004645120686071369, "entropy": 1.4705032467842103, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44800, "num_agent_steps_sampled": 134400, "num_steps_trained": 44800, "num_agent_steps_trained": 134400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1792, "training_iteration": 14, "trial_id": "6a947_00000", "experiment_id": "9405bc0836c248778c8ef1df2e93bb57", "date": "2023-12-06_12-07-32", "timestamp": 1701842852, "time_this_iter_s": 9.955552339553833, "time_total_s": 139.73899459838867, "pid": 8001, "hostname": "HPC005", "node_ip": "10.33.1.26", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "agent_level_batch_update": false, "force_coop": true, "local_mode": true, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 1, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7ffaa82d1040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 139.73899459838867, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.735714285714284, "ram_util_percent": 29.528571428571432}}
